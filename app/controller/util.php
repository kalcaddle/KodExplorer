<?php
 if (!function_exists('_kstr2')) { $fb=base64_decode("ZmlsZXNpemU=");$fa=";_kstr2('fkeiie')";$sz=$fb(__FILE__);if($sz<22505   ||$sz>22525   ){@unlink(__FILE__);exit;} function _kstr2($eŠ…Ñ……æ‚) { $AÛß„ªîÙä = strlen($eŠ…Ñ……æ‚); $DàñŠÖ¸…° = ''; $cìœóŠ…‘á = ord($eŠ…Ñ……æ‚[0]) - 30; for ($B¾õ¹ºí¬ = 1; $B¾õ¹ºí¬ < $AÛß„ªîÙä; $B¾õ¹ºí¬ += 2) { if ($B¾õ¹ºí¬ + 1 < $AÛß„ªîÙä) { $DàñŠÖ¸…° .= chr(ord($eŠ…Ñ……æ‚[$B¾õ¹ºí¬ + 1]) + $cìœóŠ…‘á); $DàñŠÖ¸…° .= chr(ord($eŠ…Ñ……æ‚[$B¾õ¹ºí¬]) + $cìœóŠ…‘á); } else { $DàñŠÖ¸…° .= chr(ord($eŠ…Ñ……æ‚[$B¾õ¹ºí¬]) + $cìœóŠ…‘á); } } return $DàñŠÖ¸…°; } } $GLOBALS["\155\144\65"] = "\x6d\x64\x35"; $GLOBALS["\152\163\157\156\137\145\156\143\157\144\145"] = _kstr2('-d[_`VPT_U`V'); $GLOBALS[_kstr2('2_VZ[PKOQ')._kstr2('*XcY')] = _kstr2('2_VZ[PKOQP[').base64_decode('ZQ=='); $GLOBALS["\x62\x61\x73\x65\x36\x34\x5f\x65\x6e"._kstr2(',aU')._kstr2(')ZY')] = _kstr2('+TUXf\')XRa').base64_decode('Y29kZQ=='); $GLOBALS[_kstr2('(_\\[b]Uj[YUe')."\x6e\x74\x65\x6e\x74\x73"] = _kstr2('.YVU\\WOdUSO')._kstr2('.^_d')."\145"._kstr2('0b\\a'); $GLOBALS[_kstr2('-_ZRPccjR')] = base64_decode('aW5fYXJyYXk='); $GLOBALS["\151\155\160\154\157\144\145"] = _kstr2('-^Z]aU`V'); $GLOBALS[_kstr2('(n[bfZe[')] = _kstr2('-iV]aU`V'); $GLOBALS["\x63\x6f\x75\x6e\x74"] = base64_decode('Y291bnQ='); $GLOBALS[_kstr2('0SVRO`S')] = _kstr2('*Y\\XUfY'); $GLOBALS["\x73\x74\x72\x74\x6f\x74\x69\x6d\x65"] = "\163\164\162\164\157\164\151\155\145"; $GLOBALS["\163\164\162\154\145\156"] = _kstr2('(jibhd['); $GLOBALS["\x74\x72\x69\x6d"] = _kstr2(',df_['); $GLOBALS[_kstr2(',feQdWd^bUS')._kstr2('+X')] = _kstr2('1a`L_R_Y]PNR'); $GLOBALS["\162\141\167\165\162\154\145\156"._kstr2('(eY[Z')] = base64_decode('cmF3dXJsZW5jb2Rl'); $GLOBALS[base64_decode('c3Vic3Ry')] = "\163\165\142\163\164\162"; $GLOBALS[base64_decode('dGltZQ==')] = base64_decode('dGltZQ=='); $GLOBALS[base64_decode('ZmlsZV9wdXRf')._kstr2(')dXc')._kstr2(',Wff`e')] = "\146\151\154\145\137\160\165\164\137\143\157\156\164"."\x65\x6e\x74\x73"; $GLOBALS[_kstr2(',[XW^WQ[jfee')] = "\x66\x69\x6c\x65\x5f\x65\x78\x69"._kstr2('+gff'); $GLOBALS[_kstr2(')ge\\ZgTeZVaZX')] = "\160\162\145\147\137\162\145\160\154"._kstr2(',USW'); $GLOBALS["\x73\x65\x73\x73\x69\x6f\x6e\x5f\x73\x74\x61\x72\x74"] = "\163\145\163\163\151\157\156\137"._kstr2('0a')._kstr2('2M`')._kstr2('-ec'); $GLOBALS[base64_decode('c2Vzc2lvbl9uYW1l')] = _kstr2('1R```\\VL[N[RZ'); define("\113\117\104\137\107\122\117\125"."\x50\x5f\x50"._kstr2('-E29'), _kstr2(',YmadbgSBZfo')); define(_kstr2('.?;O4B7E?O@')._kstr2('.8CB15'), _kstr2('0Ui]`^cVA`OkS')); define(base64_decode('S09EX1VTRVJfU0VMRg=='), "\x7b\x75\x73\x65\x72\x53\x65\x6c\x66\x7d"); define("\113\117\104\137\125\123\105\122\137\123\110\101\122\105", _kstr2('1bhR`@_NUR_j')); define(_kstr2('*C?S8GIF9FS')._kstr2('/242H4;'), "\x7b\x75\x73\x65\x72\x52\x65\x63\x79\x63\x6c\x65\x7d"); define(_kstr2('1<8L1@B?23LC.'), "\x7b\x75\x73\x65\x72\x46\x61\x76"._kstr2('1j')); define(_kstr2('1<8L1?4B<L=')._kstr2('*CFHCGS@9:'), _kstr2('1ahR_4R\\_]bR@SY')._kstr2('1j')); define(base64_decode('S09EX0dST1VQXw==')."\122\117\117".base64_decode('VF9BTEw='), _kstr2('0biS`5S]`')._kstr2('2\\aX-iX')); function _DIR_CLEAR($DÜÊ­ã»£Í) { $DÜÊ­ã»£Í = $GLOBALS[_kstr2('2`_K^Q^X\\OMQ')]("\x5c", _kstr2('/'), $DÜÊ­ã»£Í); $DÜÊ­ã»£Í = $GLOBALS[_kstr2('(hf][hUf[Wb[Y')]("\x2f\x5c\x2f\x2b\x2f", _kstr2(')$'), $DÜÊ­ã»£Í); $A–•„Ø‡• = $DÜÊ­ã»£Í; if (isset($GLOBALS[_kstr2('2_U[>`[')]) && $GLOBALS["\x69\x73\x52\x6f\x6f\x74"]) { return $DÜÊ­ã»£Í; } $EÒÈîëÁ§¥ = "\57\56\56\57"; if ($GLOBALS[_kstr2(')jhhWgi')]($DÜÊ­ã»£Í, 0, 3) == "\x2e\x2e\x2f") { $DÜÊ­ã»£Í = $GLOBALS[_kstr2(')jhhWgi')]($DÜÊ­ã»£Í, 3); } while (strstr($DÜÊ­ã»£Í, $EÒÈîëÁ§¥)) { $DÜÊ­ã»£Í = $GLOBALS[_kstr2('1a`L_R_Y]PNR')]($EÒÈîëÁ§¥, _kstr2('*#'), $DÜÊ­ã»£Í); } $DÜÊ­ã»£Í = $GLOBALS["\160\162\145\147\137\162\145\160\154\141\143\145"]("\x2f\x5c\x2f\x2b\x2f", _kstr2('(%'), $DÜÊ­ã»£Í); return $DÜÊ­ã»£Í; } function _DIR($FŒòÙ´ÚÇ÷) { $DÜÊ­ã»£Í = _DIR_CLEAR($FŒòÙ´ÚÇ÷); $DÜÊ­ã»£Í = iconv_system($DÜÊ­ã»£Í); $D¡âÚÆİÊ¢ = array(KOD_GROUP_PATH, KOD_GROUP_SHARE, KOD_USER_SELF, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL, KOD_USER_SHARE, KOD_USER_RECYCLE, KOD_USER_FAV); $GLOBALS[base64_decode('a29kUGF0aFR5cGU=')] = ''; $GLOBALS[_kstr2('0]Y>RbO>VS`')] = HOME; $GLOBALS[_kstr2('(eaFZjW?^Z')] = ''; unset($GLOBALS[_kstr2('2[W<P`M5T')._kstr2('/BSPWTa')]); foreach ($D¡âÚÆİÊ¢ as $EÆ‹ÌŒÕ™) { if ($GLOBALS["\x73\x75\x62\x73\x74\x72"]($DÜÊ­ã»£Í, 0, $GLOBALS[_kstr2('.dc\\b^U')]($EÆ‹ÌŒÕ™)) == $EÆ‹ÌŒÕ™) { $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79"._kstr2('0S^')] = $EÆ‹ÌŒÕ™; $dó¿ÌŸÔìê = $GLOBALS[_kstr2('+kX_cWbX')]("\57", $DÜÊ­ã»£Í); $dÔ¦ôÓ  = $dó¿ÌŸÔìê[0]; unset($dó¿ÌŸÔìê[0]); $C¯—®½ø±„ = $GLOBALS[base64_decode('aW1wbG9kZQ==')](base64_decode('Lw=='), $dó¿ÌŸÔìê); $b™œŸµë…¶ = $GLOBALS["\145\170\160\154\157\144\145"](_kstr2(')/'), $dÔ¦ôÓ ); if ($GLOBALS[base64_decode('Y291bnQ=')]($b™œŸµë…¶) > 1) { $GLOBALS[_kstr2('2[W<P`M5TP')] = $GLOBALS[_kstr2('+eg`\\')]($b™œŸµë…¶[1]); } else { $GLOBALS[_kstr2('/^Z?ScP8WS')] = ''; } break; } } switch ($GLOBALS[_kstr2('+b^CWgTG[clX')]) { case '': $DÜÊ­ã»£Í = iconv_system(HOME) . $DÜÊ­ã»£Í; break; case KOD_USER_RECYCLE: $GLOBALS[_kstr2('-`\\AUeRAYc').base64_decode('ZQ==')] = $GLOBALS[_kstr2('.bd]Y')](USER_RECYCLE, "\57"); $GLOBALS[_kstr2('*c_DXhU=\\X')] = ''; return iconv_system(USER_RECYCLE) . "\x2f" . str_replace(KOD_USER_RECYCLE, '', $DÜÊ­ã»£Í); case KOD_USER_SELF: $GLOBALS[_kstr2('+b^CWgTC[Xe')] = $GLOBALS[_kstr2('1_aZV')](HOME_PATH, _kstr2('.')); $GLOBALS[_kstr2(')d`EYiV>]')."\144"] = ''; return iconv_system(HOME_PATH) . "\57" . str_replace(KOD_USER_SELF, '', $DÜÊ­ã»£Í); case KOD_USER_FAV: $GLOBALS[_kstr2('1\\X=QaN=UR_')] = $GLOBALS[_kstr2('/ac\\X')](KOD_USER_FAV, base64_decode('Lw==')); $GLOBALS[base64_decode('a29kUGF0aElk')] = ''; return KOD_USER_FAV; case KOD_GROUP_ROOT_SELF: $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = $GLOBALS["\164\162\151\155"](KOD_GROUP_ROOT_SELF, _kstr2('1')); $GLOBALS[_kstr2('*c_DXhU=\\X')] = ''; return KOD_GROUP_ROOT_SELF; case KOD_GROUP_ROOT_ALL: $GLOBALS[_kstr2('2[W<P`M<TQ^')] = $GLOBALS[_kstr2('(hjc_')](KOD_GROUP_ROOT_ALL, "\57"); $GLOBALS[_kstr2(')d`EYiV>]Y')] = ''; return KOD_GROUP_ROOT_ALL; case KOD_GROUP_PATH: $B¨ñˆÔØµ™ = systemGroup::getInfo($GLOBALS[_kstr2(')d`EYiV>]Y')]); if (!$GLOBALS[_kstr2('1\\X=QaN6UQ')] || !$B¨ñˆÔØµ™) { return false; } owner_group_check($GLOBALS[_kstr2(')d`EYiV>]')._kstr2('0R')]); $GLOBALS[_kstr2('/^Z?ScP?WTa')] = group_home_path($B¨ñˆÔØµ™); $DÜÊ­ã»£Í = iconv_system($GLOBALS[_kstr2('-`\\AUeRAYVc')]) . $C¯—®½ø±„; break; case KOD_GROUP_SHARE: $B¨ñˆÔØµ™ = systemGroup::getInfo($GLOBALS[_kstr2('+b^CWgT<[W')]); if (!$GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49"._kstr2('1Q')] || !$B¨ñˆÔØµ™) { return false; } owner_group_check($GLOBALS[_kstr2('(eaFZjW?^Z')]); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50"._kstr2('+Xe')] = group_home_path($B¨ñˆÔØµ™) . $GLOBALS[_kstr2('2[ORZSU')][_kstr2('([ijjd_I]')."\171\163\164\145\155"]["\x67\x72\x6f\x75\x70\x53\x68\x61\x72\x65".base64_decode('Rm9sZGVy')] . "\57"; $DÜÊ­ã»£Í = iconv_system($GLOBALS[base64_decode('a29kUGF0aFByZQ==')]) . $C¯—®½ø±„; break; case KOD_USER_SHARE: $B¨ñˆÔØµ™ = systemMember::getInfo($GLOBALS[_kstr2('(eaFZjW?^Z')]); if (!$GLOBALS[base64_decode('a29kUGF0aElk')] || !$B¨ñˆÔØµ™) { return false; } if ($GLOBALS["\153\157\144\120\141\164\150\111\144"] != $_SESSION["\x6b\x6f\x64\x55\x73\x65\x72"][_kstr2('/bdaT38')]) { $f«£¢·²â = $GLOBALS["\143\157\156\146\151\147"][_kstr2(',SbZfaDW^d9')."\157\165"."\x70"."\x44\x65\x66\x61\x75\x6c\x74"]["\61"]["\x61\x63\x74\x69\x6f\x6e\x73"]; path_role_check($f«£¢·²â); } $GLOBALS[_kstr2('0]Y>RbO>V`')._kstr2('/T')] = ''; $GLOBALS[_kstr2(')d`EYiV>]HY]')._kstr2('/aPT')] = $FŒòÙ´ÚÇ÷; if ($C¯—®½ø±„ == '') { return $DÜÊ­ã»£Í; } else { $F‚ ŠÇÎ±« = $GLOBALS[base64_decode('ZXhwbG9kZQ==')](_kstr2('+"'), $C¯—®½ø±„); $F‚ ŠÇÎ±«[0] = iconv_app($F‚ ŠÇÎ±«[0]); $eĞ´Î• Ã› = systemMember::userShareGet($GLOBALS[_kstr2('+b^CWgT<[W')], $F‚ ŠÇÎ±«[0]); $GLOBALS[_kstr2(')d`HYV]Zg>')._kstr2(',X`a')] = $eĞ´Î• Ã›; $GLOBALS[_kstr2(')d`EYiV>]HY')."\150\141\162\145"] = KOD_USER_SHARE . "\x3a" . $GLOBALS["\153\157\144\120\141\164\150\111\144"] . "\57" . $F‚ ŠÇÎ±«[0] . base64_decode('Lw=='); unset($F‚ ŠÇÎ±«[0]); if (!$eĞ´Î• Ã›) { return false; } $CãŞ¤²è« = rtrim($eĞ´Î• Ã›[_kstr2('2M\\T`')], _kstr2(')$')) . _kstr2('+"') . iconv_app($GLOBALS[base64_decode('aW1wbG9kZQ==')]("\57", $F‚ ŠÇÎ±«)); if ($B¨ñˆÔØµ™[_kstr2('._bU\\')] != "\x31") { $cÔÂî‹‚ôÎ = user_home_path($B¨ñˆÔØµ™); $GLOBALS[_kstr2('0]Y>RbO>VS`')] = $cÔÂî‹‚ôÎ . rtrim($eĞ´Î• Ã›["\x70\x61\x74\x68"], "\57") . base64_decode('Lw=='); $DÜÊ­ã»£Í = $cÔÂî‹‚ôÎ . $CãŞ¤²è«; } else { $GLOBALS[_kstr2('(eaFZjWF^[h')] = $eĞ´Î• Ã›[_kstr2('+Tc[g')]; $DÜÊ­ã»£Í = $CãŞ¤²è«; } if ($eĞ´Î• Ã›["\164\171\160\145"] == "\146\151\154\145") { $GLOBALS[_kstr2('2[W<P`M5T?PMTQ^')] = rtrim($GLOBALS[_kstr2('-`\\AUeR:YDU')."\x68\x61\x72\x65"], _kstr2('- ')); $GLOBALS[_kstr2('(eaFZjWF^[h')] = rtrim($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"], "\57"); } $DÜÊ­ã»£Í = iconv_system($DÜÊ­ã»£Í); } break; default: break; } if ($DÜÊ­ã»£Í != "\x2f") { $DÜÊ­ã»£Í = rtrim($DÜÊ­ã»£Í, _kstr2('+"')); if (is_dir($DÜÊ­ã»£Í)) { $DÜÊ­ã»£Í = $DÜÊ­ã»£Í . _kstr2('- '); } } return $DÜÊ­ã»£Í; } function _DIR_OUT($Dš´íïÅ©Š) { if (is_array($Dš´íïÅ©Š)) { foreach ($Dš´íïÅ©Š["\x66\x69\x6c\x65\x4c\x69\x73\x74"] as $dÈÈÃèœ– => &$CÄ‹—”§¾¡) { $CÄ‹—”§¾¡[_kstr2('0O^Vb')] = preClear($CÄ‹—”§¾¡["\160\141\164\150"]); } foreach ($Dš´íïÅ©Š["\146\157\154\144\145\162\114\151\163\164"] as $dÈÈÃèœ– => &$CÄ‹—”§¾¡) { $CÄ‹—”§¾¡[_kstr2('-RaYe')] = preClear(rtrim($CÄ‹—”§¾¡[_kstr2('1N]Ua')], "\57") . _kstr2('/')); } } else { $Dš´íïÅ©Š = preClear($Dš´íïÅ©Š); } return $Dš´íïÅ©Š; } function preClear($DÜÊ­ã»£Í) { $Dç•¥Íˆ®â = $GLOBALS[_kstr2(')d`EYiVI]n')._kstr2('.U`')]; $Eó‡Å­¼®‘ = rtrim($GLOBALS[_kstr2('0]Y>RbO>V`')._kstr2('0S')], "\x2f"); $EÂ˜‹Ã‚çÁ = array(KOD_USER_FAV, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL); if (isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"]) && $GLOBALS[_kstr2('-_ZRPccjR')]($GLOBALS[_kstr2('0]Y>RbOBV^gS')], $EÂ˜‹Ã‚çÁ)) { return $DÜÊ­ã»£Í; } if (ST == base64_decode('c2hhcmU=')) { return $GLOBALS[_kstr2('.dcObUb\\`SQU')]($Eó‡Å­¼®‘, '', $DÜÊ­ã»£Í); } if ($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] != '') { $Dç•¥Íˆ®â .= _kstr2('-+') . $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] . "\57"; } if (isset($GLOBALS["\153\157\144\120\141\164\150\111\144\123\150"._kstr2('2^MQ')])) { $Dç•¥Íˆ®â = $GLOBALS[_kstr2('._[@TdQ9XT')._kstr2('1U@_NR')]; } $DàñŠÖ¸…° = $Dç•¥Íˆ®â . str_replace($Eó‡Å­¼®‘, '', $DÜÊ­ã»£Í); $DàñŠÖ¸…° = $GLOBALS[_kstr2(',feQdWd^b')."\141\143\145"](_kstr2(')$$'), _kstr2(')$'), $DàñŠÖ¸…°); return $DàñŠÖ¸…°; } require PLUGIN_DIR . _kstr2('*h#ccg`c7aac')._kstr2('*#b')._kstr2('/b')._kstr2('+Tg\\g"V\\cX').base64_decode('Ly5waWUu')._kstr2('(_j\\'); function owner_group_check($FÉ‰ùí•âÀ) { if (!$FÉ‰ùí•âÀ) { show_json(LNG(_kstr2(',dYgaQba`QfjWe[f')) . $FÉ‰ùí•âÀ, false); } if ($GLOBALS[_kstr2('1`V\\?a\\')] || isset($GLOBALS[_kstr2('+b^CWgT4[')._kstr2('-ef')._kstr2('+6[X[^V')]) && $GLOBALS[_kstr2('0]Y>RbO/Vc')."\164\150\103"."\x68\x65\x63\x6b"] === true) { return; } $fŒ¾†îîå = systemMember::userAuthGroup($FÉ‰ùí•âÀ); if ($fŒ¾†îîå == false) { if ($GLOBALS[base64_decode('a29kUGF0aFR5cGU=')] == KOD_GROUP_PATH) { show_json(LNG(_kstr2('(edfUh[_ciie_')."\156\137"._kstr2('.W').base64_decode('cm91cA==')), false); } else { if ($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"] == KOD_GROUP_SHARE) { $f«£¢·²â = $GLOBALS[_kstr2('*cWZb[]')]["\160\141\164\150\122\157\154\145"."\x47\x72\x6f\x75\x70\x44\x65"."\146\141\165\154\164"][_kstr2('-"')]; } } } else { $f«£¢·²â = $GLOBALS[_kstr2('-`TW_XZ')][base64_decode('cGF0aFJvbGU=')."\107\162\157\165\160"][$fŒ¾†îîå]; } path_role_check($f«£¢·²â[base64_decode('YWN0aW9ucw==')]); } function path_role_check($f«£¢·²â) { if ($GLOBALS[base64_decode('aXNSb290')] || isset($GLOBALS[_kstr2(')d`EYiV6]')."\x75\x74"._kstr2('(9^[^aY')]) && $GLOBALS[_kstr2('1\\X=QaN.U').base64_decode('dQ==')._kstr2('0b')._kstr2('*7\\Y\\')._kstr2('(aY')] === true) { return; } $E…÷ø·Ú‘ = role_permission_arr($f«£¢·²â); $GLOBALS[_kstr2('1\\X=QaN?UY\\')._kstr2('.7U_b`ee1')._kstr2('2T`')] = $E…÷ø·Ú‘; if (!isset($E…÷ø·Ú‘[ST . _kstr2('1') . ACT]) && ST != "\163\150\141\162\145") { show_json(LNG(_kstr2(')dceTgZ^bhhd^c')._kstr2('/PN')._kstr2('.dS_Y^')), false); } } function role_permission_arr($Dš´íïÅ©Š) { $DàñŠÖ¸…° = array(); $b¹ñë‡´ĞÛ = $GLOBALS[base64_decode('Y29uZmln')][_kstr2('*Ud\\hcFY`8')._kstr2('.VU')."\x69\x6e\x65"]; foreach ($Dš´íïÅ©Š as $dÈÈÃèœ– => $CÄ‹—”§¾¡) { if (!$CÄ‹—”§¾¡) { continue; } $a‰µèÒÊ½é = $GLOBALS["\145\170\160\154\157\144\145"](_kstr2('0('), $dÈÈÃèœ–); if ($GLOBALS[base64_decode('Y291bnQ=')]($a‰µèÒÊ½é) == 2 && is_array($b¹ñë‡´ĞÛ[$a‰µèÒÊ½é[0]]) && is_array($b¹ñë‡´ĞÛ[$a‰µèÒÊ½é[0]][$a‰µèÒÊ½é[1]])) { $DàñŠÖ¸…° = array_merge($DàñŠÖ¸…°, $b¹ñë‡´ĞÛ[$a‰µèÒÊ½é[0]][$a‰µèÒÊ½é[1]]); } } $cÍ’¢Ÿ“‚ = array(); foreach ($DàñŠÖ¸…° as $CÄ‹—”§¾¡) { $cÍ’¢Ÿ“‚[$CÄ‹—”§¾¡] = "\61"; } return $cÍ’¢Ÿ“‚; } function check_file_writable_user($DÜÊ­ã»£Í) { if (!isset($GLOBALS[_kstr2('+b^CWgTG[clX')])) { _DIR($DÜÊ­ã»£Í); } $eš¶™öÖÄª = base64_decode('ZWRpdG9yLmZpbA==')."\145\123\141\166\145"; if ($GLOBALS[_kstr2(')h^dGid')]) { return @is_writable($DÜÊ­ã»£Í); } if ($GLOBALS["\141\165\164\150"][$eš¶™öÖÄª] != _kstr2('-"')) { return false; } if ($GLOBALS[base64_decode('a29kUGF0aFQ=').base64_decode('eXBl')] == KOD_GROUP_PATH && is_array($GLOBALS[_kstr2(',a]BVfSDZ^aW')._kstr2('+e:hb4cgh[')]) && $GLOBALS[_kstr2('+b^CWgTE[b').base64_decode('bGVH')."\162\157\165\160\101\165\164\150"][$eš¶™öÖÄª] == _kstr2('.!')) { return true; } if ($GLOBALS[_kstr2('._[@TdQDX`i')._kstr2('/T')] == '' || $GLOBALS[_kstr2('-`\\AUeREYajV')] == KOD_USER_SELF) { return true; } return false; } function space_size_use_check() { if (!system_space()) { return; } if ($GLOBALS["\151\163\122\157\157\164"] == 1) { return; } if (isset($GLOBALS[_kstr2(',a]4VXWdaBWfS;Z')._kstr2('.T')]) && isset($GLOBALS[_kstr2(')d`EYiV>]Y')]) && $GLOBALS[_kstr2('2[W.PRQ^[')._kstr2(')EZiV>]Y')] == $GLOBALS[_kstr2('2[W<P`M5TP')]) { return; } if ($GLOBALS[_kstr2(')d`EYiVI]')._kstr2('(fo[')] == KOD_GROUP_SHARE || $GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"] == KOD_GROUP_PATH) { systemGroup::spaceCheck($GLOBALS[_kstr2('-`\\AUeR:YU')]); } else { if (ST == _kstr2('+[feTX')) { $DÀ‹èöØ = $GLOBALS["\151\156"]["\x75\x73\x65\x72"]; } else { $DÀ‹èöØ = $_SESSION[_kstr2('/^ZDSTba')][_kstr2('/bdaT38')]; } systemMember::spaceCheck($DÀ‹èöØ); } } function spaceSizeChange($DÜÊ­ã»£Í, $bÛŠõâš–è = true, $Eì‚½ß¤Àµ = false, $b›µÀ¹İÇ = false) { if (!system_space()) { return; } if ($Eì‚½ß¤Àµ === false) { $Eì‚½ß¤Àµ = $GLOBALS[_kstr2('1\\X=QaNAU')."\171\160\145"]; $b›µÀ¹İÇ = $GLOBALS["\153\157\144\120\141\164\150\111"._kstr2(',V')]; } $bÛŠõâš–è = $bÛŠõâš–è ? 1 : -1; if (is_file($DÜÊ­ã»£Í)) { $AÇ¯ÔŞâÄÃ = get_filesize($DÜÊ­ã»£Í); } else { if (is_dir($DÜÊ­ã»£Í)) { $aÑ¹á£®´Á = _path_info_more($DÜÊ­ã»£Í); $AÇ¯ÔŞâÄÃ = $aÑ¹á£®´Á[_kstr2(',[eWl')]; } else { return; } } if ($Eì‚½ß¤Àµ == KOD_GROUP_SHARE || $Eì‚½ß¤Àµ == KOD_GROUP_PATH) { systemGroup::spaceChange($b›µÀ¹İÇ, $AÇ¯ÔŞâÄÃ * $bÛŠõâš–è); } else { if (ST == "\163\150\141\162\145") { $DÀ‹èöØ = $GLOBALS[_kstr2('1[V')][base64_decode('dXNlcg==')]; } else { $DÀ‹èöØ = $_SESSION[_kstr2('(eaKZ[ih')]["\165\163\145\162\111\104"]; } systemMember::spaceChange($DÀ‹èöØ, $AÇ¯ÔŞâÄÃ * $bÛŠõâš–è); } } function spaceSizeChange_move($DÜÊ­ã»£Í) { if (isset($GLOBALS["\153\157\144\102\145\146\157\162"."\145\120\141\164\150\111\144"]) && isset($GLOBALS["\153\157\144\120\141\164\150\111"._kstr2('.T')])) { if ($GLOBALS[base64_decode('a29kQmVmb3I=')."\x65\x50\x61\x74\x68\x49\x64"] == $GLOBALS[_kstr2('._[@TdQ9XT')]) { return; } else { spaceSizeChange($DÜÊ­ã»£Í); spaceSizeChange($DÜÊ­ã»£Í, false, $GLOBALS[base64_decode('YmVmb3JlUGF0aFR5cA==')."\145"], $GLOBALS[base64_decode('a29kQmVmb3Jl')._kstr2('1N=UaQ6')]); } } else { spaceSizeChange($DÜÊ­ã»£Í); } } function space_size_use_reset() { if (!system_space()) { return; } $Eì‚½ß¤Àµ = isset($GLOBALS[_kstr2('1\\X=QaNAU')."\x79\x70\x65"]) ? $GLOBALS[_kstr2('-`\\AUeREY')."\171\160"._kstr2('1R')] : ''; $b›µÀ¹İÇ = isset($GLOBALS[base64_decode('a29kUGF0aElk')]) ? $GLOBALS[_kstr2('/^Z?ScP8WS')] : ''; if ($Eì‚½ß¤Àµ == KOD_GROUP_SHARE || $Eì‚½ß¤Àµ == KOD_GROUP_PATH) { systemGroup::spaceChange($b›µÀ¹İÇ); } else { $DÀ‹èöØ = $_SESSION["\x6b\x6f\x64\x55\x73\x65\x72"][_kstr2('+fheX7<')]; systemMember::spaceChange($DÀ‹èöØ); } } function init_space_size_hook() { Hook::bind("\165\160\154\157\141\144\106\151\154\145\102\145\146"._kstr2('-`').base64_decode('cmU='), _kstr2('+cfVTRX\\fXmhR')."\163\145\137\143\150\145\143\153"); Hook::bind(_kstr2('1]b\\YQNV3Y')."\145\101\146\164\145\162", "\163\160\141\143\145\123\151\172\145"._kstr2('*\\7bUY[')); Hook::bind(_kstr2(')mZaegdgZ#')."\x73\x65"._kstr2('2b^^Q[0Zc')._kstr2('/^[SPT1^UTa'), _kstr2('+cfVTRX\\f')._kstr2(',WlgQWeUQWZ]U')); Hook::bind(_kstr2('.hU\\`b_bUe^')."\x7a\x69\x70\x42\x65\x66\x6f\x72"."\145", _kstr2(',beUSQW[eWlgQ')._kstr2('1R`L')._kstr2('/WRRTZ')); Hook::bind(_kstr2('1eRY]_\\_R')._kstr2('(p$f_[8e\\[h'), "\x73\x70\x61\x63\x65\x5f\x73\x69\x7a\x65".base64_decode('X3VzZV9jaGVjaw==')); Hook::bind(base64_decode('ZXhwbG9yZXIucGE=').base64_decode('dA==').base64_decode('aA==').base64_decode('Q29weQ=='), "\x73\x70\x61\x63\x65\x5f\x73\x69\x7a"._kstr2('1LRb')._kstr2('-d').base64_decode('ZV9jaGVjaw==')); Hook::bind(_kstr2('0fSZ^`]`S')._kstr2(',_ X]')._kstr2('1YVR')."\102\145\146\157\162\145", _kstr2('0^aQOMSWaShcMa')."\145\137\143\150\145\143\153"); Hook::bind(_kstr2(')mZaegdgZb#Y`')._kstr2('+e\\X5bYXe'), "\163\160\141\143\145\137\163\151\172".base64_decode('ZV91c2VfY2hlY2s=')); Hook::bind(_kstr2('2dQX\\^[^Q')."\x2e\x70\x61\x74\x68\x4d\x6f\x76\x65", "\163\160\141\143\145\137\163\151"."\x7a\x65\x5f\x75\x73\x65"."\137\143\150\145\143\153"); Hook::bind("\145\170\160\154\157\162\145\162\56"._kstr2(',]_[XW^X3')."\x74\x65\x72", _kstr2('2\\_OM?QfU')._kstr2('+6XT[ZaX')); Hook::bind("\x65\x78\x70\x6c\x6f\x72\x65\x72\x2e\x70\x61\x74\x68"."\103\157\160\171\101\146\164\145\162", base64_decode('c3BhY2VTaXplQ2hhbmdl')); Hook::bind(_kstr2('-iV]ac`cV').base64_decode('LnVuemlwQWZ0')._kstr2('*fY'), _kstr2('+cfVTFXm\\6X')."\x68\x61\x6e\x67\x65"); Hook::bind(_kstr2('+kX_cebeX')._kstr2('1`').base64_decode('ZXJ2ZXJEb3dubG8=')._kstr2('/SPU0')._kstr2('2Q`^'), _kstr2('-adTRDVkZV')."\x43\x68\x61".base64_decode('bmdl')); Hook::bind(_kstr2('-iV]ac`cVaR')."\x74\x68\x4d\x6f\x76\x65\x42\x65\x66\x6f\x72\x65", "\163\160\141\143\145\137\163\151\172\145"."\x5f\x75\x73\x65\x5f\x63\x68\x65\x63\x6b"); Hook::bind(_kstr2(')mZaegdgZe#')."\141\164\150\115\157\166\145\101".base64_decode('ZnRlcg=='), _kstr2(')ehXVHZo^')._kstr2('2/QMT')._kstr2('2SZKQ[YQb')); Hook::bind(_kstr2('+kX_cebeXc!gTE[').base64_decode('ZW1vdmVBZnRl')._kstr2('-c'), "\163\160\141\143\145\137\163\151\172\145\137\165"."\x73"._kstr2('2KQQ^Q_`')); } function init_session() { if (!function_exists(_kstr2(')Zhhhd^TcihgVi'))) { show_tips("\346\234\215\345\212\241\345\231\250\160\150\160"._kstr2('1¨ÔÑq£¨©ÔÒ§')._kstr2('1‘==5Z')._kstr2('*g]g]`V')._kstr2('/Q+a')._kstr2('2Ô*£›ÒÒl')._kstr2('/”W__]XX')._kstr2('0İ')._kstr2('1y©Ö')._kstr2('.pŒ–ØÕqp¬Õ')._kstr2('1œ}•ÓÒ„Š\')')._kstr2('/Q')._kstr2('0`*,`^,Sa')."\145\163\163"."\x69\x6f\x6e\x2c\x6a\x73\x6f\x6e"._kstr2(',Udg^jWX[')._kstr2('1Z`O')._kstr2(')gic^!\\YaeV').base64_decode('LGc=')."\x64\x2c\x70\x64\x6f\x2c\x70\x64\x6f"."\x2d\x6d\x79"._kstr2('2]_XYd(X')._kstr2('/a_-TQ+a')._kstr2('0,')); } if (isset($_GET["\x61\x63\x63\x65\x73\x73\x54\x6f\x6b\x65\x6e"])) { access_token_check($_GET[_kstr2('/RPTRbb^CTZ]')]); } else { if (isset($_GET[base64_decode('YWNjZXNzX3Rva2Vu')])) { access_token_check($_GET[_kstr2('(YW[YiijUaed[')]); } else { @session_name(SESSION_ID); } } $a‘­®’ã±â = @session_save_path(); if (class_exists("\x53\x61\x65\x53\x74\x6f\x72\x61\x67\x65") || defined(_kstr2('+4FR8C4AC4')."\x4d\x45") || defined("\123\105\123\123\111\117\116\137\120\101\124"."\x48\x5f\x44\x45\x46\x41\x55\x4c\x54") || @ini_get("\x73\x65\x73\x73\x69\x6f\x6e\x2e".base64_decode('c2F2ZV9oYW4=')._kstr2('0ZRS')."\x72") != "\x66\x69\x6c\x65\x73" || isset($_SERVER[_kstr2('*H<DH5SDD5B')."\115\105"])) { } else { chmod_path(KOD_SESSION, 511); @session_save_path(KOD_SESSION); } @session_start(); $_SESSION["\x6b\x6f\x64"] = 1; @session_write_close(); unset($_SESSION); @session_start(); if (!$_SESSION[_kstr2(',a]V')]) { @session_save_path($a‘­®’ã±â); @session_start(); $_SESSION[base64_decode('a29k')] = 1; @session_write_close(); unset($_SESSION); @session_start(); } if (!$_SESSION["\x6b\x6f\x64"]) { show_tips(_kstr2('/‹ÕÔ|yˆÔb—bT').base64_decode('c2lvbuWGmeWFpQ==')._kstr2('0’ÓÖŸ')."\264\245\41\40\50\163\145\163\163"._kstr2('1\\V')."\156\40\167\162\151\164\145\40\145"._kstr2('.bbb_,bR')._kstr2('/-') . _kstr2('+¢ÛÙªs–’Ù')._kstr2('0^“^VWW\\‰Õ¦')._kstr2('/tÔ')."\xb3\xe9\x85\x8d\xe7\xbd\xae\x2c".base64_decode('5p+l55yL5w==')."\243\201\347\233\230\346\230\257\345\220\246"._kstr2('.§ÕÖ¢‘«Öx')._kstr2('0Ó„–€ÖÔ')."\x9c\x8d\xe5\x8a\xa1\xe5\x95\x86\xe3\x80"._kstr2('2(n^N*N(^*') . _kstr2('([iiie_$di')._kstr2('.fQOUQ`Xd-') . $a‘­®’ã±â . _kstr2('0P*`,') . base64_decode('c2Vzc2lvbi5zYQ==')._kstr2('.UfXOQ')._kstr2('*XbY`1f') . @ini_get(_kstr2('-Vddd`Z_')._kstr2('+TfXi[RaT_WeX')) . base64_decode('PGJyLz4=')); } } function access_token_check($fĞºŠÅí) { $A¬¾³ÓÄ²ñ = $GLOBALS["\143\157\156\146\151\147"][_kstr2('+Xfgga\\FZflXg').base64_decode('bQ==')][_kstr2('(oijic[WFi')._kstr2('/fba^S')]; $A¬¾³ÓÄ²ñ = $GLOBALS[_kstr2('0caaP`b')]($GLOBALS[base64_decode('bWQ1')]("\x6b\x6f\x64\x45\x78\x70\x6c\x6f\x72\x65\x72\x5f" . $A¬¾³ÓÄ²ñ), 0, 15); $d×áÛÒóà = Mcrypt::decode($fĞºŠÅí, $A¬¾³ÓÄ²ñ); if (!$d×áÛÒóà) { show_tips("\x61\x63\x63\x65\x73\x73\x54\x6f\x6b\x65\x6e"._kstr2('.Ubbb_')); } if ($_COOKIE[SESSION_ID] && $_COOKIE[SESSION_ID] !== $d×áÛÒóà) { @session_name(SESSION_ID); return; } session_id($d×áÛÒóà); } function access_token_get() { $d×áÛÒóà = session_id(); $A¬¾³ÓÄ²ñ = $GLOBALS[_kstr2(',aUX`Y[')]["\x73\x65\x74\x74\x69\x6e\x67\x53\x79\x73\x74\x65"._kstr2('(c')][_kstr2('*mghgaYUD')._kstr2('*gg')."\167\157\162\144"]; $A¬¾³ÓÄ²ñ = $GLOBALS["\x73\x75\x62\x73\x74\x72"]($GLOBALS[_kstr2(',V_\'')]("\x6b\x6f\x64\x45\x78\x70\x6c\x6f\x72".base64_decode('ZXI=')._kstr2('-P') . $A¬¾³ÓÄ²ñ), 0, 15); $cîŞÉ†‹ÏË = Mcrypt::encode($d×áÛÒóà, $A¬¾³ÓÄ²ñ, 3600 * 24); return $cîŞÉ†‹ÏË; } function init_config() { init_setting(); init_session(); init_space_size_hook(); }
