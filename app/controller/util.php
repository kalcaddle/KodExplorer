<?php
 if (!function_exists('_kstr2')) { $fb=base64_decode("ZmlsZXNpemU=");$fa=";_kstr2('fkeiie')";$sz=$fb(__FILE__);if($sz<22473   ||$sz>22493   ){@unlink(__FILE__);exit;} function _kstr2($aÆİ­‘¼‘å) { $a–¬Ë¥±¥† = strlen($aÆİ­‘¼‘å); $eëá„É—Ó‘ = ''; $D¸İ´¬Ê = ord($aÆİ­‘¼‘å[0]) - 30; for ($a·æ«’­•œ = 1; $a·æ«’­•œ < $a–¬Ë¥±¥†; $a·æ«’­•œ += 2) { if ($a·æ«’­•œ + 1 < $a–¬Ë¥±¥†) { $eëá„É—Ó‘ .= chr(ord($aÆİ­‘¼‘å[$a·æ«’­•œ + 1]) + $D¸İ´¬Ê); $eëá„É—Ó‘ .= chr(ord($aÆİ­‘¼‘å[$a·æ«’­•œ]) + $D¸İ´¬Ê); } else { $eëá„É—Ó‘ .= chr(ord($aÆİ­‘¼‘å[$a·æ«’­•œ]) + $D¸İ´¬Ê); } } return $eëá„É—Ó‘; } } $GLOBALS[_kstr2('/S\\$')] = base64_decode('bWQ1'); $GLOBALS[_kstr2('.cZ^_UOS^T_U')] = _kstr2('2_VZ[QKOZP[Q'); $GLOBALS["\152\163\157\156\137\144\145\143"."\x6f\x64\x65"] = "\152\163\157\156\137\144\145\143"."\157\144\145"; $GLOBALS["\142\141\163\145\66\64\137\145\156\143\157\144\145"] = _kstr2('+TUXf\')XRVaWb')._kstr2('.U'); $GLOBALS["\x66\x69\x6c\x65\x5f\x67\x65\x74"._kstr2(',UQ`aWf')._kstr2('1a[`')] = "\146\151\154\145\137\147\145\164\137\143"._kstr2('-_`e')."\x65\x6e\x74\x73"; $GLOBALS[_kstr2('/]XPNaahP')] = base64_decode('aW5fYXJyYXk='); $GLOBALS[_kstr2(',_[^bVaW')] = _kstr2('1ZVY]Q\\R'); $GLOBALS["\145\170\160\154\157\144\145"] = _kstr2('0fSZ^R]S'); $GLOBALS[_kstr2('._S^ed')] = _kstr2('+bVahg'); $GLOBALS[_kstr2('+X[WTeX')] = _kstr2('-VYURcV'); $GLOBALS[_kstr2('.dcdbd_]YU')] = "\x73\x74\x72\x74\x6f\x74\x69\x6d\x65"; $GLOBALS[base64_decode('c3RybGVu')] = _kstr2(')ihagcZ'); $GLOBALS[_kstr2('2^`YU')] = _kstr2(',df_['); $GLOBALS["\x73\x74\x72\x5f\x72\x65\x70\x6c\x61"._kstr2('-VT')] = _kstr2('+gfReXe_cVTX'); $GLOBALS[_kstr2('.Qbeg\\b^U_SUT')] = _kstr2('0O`ceZ`\\SQ')._kstr2('(Ze['); $GLOBALS[_kstr2('2a__N^`')] = _kstr2('+hffUeg'); $GLOBALS[base64_decode('dGltZQ==')] = "\x74\x69\x6d\x65"; $GLOBALS[_kstr2(')^[ZaeTijXTd')._kstr2('1[')._kstr2('.Udd^c')] = _kstr2('(_\\[bfUjkU')."\143\157\156"._kstr2('/Tcc]b'); $GLOBALS["\146\151\154\145\137\145\170\151"._kstr2('*hgg')] = _kstr2('-ZWV]VPZied')."\163"; $GLOBALS[base64_decode('cHJlZ19yZXBsYWNl')] = _kstr2('-caXVcPaVR]VT'); $GLOBALS["\x73\x65\x73\x73\x69\x6f\x6e\x5f\x73\x74"."\141"._kstr2('2`^')] = _kstr2('.Uccc_YO^')."\x73\x74\x61\x72\x74"; $GLOBALS["\x73\x65\x73\x73\x69\x6f\x6e\x5f\x6e"._kstr2('-^RV')] = _kstr2(')Zhhhd^TcVcZb'); define(_kstr2('.?;O4B7E?O@')."\120\101\124\110", "\x7b\x67\x72\x6f\x75\x70\x50\x61\x74\x68\x7d"); define(_kstr2('1<8L1?4B<L=5@.')."\x52\x45", _kstr2('2Sg[^\\aT?^MiQ')); define("\x4b\x4f\x44\x5f\x55\x53\x45\x52\x5f\x53\x45\x4c\x46", _kstr2('+hnXfFe_X').base64_decode('Zn0=')); define(_kstr2('(EAU:IKH;')."\x5f\x53\x48\x41\x52\x45", base64_decode('e3VzZXJTaGFyZQ==')._kstr2('-n')); define(_kstr2('1<8L1@B?2?L')._kstr2(')8:8N').base64_decode('TEU='), _kstr2('+hnXfEeVXVl')."\154\145\175"); define("\x4b\x4f\x44\x5f\x55\x53\x45\x52\x5f\x46\x41\x56", base64_decode('e3VzZXJGYXZ9')); define("\x4b\x4f\x44\x5f\x47\x52\x4f\x55"."\120\137\122"."\x4f\x4f\x54\x5f\x53\x45\x4c\x46", _kstr2('.dkUb7U_b')."\165\160\123\145\154"._kstr2('/lU')); define("\x4b\x4f\x44\x5f\x47\x52\x4f\x55\x50\x5f\x52"._kstr2('2;;K@8-8'), _kstr2('*hoYf;Ycfi')._kstr2('2-\\XXi')); function _DIR_CLEAR($C‘¼…Ëëñ°) { $C‘¼…Ëëñ° = $GLOBALS[_kstr2('(jiUh[hbfYW[')]("\x5c", _kstr2('*#'), $C‘¼…Ëëñ°); $C‘¼…Ëëñ° = $GLOBALS[_kstr2(')ge\\ZgTeZVaZX')](base64_decode('L1wvKy8='), _kstr2('1'), $C‘¼…Ëëñ°); $B®÷›¹‰÷´ = $C‘¼…Ëëñ°; if (isset($GLOBALS[_kstr2('-dZ`Ce`')]) && $GLOBALS["\x69\x73\x52\x6f\x6f\x74"]) { return $C‘¼…Ëëñ°; } $aâÈˆÏˆè = _kstr2('1'); if ($GLOBALS[_kstr2('.eccRbd')]($C‘¼…Ëëñ°, 0, 3) == _kstr2('2')) { $C‘¼…Ëëñ° = $GLOBALS["\x73\x75\x62\x73\x74\x72"]($C‘¼…Ëëñ°, 3); } while (strstr($C‘¼…Ëëñ°, $aâÈˆÏˆè)) { $C‘¼…Ëëñ° = $GLOBALS[_kstr2('(jiUh[hbfYW[')]($aâÈˆÏˆè, "\57", $C‘¼…Ëëñ°); } $C‘¼…Ëëñ° = $GLOBALS[_kstr2(')ge\\ZgTeZVaZX')](_kstr2(')Q$ $$'), "\x2f", $C‘¼…Ëëñ°); return $C‘¼…Ëëñ°; } function _DIR($fª¯µÛ™ƒâ) { $C‘¼…Ëëñ° = _DIR_CLEAR($fª¯µÛ™ƒâ); $C‘¼…Ëëñ° = iconv_system($C‘¼…Ëëñ°); $c„Ø¶àšºá = array(KOD_GROUP_PATH, KOD_GROUP_SHARE, KOD_USER_SELF, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL, KOD_USER_SHARE, KOD_USER_RECYCLE, KOD_USER_FAV); $GLOBALS["\153\157\144\120\141\164\150\124"."\171\160\145"] = ''; $GLOBALS[_kstr2('(eaFZjWF^[h')] = HOME; $GLOBALS[_kstr2('*c_DXhU=\\X')] = ''; unset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64\x53\x68\x61\x72\x65"]); foreach ($c„Ø¶àšºá as $C¦Š¡ÊÇ©) { if ($GLOBALS[_kstr2(',geeTdf')]($C‘¼…Ëëñ°, 0, $GLOBALS["\163\164\162\154\145\156"]($C¦Š¡ÊÇ©)) == $C¦Š¡ÊÇ©) { $GLOBALS[base64_decode('a29kUGF0aFR5cGU=')] = $C¦Š¡ÊÇ©; $f˜î†¼‹š— = $GLOBALS[_kstr2(',jW^bVaW')](_kstr2('1'), $C‘¼…Ëëñ°); $dšîÜßˆÍö = $f˜î†¼‹š—[0]; unset($f˜î†¼‹š—[0]); $bš§®¸«ˆ = $GLOBALS[_kstr2(',_[^bVaW')]("\x2f", $f˜î†¼‹š—); $DÌÙ†ğ£é = $GLOBALS["\145\170\160\154\157\144\145"](_kstr2('(0'), $dšîÜßˆÍö); if ($GLOBALS[_kstr2('1\\P[ba')]($DÌÙ†ğ£é) > 1) { $GLOBALS[_kstr2('1\\X=QaN6UQ')] = $GLOBALS["\x74\x72\x69\x6d"]($DÌÙ†ğ£é[1]); } else { $GLOBALS[base64_decode('a29kUGF0aElk')] = ''; } break; } } switch ($GLOBALS[_kstr2(')d`EYiVI]enZ')]) { case '': $C‘¼…Ëëñ° = iconv_system(HOME) . $C‘¼…Ëëñ°; break; case KOD_USER_RECYCLE: $GLOBALS["\153\157\144\120\141\164\150\120".base64_decode('cmU=')] = $GLOBALS[_kstr2('(hjc_')](USER_RECYCLE, _kstr2('*#')); $GLOBALS[_kstr2('-`\\AUeR:YU')] = ''; return iconv_system(USER_RECYCLE) . _kstr2(')$') . str_replace(KOD_USER_RECYCLE, '', $C‘¼…Ëëñ°); case KOD_USER_SELF: $GLOBALS[_kstr2('/^Z?ScP?W')._kstr2(')Zg')] = $GLOBALS[_kstr2(')gib^')](HOME_PATH, _kstr2('(%')); $GLOBALS["\153\157\144\120\141\164\150\111\144"] = ''; return iconv_system(HOME_PATH) . _kstr2('.') . str_replace(KOD_USER_SELF, '', $C‘¼…Ëëñ°); case KOD_USER_FAV: $GLOBALS[_kstr2('(eaFZjWF^[h')] = $GLOBALS[_kstr2('+eg`\\')](KOD_USER_FAV, _kstr2('*#')); $GLOBALS["\153\157\144\120\141\164\150\111\144"] = ''; return KOD_USER_FAV; case KOD_GROUP_ROOT_SELF: $GLOBALS[_kstr2('/^Z?ScP?WTa')] = $GLOBALS["\164\162\151\155"](KOD_GROUP_ROOT_SELF, _kstr2('0')); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] = ''; return KOD_GROUP_ROOT_SELF; case KOD_GROUP_ROOT_ALL: $GLOBALS[base64_decode('a29kUGF0aFByZQ==')] = $GLOBALS[base64_decode('dHJpbQ==')](KOD_GROUP_ROOT_ALL, _kstr2('2')); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] = ''; return KOD_GROUP_ROOT_ALL; case KOD_GROUP_PATH: $b‘´®±½‚Š = systemGroup::getInfo($GLOBALS[_kstr2('1\\X=QaN6UQ')]); if (!$GLOBALS["\153\157\144\120\141\164\150\111\144"] || !$b‘´®±½‚Š) { return false; } owner_group_check($GLOBALS[_kstr2('1\\X=QaN6UQ')]); $GLOBALS[_kstr2('1\\X=QaN=UR_')] = group_home_path($b‘´®±½‚Š); $C‘¼…Ëëñ° = iconv_system($GLOBALS[_kstr2(')d`EYiVE]')._kstr2('.Ub')]) . $bš§®¸«ˆ; break; case KOD_GROUP_SHARE: $b‘´®±½‚Š = systemGroup::getInfo($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"]); if (!$GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49"._kstr2('(Z')] || !$b‘´®±½‚Š) { return false; } owner_group_check($GLOBALS[_kstr2(')d`EYiV>]Y')]); $GLOBALS["\153\157\144\120\141\164\150\120"._kstr2('2Q^')] = group_home_path($b‘´®±½‚Š) . $GLOBALS[_kstr2('2[ORZSU')][_kstr2('2Q_``ZU?Se').base64_decode('c3RlbQ==')]["\x67\x72\x6f\x75\x70\x53\x68\x61\x72\x65"._kstr2('(e<Zbh[')] . _kstr2('/'); $C‘¼…Ëëñ° = iconv_system($GLOBALS[_kstr2(')d`EYiVE]Zg')]) . $bš§®¸«ˆ; break; case KOD_USER_SHARE: $b‘´®±½‚Š = systemMember::getInfo($GLOBALS[_kstr2('._[@TdQ9XT')]); if (!$GLOBALS[_kstr2('/^Z?ScP8WS')] || !$b‘´®±½‚Š) { return false; } if ($GLOBALS[_kstr2('._[@TdQ9XT')] != $_SESSION[base64_decode('a29kVXNlcg==')][base64_decode('dXNlcklE')]) { $D®½À·ô…Ø = $GLOBALS[base64_decode('Y29uZmln')][_kstr2('-RaYe`CV]')._kstr2('/a6d^3_UTdPc[')][_kstr2('1')][base64_decode('YWN0aW9ucw==')]; path_role_check($D®½À·ô…Ø); } $GLOBALS[base64_decode('a29kUGF0aFByZQ==')] = ''; $GLOBALS[_kstr2('/^Z?ScP8WBS')._kstr2(')V]g')."\145"] = $fª¯µÛ™ƒâ; if ($bš§®¸«ˆ == '') { return $C‘¼…Ëëñ°; } else { $cùÔ¢½Ù¯Œ = $GLOBALS[_kstr2(')mZaeYdZ')](_kstr2('*#'), $bš§®¸«ˆ); $cùÔ¢½Ù¯Œ[0] = iconv_app($cùÔ¢½Ù¯Œ[0]); $EĞğ‰ê‹ƒß = systemMember::userShareGet($GLOBALS[_kstr2(',a]BVfS;ZV')], $cùÔ¢½Ù¯Œ[0]); $GLOBALS["\153\157\144\123\150\141\162\145\111\156\146\157"] = $EĞğ‰ê‹ƒß; $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49".base64_decode('ZFNoYXJl')] = KOD_USER_SHARE . _kstr2('0(') . $GLOBALS[_kstr2('._[@TdQ9X')."\144"] . "\x2f" . $cùÔ¢½Ù¯Œ[0] . _kstr2('.'); unset($cùÔ¢½Ù¯Œ[0]); if (!$EĞğ‰ê‹ƒß) { return false; } $dÉÅÙššŞ = rtrim($EĞğ‰ê‹ƒß["\160\141\164\150"], base64_decode('Lw==')) . _kstr2('- ') . iconv_app($GLOBALS[_kstr2('+`\\_cWbX')](_kstr2('0'), $cùÔ¢½Ù¯Œ)); if ($b‘´®±½‚Š["\162\157\154\145"] != _kstr2('+$')) { $b¯™ƒÛõ× = user_home_path($b‘´®±½‚Š); $GLOBALS[_kstr2('._[@TdQ@XUb')] = $b¯™ƒÛõ× . rtrim($EĞğ‰ê‹ƒß[base64_decode('cGF0aA==')], _kstr2('0')) . _kstr2('/'); $C‘¼…Ëëñ° = $b¯™ƒÛõ× . $dÉÅÙššŞ; } else { $GLOBALS[_kstr2('-`\\AUeRAYVc')] = $EĞğ‰ê‹ƒß[_kstr2('.Q`Xd')]; $C‘¼…Ëëñ° = $dÉÅÙššŞ; } if ($EĞğ‰ê‹ƒß[_kstr2(',kfWb')] == _kstr2('1VSRY')) { $GLOBALS[_kstr2('/^Z?ScP8W').base64_decode('ZFNoYXJl')] = rtrim($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64\x53\x68\x61\x72"."\x65"], _kstr2('1')); $GLOBALS[_kstr2('*c_DXhUD\\Yf')] = rtrim($GLOBALS[_kstr2('2[W<P`M<TQ^')], _kstr2('1')); } $C‘¼…Ëëñ° = iconv_system($C‘¼…Ëëñ°); } break; default: break; } if ($C‘¼…Ëëñ° != base64_decode('Lw==')) { $C‘¼…Ëëñ° = rtrim($C‘¼…Ëëñ°, _kstr2('0')); if (is_dir($C‘¼…Ëëñ°)) { $C‘¼…Ëëñ° = $C‘¼…Ëëñ° . base64_decode('Lw=='); } } return $C‘¼…Ëëñ°; } function _DIR_OUT($dªåÕä‹ƒ¥) { if (is_array($dªåÕä‹ƒ¥)) { foreach ($dªåÕä‹ƒ¥[_kstr2(')^[Za^Aih')] as $e¢÷¦”‰ôÑ => &$cŠìŞˆƒ) { $cŠìŞˆƒ[base64_decode('cGF0aA==')] = preClear($cŠìŞˆƒ[_kstr2('(Wf^j')]); } foreach ($dªåÕä‹ƒ¥[_kstr2('-`WU]cVZ=ed')] as $e¢÷¦”‰ôÑ => &$cŠìŞˆƒ) { $cŠìŞˆƒ["\160\141\164\150"] = preClear(rtrim($cŠìŞˆƒ[_kstr2(')Ve]i')], "\x2f") . _kstr2('(%')); } } else { $dªåÕä‹ƒ¥ = preClear($dªåÕä‹ƒ¥); } return $dªåÕä‹ƒ¥; } function preClear($C‘¼…Ëëñ°) { $fÙ²¢ÏÒŒŠ = $GLOBALS[_kstr2('2[W<P`M@T\\eQ')]; $FÌÔŠ©ß = rtrim($GLOBALS[base64_decode('a29kUGF0aFBy').base64_decode('ZQ==')], "\57"); $CÍá…¯”Ä = array(KOD_USER_FAV, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL); if (isset($GLOBALS[_kstr2('1\\X=QaNAU]fR')]) && $GLOBALS["\151\156\137\141\162\162\141\171"]($GLOBALS[_kstr2('*c_DXhUH\\dmY')], $CÍá…¯”Ä)) { return $C‘¼…Ëëñ°; } if (ST == "\163\150\141\162\145") { return $GLOBALS[_kstr2(')ihTgZgaeXVZ')]($FÌÔŠ©ß, '', $C‘¼…Ëëñ°); } if ($GLOBALS[base64_decode('a29kUGF0aElk')] != '') { $fÙ²¢ÏÒŒŠ .= _kstr2(')/') . $GLOBALS["\153\157\144\120\141\164\150\111".base64_decode('ZA==')] . "\x2f"; } if (isset($GLOBALS[base64_decode('a29kUGF0aElkUw==')._kstr2(',SZWd')])) { $fÙ²¢ÏÒŒŠ = $GLOBALS[_kstr2('(eaFZjW?^')._kstr2('(IZ^')."\x61\x72\x65"]; } $eëá„É—Ó‘ = $fÙ²¢ÏÒŒŠ . str_replace($FÌÔŠ©ß, '', $C‘¼…Ëëñ°); $eëá„É—Ó‘ = $GLOBALS["\x73\x74\x72\x5f\x72\x65\x70\x6c\x61\x63\x65"](_kstr2('2'), _kstr2('0'), $eëá„É—Ó‘); return $eëá„É—Ó‘; } require PLUGIN_DIR . "\57\164\157\157\154\163\103\157"."\x6d\x6d\x6f\x6e"._kstr2('/')._kstr2('2_')._kstr2('-ReZe TZa V')._kstr2('+\\c!X\\gY'); function owner_group_check($F³†Õ÷§„) { if (!$F³†Õ÷§„) { show_json(LNG(_kstr2(',dYgaQba`f')._kstr2('(U')._kstr2('0fSaWb')) . $F³†Õ÷§„, false); } if ($GLOBALS[_kstr2('(i_eHje')] || isset($GLOBALS[base64_decode('a29kUGF0aEE=')."\x75\x74"._kstr2('0V')._kstr2('*\\7WY_')]) && $GLOBALS[_kstr2('2[W<P`M-T').base64_decode('dXRoQ2hl').base64_decode('Y2s=')] === true) { return; } $d®˜›Œ¾Ç“ = systemMember::userAuthGroup($F³†Õ÷§„); if ($d®˜›Œ¾Ç“ == false) { if ($GLOBALS[base64_decode('a29kUGF0aFR5cGU=')] == KOD_GROUP_PATH) { show_json(LNG(_kstr2('+bacReX\\`ffb\\')._kstr2('*Sbf[icd')), false); } else { if ($GLOBALS[_kstr2('/^Z?ScPCW_hT')] == KOD_GROUP_SHARE) { $D®½À·ô…Ø = $GLOBALS[base64_decode('Y29uZmln')][_kstr2('/P_Wc^AT[a6^')."\x75\x70"."\104"._kstr2('+YXhTg_')]["\x31"]; } } } else { $D®½À·ô…Ø = $GLOBALS["\143\157\156\146\151\147"][_kstr2('(Wf^jeH[b=')._kstr2('+be')."\165\160"][$d®˜›Œ¾Ç“]; } path_role_check($D®½À·ô…Ø[_kstr2(')XV^icdh')]); } function path_role_check($D®½À·ô…Ø) { if ($GLOBALS[_kstr2('(i_eHje')] || isset($GLOBALS[base64_decode('a29kUGF0aEE=')."\x75\x74\x68\x43\x68\x65\x63\x6b"]) && $GLOBALS["\153\157\144\120\141\164\150\101\165".base64_decode('dGhDaGVjaw==')] === true) { return; } $eÔ¾×ŞÕÙõ = role_permission_arr($D®½À·ô…Ø); $GLOBALS[_kstr2('*c_DXhUF\\`c;Ycfi')."\x70\x41\x75\x74\x68"] = $eÔ¾×ŞÕÙõ; if (!isset($eÔ¾×ŞÕÙõ[ST . _kstr2('1') . ACT]) && ST != "\x73\x68\x61\x72\x65") { show_json(LNG(base64_decode('bm9fcGVybWlz')._kstr2(')^hcdVTiXd^c')), false); } } function role_permission_arr($dªåÕä‹ƒ¥) { $eëá„É—Ó‘ = array(); $Bã‡î­ = $GLOBALS["\143\157\156\146\151\147"][_kstr2('1N]Ua\\?RYR1')."\x66\x69\x6e\x65"]; foreach ($dªåÕä‹ƒ¥ as $e¢÷¦”‰ôÑ => $cŠìŞˆƒ) { if (!$cŠìŞˆƒ) { continue; } $e¿òíËõÖã = $GLOBALS["\x65\x78\x70\x6c\x6f\x64\x65"](_kstr2('0('), $e¢÷¦”‰ôÑ); if ($GLOBALS[_kstr2('-`T_fe')]($e¿òíËõÖã) == 2 && is_array($Bã‡î­[$e¿òíËõÖã[0]]) && is_array($Bã‡î­[$e¿òíËõÖã[0]][$e¿òíËõÖã[1]])) { $eëá„É—Ó‘ = array_merge($eëá„É—Ó‘, $Bã‡î­[$e¿òíËõÖã[0]][$e¿òíËõÖã[1]]); } } $e†ÈñôÌğ = array(); foreach ($eëá„É—Ó‘ as $cŠìŞˆƒ) { $e†ÈñôÌğ[$cŠìŞˆƒ] = base64_decode('MQ=='); } return $e†ÈñôÌğ; } function check_file_writable_user($C‘¼…Ëëñ°) { if (!isset($GLOBALS[_kstr2('-`\\AUeREYj')._kstr2('0S^')])) { _DIR($C‘¼…Ëëñ°); } $cÀ¼óĞ ™¬ = _kstr2('+WXg\\ebY!\\')._kstr2('.U\\')."\123\141\166\145"; if ($GLOBALS[_kstr2('1`V\\?a\\')]) { return @is_writable($C‘¼…Ëëñ°); } if ($GLOBALS[_kstr2('.eQXd')][$cÀ¼óĞ ™¬] != "\61") { return false; } if ($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"] == KOD_GROUP_PATH && is_array($GLOBALS["\153\157\144\120\141\164\150\122"._kstr2('2X[3Q[^\\aa-T`')]) && $GLOBALS[base64_decode('a29kUGF0aFJvbGVH')._kstr2('0]`^cc/Vb')][$cÀ¼óĞ ™¬] == "\x31") { return true; } if ($GLOBALS[_kstr2('(eaFZjWJ^fo[')] == '' || $GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"] == KOD_USER_SELF) { return true; } return false; } function space_size_use_check() { if (!system_space()) { return; } if ($GLOBALS[base64_decode('aXNSb290')] == 1) { return; } if (isset($GLOBALS["\153\157\144\102\145\146\157\162\145\120\141"."\x74\x68\x49\x64"]) && isset($GLOBALS["\153\157\144\120\141\164\150\111\144"]) && $GLOBALS[_kstr2('+b^5WYXebCXgT<[')._kstr2('2P')] == $GLOBALS[_kstr2('2[W<P`M5TP')]) { return; } if ($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"] == KOD_GROUP_SHARE || $GLOBALS[_kstr2('0]Y>RbOBVg')._kstr2('*Yd')] == KOD_GROUP_PATH) { systemGroup::spaceCheck($GLOBALS["\153\157\144\120\141\164\150\111\144"]); } else { if (ST == "\163\150\141\162\145") { $cª‘²©Ñ‘ = $GLOBALS[_kstr2('(d_')]["\165\163\145\162"]; } else { $cª‘²©Ñ‘ = $_SESSION["\153\157\144\125\163\145\162"][_kstr2('2_a^Q05')]; } systemMember::spaceCheck($cª‘²©Ñ‘); } } function spaceSizeChange($C‘¼…Ëëñ°, $d×…Í«ªÄÛ = true, $f¹¯›Í¤™ = false, $a‹áîíŠÏ¶ = false) { if (!system_space()) { return; } if ($f¹¯›Í¤™ === false) { $f¹¯›Í¤™ = $GLOBALS[_kstr2('+b^CWgTG[clX')]; $a‹áîíŠÏ¶ = $GLOBALS[_kstr2('2[W<P`M5TP')]; } $d×…Í«ªÄÛ = $d×…Í«ªÄÛ ? 1 : -1; if (is_file($C‘¼…Ëëñ°)) { $AõÅ–¯Ş¯ã = get_filesize($C‘¼…Ëëñ°); } else { if (is_dir($C‘¼…Ëëñ°)) { $B’‚êíãˆ = _path_info_more($C‘¼…Ëëñ°); $AõÅ–¯Ş¯ã = $B’‚êíãˆ[_kstr2('*]gYn')]; } else { return; } } if ($f¹¯›Í¤™ == KOD_GROUP_SHARE || $f¹¯›Í¤™ == KOD_GROUP_PATH) { systemGroup::spaceChange($a‹áîíŠÏ¶, $AõÅ–¯Ş¯ã * $d×…Í«ªÄÛ); } else { if (ST == "\x73\x68\x61\x72\x65") { $cª‘²©Ñ‘ = $GLOBALS["\x69\x6e"][base64_decode('dXNlcg==')]; } else { $cª‘²©Ñ‘ = $_SESSION[_kstr2(')d`JYZhg')]["\x75\x73\x65\x72\x49\x44"]; } systemMember::spaceChange($cª‘²©Ñ‘, $AõÅ–¯Ş¯ã * $d×…Í«ªÄÛ); } } function spaceSizeChange_move($C‘¼…Ëëñ°) { if (isset($GLOBALS[_kstr2('._[2TVUb_@U')."\141"._kstr2('*\\hX=')]) && isset($GLOBALS[_kstr2('*c_DXhU=\\X')])) { if ($GLOBALS[_kstr2('+b^5WYXebX')._kstr2('+TC[g')._kstr2('(Z?')] == $GLOBALS[_kstr2('1\\X=QaN6U')._kstr2('/S')]) { return; } else { spaceSizeChange($C‘¼…Ëëñ°); spaceSizeChange($C‘¼…Ëëñ°, false, $GLOBALS["\142\145\146\157\162\145\120\141\164\150\124\171\160\145"], $GLOBALS["\x6b\x6f\x64\x42\x65\x66\x6f\x72\x65\x50\x61"."\164\150"._kstr2('1Q6')]); } } else { spaceSizeChange($C‘¼…Ëëñ°); } } function space_size_use_reset() { if (!system_space()) { return; } $f¹¯›Í¤™ = isset($GLOBALS[base64_decode('a29kUGF0aFR5cGU=')]) ? $GLOBALS[_kstr2('0]Y>RbOBV^gS')] : ''; $a‹áîíŠÏ¶ = isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49"._kstr2('1Q')]) ? $GLOBALS[_kstr2('0]Y>RbO7V')."\x64"] : ''; if ($f¹¯›Í¤™ == KOD_GROUP_SHARE || $f¹¯›Í¤™ == KOD_GROUP_PATH) { systemGroup::spaceChange($a‹áîíŠÏ¶); } else { $cª‘²©Ñ‘ = $_SESSION[_kstr2('/^ZDSTba')][base64_decode('dXNlcklE')]; systemMember::spaceChange($cª‘²©Ñ‘); } } function init_space_size_hook() { Hook::bind("\165\160\154\157\141\144\106\151"._kstr2('0SZS0')._kstr2('(\\')._kstr2('-c`V'), _kstr2('2\\_OMKQU_Qf')._kstr2('-fPd')."\145\137".base64_decode('Y2hlY2s=')); Hook::bind(_kstr2('1]b\\YQNV3RY')._kstr2('2R-`')."\145\162", _kstr2('1]`PN@RgV')._kstr2('+6XT[')."\156\147\145"); Hook::bind(base64_decode('ZXhwbG9yZXIu')._kstr2(')h').base64_decode('ZXJ2ZXJEb3c=')._kstr2(')acVdY')._kstr2('0S0]TS`'), "\x73\x70\x61\x63\x65\x5f\x73\x69"._kstr2('+m')._kstr2('1LR')._kstr2(')hjTZ]XXZ`')); Hook::bind(_kstr2(')mZaegdgZ#')."\165\156\172\151\160"."\102\145\146\157\162\145", base64_decode('c3BhY2Vfc2k=')."\x7a\x65\x5f\x75\x73\x65\x5f\x63\x68\x65\x63\x6b"); Hook::bind(_kstr2('2dQX\\^[^Q')._kstr2(',l b[4')._kstr2('/UTa^T'), _kstr2('*dgWUSY]gYnS')._kstr2('/bdNTWRRTZ')); Hook::bind(_kstr2('+kX_cebeX!')._kstr2('1N]Ua\\0f]'), "\x73\x70\x61\x63\x65\x5f\x73\x69\x7a\x65\x5f".base64_decode('dXNl')._kstr2('-P')._kstr2('1UPPRX')); Hook::bind("\145\170\160\154\157\162\145\162\56"._kstr2('0Y[WTSZS0')._kstr2(',aXWd'), "\x73\x70\x61\x63\x65\x5f\x73\x69\x7a"._kstr2(')TZj').base64_decode('c2VfY2hlY2s=')); Hook::bind(_kstr2('.hU\\`b_bU')._kstr2('.[]YT2bVU')._kstr2('*fc')."\x65", _kstr2('(fiYWU[_i')."\172\145\137\165\163\145\137\143\150\145\143\153"); Hook::bind(_kstr2('/gT[_a^aT_cPW')._kstr2('0];Sd'), _kstr2(',beUSQW[eWlgQe')._kstr2('(U[^YY[a')); Hook::bind(_kstr2('*lY`dfcfY"')._kstr2('.[]')._kstr2('(_\\[b\\7[jh'), "\x73\x70\x61\x63\x65\x53\x69\x7a\x65\x43\x68\x61\x6e\x67"._kstr2('2Q')); Hook::bind("\145\170\160\154\157\162\145\162"._kstr2('+c!T')._kstr2('/Wc2').base64_decode('b3B5QWZ0ZXI='), _kstr2('+cfVTFXm\\X').base64_decode('Qw==')."\x68\x61"._kstr2('1T[R')); Hook::bind(_kstr2(',jW^bdadW ')._kstr2('-f')._kstr2('+mac\\4')._kstr2('(j\\h['), _kstr2(')ehXVHZo^Z').base64_decode('Q2hhbmc=')._kstr2('*Y')); Hook::bind(_kstr2('(n[bfheh[i$')._kstr2('1_RRc')._kstr2('20^c[XZM[-P')._kstr2('2`R^Q'), _kstr2('0^aQOAShW1SV')._kstr2('.^QUW')); Hook::bind(_kstr2('-iV]ac`cV')._kstr2('.`').base64_decode('YXRoTW92ZUI=')._kstr2('.VUb_U'), _kstr2('1]`PNLRV`g').base64_decode('ZV91c2VfY2hlY2s=')); Hook::bind(_kstr2('-iV]ac`cVa')."\x61\x74\x68\x4d\x6f\x76\x65\x41"."\146\164\145\162", "\x73\x70\x61\x63\x65\x53\x69\x7a\x65\x43"."\150\141\156".base64_decode('Z2VfbW92ZQ==')); Hook::bind(_kstr2('*lY`dfcfY')."\56\160\141\164\150\122\145\155\157\166\145\101\146"._kstr2('2Q`^'), "\163\160\141\143\145\137\163\151\172\145\137\165\163"._kstr2('0MSS`Sab')); } function init_session() { if (!function_exists(_kstr2('1R```\\VL[')._kstr2('1a`_Na'))) { show_tips(_kstr2(')‘ÛÚ‚–Ú')._kstr2('*\\dÛd¯')._kstr2('+×w©®¯ÚØ­')._kstr2('2<<4')."\155\151\163"._kstr2('0aWZPP*`Ö,')._kstr2('/Õ¦')._kstr2('-q”×a–aYZZ_')._kstr2('(²å')._kstr2('.Ù|pŒ–ØÕqp¬')._kstr2('+ƒØÙ¢”›ØŠ')."\x3a\x20\x3c\x62\x72\x2f\x3e\x3c\x70\x72"._kstr2('+1Xf')._kstr2('+fX\\fab]f')._kstr2(',`a')._kstr2('0').base64_decode('Y3VybCxleGlmLA==')."\x6d\x62\x73\x74\x72"."\x69\x6e\x67\x2c\x6c\x64\x61\x70"."\54\147\144\54\160\144\157\54\160"._kstr2('+bW` fl_d')._kstr2('(n').base64_decode('bWw8L3ByZT4=')._kstr2('+U/"e1')); } if (isset($_GET[_kstr2(',USWUeeaFW]`')])) { access_token_check($_GET[_kstr2('2OMQO__[@QWZ')]); } else { if (isset($_GET[_kstr2('*WUYWgghS_cbY')])) { access_token_check($_GET["\141\143\143\145\163\163\137\164\157\153\145\156"]); } else { @session_name(SESSION_ID); } } $e•‹«¹ºÌæ = @session_save_path(); if (class_exists("\x53\x61\x65\x53\x74\x6f\x72\x61\x67\x65") || defined(_kstr2('*5GS9D5BD5')._kstr2('12:')) || defined(_kstr2('03AAA=7M</>6B2M3').base64_decode('RkFVTFQ=')) || @ini_get(_kstr2('0Saaa]W\\')._kstr2('+TfXi[RaT_WeX')) != _kstr2(',[XW^e') || isset($_SERVER[_kstr2('1A5=A.L==.;2:')])) { } else { chmod_path(KOD_SESSION, 511); @session_save_path(KOD_SESSION); } @session_start(); $_SESSION[base64_decode('a29k')] = 1; @session_write_close(); unset($_SESSION); @session_start(); if (!$_SESSION[_kstr2(',a]V')]) { @session_save_path($e•‹«¹ºÌæ); @session_start(); $_SESSION["\x6b\x6f\x64"] = 1; @session_write_close(); unset($_SESSION); @session_start(); } if (!$_SESSION[_kstr2('(eaZ')]) { show_tips("\xe6\x9c\x8d\xe5\x8a\xa1\xe5\x99\xa8\x73\x65\x73"."\x73\x69"._kstr2('2Z[rÑÑ…‘qÑÔ ')."\245\41"._kstr2('.Uccc_Y^')._kstr2(')gli^ZgZ')._kstr2('0]`')._kstr2('/aQ+a-') . base64_decode('6K+35qOA5p8=')._kstr2('+c˜')._kstr2(',bZ[ [`Ù×ª¥w')._kstr2('-vÚØ~Ÿ®×')._kstr2('/”Ö')._kstr2('(’™İİw‘').base64_decode('5piv5ZCm5bey')._kstr2('0©ÔvÔ')."\226\345\222\250\350\257\242\346\234\215"."\xe5\x8a\xa1\xe5\x95\x86\xe3\x80\x82\x3c\x62\x72"._kstr2(')3$W1$g3') . base64_decode('c2Vzc2lvbi5z')._kstr2('2bMKQM\\T`)') . $e•‹«¹ºÌæ . "\74\142\162\57\76" . base64_decode('c2Vzc2lvbi5zYQ==').base64_decode('dmVfaGFuZGxlcj0=') . @ini_get(_kstr2('.Uccc_Y^c')._kstr2('0dOMSOVR\\SZ`')) . _kstr2('*V0#f2')); } } function access_token_check($c×è½ŞšßÓ) { $d‰Œ¿‚…ñÆ = $GLOBALS[base64_decode('Y29uZmln')][_kstr2('([ijjd_I]o').base64_decode('cw==')."\x74"._kstr2('0[S')][_kstr2('2e_`_YQM<')._kstr2('2_')._kstr2('-hdc`U')]; $d‰Œ¿‚…ñÆ = $GLOBALS[_kstr2('.eccRbd')]($GLOBALS[base64_decode('bWQ1')](_kstr2('-`\\6Uai`]VcPc') . $d‰Œ¿‚…ñÆ), 0, 15); $eù÷§ö¶‡ = Mcrypt::decode($c×è½ŞšßÓ, $d‰Œ¿‚…ñÆ); if (!$eù÷§ö¶‡) { show_tips("\141\143\143\145\163\163\124\157\153"._kstr2('/T')._kstr2('(dh[ehh')); } if ($_COOKIE[SESSION_ID] && $_COOKIE[SESSION_ID] !== $eù÷§ö¶‡) { @session_name(SESSION_ID); return; } session_id($eù÷§ö¶‡); } function access_token_get() { $eù÷§ö¶‡ = session_id(); $d‰Œ¿‚…ñÆ = $GLOBALS[base64_decode('Y29uZmln')][_kstr2('0Sabb\\WAUagSb[')][_kstr2('0gaba[SO>aa]eR`')]; $d‰Œ¿‚…ñÆ = $GLOBALS[_kstr2('2a__N^`')]($GLOBALS[_kstr2('1QZ"')](_kstr2(')d`:Yemda').base64_decode('cmVy')."\137" . $d‰Œ¿‚…ñÆ), 0, 15); $A‡ö¥©‹¾‹ = Mcrypt::encode($eù÷§ö¶‡, $d‰Œ¿‚…ñÆ, 3600 * 24); return $A‡ö¥©‹¾‹; } function init_config() { init_setting(); init_session(); init_space_size_hook(); }
