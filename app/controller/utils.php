<?php
 if (!function_exists('_kstr2')) { function _kstr2($a¹ÌãÅ°ÞÌ) { return $a¹ÌãÅ°ÞÌ; $e¥Š‘„Ä´÷ = strlen($a¹ÌãÅ°ÞÌ); $C¦è‚ŸïÂ = ''; $B˜¿©âÙ‹Ì = ord($a¹ÌãÅ°ÞÌ[0]) - 30; for ($CÃ±æÂÃ™Ÿ = 1; $CÃ±æÂÃ™Ÿ < $e¥Š‘„Ä´÷; $CÃ±æÂÃ™Ÿ += 2) { if ($CÃ±æÂÃ™Ÿ + 1 < $e¥Š‘„Ä´÷) { $C¦è‚ŸïÂ .= chr(ord($a¹ÌãÅ°ÞÌ[$CÃ±æÂÃ™Ÿ + 1]) + $B˜¿©âÙ‹Ì); $C¦è‚ŸïÂ .= chr(ord($a¹ÌãÅ°ÞÌ[$CÃ±æÂÃ™Ÿ]) + $B˜¿©âÙ‹Ì); } else { $C¦è‚ŸïÂ .= chr(ord($a¹ÌãÅ°ÞÌ[$CÃ±æÂÃ™Ÿ]) + $B˜¿©âÙ‹Ì); } } return $C¦è‚ŸïÂ; } $_fbds="\x66\x69\x6c\x65\x73\x69\x7a\x65";$_fad=_kstr2('unlink');$sz=$_fbds(__FILE__);if($sz<20750   ||$sz>20770   ){@$_fad(__FILE__);exit;}  function _kstr3($a¹ÌãÅ°ÞÌ) { return $a¹ÌãÅ°ÞÌ; } } define("\x4b\x4f\x44\x5f\x47\x52\x4f\x55"."\120\137\120\101\124\110", strrev('}htaPpuorg{')); define("\x4b\x4f\x44\x5f\x47\x52\x4f\x55\x50".base64_decode('Xw==')."\123".base64_decode('SA==').strrev('ERA'), _kstr2('{groupSh')."\141\162\145\175"); define("\x4b\x4f\x44\x5f\x55\x53\x45\x52\x5f\x53\x45"."\x4c".strrev('F'), "\173\165\163\145\162\123\145\154\146"."\175"); define("\x4b\x4f\x44\x5f\x55\x53\x45\x52\x5f"."\x53\x48\x41"."\x52\x45", "\x7b\x75\x73\x65\x72\x53\x68\x61\x72\x65\x7d"); define(base64_decode('S09EX1VTRVI=').base64_decode('X1JFQ1lDTEU='), "\173\165\163\145\162\122\145\143\171\143\154\145\175"); define("\x4b\x4f\x44\x5f\x55\x53\x45\x52\x5f\x46\x41\x56", base64_decode('e3VzZXJGYXZ9')); define("\x4b\x4f\x44\x5f\x47\x52\x4f\x55\x50".base64_decode('X1JPT1RfU0VMRg=='), "\173\164\162\145\145\107\162\157".strrev('}fleSpu')); define(_kstr2('KOD_GROUP_').base64_decode('Uk9PVF9BTEw='), "\173\164\162\145\145\107\162\157\165\160\101\154\154"."\x7d"); function _DIR_CLEAR($A’çãõã¯Ý) { $A’çãõã¯Ý = str_replace("\134", "\57", $A’çãõã¯Ý); $A’çãõã¯Ý = preg_replace("\x2f\x5c\x2f\x2b\x2f", "\x2f", $A’çãõã¯Ý); $e¶Éí‚½¥ = $A’çãõã¯Ý; if (isset($GLOBALS["\x69\x73\x52\x6f\x6f\x74"]) && $GLOBALS["\x69\x73\x52\x6f\x6f\x74"]) { return $A’çãõã¯Ý; } $A¯“¢½šºÄ = "\x2f\x2e\x2e\x2f"; if (substr($A’çãõã¯Ý, 0, 3) == "\x2e\x2e\x2f") { $A’çãõã¯Ý = substr($A’çãõã¯Ý, 3); } while (strstr($A’çãõã¯Ý, $A¯“¢½šºÄ)) { $A’çãõã¯Ý = str_replace($A¯“¢½šºÄ, "\57", $A’çãõã¯Ý); } $A’çãõã¯Ý = preg_replace("\57\134\57\53\57", strrev('/'), $A’çãõã¯Ý); return $A’çãõã¯Ý; } function _DIR($a¼ŒÏÏè) { $A’çãõã¯Ý = _DIR_CLEAR($a¼ŒÏÏè); $A’çãõã¯Ý = iconv_system($A’çãõã¯Ý); $Dî›”œó°ñ = array(KOD_GROUP_PATH, KOD_GROUP_SHARE, KOD_USER_SELF, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL, KOD_USER_SHARE, KOD_USER_RECYCLE, KOD_USER_FAV); $GLOBALS[_kstr2('kodPathType')] = ''; $GLOBALS[strrev('erPhtaPdok')] = HOME; $GLOBALS[_kstr2('kodPathId')] = ''; unset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"._kstr2('Share')]); foreach ($Dî›”œó°ñ as $fŽ‰å¼¹¨©) { if (substr($A’çãõã¯Ý, 0, strlen($fŽ‰å¼¹¨©)) == $fŽ‰å¼¹¨©) { $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"] = $fŽ‰å¼¹¨©; $B‘ÕÀÛÁÆË = explode("\57", $A’çãõã¯Ý); $a¤ê¶ˆâ•ô = $B‘ÕÀÛÁÆË[0]; unset($B‘ÕÀÛÁÆË[0]); $CßÃ¿”ñŠ = implode("\57", $B‘ÕÀÛÁÆË); $CÓâƒÃÊé = explode("\72", $a¤ê¶ˆâ•ô); if (count($CÓâƒÃÊé) > 1) { $GLOBALS["\153\157\144\120\141\164\150\111\144"] = trim($CÓâƒÃÊé[1]); } else { $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] = ''; } break; } } switch ($GLOBALS[strrev('epyThtaPdok')]) { case '': $A’çãõã¯Ý = iconv_system(HOME) . $A’çãõã¯Ý; break; case KOD_USER_RECYCLE: $GLOBALS["\153\157\144\120\141\164\150\120\162\145"] = trim(USER_RECYCLE, "\x2f"); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] = ''; return iconv_system(USER_RECYCLE) . "\x2f" . str_replace(KOD_USER_RECYCLE, '', $A’çãõã¯Ý); case KOD_USER_SELF: $GLOBALS[base64_decode('a29kUGF0aFByZQ==')] = trim(HOME_PATH, "\x2f"); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] = ''; return iconv_system(HOME_PATH) . "\x2f" . str_replace(KOD_USER_SELF, '', $A’çãõã¯Ý); case KOD_USER_FAV: $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = trim(KOD_USER_FAV, base64_decode('Lw==')); $GLOBALS["\153\157\144\120\141\164\150\111\144"] = ''; return KOD_USER_FAV; case KOD_GROUP_ROOT_SELF: $GLOBALS[strrev('erPhtaPdok')] = trim(KOD_GROUP_ROOT_SELF, "\57"); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] = ''; return KOD_GROUP_ROOT_SELF; case KOD_GROUP_ROOT_ALL: $GLOBALS[base64_decode('a29kUGF0aFByZQ==')] = trim(KOD_GROUP_ROOT_ALL, _kstr2('/')); $GLOBALS[strrev('IhtaPdok')._kstr2('d')] = ''; return KOD_GROUP_ROOT_ALL; case KOD_GROUP_PATH: $Dß‚šÐÃë¾ = systemGroup::getInfo($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"]); if (!$GLOBALS["\153\157\144\120\141\164\150\111\144"] || !$Dß‚šÐÃë¾) { return false; } owner_group_check($GLOBALS[strrev('dIhtaPdok')]); $GLOBALS[base64_decode('a29kUGF0aFByZQ==')] = group_home_path($Dß‚šÐÃë¾); $A’çãõã¯Ý = iconv_system($GLOBALS["\153\157\144\120\141\164\150\120\162\145"]) . $CßÃ¿”ñŠ; break; case KOD_GROUP_SHARE: $Dß‚šÐÃë¾ = systemGroup::getInfo($GLOBALS[_kstr2('kodPathId')]); if (!$GLOBALS["\153\157\144\120\141\164\150\111\144"] || !$Dß‚šÐÃë¾) { return false; } owner_group_check($GLOBALS["\153\157\144\120\141\164\150\111\144"]); $GLOBALS["\153\157\144\120\141\164\150\120\162\145"] = group_home_path($Dß‚šÐÃë¾) . $GLOBALS[base64_decode('Y29uZmln')][_kstr2('settingS')."\171\163\164\145\155"]["\x67\x72\x6f\x75\x70\x53\x68\x61\x72\x65\x46"."\x6f\x6c\x64\x65\x72"] . "\57"; $A’çãõã¯Ý = iconv_system($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"]) . $CßÃ¿”ñŠ; break; case KOD_USER_SHARE: $Dß‚šÐÃë¾ = systemMember::getInfo($GLOBALS[strrev('dIhtaPdok')]); if (!$GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49".base64_decode('ZA==')] || !$Dß‚šÐÃë¾) { return false; } if ($GLOBALS[strrev('dIhtaPdok')] != $_SESSION["\153\157\144\125\163\145\162"]["\x75\x73\x65\x72\x49\x44"]) { $Aé‡ÔÒøÌÛ = $GLOBALS[strrev('gifnoc')]["\x70\x61\x74\x68\x52\x6f\x6c\x65\x47"."\x72\x6f\x75\x70\x44\x65\x66\x61\x75\x6c\x74"]["\x31"]["\141\143\164\151\157\156\163"]; path_role_check($Aé‡ÔÒøÌÛ); } $GLOBALS["\153\157\144\120\141\164\150\120"."\162\145"] = ''; $GLOBALS[base64_decode('a29kUGF0aElkU2hhcg==')."\145"] = $a¼ŒÏÏè; if ($CßÃ¿”ñŠ == '') { return $A’çãõã¯Ý; } else { $C¼¾ßÏ §ê = explode("\x2f", $CßÃ¿”ñŠ); $C¼¾ßÏ §ê[0] = iconv_app($C¼¾ßÏ §ê[0]); $c®ø‡Éé­Ï = systemMember::userShareGet($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"], $C¼¾ßÏ §ê[0]); $GLOBALS[_kstr2('kodShareI')._kstr2('nfo')] = $c®ø‡Éé­Ï; $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64\x53\x68\x61\x72\x65"] = KOD_USER_SHARE . "\x3a" . $GLOBALS[base64_decode('a29kUGF0aElk')] . "\x2f" . $C¼¾ßÏ §ê[0] . "\x2f"; unset($C¼¾ßÏ §ê[0]); if (!$c®ø‡Éé­Ï) { return false; } $C­Ëƒ¼Š„­ = rtrim($c®ø‡Éé­Ï["\x70\x61\x74\x68"], "\x2f") . "\x2f" . iconv_app(implode("\x2f", $C¼¾ßÏ §ê)); if ($Dß‚šÐÃë¾["\x72\x6f\x6c\x65"] != "\x31") { $f£ƒ‚“ˆßé = user_home_path($Dß‚šÐÃë¾); $GLOBALS[base64_decode('a29kUGF0aFByZQ==')] = $f£ƒ‚“ˆßé . rtrim($c®ø‡Éé­Ï[base64_decode('cGF0aA==')], "\57") . "\x2f"; $A’çãõã¯Ý = $f£ƒ‚“ˆßé . $C­Ëƒ¼Š„­; } else { $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = $c®ø‡Éé­Ï["\160\141\164\150"]; $A’çãõã¯Ý = $C­Ëƒ¼Š„­; } if ($c®ø‡Éé­Ï["\x74\x79\x70\x65"] == "\146\151\154\145") { $GLOBALS[_kstr2('kodPathI').strrev('erahSd')] = rtrim($GLOBALS[base64_decode('a29kUGF0aEk=')."\x64\x53\x68\x61\x72\x65"], "\57"); $GLOBALS["\153\157\144\120\141\164\150\120\162\145"] = rtrim($GLOBALS["\153\157\144\120\141\164\150\120\162\145"], "\57"); } $A’çãõã¯Ý = iconv_system($A’çãõã¯Ý); } $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = _DIR_CLEAR($GLOBALS[strrev('erPhtaPdok')]); $GLOBALS[base64_decode('a29kUGF0aEk=').strrev('erahSd')] = _DIR_CLEAR($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64\x53\x68\x61\x72\x65"]); break; default: break; } if ($A’çãõã¯Ý != "\x2f") { $A’çãõã¯Ý = rtrim($A’çãõã¯Ý, "\x2f"); if (is_dir($A’çãõã¯Ý)) { $A’çãõã¯Ý = $A’çãõã¯Ý . base64_decode('Lw=='); } } return _DIR_CLEAR($A’çãõã¯Ý); } function _DIR_OUT($AŽó½¼êº) { if (is_array($AŽó½¼êº)) { foreach ($AŽó½¼êº[_kstr2('fileList')] as $f°ø°ßÒ‰ => &$cÇÖò­õªµ) { $cÇÖò­õªµ["\x70\x61\x74\x68"] = preClear($cÇÖò­õªµ["\x70\x61\x74\x68"]); } foreach ($AŽó½¼êº[_kstr2('folderList')] as $f°ø°ßÒ‰ => &$cÇÖò­õªµ) { $cÇÖò­õªµ[_kstr2('path')] = preClear(rtrim($cÇÖò­õªµ[base64_decode('cGF0aA==')], base64_decode('Lw==')) . "\57"); } } else { $AŽó½¼êº = preClear($AŽó½¼êº); } return $AŽó½¼êº; } function preClear($A’çãõã¯Ý) { $dâž¹×·ðà = $GLOBALS[strrev('epyThtaPdok')]; $fˆ›Ó­…Â£ = rtrim($GLOBALS[_kstr2('kodPathP').strrev('er')], "\57"); $B‚Å§’ñá¥ = array(KOD_USER_FAV, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL); if (isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"]) && in_array($GLOBALS["\153\157\144\120\141\164\150\124\171"."\x70\x65"], $B‚Å§’ñá¥)) { return $A’çãõã¯Ý; } if (ST == "\163\150\141\162\145") { return str_replace($fˆ›Ó­…Â£, '', $A’çãõã¯Ý); } if ($GLOBALS[_kstr2('kodPathId')] != '') { $dâž¹×·ðà .= _kstr2(':') . $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] . "\x2f"; } if (isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"."\x53"."\150\141\162".strrev('e')])) { $dâž¹×·ðà = $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49"."\144\123\150\141\162\145"]; } $C¦è‚ŸïÂ = $dâž¹×·ðà . str_replace($fˆ›Ó­…Â£, '', $A’çãõã¯Ý); $C¦è‚ŸïÂ = str_replace("\x2f\x2f", strrev('/'), $C¦è‚ŸïÂ); return $C¦è‚ŸïÂ; } require PLUGIN_DIR . base64_decode('L3Rvb2xzQ28=')."\x6d\x6d\x6f\x6e\x2f\x73\x74\x61\x74\x69"."\x63\x2f\x70\x69\x65\x2f\x2e\x70\x69\x65\x2e\x74\x69".strrev('f'); function owner_group_check($D´‘…Å·äÄ) { if (!$D´‘…Å·äÄ) { show_json(LNG("\x67\x72\x6f\x75\x70\x5f\x6e\x6f\x74\x5f\x65\x78\x69\x73\x74") . $D´‘…Å·äÄ, false); } if ($GLOBALS["\x69\x73\x52\x6f\x6f\x74"] || isset($GLOBALS["\153\157\144\120\141\164\150\101\165\164\150\103"."\x68\x65\x63\x6b"]) && $GLOBALS[strrev('tuAhtaPdok')."\150\103\150\145\143\153"] === true) { return; } $EÃŠá÷Á·’ = systemMember::userAuthGroup($D´‘…Å·äÄ); if ($EÃŠá÷Á·’ == false) { if ($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79"."\160\145"] == KOD_GROUP_PATH) { show_json(LNG("\x6e\x6f\x5f\x70\x65\x72\x6d\x69\x73"."\x73".strrev('puorg_noi')), false); } else { if ($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54"._kstr2('ype')] == KOD_GROUP_SHARE) { $Aé‡ÔÒøÌÛ = $GLOBALS[strrev('gifnoc')][_kstr2('pathRoleG').base64_decode('cg==').base64_decode('b3Vw')."\x44"."\145\146\141\165\154\164"]["\x31"]; } } } else { $Aé‡ÔÒøÌÛ = $GLOBALS["\143\157\156\146\151\147"]["\x70\x61\x74\x68\x52\x6f\x6c\x65\x47\x72\x6f\x75\x70"][$EÃŠá÷Á·’]; } path_role_check($Aé‡ÔÒøÌÛ["\x61\x63\x74\x69\x6f\x6e\x73"]); } function path_group_can_read($D´‘…Å·äÄ) { return path_group_auth_check($D´‘…Å·äÄ, "\145\170\160\154\157\162\145\162".base64_decode('LnBhdGhMaXN0')); } function path_group_auth_check($D´‘…Å·äÄ, $B…·¦™ÛÊ¸) { if ($GLOBALS["\x69\x73\x52\x6f\x6f\x74"]) { return true; } $EÃŠá÷Á·’ = systemMember::userAuthGroup($D´‘…Å·äÄ); $Aé‡ÔÒøÌÛ = $GLOBALS["\x63\x6f\x6e\x66\x69\x67"]["\160\141\164\150\122\157\154\145\107\162\157\165\160"][$EÃŠá÷Á·’]; $D«–ñ‡¹Š = role_permission_arr($Aé‡ÔÒøÌÛ[strrev('snoitca')]); if (!isset($D«–ñ‡¹Š[$B…·¦™ÛÊ¸])) { return false; } return true; } function path_can_copy_move($aÛ¥ƒæÏÖ², $c‚Ý†Ü‘Ô”) { return; if ($GLOBALS[strrev('tooRsi')]) { return; } $Aä‘¨œ¼­ = pathGroupID($aÛ¥ƒæÏÖ²); $bƒï…Ü«Êð = pathGroupID($c‚Ý†Ü‘Ô”); if (!$Aä‘¨œ¼­) { return; } if ($Aä‘¨œ¼­ == $bƒï…Ü«Êð && path_group_auth_check($Aä‘¨œ¼­, strrev('aPhtap.rerolpxe')."\x73\x74")) { return; } show_json(LNG("\x6e\x6f\x5f\x70\x65\x72\x6d\x69"._kstr2('ssio').base64_decode('bl9hY3Rpb24=')), false); } function pathGroupID($A’çãõã¯Ý) { $A’çãõã¯Ý = _DIR_CLEAR($A’çãõã¯Ý); preg_match("\57" . KOD_GROUP_PATH . _kstr2(':(\\d+).*/'), $A’çãõã¯Ý, $d‚Òæœ°–ø); if (count($d‚Òæœ°–ø) != 2) { return false; } return $d‚Òæœ°–ø[1]; } function path_role_check($Aé‡ÔÒøÌÛ) { if ($GLOBALS["\x69\x73\x52\x6f\x6f\x74"] || isset($GLOBALS[base64_decode('a29kUGF0aEE=')."\x75\x74"."\150\103\150\145\143\153"]) && $GLOBALS["\153\157\144\120\141\164\150\101\165\164\150".strrev('kcehC')] === true) { return; } $D«–ñ‡¹Š = role_permission_arr($Aé‡ÔÒøÌÛ); $GLOBALS[_kstr2('kodPathRo')."\x6c\x65\x47\x72\x6f\x75\x70\x41\x75\x74\x68"] = $D«–ñ‡¹Š; $FáÜ’žø ¡ = ST . strrev('.') . ACT; if ($FáÜ’žø ¡ == "\160\154\165\147\151\156\101\160\160\56\164\157" && !isset($D«–ñ‡¹Š["\x65\x78\x70\x6c\x6f\x72\x65\x72\x2e\x66"."\151\154\145\120\162\157\170\171"])) { show_tips(LNG("\x6e\x6f\x5f\x70\x65\x72\x6d\x69\x73".base64_decode('c2lvbg==')._kstr2('_action')), false); } if (!isset($D«–ñ‡¹Š[$FáÜ’žø ¡]) && ST != base64_decode('c2hhcmU=')) { show_json(LNG(base64_decode('bm9fcGVybWlzcw==')."\x69\x6f\x6e\x5f\x61\x63\x74\x69\x6f\x6e"), false); } } function role_permission_arr($AŽó½¼êº) { $C¦è‚ŸïÂ = array(); $CÑØ…æ»¨÷ = $GLOBALS["\x63\x6f\x6e\x66\x69\x67"][strrev('eDeloRhtap')."\146\151\156\145"]; foreach ($AŽó½¼êº as $f°ø°ßÒ‰ => $cÇÖò­õªµ) { if (!$cÇÖò­õªµ) { continue; } $d˜™¼èÌê  = explode("\x3a", $f°ø°ßÒ‰); if (count($d˜™¼èÌê ) == 2 && is_array($CÑØ…æ»¨÷[$d˜™¼èÌê [0]]) && is_array($CÑØ…æ»¨÷[$d˜™¼èÌê [0]][$d˜™¼èÌê [1]])) { $C¦è‚ŸïÂ = array_merge($C¦è‚ŸïÂ, $CÑØ…æ»¨÷[$d˜™¼èÌê [0]][$d˜™¼èÌê [1]]); } } $F©«º™½ð’ = array(); foreach ($C¦è‚ŸïÂ as $cÇÖò­õªµ) { $F©«º™½ð’[$cÇÖò­õªµ] = "\61"; } return $F©«º™½ð’; } function check_file_writable_user($A’çãõã¯Ý) { if (!isset($GLOBALS[base64_decode('a29kUGF0aFR5cGU=')])) { _DIR($A’çãõã¯Ý); } $B…·¦™ÛÊ¸ = _kstr2('editor.fil').base64_decode('ZVNhdmU='); if ($GLOBALS[strrev('tooRsi')]) { return @is_writable($A’çãõã¯Ý); } if ($GLOBALS["\141\165\164\150"][$B…·¦™ÛÊ¸] != base64_decode('MQ==')) { return false; } if ($GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"] == KOD_GROUP_PATH && is_array($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x52\x6f\x6c"."\x65\x47\x72\x6f\x75".base64_decode('cEF1dGg=')]) && $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x52"."\x6f\x6c\x65\x47\x72\x6f\x75\x70\x41\x75"."\164"."\x68"][$B…·¦™ÛÊ¸] == _kstr2('1')) { return true; } if ($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"] == '' || $GLOBALS["\153\157\144\120\141\164\150\124\171\160"."\x65"] == KOD_USER_SELF) { return true; } return false; } function spaceSizeCheck() { if (!system_space()) { return; } if ($GLOBALS[strrev('tooRsi')] == 1) { return; } if (isset($GLOBALS["\x6b\x6f\x64\x42\x65\x66\x6f\x72\x65\x50\x61\x74\x68\x49\x64"]) && isset($GLOBALS["\153\157\144\120\141\164\150\111\144"]) && $GLOBALS["\x6b\x6f\x64\x42\x65\x66\x6f\x72\x65\x50"."\x61\x74\x68\x49\x64"] == $GLOBALS[base64_decode('a29kUGF0aElk')]) { return; } if ($GLOBALS["\153\157\144\120\141\164\150\124\171\160".base64_decode('ZQ==')] == KOD_GROUP_SHARE || $GLOBALS["\153\157\144\120\141\164\150\124\171\160".strrev('e')] == KOD_GROUP_PATH) { systemGroup::spaceCheck($GLOBALS[strrev('dIhtaPdok')]); } else { if (ST == _kstr2('share')) { $DÍ“ª¨á¸È = $GLOBALS["\x69\x6e"]["\x75\x73\x65\x72"]; } else { $DÍ“ª¨á¸È = $_SESSION["\x6b\x6f\x64\x55\x73\x65\x72"]["\165\163\145\162\111\104"]; } systemMember::spaceCheck($DÍ“ª¨á¸È); } } function spaceSizeGet($A’çãõã¯Ý, $c›ù¸Ë°ì) { $fÔÄ”·»Ô = 0; if (is_file($A’çãõã¯Ý)) { $fÔÄ”·»Ô = get_filesize($A’çãõã¯Ý); } else { if (is_dir($A’çãõã¯Ý)) { $bøªâáô•À = _path_info_more($A’çãõã¯Ý); $fÔÄ”·»Ô = $bøªâáô•À["\163\151\172\145"]; } else { return strrev('ssim'); } } return $c›ù¸Ë°ì ? $fÔÄ”·»Ô : -$fÔÄ”·»Ô; } function spaceInData($A’çãõã¯Ý) { if (substr($A’çãõã¯Ý, 0, strlen(HOME_PATH)) == HOME_PATH || substr($A’çãõã¯Ý, 0, strlen(USER_RECYCLE)) == USER_RECYCLE) { return true; } return false; } function spaceSizeChange($aÁ’©Ž—Æ¡, $c›ù¸Ë°ì = true, $dŒ¦ç³çªÔ = false, $câ§¦Ö™•† = false) { if (!system_space()) { return; } if ($dŒ¦ç³çªÔ === false) { $dŒ¦ç³çªÔ = $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"]; $câ§¦Ö™•† = $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"]; } $A‚…è÷«˜¾ = spaceSizeGet($aÁ’©Ž—Æ¡, $c›ù¸Ë°ì); if ($A‚…è÷«˜¾ == base64_decode('bWlzcw==')) { return false; } if ($dŒ¦ç³çªÔ == KOD_GROUP_SHARE || $dŒ¦ç³çªÔ == KOD_GROUP_PATH) { systemGroup::spaceChange($câ§¦Ö™•†, $A‚…è÷«˜¾); } else { if (ST == "\x73\x68\x61\x72\x65") { $DÍ“ª¨á¸È = $GLOBALS["\x69\x6e"]["\165\163\145\162"]; } else { $DÍ“ª¨á¸È = $_SESSION[_kstr2('kodUser')]["\x75\x73\x65\x72\x49\x44"]; } systemMember::spaceChange($DÍ“ª¨á¸È, $A‚…è÷«˜¾); } } function spaceSizeChangeRemove($aÁ’©Ž—Æ¡) { spaceSizeChange($aÁ’©Ž—Æ¡, false); } function spaceSizeChangeMove($F¶¤•Øâ™¥, $dÍ¼•”Ë¬¿) { if (isset($GLOBALS["\x6b\x6f\x64\x42\x65\x66\x6f\x72"."\x65\x50\x61\x74\x68"."\x49\x64"]) && isset($GLOBALS[strrev('dIhtaPdok')])) { if ($GLOBALS[_kstr2('kodBefor')."\x65\x50\x61\x74"."\x68\x49\x64"] == $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] && $GLOBALS[_kstr2('beforePath')._kstr2('Type')] == $GLOBALS[_kstr2('kodPathType')]) { return; } spaceSizeChange($dÍ¼•”Ë¬¿, false); spaceSizeChange($dÍ¼•”Ë¬¿, true, $GLOBALS[base64_decode('YmVmb3JlUGF0')."\x68"."\x54\x79\x70\x65"], $GLOBALS[strrev('erofeBdok').strrev('IhtaP')."\x64"]); } else { spaceSizeChange($dÍ¼•”Ë¬¿); } } function spaceSizeReset() { if (!system_space()) { return; } $dŒ¦ç³çªÔ = isset($GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"]) ? $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"] : ''; $câ§¦Ö™•† = isset($GLOBALS["\153\157\144\120\141\164\150\111\144"]) ? $GLOBALS[strrev('dIhtaPdok')] : ''; if ($dŒ¦ç³çªÔ == KOD_GROUP_SHARE || $dŒ¦ç³çªÔ == KOD_GROUP_PATH) { systemGroup::spaceChange($câ§¦Ö™•†); } else { $DÍ“ª¨á¸È = $_SESSION[base64_decode('a29kVXNlcg==')][strrev('DIresu')]; systemMember::spaceChange($DÍ“ª¨á¸È); } } function init_session() { if (!function_exists(base64_decode('c2Vzc2lvbl9zdGFydA=='))) { show_tips(strrev('¨™å¡Šåœæ')."\160\150\160\347\273\204\344\273".base64_decode('tue8uuWk')._kstr2('±! (PHP ').base64_decode('bWlzcyBsaQ==').strrev('·¯è>/rb<)b')."\346\243\200\346\237"."\xa5\x70\x68\x70\x2e\x69\x6e\x69"."\357\274\214\351\234".base64_decode('gOimgeW8gOWQr+aooeWd')._kstr2('—: <br/><p')."\x72\x65\x3e\x73"."\x65\x73\x73\x69\x6f\x6e\x2c\x6a\x73\x6f\x6e"."\x2c\x63\x75\x72\x6c\x2c\x65\x78\x69"._kstr2('f,mb')."\x73\x74".strrev('g,padl,gnir')."\144\54\160\144\157\54\160\144\157\55\155\171".strrev('<lmx,lqs')."\x2f\x70\x72\x65\x3e\x3c\x62\x72\x2f\x3e"); } if (isset($_REQUEST[base64_decode('YWNjZXNzVG9rZW4=')])) { access_token_check($_REQUEST[strrev('nekoTssecca')]); } else { if (isset($_REQUEST["\141\143\143\145\163\163\137\164\157\153"."\145"."\156"])) { access_token_check($_REQUEST["\x61\x63\x63\x65\x73\x73\x5f\x74\x6f\x6b\x65\x6e"]); } else { @session_name(SESSION_ID); } } $eñ†²ÁÎ = @session_save_path(); if (class_exists("\123\141\145\123\164\157\162\141\147\145") || defined(base64_decode('U0FFX0FQUE5BTUU=')) || defined("\x53\x45\x53\x53\x49\x4f\x4e\x5f\x50\x41\x54"."\x48\x5f\x44\x45\x46\x41\x55\x4c\x54") || @ini_get("\163\145\163\163\151\157\156\56\163\141\166\145\137\150\141".strrev('reldn')) != "\x66\x69\x6c\x65\x73" || isset($_SERVER[strrev('EMANPPA_PTTH')])) { } else { chmod_path(KOD_SESSION, 511); @session_save_path(KOD_SESSION); } @session_start(); $_SESSION["\x6b\x6f\x64"] = 1; @session_write_close(); @session_start(); if (!$_SESSION["\153\157\144"]) { @session_save_path($eñ†²ÁÎ); @session_start(); $_SESSION["\x6b\x6f\x64"] = 1; @session_write_close(); @session_start(); } if (!$_SESSION["\153\157\144"]) { show_tips(base64_decode('5pyN5Yqh5Zmo')."\x73\x65\x73\x73\x69\x6f\x6e\xe5"._kstr2('†™å…¥å¤±è´¥!')."\x20\x28\x73\x65\x73\x73\x69\x6f\x6e\x20\x77\x72\x69"."\164\145\40\145\162\162\157\162\51"."\x3c\x62\x72\x2f\x3e" . base64_decode('6K+35qOA5p+l')."\160\150\160\56\151"."\156\151\347\233\270\345\205\263\351\205".strrev('‹œç¥Ÿæ,®½ç').strrev('¯˜æ˜›ç£ç')._kstr2('å¦å·²æ»¡,æ')."\210".base64_decode('luWSqOivouacjQ==')."\345\212\241\345\225\206\343\200\202\74"."\x62\x72\x2f\x3e".strrev('>/rb<') . strrev('.noisses').strrev('evas')._kstr2('_path=') . $eñ†²ÁÎ . "\x3c\x62\x72\x2f\x3e" . "\x73\x65\x73\x73\x69\x6f\x6e\x2e\x73"."\141\166"."\x65\x5f\x68\x61\x6e\x64\x6c\x65\x72\x3d" . @ini_get("\x73\x65\x73\x73\x69\x6f\x6e\x2e\x73".strrev('va')."\145\137\150\141\156\144\154\145"._kstr2('r')) . strrev('>/rb<')); } } function access_token_check($eâ¦ôà›ôÍ) { $fƒÑ¬ßÓÍŒ = $GLOBALS[strrev('gifnoc')][base64_decode('c2V0dGluZ1N5').strrev('mets')]["\163\171\163\164\145\155\120\141\163\163"."\167\157\162\144"]; $fƒÑ¬ßÓÍŒ = substr(md5("\x6b\x6f\x64\x45\x78\x70\x6c\x6f\x72\x65\x72\x5f" . $fƒÑ¬ßÓÍŒ), 0, 15); $eˆŒîß„ã– = Mcrypt::decode($eâ¦ôà›ôÍ, $fƒÑ¬ßÓÍŒ); if (!$eˆŒîß„ã–) { show_tips("\141\143\143\145\163\163\124\157"."\153\145\156\40\145\162\162\157\162\41"); } session_id($eˆŒîß„ã–); session_name(SESSION_ID); } function access_token_get() { $eˆŒîß„ã– = session_id(); $fƒÑ¬ßÓÍŒ = $GLOBALS[_kstr2('config')]["\x73\x65\x74\x74\x69\x6e\x67\x53\x79\x73"."\x74\x65\x6d"]["\x73\x79\x73\x74\x65\x6d\x50\x61\x73\x73"._kstr2('wo')."\162\144"]; $fƒÑ¬ßÓÍŒ = substr(md5("\153\157\144\105\170\160\154\157"."\162"."\x65\x72\x5f" . $fƒÑ¬ßÓÍŒ), 0, 15); $DÃŸ¤ùã‹ = Mcrypt::encode($eˆŒîß„ã–, $fƒÑ¬ßÓÍŒ, 3600 * 24); return $DÃŸ¤ùã‹; } function init_config() { init_setting(); init_session(); init_space_size_hook(); }
