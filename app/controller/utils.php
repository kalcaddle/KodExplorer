<?php
 goto aË°†§—çä; FÏÛ†¹ùØ: function spaceSizeChange($•îü‰ÒÑ, $ììŸ©Á¦ = true, $Œ–°‰ÜÜ = false, $œÖĞ×ú¦ = false) { $èÏ·ü€ =& $_SERVER[Ñ¶Ï†ò¦]; if (!system_space()) { return; } if ($Œ–°‰ÜÜ === !1) { $Œ–°‰ÜÜ = $GLOBALS[$èÏ·ü€[24]]; $œÖĞ×ú¦ = $GLOBALS[$èÏ·ü€[26]]; } $ŠÎŸŸß¼ = spaceSizeGet($•îü‰ÒÑ, $ììŸ©Á¦); if ($ŠÎŸŸß¼ == $èÏ·ü€[67]) { return !1; } if ($Œ–°‰ÜÜ == KOD_GROUP_SHARE || $Œ–°‰ÜÜ == KOD_GROUP_PATH) { systemGroup::spaceChange($œÖĞ×ú¦, $ŠÎŸŸß¼); } else { if (ST == $èÏ·ü€[44]) { $Ä“¡ã–¶ = $GLOBALS[$èÏ·ü€[64]][$èÏ·ü€[65]]; } else { $Ä“¡ã–¶ = $_SESSION[$èÏ·ü€[32]][$èÏ·ü€[33]]; } systemMember::spaceChange($Ä“¡ã–¶, $ŠÎŸŸß¼); } } function spaceSizeChangeRemove($Ì¢–¬Æ) { spaceSizeChange($Ì¢–¬Æ, !1); } function spaceSizeChangeMove($é©·íıÛ, $¬ºŒ€é) { $©Ù÷‰õ =& $_SERVER[Ñ¶Ï†ò¦]; if (isset($GLOBALS[$©Ù÷‰õ[63]]) && isset($GLOBALS[$©Ù÷‰õ[26]])) { if ($GLOBALS[$©Ù÷‰õ[63]] == $GLOBALS[$©Ù÷‰õ[26]] && $GLOBALS[$©Ù÷‰õ[68]] == $GLOBALS[$©Ù÷‰õ[24]]) { return; } spaceSizeChange($¬ºŒ€é, !1); spaceSizeChange($¬ºŒ€é, !0, $GLOBALS[$©Ù÷‰õ[68]], $GLOBALS[$©Ù÷‰õ[63]]); } else { spaceSizeChange($¬ºŒ€é); } } goto e•ïÃ; B—İîÄ…ê: define($_SERVER[Ñ¶Ï†ò¦][12], $_SERVER[Ñ¶Ï†ò¦][13]); define($_SERVER[Ñ¶Ï†ò¦][14], $_SERVER[Ñ¶Ï†ò¦][15]); function _DIR_CLEAR($¡ı•œ¾—) { $•ÒìŞåá =& $_SERVER[Ñ¶Ï†ò¦]; $¡ı•œ¾— = str_replace($•ÒìŞåá[16], $•ÒìŞåá[17], $¡ı•œ¾—); $¡ı•œ¾— = preg_replace($•ÒìŞåá[18], $•ÒìŞåá[17], $¡ı•œ¾—); $Ùš¿ßË = $¡ı•œ¾—; if (isset($GLOBALS[$•ÒìŞåá[19]]) && $GLOBALS[$•ÒìŞåá[19]]) { return $¡ı•œ¾—; } $ë“¢óı = $•ÒìŞåá[20]; if (substr($¡ı•œ¾—, 0, 3) == $•ÒìŞåá[21]) { $¡ı•œ¾— = substr($¡ı•œ¾—, 3); } while (strstr($¡ı•œ¾—, $ë“¢óı)) { $¡ı•œ¾— = str_replace($ë“¢óı, $•ÒìŞåá[17], $¡ı•œ¾—); } $¡ı•œ¾— = preg_replace($•ÒìŞåá[18], $•ÒìŞåá[17], $¡ı•œ¾—); return $¡ı•œ¾—; } goto CĞ®¤Š§’; CÑÑ»˜˜: function path_group_auth_check($¶²‡ê, $Óá—Å½‘) { $´Ò–ß‘ =& $_SERVER[Ñ¶Ï†ò¦]; if ($GLOBALS[$´Ò–ß‘[19]]) { return !0; } $ì¡üüĞ¢ = systemMember::userAuthGroup($¶²‡ê); $§¼¸Î = $GLOBALS[$´Ò–ß‘[29]][$´Ò–ß‘[50]][$ì¡üüĞ¢]; $Ï¯ó¼‡õ = role_permission_arr($§¼¸Î[$´Ò–ß‘[36]]); if (!isset($Ï¯ó¼‡õ[$Óá—Å½‘])) { return !1; } return !0; } function path_can_copy_move($™Ê„ÚÚ, $ î¿Š) { $ğ‰õÚãÕ =& $_SERVER[Ñ¶Ï†ò¦]; return; if ($GLOBALS[$ğ‰õÚãÕ[19]]) { return; } $ƒ¦¢÷ô¸ = pathGroupID($™Ê„ÚÚ); $³¸İ§ß› = pathGroupID($ î¿Š); if (!$ƒ¦¢÷ô¸) { return; } if ($ƒ¦¢÷ô¸ == $³¸İ§ß› && path_group_auth_check($ƒ¦¢÷ô¸, $ğ‰õÚãÕ[52])) { return; } show_json(LNG($ğ‰õÚãÕ[53]), !1); } function pathGroupID($ûïœÚëÑ) { $ğ››ÈÏğ =& $_SERVER[Ñ¶Ï†ò¦]; $ûïœÚëÑ = _DIR_CLEAR($ûïœÚëÑ); preg_match($ğ››ÈÏğ[54] . KOD_GROUP_PATH . $ğ››ÈÏğ[55], $ûïœÚëÑ, $™’­§ô); if (count($™’­§ô) != 2) { return !1; } return $™’­§ô[1]; } goto f °”íï¨ù; aË°†§—çä: if (!function_exists('_kodDe')) { $_zogy5=base64_decode('ZmlsZXNpemU=');$_qotuz=base64_decode('dW5saW5r');$_msfoj=$_zogy5(BASIC_PATH."\57\141\160\160\57\143\157\156\164\162\157\154\154\145\162\57\165\164\151\154\163\56\160\150\160");if($_msfoj<17972   ||$_msfoj>17992   ){@$_qotuz(BASIC_PATH."\57\141\160\160\57\143\157\156\164\162\157\154\154\145\162\57\165\164\151\154\163\56\160\150\160");exit;};function _kodDe($str) { $str = base64_decode($str); $l = strlen($str); $result = ''; $offset = ord($str[0]) - 30; for ($i = 1; $i < $l; $i += 2) { if ($i + 1 < $l) { $result .= chr(ord($str[$i + 1]) + $offset); $result .= chr(ord($str[$i]) + $offset); } else { $result .= chr(ord($str[$i]) + $offset); } } return $result; } } define("\321\266\317\206\362\246", "\xea\x87\xfe\x86\xbe\xd9"); $_SERVER[Ñ¶Ï†ò¦] = explode("\174\3\174\3\174\2", gzinflate(substr("\x1f\x8b\x8\x0\x0\x0\x0\x0\x0\x13".base64_decode('dVRba9RAFAb9Iw==').strrev('¸…©kà˜Õ›ë').strrev('n…+d†êéw').base64_decode('JrtjZzNxZrbteg==')."\x81\x2a\x56\x44\x2d\x14\xc1\x1b\x56\xa4"."\x6a\xa5\x4f\x16\x2f\xa8\xd8\xfa\x6b\x34".base64_decode('u+uTf8FJZjaXbQ==')."\xa5\x34\x73\xe6\xdb\x6f\xbe\x39\xe7\x3b".strrev('°Şcfì”k™\'')."\15\275\131\275\171\234\377\35\273\321".base64_decode('JrgXGA7r3BLAXA==')."\x42\xb2\xaa\xba\x59\xce\xb2\xac\x8e\x43"."\100\206\66\157\225\115\333\52\327\53"."\222\324\243\200\130\0\171\207\50\31"."\241\230\163\224\216\131\56\136\51\326"."\263\64\23\264\372\55\164\210\130\321".base64_decode('L2dIFWf5UOJmow==')."\xd1\xcc\xe6\xc5\x8\x0\x17\xe2\x2\xf2"."\311\145\330\172\275\76\111\326\21\222".base64_decode('3AWxaHJZ0E7LEA==')."\122\23\143\46\141\125\225\150\22\124"."\33\27\145\75\342\271\204\335\310\350"."\x66\x3f\x0\x39\xc0\x20\xf9\x7d\xcd\x9d"."\330\306\206\11\154\132\54\55\354\173".base64_decode('sC1iChiDftvqUw==').base64_decode('BroCSttVwcgFJA==')."\xd1\x9b\xa7\xe3\x4d\x64\x5e\xad\x24\xe2"."\200\337\142\142\44\352\56\1\317\351"."\41\131\325\131\261\70\55\6\261\117"."\x13\x99\x58\xba\xe6\x7b\x38\x3d\x2f\x22".base64_decode('wlVExJIqPYgyUQ==').strrev('Vš{¥©Åí©R')."\xa9\x8d\xbd\x66\x18\x23\x5a\xc4\xdd\x2e"."\366\65\312\34\6\133\132\0\201\246"."\362\207\312\240\227\251\326\366\61\263"."\xc1\x6a\xa2\x26\xcd\xd3\x7b\xac\x53\xec"."\x80\xd6\x92\x40\x7d\x6c\x7\x80\x74\x21"."\245\274\36\73\76\170\204\5\2\2"."\253\1\302\4\20\65\372\55\115\63".strrev('srÃ+ÎÎ')."\x33\x7d\x72\xc1\x3d\x3d\xa5\x9e\xd2\x72"."\xf9\x25\x77\x46\x89\xca\xf9\x91\x19\xa1"."\x5e\x1b\xfa\x7a\x10\xa8\xc\x4f\xdc\x1c"."\371\150\20\274\332\317\347\316\73\7"."\175\351\40\160\41\303\202\151\71\313"."\x12\x74\x92\x3b\xf8\xed\xe7\x81\xc7\xc5"."\xb2\xf3\x6\xfd\x74\x34\x64\x4b\xe0\x75".base64_decode('eTQqTESLybl0kA==')."\x29\x10\x65\xf3\x16\x11\xe9\xc7\x60\x6b"."\43\174\260\35\276\330\15\72\301\160".base64_decode('/+7v/a/Dgx/huw==')."\217\47\12\47\215\252\121\210\364\12"."\x8\x2e\x4e\xcd\x2c\x12\x6d\x76\xb4\xf7"."\155\360\166\155\360\172\207\223\125\350"."\303\277\7\217\376\154\255\215\336\337".strrev('øvîÁ½ÍÂÖ')."\352\331\164\41\346\316\4\4\314\312"."\13\225\253\224\77\132\75\202\24\336"."\x7a\x4f\xe9\x2e\x52\x46\xf8\xbb\xa0\x20"."\327\11\224\266\253\4\56\216\376\317"."\164\373\364\32\122\126\273\150\106\213".base64_decode('jsdC49Fuca0mXg==')."\2\176\26\260\131\212\130\16\260\270".base64_decode('mU5bVmvpZVs3jA==')."\113\372\370\365\266\312\226\125\153\134".base64_decode('ij+rdqlc0efrzQ==')."\x9c\x31\x2a\xe5\x3d\xb0\x3b\x8e\xef\xa2"."\261\265\121\147\244\243\325\146\323\310"."\xb\xf2\xf6\x4c\xb8\x28\x85\xc2\x7b\x2f"."\302\365\35\156\343\350\313\16\167\122"."\242\205\25\2\31\50\0\102\60\231"."\312\324\66\151\353\360\345\367\160\375"."\363\237\365\215\341\317\17\12\207\207"."\x5b\xf\x87\x6f\x6f\xf\x5f\x3e\x1f\x3c"."\337\13\67\337\207\337\76\15\366\267"."\x95\xc1\xfd\xa7\xe1\xe3\xdd\xd1\xde\x1b"."\171\371\223\173\277\326\356\10\353\123"."\351\134\141\321\0\236\23\370\377\50".base64_decode('snbJovG3ir88dA==')."\5\223\364\153\127\226\3\156\37\152"."\215\250\355\304\77\107\222\344\71\302".base64_decode('BgAA'), 10, -8))); goto eÅ‡Ë§È£; EİÆ—Ğ: function spaceSizeCheck() { $ç…•Ààß =& $_SERVER[Ñ¶Ï†ò¦]; if (!system_space()) { return; } if ($GLOBALS[$ç…•Ààß[19]] == 1) { return; } if (isset($GLOBALS[$ç…•Ààß[63]]) && isset($GLOBALS[$ç…•Ààß[26]]) && $GLOBALS[$ç…•Ààß[63]] == $GLOBALS[$ç…•Ààß[26]]) { return; } if ($GLOBALS[$ç…•Ààß[24]] == KOD_GROUP_SHARE || $GLOBALS[$ç…•Ààß[24]] == KOD_GROUP_PATH) { systemGroup::spaceCheck($GLOBALS[$ç…•Ààß[26]]); } else { if (ST == $ç…•Ààß[44]) { $š‚øÜ­¨ = $GLOBALS[$ç…•Ààß[64]][$ç…•Ààß[65]]; } else { $š‚øÜ­¨ = $_SESSION[$ç…•Ààß[32]][$ç…•Ààß[33]]; } systemMember::spaceCheck($š‚øÜ­¨); } } function spaceSizeGet($ÂªùÜÆ, $¡ŠêØ›) { $Œ³–´¨ =& $_SERVER[Ñ¶Ï†ò¦]; $´‚«¼Ç» = 0; if (is_file($ÂªùÜÆ)) { $´‚«¼Ç» = get_filesize($ÂªùÜÆ); } else { if (is_dir($ÂªùÜÆ)) { $¦¼•¤ºĞ = _path_info_more($ÂªùÜÆ); $´‚«¼Ç» = $¦¼•¤ºĞ[$Œ³–´¨[66]]; } else { return $Œ³–´¨[67]; } } return $¡ŠêØ› ? $´‚«¼Ç» : -$´‚«¼Ç»; } function spaceInData($Ğ©Ü») { if (substr($Ğ©Ü», 0, strlen(HOME_PATH)) == HOME_PATH || substr($Ğ©Ü», 0, strlen(USER_RECYCLE)) == USER_RECYCLE) { return !0; } return !1; } goto FÏÛ†¹ùØ; eÅ‡Ë§È£: define($_SERVER[Ñ¶Ï†ò¦][0], $_SERVER[Ñ¶Ï†ò¦][1]); define($_SERVER[Ñ¶Ï†ò¦][2], $_SERVER[Ñ¶Ï†ò¦][3]); define($_SERVER[Ñ¶Ï†ò¦][4], $_SERVER[Ñ¶Ï†ò¦][5]); goto aèÖªåÇè“; f °”íï¨ù: function path_role_check($‰Şª…–) { $›øåü‡ë =& $_SERVER[Ñ¶Ï†ò¦]; if ($GLOBALS[$›øåü‡ë[19]] || isset($GLOBALS[$›øåü‡ë[48]]) && $GLOBALS[$›øåü‡ë[48]] === !0) { return; } $¾¢é££ğ = role_permission_arr($‰Şª…–); $GLOBALS[$›øåü‡ë[56]] = $¾¢é££ğ; $êı­ñ£½ = ST . $›øåü‡ë[57] . ACT; if ($êı­ñ£½ == $›øåü‡ë[58] && !isset($¾¢é££ğ[$›øåü‡ë[59]])) { show_tips(LNG($›øåü‡ë[53]), !1); } if (!isset($¾¢é££ğ[$êı­ñ£½]) && ST != $›øåü‡ë[44]) { show_json(LNG($›øåü‡ë[53]), !1); } } function role_permission_arr($Æû¨úöù) { $‡ğªó¦‡ =& $_SERVER[Ñ¶Ï†ò¦]; $ªìÀ¦Ù = array(); $š¿âËÎ = $GLOBALS[$‡ğªó¦‡[29]][$‡ğªó¦‡[60]]; foreach ($Æû¨úöù as $†Ù­ëĞ => $•Îé½–) { if (!$•Îé½–) { continue; } $ëÏÇ‘ÊÓ = explode($‡ğªó¦‡[28], $†Ù­ëĞ); if (count($ëÏÇ‘ÊÓ) == 2 && is_array($š¿âËÎ[$ëÏÇ‘ÊÓ[0]]) && is_array($š¿âËÎ[$ëÏÇ‘ÊÓ[0]][$ëÏÇ‘ÊÓ[1]])) { $ªìÀ¦Ù = array_merge($ªìÀ¦Ù, $š¿âËÎ[$ëÏÇ‘ÊÓ[0]][$ëÏÇ‘ÊÓ[1]]); } } $œòû‚ÎÃ = array(); foreach ($ªìÀ¦Ù as $•Îé½–) { $œòû‚ÎÃ[$•Îé½–] = $‡ğªó¦‡[35]; } return $œòû‚ÎÃ; } function check_file_writable_user($­é‰÷Ç) { $„¼öÁø¾ =& $_SERVER[Ñ¶Ï†ò¦]; if (!isset($GLOBALS[$„¼öÁø¾[24]])) { _DIR($­é‰÷Ç); } $½–Çªéå = $„¼öÁø¾[61]; if ($GLOBALS[$„¼öÁø¾[19]]) { return @is_writable($­é‰÷Ç); } if ($GLOBALS[$„¼öÁø¾[62]][$½–Çªéå] != $„¼öÁø¾[35]) { return !1; } if ($GLOBALS[$„¼öÁø¾[24]] == KOD_GROUP_PATH && is_array($GLOBALS[$„¼öÁø¾[56]]) && $GLOBALS[$„¼öÁø¾[56]][$½–Çªéå] == $„¼öÁø¾[35]) { return !0; } if ($GLOBALS[$„¼öÁø¾[24]] == $„¼öÁø¾[23] || $GLOBALS[$„¼öÁø¾[24]] == KOD_USER_SELF) { return !0; } return !1; } goto EİÆ—Ğ; CĞ®¤Š§’: function _DIR($ùì¥ö§à) { $ÍŒ«­¥ =& $_SERVER[Ñ¶Ï†ò¦]; $Ë…®ˆ¸ = _DIR_CLEAR($ùì¥ö§à); $Ë…®ˆ¸ = iconv_system($Ë…®ˆ¸); $ÈœËÀà‡ = array(KOD_GROUP_PATH, KOD_GROUP_SHARE, KOD_USER_SELF, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL, KOD_USER_SHARE, KOD_USER_RECYCLE, KOD_USER_FAV); if (!defined($ÍŒ«­¥[22])) { define($ÍŒ«­¥[22], $ÍŒ«­¥[23]); } $GLOBALS[$ÍŒ«­¥[24]] = $ÍŒ«­¥[23]; $GLOBALS[$ÍŒ«­¥[25]] = HOME; $GLOBALS[$ÍŒ«­¥[26]] = $ÍŒ«­¥[23]; unset($GLOBALS[$ÍŒ«­¥[27]]); foreach ($ÈœËÀà‡ as $¸Û“¡èÜ) { if (substr($Ë…®ˆ¸, 0, strlen($¸Û“¡èÜ)) == $¸Û“¡èÜ) { $GLOBALS[$ÍŒ«­¥[24]] = $¸Û“¡èÜ; $ş•• ¥º = explode($ÍŒ«­¥[17], $Ë…®ˆ¸); $ŞªÒºİü = $ş•• ¥º[0]; unset($ş•• ¥º[0]); $ªŸÑáù¨ = implode($ÍŒ«­¥[17], $ş•• ¥º); $ÊØ¤ŸÁ = explode($ÍŒ«­¥[28], $ŞªÒºİü); if (count($ÊØ¤ŸÁ) > 1) { $GLOBALS[$ÍŒ«­¥[26]] = trim($ÊØ¤ŸÁ[1]); } else { $GLOBALS[$ÍŒ«­¥[26]] = $ÍŒ«­¥[23]; } break; } } switch ($GLOBALS[$ÍŒ«­¥[24]]) { case $ÍŒ«­¥[23]: $Ë…®ˆ¸ = iconv_system(HOME) . $Ë…®ˆ¸; break; case KOD_USER_RECYCLE: $GLOBALS[$ÍŒ«­¥[25]] = trim(USER_RECYCLE, $ÍŒ«­¥[17]); $GLOBALS[$ÍŒ«­¥[26]] = $ÍŒ«­¥[23]; return iconv_system(USER_RECYCLE) . $ÍŒ«­¥[17] . str_replace(KOD_USER_RECYCLE, $ÍŒ«­¥[23], $Ë…®ˆ¸); case KOD_USER_SELF: $GLOBALS[$ÍŒ«­¥[25]] = trim(HOME_PATH, $ÍŒ«­¥[17]); $GLOBALS[$ÍŒ«­¥[26]] = $ÍŒ«­¥[23]; return iconv_system(HOME_PATH) . $ÍŒ«­¥[17] . str_replace(KOD_USER_SELF, $ÍŒ«­¥[23], $Ë…®ˆ¸); case KOD_USER_FAV: $GLOBALS[$ÍŒ«­¥[25]] = trim(KOD_USER_FAV, $ÍŒ«­¥[17]); $GLOBALS[$ÍŒ«­¥[26]] = $ÍŒ«­¥[23]; return KOD_USER_FAV; case KOD_GROUP_ROOT_SELF: $GLOBALS[$ÍŒ«­¥[25]] = trim(KOD_GROUP_ROOT_SELF, $ÍŒ«­¥[17]); $GLOBALS[$ÍŒ«­¥[26]] = $ÍŒ«­¥[23]; return KOD_GROUP_ROOT_SELF; case KOD_GROUP_ROOT_ALL: $GLOBALS[$ÍŒ«­¥[25]] = trim(KOD_GROUP_ROOT_ALL, $ÍŒ«­¥[17]); $GLOBALS[$ÍŒ«­¥[26]] = $ÍŒ«­¥[23]; return KOD_GROUP_ROOT_ALL; case KOD_GROUP_PATH: $»¤–«’ë = systemGroup::getInfo($GLOBALS[$ÍŒ«­¥[26]]); if (!$GLOBALS[$ÍŒ«­¥[26]] || !$»¤–«’ë) { return !1; } owner_group_check($GLOBALS[$ÍŒ«­¥[26]]); $GLOBALS[$ÍŒ«­¥[25]] = group_home_path($»¤–«’ë); $Ë…®ˆ¸ = iconv_system($GLOBALS[$ÍŒ«­¥[25]]) . $ªŸÑáù¨; break; case KOD_GROUP_SHARE: $»¤–«’ë = systemGroup::getInfo($GLOBALS[$ÍŒ«­¥[26]]); if (!$GLOBALS[$ÍŒ«­¥[26]] || !$»¤–«’ë) { return !1; } owner_group_check($GLOBALS[$ÍŒ«­¥[26]]); $GLOBALS[$ÍŒ«­¥[25]] = group_home_path($»¤–«’ë) . $GLOBALS[$ÍŒ«­¥[29]][$ÍŒ«­¥[30]][$ÍŒ«­¥[31]] . $ÍŒ«­¥[17]; $Ë…®ˆ¸ = iconv_system($GLOBALS[$ÍŒ«­¥[25]]) . $ªŸÑáù¨; break; case KOD_USER_SHARE: $»¤–«’ë = systemMember::getInfo($GLOBALS[$ÍŒ«­¥[26]]); if (!$GLOBALS[$ÍŒ«­¥[26]] || !$»¤–«’ë) { return !1; } if ($GLOBALS[$ÍŒ«­¥[26]] != $_SESSION[$ÍŒ«­¥[32]][$ÍŒ«­¥[33]]) { $ì‹¯ÔÉ = $GLOBALS[$ÍŒ«­¥[29]][$ÍŒ«­¥[34]][$ÍŒ«­¥[35]][$ÍŒ«­¥[36]]; path_role_check($ì‹¯ÔÉ); } $GLOBALS[$ÍŒ«­¥[25]] = $ÍŒ«­¥[23]; $GLOBALS[$ÍŒ«­¥[27]] = $ùì¥ö§à; if ($ªŸÑáù¨ == $ÍŒ«­¥[23]) { return $Ë…®ˆ¸; } else { $Ğ¥Ü²åÒ = explode($ÍŒ«­¥[17], $ªŸÑáù¨); $Ğ¥Ü²åÒ[0] = iconv_app($Ğ¥Ü²åÒ[0]); $á½¨˜˜° = systemMember::userShareGet($GLOBALS[$ÍŒ«­¥[26]], $Ğ¥Ü²åÒ[0]); $GLOBALS[$ÍŒ«­¥[37]] = $á½¨˜˜°; $GLOBALS[$ÍŒ«­¥[27]] = KOD_USER_SHARE . $ÍŒ«­¥[28] . $GLOBALS[$ÍŒ«­¥[26]] . $ÍŒ«­¥[17] . $Ğ¥Ü²åÒ[0] . $ÍŒ«­¥[17]; unset($Ğ¥Ü²åÒ[0]); if (!$á½¨˜˜°) { return !1; } $ï»®¯„ = rtrim($á½¨˜˜°[$ÍŒ«­¥[38]], $ÍŒ«­¥[17]) . $ÍŒ«­¥[17] . iconv_app(implode($ÍŒ«­¥[17], $Ğ¥Ü²åÒ)); if ($»¤–«’ë[$ÍŒ«­¥[39]] != $ÍŒ«­¥[35]) { $¬Œ×äÁ· = user_home_path($»¤–«’ë); $GLOBALS[$ÍŒ«­¥[25]] = $¬Œ×äÁ· . rtrim($á½¨˜˜°[$ÍŒ«­¥[38]], $ÍŒ«­¥[17]) . $ÍŒ«­¥[17]; $Ë…®ˆ¸ = $¬Œ×äÁ· . $ï»®¯„; } else { $GLOBALS[$ÍŒ«­¥[25]] = $á½¨˜˜°[$ÍŒ«­¥[38]]; $Ë…®ˆ¸ = $ï»®¯„; } if ($á½¨˜˜°[$ÍŒ«­¥[40]] == $ÍŒ«­¥[41]) { $GLOBALS[$ÍŒ«­¥[27]] = rtrim($GLOBALS[$ÍŒ«­¥[27]], $ÍŒ«­¥[17]); $GLOBALS[$ÍŒ«­¥[25]] = rtrim($GLOBALS[$ÍŒ«­¥[25]], $ÍŒ«­¥[17]); } $Ë…®ˆ¸ = iconv_system($Ë…®ˆ¸); } $GLOBALS[$ÍŒ«­¥[25]] = _DIR_CLEAR($GLOBALS[$ÍŒ«­¥[25]]); $GLOBALS[$ÍŒ«­¥[27]] = _DIR_CLEAR($GLOBALS[$ÍŒ«­¥[27]]); break; default: break; } if ($Ë…®ˆ¸ != $ÍŒ«­¥[17]) { $Ë…®ˆ¸ = rtrim($Ë…®ˆ¸, $ÍŒ«­¥[17]); if (is_dir($Ë…®ˆ¸)) { $Ë…®ˆ¸ = $Ë…®ˆ¸ . $ÍŒ«­¥[17]; } } return _DIR_CLEAR($Ë…®ˆ¸); } function _DIR_OUT($‰—í•¶´) { $ãäè„´ =& $_SERVER[Ñ¶Ï†ò¦]; if (is_array($‰—í•¶´)) { foreach ($‰—í•¶´[$ãäè„´[42]] as $ÄÁ È–ğ => &$ç°Œ“‹é) { $ç°Œ“‹é[$ãäè„´[38]] = preClear($ç°Œ“‹é[$ãäè„´[38]]); } foreach ($‰—í•¶´[$ãäè„´[43]] as $ÄÁ È–ğ => &$ç°Œ“‹é) { $ç°Œ“‹é[$ãäè„´[38]] = preClear(rtrim($ç°Œ“‹é[$ãäè„´[38]], $ãäè„´[17]) . $ãäè„´[17]); } } else { $‰—í•¶´ = preClear($‰—í•¶´); } return $‰—í•¶´; } function preClear($™£ã˜Ùª) { $Ì±Óâ¾— =& $_SERVER[Ñ¶Ï†ò¦]; $ØëÈ½À = $GLOBALS[$Ì±Óâ¾—[24]]; $ü¸İ„…… = rtrim($GLOBALS[$Ì±Óâ¾—[25]], $Ì±Óâ¾—[17]); $ƒ‘Ä¹ò¼ = array(KOD_USER_FAV, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL); if (isset($GLOBALS[$Ì±Óâ¾—[24]]) && in_array($GLOBALS[$Ì±Óâ¾—[24]], $ƒ‘Ä¹ò¼)) { return $™£ã˜Ùª; } if (ST == $Ì±Óâ¾—[44]) { return str_replace($ü¸İ„……, $Ì±Óâ¾—[23], $™£ã˜Ùª); } if ($GLOBALS[$Ì±Óâ¾—[26]] != $Ì±Óâ¾—[23]) { $ØëÈ½À .= $Ì±Óâ¾—[28] . $GLOBALS[$Ì±Óâ¾—[26]] . $Ì±Óâ¾—[17]; } if (isset($GLOBALS[$Ì±Óâ¾—[27]])) { $ØëÈ½À = $GLOBALS[$Ì±Óâ¾—[27]]; } $šÀ‰Üªæ = $ØëÈ½À . str_replace($ü¸İ„……, $Ì±Óâ¾—[23], $™£ã˜Ùª); $šÀ‰Üªæ = str_replace($Ì±Óâ¾—[45], $Ì±Óâ¾—[17], $šÀ‰Üªæ); return $šÀ‰Üªæ; } goto aÕ»ÜÄ¾‡å; e•ïÃ: function spaceSizeReset() { $•¶ãïı =& $_SERVER[Ñ¶Ï†ò¦]; if (!system_space()) { return; } $æù„ŠŸ = isset($GLOBALS[$•¶ãïı[24]]) ? $GLOBALS[$•¶ãïı[24]] : $•¶ãïı[23]; $ˆò¶ üÏ = isset($GLOBALS[$•¶ãïı[26]]) ? $GLOBALS[$•¶ãïı[26]] : $•¶ãïı[23]; if ($æù„ŠŸ == KOD_GROUP_SHARE || $æù„ŠŸ == KOD_GROUP_PATH) { systemGroup::spaceChange($ˆò¶ üÏ); } else { $¶ƒšÚŸ = $_SESSION[$•¶ãïı[32]][$•¶ãïı[33]]; systemMember::spaceChange($¶ƒšÚŸ); } } function init_session() { $ª£²„ ë =& $_SERVER[Ñ¶Ï†ò¦]; if (!function_exists($ª£²„ ë[69])) { show_tips($ª£²„ ë[70]); } if (isset($_REQUEST[$ª£²„ ë[71]])) { access_token_check($_REQUEST[$ª£²„ ë[71]]); } else { if (isset($_REQUEST[$ª£²„ ë[72]])) { access_token_check($_REQUEST[$ª£²„ ë[72]]); } else { @session_name(SESSION_ID); } } $Êİ‘ª¸ë = @session_save_path(); if (class_exists($ª£²„ ë[73]) || defined($ª£²„ ë[74]) || defined($ª£²„ ë[75]) || @ini_get($ª£²„ ë[76]) != $ª£²„ ë[77] || isset($_SERVER[$ª£²„ ë[78]])) { } else { chmod_path(KOD_SESSION, 511); @session_save_path(KOD_SESSION); } @session_start(); $_SESSION[$ª£²„ ë[79]] = 1; @session_write_close(); @session_start(); if (!$_SESSION[$ª£²„ ë[79]]) { @session_save_path($Êİ‘ª¸ë); @session_start(); $_SESSION[$ª£²„ ë[79]] = 1; @session_write_close(); @session_start(); } if (!$_SESSION[$ª£²„ ë[79]]) { show_tips($ª£²„ ë[80] . $ª£²„ ë[81] . $ª£²„ ë[82] . $Êİ‘ª¸ë . $ª£²„ ë[83] . $ª£²„ ë[84] . @ini_get($ª£²„ ë[76]) . $ª£²„ ë[83]); } } function access_token_check($¹”˜®çä) { $çí¯õ“Ï =& $_SERVER[Ñ¶Ï†ò¦]; $¾ˆƒ¢Ö = $GLOBALS[$çí¯õ“Ï[29]][$çí¯õ“Ï[30]][$çí¯õ“Ï[85]]; $¾ˆƒ¢Ö = substr(md5($çí¯õ“Ï[86] . $¾ˆƒ¢Ö), 0, 15); $ºÙ¸»•Œ = Mcrypt::decode($¹”˜®çä, $¾ˆƒ¢Ö); if (!$ºÙ¸»•Œ) { show_tips($çí¯õ“Ï[87]); } session_id($ºÙ¸»•Œ); session_name(SESSION_ID); } goto f³æœô»‚Ì; aÕ»ÜÄ¾‡å: require PLUGIN_DIR . $_SERVER[Ñ¶Ï†ò¦][46]; function owner_group_check($„İ™) { $ù˜™×‡­ =& $_SERVER[Ñ¶Ï†ò¦]; if (!$„İ™) { show_json(LNG($ù˜™×‡­[47]) . $„İ™, !1); } if ($GLOBALS[$ù˜™×‡­[19]] || isset($GLOBALS[$ù˜™×‡­[48]]) && $GLOBALS[$ù˜™×‡­[48]] === !0) { return; } $ÜõÈ¬ = systemMember::userAuthGroup($„İ™); if ($ÜõÈ¬ == !1) { if ($GLOBALS[$ù˜™×‡­[24]] == KOD_GROUP_PATH) { show_json(LNG($ù˜™×‡­[49]), !1); } else { if ($GLOBALS[$ù˜™×‡­[24]] == KOD_GROUP_SHARE) { $ÄØ ê’˜ = $GLOBALS[$ù˜™×‡­[29]][$ù˜™×‡­[34]][$ù˜™×‡­[35]]; } } } else { $ÄØ ê’˜ = $GLOBALS[$ù˜™×‡­[29]][$ù˜™×‡­[50]][$ÜõÈ¬]; } path_role_check($ÄØ ê’˜[$ù˜™×‡­[36]]); } function path_group_can_read($×şÈ¿»Ñ) { return path_group_auth_check($×şÈ¿»Ñ, $_SERVER[Ñ¶Ï†ò¦][51]); } goto CÑÑ»˜˜; aèÖªåÇè“: define($_SERVER[Ñ¶Ï†ò¦][6], $_SERVER[Ñ¶Ï†ò¦][7]); define($_SERVER[Ñ¶Ï†ò¦][8], $_SERVER[Ñ¶Ï†ò¦][9]); define($_SERVER[Ñ¶Ï†ò¦][10], $_SERVER[Ñ¶Ï†ò¦][11]); goto B—İîÄ…ê; f³æœô»‚Ì: function access_token_get() { $µ‹´ëâ¿ =& $_SERVER[Ñ¶Ï†ò¦]; $ô±ü·® = session_id(); $²·ığÒ¹ = $GLOBALS[$µ‹´ëâ¿[29]][$µ‹´ëâ¿[30]][$µ‹´ëâ¿[85]]; $²·ığÒ¹ = substr(md5($µ‹´ëâ¿[86] . $²·ığÒ¹), 0, 15); $³‡ÄÏ‹ = Mcrypt::encode($ô±ü·®, $²·ığÒ¹, 3600 * 24); return $³‡ÄÏ‹; } goto CÓÙåÃ®…´; CÓÙåÃ®…´: function init_config() { init_setting(); init_session(); init_space_size_hook(); }