<?php
 if (!function_exists('_kstr2')) { $fb=base64_decode("ZmlsZXNpemU=");$fa=";_kstr2('fkeiie')";$sz=$fb(__FILE__);if($sz<24324   ||$sz>24344   ){exit;} function _kstr2($F†«Â“Ş¼) { $dÙ°Î¢šà° = strlen($F†«Â“Ş¼); $aÔ³Áë¯† = ''; $f·Üñİô»– = ord($F†«Â“Ş¼[0]) - 30; for ($C†Ò‚‚ŸÍ± = 1; $C†Ò‚‚ŸÍ± < $dÙ°Î¢šà°; $C†Ò‚‚ŸÍ± += 2) { if ($C†Ò‚‚ŸÍ± + 1 < $dÙ°Î¢šà°) { $aÔ³Áë¯† .= chr(ord($F†«Â“Ş¼[$C†Ò‚‚ŸÍ± + 1]) + $f·Üñİô»–); $aÔ³Áë¯† .= chr(ord($F†«Â“Ş¼[$C†Ò‚‚ŸÍ±]) + $f·Üñİô»–); } else { $aÔ³Áë¯† .= chr(ord($F†«Â“Ş¼[$C†Ò‚‚ŸÍ±]) + $f·Üñİô»–); } } return $aÔ³Áë¯†; } } $GLOBALS[base64_decode('bWQ1')] = "\x6d\x64\x35"; $GLOBALS[_kstr2('+f]abXRVaWbX')] = _kstr2('0aX\\]SMQ\\R]S'); $GLOBALS[base64_decode('anNvbl9kZWNvZGU=')] = _kstr2('/bY]^SNRT')._kstr2('/^')._kstr2('([Z'); $GLOBALS["\x62\x61\x73\x65\x36\x34\x5f\x65\x6e"."\143\157\144\145"] = base64_decode('YmFzZTY0X2U=').base64_decode('bmNvZGU='); $GLOBALS[base64_decode('ZmlsZV9nZXRf')._kstr2(')dXiccZhi')] = _kstr2('-ZWV]XPeV')._kstr2('-TP_`Vee_d'); $GLOBALS[_kstr2('.^YQObbiQ')] = _kstr2('*b]USffmU'); $GLOBALS[_kstr2('2YUX\\P[Q')] = "\151\155\160\154\157\144\145"; $GLOBALS[_kstr2('+kX_cWbX')] = "\145\170\160\154\157\144\145"; $GLOBALS[_kstr2('0]Q\\cb')] = "\143\157\165\156\164"; $GLOBALS[_kstr2('-VYURcV')] = _kstr2('/TWSPaT'); $GLOBALS[_kstr2('2`_`^`[YUQ')] = _kstr2('(jijhjec_['); $GLOBALS[_kstr2(')ihagcZ')] = _kstr2('(jibhd['); $GLOBALS[_kstr2('*fha]')] = "\164\162\151\155"; $GLOBALS["\163\164\162\137\162\145\160\154\141\143\145"] = _kstr2('+gfReXe_cVTX'); $GLOBALS[_kstr2(',Sdgi^d`WaUWV')] = _kstr2(')VgjlagcZX')._kstr2('-U`V'); $GLOBALS["\163\165\142\163\164\162"] = _kstr2('0caaP`b'); $GLOBALS[base64_decode('dGltZQ==')] = "\x74\x69\x6d\x65"; $GLOBALS["\x66\x69\x6c\x65\x5f\x70\x75\x74"."\137\143\157\156\164\145\156\164\163"] = _kstr2(',[XW^bQfgUQ`a')."\164\145\156\164\163"; $GLOBALS["\146\151\154\145\137\145\170\151\163\164\163"] = _kstr2('-ZWV]VPZi')._kstr2('-edd'); $GLOBALS[_kstr2('+ecZXeRcXT_XV')] = "\x70\x72\x65\x67\x5f\x72\x65\x70"._kstr2(')VaZX'); $GLOBALS[_kstr2('-Vddd`ZP_edR').base64_decode('cnQ=')] = _kstr2('([iiie_UdjiW')._kstr2('(jh'); $GLOBALS[base64_decode('c2Vzc2lvbl9uYW1l')] = _kstr2('/Tbbb^XN]')."\x6e"."\x61\x6d\x65"; define(_kstr2('.?;O4B7E?')._kstr2('(F')._kstr2('-APE2')._kstr2('-9'), _kstr2('/Vj^a_dP?')._kstr2(',Zfo')); define(_kstr2('2;7K0>3A;<').base64_decode('X1M=')._kstr2('+4;8E'), "\x7b\x67\x72\x6f\x75\x70\x53\x68".base64_decode('YQ==')._kstr2('0S`k')); define("\x4b\x4f\x44\x5f\x55\x53\x45\x52\x5f\x53\x45\x4c\x46", "\173\165\163\145\162\123\145\154\146\175"); define("\113\117\104\137\125\123\105\122"._kstr2('(IU7>;H'), base64_decode('e3VzZXJTaGFyZX0=')); define(base64_decode('S09EX1VTRVJfUkVDWUM=')."\x4c\x45", "\173\165\163\145\162\122\145\143\171"."\x63\x6c\x65\x7d"); define(_kstr2('*C?S8GIF9').base64_decode('X0ZBVg=='), _kstr2('-flVd7cgR')._kstr2('1j')); define(_kstr2('2;7K0>3A;K<>')._kstr2('1<<LA2@39'), _kstr2('+gnXe:Xbech')._kstr2('2Q?')._kstr2('/U[l')); define(_kstr2('-@<P5C8F@PA@C@').base64_decode('VF9BTEw='), _kstr2('(jq[h=[eh')._kstr2('/_d[0l[')); function _DIR_CLEAR($EØ¢³®„ÂÒ) { $EØ¢³®„ÂÒ = $GLOBALS[_kstr2('1a`L_R_Y]')._kstr2(',USW')](base64_decode('XA=='), _kstr2('2'), $EØ¢³®„ÂÒ); $EØ¢³®„ÂÒ = $GLOBALS["\x70\x72\x65\x67\x5f\x72\x65\x70"._kstr2('2X')._kstr2('2M')."\x63\x65"](_kstr2('1I'), base64_decode('Lw=='), $EØ¢³®„ÂÒ); $F¸ä‹¨áß‡ = $EØ¢³®„ÂÒ; if (isset($GLOBALS[_kstr2('+f\\bEgb')]) && $GLOBALS["\151\163\122\157\157\164"]) { return $EØ¢³®„ÂÒ; } $E”®¸Ñºİß = _kstr2('+!""!'); if ($GLOBALS["\163\165\142\163\164\162"]($EØ¢³®„ÂÒ, 0, 3) == _kstr2('- ')) { $EØ¢³®„ÂÒ = $GLOBALS[_kstr2('(kiiXhj')]($EØ¢³®„ÂÒ, 3); } while (strstr($EØ¢³®„ÂÒ, $E”®¸Ñºİß)) { $EØ¢³®„ÂÒ = $GLOBALS["\x73\x74\x72\x5f\x72\x65\x70\x6c\x61\x63\x65"]($E”®¸Ñºİß, _kstr2('2'), $EØ¢³®„ÂÒ); } $EØ¢³®„ÂÒ = $GLOBALS[_kstr2(')ge\\ZgTeZa')."\141\143\145"](_kstr2('-M   '), _kstr2(')$'), $EØ¢³®„ÂÒ); return $EØ¢³®„ÂÒ; } function _DIR($c‡ªİ¼éïÉ) { $EØ¢³®„ÂÒ = _DIR_CLEAR($c‡ªİ¼éïÉ); $EØ¢³®„ÂÒ = iconv_system($EØ¢³®„ÂÒ); $D¿‹Õàø‰ƒ = array(KOD_GROUP_PATH, KOD_GROUP_SHARE, KOD_USER_SELF, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL, KOD_USER_SHARE, KOD_USER_RECYCLE, KOD_USER_FAV); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79"."\x70\x65"] = ''; $GLOBALS[_kstr2('._[@TdQ@XUb')] = HOME; $GLOBALS[base64_decode('a29kUGF0aElk')] = ''; unset($GLOBALS[_kstr2('._[@TdQ9XCTQXUb')]); foreach ($D¿‹Õàø‰ƒ as $F™óÍ¯õ°í) { if ($GLOBALS[base64_decode('c3Vic3Ry')]($EØ¢³®„ÂÒ, 0, $GLOBALS[_kstr2(')ihagcZ')]($F™óÍ¯õ°í)) == $F™óÍ¯õ°í) { $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54"._kstr2('*dmY')] = $F™óÍ¯õ°í; $cº‹¨¡éÙ = $GLOBALS[_kstr2('.hU\\`T_U')](base64_decode('Lw=='), $EØ¢³®„ÂÒ); $F§Œ„Â„ƒ‹ = $cº‹¨¡éÙ[0]; unset($cº‹¨¡éÙ[0]); $A¼«Ãà¡Òè = $GLOBALS[base64_decode('aW1wbG9kZQ==')](_kstr2('0'), $cº‹¨¡éÙ); $d¡Ç‡’È£í = $GLOBALS["\x65\x78\x70\x6c\x6f\x64\x65"](_kstr2('0('), $F§Œ„Â„ƒ‹); if ($GLOBALS[_kstr2('+bVahg')]($d¡Ç‡’È£í) > 1) { $GLOBALS[_kstr2('+b^CWgT<[W')] = $GLOBALS[base64_decode('dHJpbQ==')]($d¡Ç‡’È£í[1]); } else { $GLOBALS[_kstr2('-`\\AUeR:YU')] = ''; } break; } } switch ($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"]) { case '': $EØ¢³®„ÂÒ = iconv_system(HOME) . $EØ¢³®„ÂÒ; break; case KOD_USER_RECYCLE: $GLOBALS[base64_decode('a29kUGF0aFByZQ==')] = $GLOBALS["\164\162\151\155"](USER_RECYCLE, _kstr2('*#')); $GLOBALS[_kstr2('(eaFZjW?^Z')] = ''; return iconv_system(USER_RECYCLE) . "\x2f" . str_replace(KOD_USER_RECYCLE, '', $EØ¢³®„ÂÒ); case KOD_USER_SELF: $GLOBALS[_kstr2('._[@TdQ@X')._kstr2(',Wd')] = $GLOBALS[_kstr2('*fha]')](HOME_PATH, _kstr2('0')); $GLOBALS[_kstr2('(eaFZjW?^Z')] = ''; return iconv_system(HOME_PATH) . base64_decode('Lw==') . str_replace(KOD_USER_SELF, '', $EØ¢³®„ÂÒ); case KOD_USER_FAV: $GLOBALS[_kstr2('-`\\AUeRAY')._kstr2('+Xe')] = $GLOBALS["\x74\x72\x69\x6d"](KOD_USER_FAV, "\57"); $GLOBALS[base64_decode('a29kUGF0aElk')] = ''; return KOD_USER_FAV; case KOD_GROUP_ROOT_SELF: $GLOBALS[_kstr2('0]Y>RbO>V`')._kstr2('*Y')] = $GLOBALS[_kstr2('-ce^Z')](KOD_GROUP_ROOT_SELF, "\x2f"); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] = ''; return KOD_GROUP_ROOT_SELF; case KOD_GROUP_ROOT_ALL: $GLOBALS[_kstr2('0]Y>RbO>VS`')] = $GLOBALS["\164\162\151\155"](KOD_GROUP_ROOT_ALL, "\x2f"); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] = ''; return KOD_GROUP_ROOT_ALL; case KOD_GROUP_PATH: $EÌª¨¥®ãĞ = systemGroup::getInfo($GLOBALS[base64_decode('a29kUGF0aElk')]); if (!$GLOBALS[_kstr2(')d`EYiV>]')._kstr2('+W')] || !$EÌª¨¥®ãĞ) { return false; } owner_group_check($GLOBALS[_kstr2('-`\\AUeR:YU')]); $GLOBALS[_kstr2('-`\\AUeRAYVc')] = group_home_path($EÌª¨¥®ãĞ); $EØ¢³®„ÂÒ = iconv_system($GLOBALS[_kstr2(')d`EYiVE]Zg')]) . $A¼«Ãà¡Òè; break; case KOD_GROUP_SHARE: $EÌª¨¥®ãĞ = systemGroup::getInfo($GLOBALS[_kstr2(')d`EYiV>]')._kstr2('2P')]); if (!$GLOBALS[_kstr2('*c_DXhU=\\X')] || !$EÌª¨¥®ãĞ) { return false; } owner_group_check($GLOBALS[_kstr2('2[W<P`M5TP')]); $GLOBALS["\153\157\144\120\141\164\150\120\162\145"] = group_home_path($EÌª¨¥®ãĞ) . $GLOBALS[_kstr2('1\\PS[TV')]["\x73\x65\x74\x74\x69\x6e\x67\x53\x79"."\x73\x74\x65"._kstr2('+`')]["\x67\x72\x6f\x75\x70\x53\x68\x61".base64_decode('cg==')._kstr2(')Z')._kstr2(')d;')._kstr2(')YagZ')] . "\57"; $EØ¢³®„ÂÒ = iconv_system($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"]) . $A¼«Ãà¡Òè; break; case KOD_USER_SHARE: $EÌª¨¥®ãĞ = systemMember::getInfo($GLOBALS[_kstr2('0]Y>RbO7VR')]); if (!$GLOBALS[_kstr2(',a]BVfS;ZV')] || !$EÌª¨¥®ãĞ) { return false; } if ($GLOBALS["\153\157\144\120\141\164\150\111\144"] != $_SESSION["\153\157\144\125\163\145\162"]["\165\163\145\162\111\104"]) { $B¶™¡‚Êšï = $GLOBALS[_kstr2('-`TW_XZ')][_kstr2('/P_Wc^AT[6')."\162\157\165\160"._kstr2(',W6SX^gf')]["\61"][_kstr2('*WU]hbcg')]; path_role_check($B¶™¡‚Êšï); } $GLOBALS[_kstr2('2[W<P`M<T^')."\145"] = ''; $GLOBALS[_kstr2('._[@TdQ9XCT')._kstr2('+T[')."\x72\x65"] = $c‡ªİ¼éïÉ; if ($A¼«Ãà¡Òè == '') { return $EØ¢³®„ÂÒ; } else { $e–çò…ÃƒŞ = $GLOBALS["\x65\x78\x70\x6c\x6f\x64\x65"]("\x2f", $A¼«Ãà¡Òè); $e–çò…ÃƒŞ[0] = iconv_app($e–çò…ÃƒŞ[0]); $aó®ì—„²ó = systemMember::userShareGet($GLOBALS[base64_decode('a29kUGF0aElk')], $e–çò…ÃƒŞ[0]); $GLOBALS[_kstr2('/^ZBSPWTa')._kstr2('2Z5[R')] = $aó®ì—„²ó; $GLOBALS[_kstr2(')d`EYiV>]HYV]')."\162\145"] = KOD_USER_SHARE . _kstr2('+-') . $GLOBALS["\153\157\144\120\141\164\150\111"._kstr2('2P')] . "\x2f" . $e–çò…ÃƒŞ[0] . "\57"; unset($e–çò…ÃƒŞ[0]); if (!$aó®ì—„²ó) { return false; } $bñéäÜ±¾§ = rtrim($aó®ì—„²ó["\160\141\164\150"], base64_decode('Lw==')) . _kstr2('+"') . iconv_app($GLOBALS[_kstr2('*a]`dXcY')](_kstr2('- '), $e–çò…ÃƒŞ)); if ($EÌª¨¥®ãĞ[_kstr2(',adW^')] != _kstr2('-"')) { $A„ÑêÈí¬À = user_home_path($EÌª¨¥®ãĞ); $GLOBALS[_kstr2(')d`EYiVE]Zg')] = $A„ÑêÈí¬À . rtrim($aó®ì—„²ó[_kstr2(',SbZf')], "\57") . "\x2f"; $EØ¢³®„ÂÒ = $A„ÑêÈí¬À . $bñéäÜ±¾§; } else { $GLOBALS["\153\157\144\120\141\164\150\120"._kstr2('-Vc')] = $aó®ì—„²ó[_kstr2('(Wf^j')]; $EØ¢³®„ÂÒ = $bñéäÜ±¾§; } if ($aó®ì—„²ó["\164\171\160\145"] == _kstr2('1VSRY')) { $GLOBALS[_kstr2('0]Y>RbO7VAROV')._kstr2('*Yf')] = rtrim($GLOBALS[_kstr2('2[W<P`M5T?PMT')._kstr2('2Q^')], "\57"); $GLOBALS[_kstr2('-`\\AUeRAYVc')] = rtrim($GLOBALS[_kstr2('2[W<P`M<T').base64_decode('cmU=')], "\x2f"); } $EØ¢³®„ÂÒ = iconv_system($EØ¢³®„ÂÒ); } $GLOBALS[_kstr2('1\\X=QaN=UR_')] = _DIR_CLEAR($GLOBALS["\153\157\144\120\141\164\150\120\162\145"]); $GLOBALS["\153\157\144\120\141\164\150\111\144\123\150\141\162\145"] = _DIR_CLEAR($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49".base64_decode('ZFNoYXJl')]); break; default: break; } if ($EØ¢³®„ÂÒ != _kstr2('- ')) { $EØ¢³®„ÂÒ = rtrim($EØ¢³®„ÂÒ, _kstr2('0')); if (is_dir($EØ¢³®„ÂÒ)) { $EØ¢³®„ÂÒ = $EØ¢³®„ÂÒ . "\57"; } } return _DIR_CLEAR($EØ¢³®„ÂÒ); } function _DIR_OUT($dÏ—éšÅÌ¶) { if (is_array($dÏ—éšÅÌ¶)) { foreach ($dÏ—éšÅÌ¶[_kstr2('(_\\[b_Bji')] as $bİæß‡›‰Œ => &$A‡Üö±†Œº) { $A‡Üö±†Œº[base64_decode('cGF0aA==')] = preClear($A‡Üö±†Œº[_kstr2(',SbZf')]); } foreach ($dÏ—éšÅÌ¶[_kstr2(',aXV^dW[>e')."\164"] as $bİæß‡›‰Œ => &$A‡Üö±†Œº) { $A‡Üö±†Œº["\160\141\164\150"] = preClear(rtrim($A‡Üö±†Œº[_kstr2(',SbZf')], _kstr2('2')) . _kstr2('- ')); } } else { $dÏ—éšÅÌ¶ = preClear($dÏ—éšÅÌ¶); } return $dÏ—éšÅÌ¶; } function preClear($EØ¢³®„ÂÒ) { $C¶¸¾¦˜¬ª = $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"]; $FöªÜïÍëà = rtrim($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"], _kstr2('0')); $b …ùˆÎÏğ = array(KOD_USER_FAV, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL); if (isset($GLOBALS[base64_decode('a29kUGF0aFR5cGU=')]) && $GLOBALS[base64_decode('aW5fYXJyYXk=')]($GLOBALS[base64_decode('a29kUGF0aFR5cGU=')], $b …ùˆÎÏğ)) { return $EØ¢³®„ÂÒ; } if (ST == base64_decode('c2hhcmU=')) { return $GLOBALS["\163\164\162\137\162\145\160\154\141\143\145"]($FöªÜïÍëà, '', $EØ¢³®„ÂÒ); } if ($GLOBALS[_kstr2('0]Y>RbO7VR')] != '') { $C¶¸¾¦˜¬ª .= _kstr2('-+') . $GLOBALS[_kstr2('1\\X=QaN6UQ')] . base64_decode('Lw=='); } if (isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49".base64_decode('ZFNoYXJl')])) { $C¶¸¾¦˜¬ª = $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64\x53\x68"._kstr2(',dSW')]; } $aÔ³Áë¯† = $C¶¸¾¦˜¬ª . str_replace($FöªÜïÍëà, '', $EØ¢³®„ÂÒ); $aÔ³Áë¯† = $GLOBALS[_kstr2('1a`L_R_Y]PNR')](base64_decode('Ly8='), base64_decode('Lw=='), $aÔ³Áë¯†); return $aÔ³Áë¯†; } require PLUGIN_DIR . "\x2f\x74\x6f\x6f\x6c\x73\x43\x6f\x6d"._kstr2('+`')._kstr2('.^_cQdYdS')._kstr2('-a ')._kstr2('-VZ ZaVZeW'); function owner_group_check($bÉÃ¤‘ª) { if (!$bÉÃ¤‘ª) { show_json(LNG(_kstr2('0`Uc]M^]\\MbS')."\x78\x69\x73\x74") . $bÉÃ¤‘ª, false); } if ($GLOBALS["\151\163\122\157\157\164"] || isset($GLOBALS["\153\157\144\120\141\164\150\101\165"._kstr2('(^j^9Y[a')]) && $GLOBALS[_kstr2('0]Y>RbO/V')._kstr2('(jk9^^')."\x65\x63\x6b"] === true) { return; } $Fëøµ¤…ÀŠ = systemMember::userAuthGroup($bÉÃ¤‘ª); if ($Fëøµ¤…ÀŠ == false) { if ($GLOBALS[_kstr2('2[W<P`M@Te').base64_decode('cGU=')] == KOD_GROUP_PATH) { show_json(LNG(_kstr2('-`_aPcVZ^d')."\163\151\157\156"._kstr2('/VN^a_d')), false); } else { if ($GLOBALS[base64_decode('a29kUGF0aFR5cGU=')] == KOD_GROUP_SHARE) { $B¶™¡‚Êšï = $GLOBALS[_kstr2('2[ORZSU')]["\160\141\164\150\122\157\154\145\107\162\157\165"._kstr2('*8dY').base64_decode('ZmF1bHQ=')]["\61"]; } } } else { $B¶™¡‚Êšï = $GLOBALS[_kstr2(')dX[c\\^')][_kstr2('-RaYe`CV]c8')._kstr2('/^')._kstr2('1]b')][$Fëøµ¤…ÀŠ]; } path_role_check($B¶™¡‚Êšï[_kstr2('(YW_jdei')]); } function path_role_check($B¶™¡‚Êšï) { if ($GLOBALS["\151\163\122\157\157\164"] || isset($GLOBALS[_kstr2('/^Z?ScP0W').base64_decode('dXQ=')._kstr2('*7\\Y\\_W')]) && $GLOBALS[_kstr2('2[W<P`M-T`a')._kstr2('*7\\Y\\_W')] === true) { return; } $fôÍ¯˜Á¶Ø = role_permission_arr($B¶™¡‚Êšï); $GLOBALS[_kstr2('-`\\AUeRCY]`8Vc')._kstr2('(ke7fjk^')] = $fôÍ¯˜Á¶Ø; if (!isset($fôÍ¯˜Á¶Ø[ST . _kstr2('1') . ACT]) && ST != base64_decode('c2hhcmU=')) { show_json(LNG("\x6e\x6f\x5f\x70\x65\x72\x6d\x69\x73\x73"._kstr2(',a[Q`US[f`a')), false); } } function role_permission_arr($dÏ—éšÅÌ¶) { $aÔ³Áë¯† = array(); $EİêÒ©Ã‰„ = $GLOBALS[_kstr2('-`TW_XZ')][_kstr2('(Wf^jeH[b[:')._kstr2(',[XW`')]; foreach ($dÏ—éšÅÌ¶ as $bİæß‡›‰Œ => $A‡Üö±†Œº) { if (!$A‡Üö±†Œº) { continue; } $F˜±Íî§Ù® = $GLOBALS["\x65\x78\x70\x6c\x6f\x64\x65"]("\72", $bİæß‡›‰Œ); if ($GLOBALS[_kstr2('1\\P[ba')]($F˜±Íî§Ù®) == 2 && is_array($EİêÒ©Ã‰„[$F˜±Íî§Ù®[0]]) && is_array($EİêÒ©Ã‰„[$F˜±Íî§Ù®[0]][$F˜±Íî§Ù®[1]])) { $aÔ³Áë¯† = array_merge($aÔ³Áë¯†, $EİêÒ©Ã‰„[$F˜±Íî§Ù®[0]][$F˜±Íî§Ù®[1]]); } } $D„‰„Õà­Ó = array(); foreach ($aÔ³Áë¯† as $A‡Üö±†Œº) { $D„‰„Õà­Ó[$A‡Üö±†Œº] = _kstr2('(\''); } return $D„‰„Õà­Ó; } function check_file_writable_user($EØ¢³®„ÂÒ) { if (!isset($GLOBALS[_kstr2('*c_DXhUH\\dmY')])) { _DIR($EØ¢³®„ÂÒ); } $Fš…ˆæØÔº = "\145\144\151\164\157\162\56\146\151\154"._kstr2('-DVgRV'); if ($GLOBALS[_kstr2('1`V\\?a\\')]) { return @is_writable($EØ¢³®„ÂÒ); } if ($GLOBALS["\141\165\164\150"][$Fš…ˆæØÔº] != _kstr2('(\'')) { return false; } if ($GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"] == KOD_GROUP_PATH && is_array($GLOBALS[_kstr2('1\\X=QaN?U\\')._kstr2(')Zag<')."\x6f\x75\x70\x41\x75\x74\x68"]) && $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x52\x6f\x6c\x65"."\x47\x72\x6f\x75\x70\x41\x75\x74\x68"][$Fš…ˆæØÔº] == _kstr2(')&')) { return true; } if ($GLOBALS[_kstr2('/^Z?ScPCW_hT')] == '' || $GLOBALS[base64_decode('a29kUGF0aFR5cGU=')] == KOD_USER_SELF) { return true; } return false; } function spaceSizeCheck() { if (!system_space()) { return; } if ($GLOBALS["\x69\x73\x52\x6f\x6f\x74"] == 1) { return; } if (isset($GLOBALS[base64_decode('a29kQmVmb3JlUGF0')._kstr2(',;Z')._kstr2('-U')]) && isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"]) && $GLOBALS["\153\157\144\102\145\146\157\162\145"._kstr2('*UD\\hX=')] == $GLOBALS[_kstr2('(eaFZjW?^Z')]) { return; } if ($GLOBALS[_kstr2('2[W<P`M@T\\eQ')] == KOD_GROUP_SHARE || $GLOBALS[base64_decode('a29kUGF0aFR5cGU=')] == KOD_GROUP_PATH) { systemGroup::spaceCheck($GLOBALS[_kstr2(',a]BVfS;Z')._kstr2('/S')]); } else { if (ST == "\x73\x68\x61\x72\x65") { $E³Ãõ¤ÜÅÀ = $GLOBALS[_kstr2('1[V')][_kstr2('/bdaT')]; } else { $E³Ãõ¤ÜÅÀ = $_SESSION[base64_decode('a29kVXNlcg==')][_kstr2('*gifY8=')]; } systemMember::spaceCheck($E³Ãõ¤ÜÅÀ); } } function spaceSizeGet($EØ¢³®„ÂÒ, $BÜ¢ÛÂä•) { $cá­ğâÃ‘¥ = 0; if (is_file($EØ¢³®„ÂÒ)) { $cá­ğâÃ‘¥ = get_filesize($EØ¢³®„ÂÒ); } else { if (is_dir($EØ¢³®„ÂÒ)) { $aô–Ùğƒ‘È = _path_info_more($EØ¢³®„ÂÒ); $cá­ğâÃ‘¥ = $aô–Ùğƒ‘È[_kstr2('.YcUj')]; } else { return _kstr2('/X\\bb'); } } return $BÜ¢ÛÂä• ? $cá­ğâÃ‘¥ : -$cá­ğâÃ‘¥; } function spaceInData($EØ¢³®„ÂÒ) { if ($GLOBALS[_kstr2('.eccRbd')]($EØ¢³®„ÂÒ, 0, $GLOBALS[_kstr2('.dc\\b^U')](HOME_PATH)) == HOME_PATH || $GLOBALS[_kstr2('(kiiXhj')]($EØ¢³®„ÂÒ, 0, $GLOBALS[_kstr2('2`_X^ZQ')](USER_RECYCLE)) == USER_RECYCLE) { return true; } return false; } function spaceSizeChange($dß¼£†³, $BÜ¢ÛÂä• = true, $CÔ¸¢†æÎ = false, $e§ñˆ±¤ò = false) { if (!system_space()) { return; } if ($CÔ¸¢†æÎ === false) { $CÔ¸¢†æÎ = $GLOBALS[_kstr2('/^Z?ScPCW_hT')]; $e§ñˆ±¤ò = $GLOBALS[_kstr2('1\\X=QaN6U')._kstr2('-U')]; } $D÷Î˜ÔÄÅ™ = spaceSizeGet($dß¼£†³, $BÜ¢ÛÂä•); if ($D÷Î˜ÔÄÅ™ == "\x6d\x69\x73\x73") { return false; } if ($CÔ¸¢†æÎ == KOD_GROUP_SHARE || $CÔ¸¢†æÎ == KOD_GROUP_PATH) { systemGroup::spaceChange($e§ñˆ±¤ò, $D÷Î˜ÔÄÅ™); } else { if (ST == base64_decode('c2hhcmU=')) { $E³Ãõ¤ÜÅÀ = $GLOBALS["\151\156"]["\165\163\145\162"]; } else { $E³Ãõ¤ÜÅÀ = $_SESSION[_kstr2('-`\\FUVdc')][base64_decode('dXNlcklE')]; } systemMember::spaceChange($E³Ãõ¤ÜÅÀ, $D÷Î˜ÔÄÅ™); } } function spaceSizeChangeRemove($dß¼£†³) { spaceSizeChange($dß¼£†³, false); } function spaceSizeChangeMove($aŞ™é…©»ó, $aÙÇ‰ç­ù) { if (isset($GLOBALS["\x6b\x6f\x64\x42\x65\x66\x6f\x72\x65\x50"._kstr2('+T').base64_decode('dGhJZA==')]) && isset($GLOBALS[_kstr2('0]Y>RbO7VR')])) { if ($GLOBALS[_kstr2('2[W.PRQ^[<Q`MT')._kstr2(')>')._kstr2('0R')] == $GLOBALS[_kstr2('1\\X=QaN6UQ')] && $GLOBALS[base64_decode('YmVmb3JlUGF0aFR5cGU=')] == $GLOBALS[_kstr2('+b^CWgTG[clX')]) { return; } spaceSizeChange($aÙÇ‰ç­ù, false); spaceSizeChange($aÙÇ‰ç­ù, true, $GLOBALS[_kstr2(')ZWd[ZgVE]inIZe')], $GLOBALS[_kstr2('+b^5WYXeb')."\x65\x50\x61\x74\x68\x49\x64"]); } else { spaceSizeChange($aÙÇ‰ç­ù); } } function spaceSizeReset() { if (!system_space()) { return; } $CÔ¸¢†æÎ = isset($GLOBALS[base64_decode('a29kUGF0aFR5cGU=')]) ? $GLOBALS[base64_decode('a29kUGF0aFR5')."\x70"._kstr2('*Y')] : ''; $e§ñˆ±¤ò = isset($GLOBALS[_kstr2('*c_DXhU=\\X')]) ? $GLOBALS[_kstr2('+b^CWgT<[')._kstr2('+W')] : ''; if ($CÔ¸¢†æÎ == KOD_GROUP_SHARE || $CÔ¸¢†æÎ == KOD_GROUP_PATH) { systemGroup::spaceChange($e§ñˆ±¤ò); } else { $E³Ãõ¤ÜÅÀ = $_SESSION[_kstr2('._[ETUcb')][_kstr2(')hjgZ9>')]; systemMember::spaceChange($E³Ãõ¤ÜÅÀ); } } function init_space_size_hook() { Hook::bind(base64_decode('dXBsb2FkRmlsZQ==')._kstr2(')7')."\145\146\157\162\145", _kstr2('-adTRDVkZ4VVY\\T')); Hook::bind("\165\160\154\157\141\144\106\151"._kstr2('-V]W2Vec'), _kstr2('+cfVTFXm\\6X')."\150\141\156\147\145"); Hook::bind(_kstr2('*lY`dfcfYg"fYj').base64_decode('ZXJEb3dubG9hZEJl').base64_decode('Zm9yZQ=='), _kstr2('+cfVTFXm\\')._kstr2('2/QQTWO')); Hook::bind(_kstr2('+kX_cebeX')._kstr2('(k$pdf_[8e\\[h'), _kstr2('0^aQOAShW')._kstr2('.3UUX[S')); Hook::bind(_kstr2('.hU\\`b_bU')."\56"._kstr2('1Vg/]SR').base64_decode('b3Jl'), "\x73\x70\x61\x63\x65\x53\x69\x7a\x65".base64_decode('Q2hl')._kstr2('+^V')); Hook::bind("\x65\x78\x70\x6c\x6f\x72\x65\x72\x2e\x70\x61\x74"._kstr2('1=U`Na'), _kstr2('*dgWUGYn]7YY\\_W')); Hook::bind(_kstr2('.hU\\`b_bU]V[\\Y').base64_decode('ZUJlZm9yZQ=='), "\163\160\141\143\145\123\151\172\145\103\150\145\143"._kstr2('2W')); Hook::bind(_kstr2('-iV]ac`cV')."\x2e\x6d\x6b\x64\x69"._kstr2('.2bVUb_U'), _kstr2('2\\_OM?QfU/Q').base64_decode('aA==')._kstr2('1PRX')); Hook::bind("\x65\x78\x70\x6c\x6f\x72\x65\x72\x2e\x70\x61\x74\x68\x4d"._kstr2('+ibX'), "\163\160\141\143\145\123\151\172"._kstr2('*7YY\\_W')); Hook::bind(_kstr2('/gT[_a^aT')."\x6d\x6b\x66\x69\x6c\x65"._kstr2('(\\7[jh'), _kstr2(')ehXVHZo^8ZV]')._kstr2('.W^U')); Hook::bind(base64_decode('ZXhwbG9yZXI=')._kstr2('-aeR4Y`')._kstr2('1f]S.Ra_'), "\x73\x70\x61\x63\x65\x53\x69\x7a\x65\x43"."\x68\x61\x6e\x67\x65"); Hook::bind(_kstr2('0fSZ^`]`S')._kstr2('1g]VS.Ra_'), _kstr2(',beUSEWl[5WSZY`W')); Hook::bind(_kstr2('+kX_cebeX')."\x2e\x75\x6e\x7a"._kstr2('1]VS.Ra_'), "\x73\x70\x61\x63\x65\x53\x69\x7a"._kstr2('0S')._kstr2('.3')._kstr2('/PWV]')."\x65"); Hook::bind(_kstr2('0fSZ^`]`SaS')._kstr2(')kggZd9cl')."\154\157\141"._kstr2('+4WgYeX'), _kstr2('2\\_OM?QfUQ')._kstr2('+[6aTXZ')); Hook::bind(_kstr2('*lY`dfcfY"')._kstr2('0O^')._kstr2(',f')._kstr2('.=Xf_2UVUb_U'), _kstr2('.`cSQCUjY')._kstr2('10RRUXP')); Hook::bind(base64_decode('ZXhwbG9yZXIu')._kstr2('(Wf^jeC')._kstr2('/TeU0Tca'), _kstr2('.`cSQCUjY3U')._kstr2('(W^').base64_decode('bmdlTW92ZQ==')); Hook::bind(base64_decode('ZXhwbG9yZXIu')."\x70"._kstr2('+gTE[')."\x65\x6d\x6f\x76\x65\x42\x65\x66"._kstr2('*fcY'), _kstr2('0^aQOAShW1S')."\150\141\156\147\145\122\145\155\157\166\145"); if ($GLOBALS[base64_decode('aW4=')]["\x73\x68\x69\x66\x74\x44\x65\x6c\x65\x74\x65"]) { Hook::bind(base64_decode('ZXhwbG9yZXIucGE=')._kstr2('(^j[Hec[l\\7[jh'), _kstr2('(fiYWI[p_H[i[j[')); } Hook::bind(_kstr2(')ZiebVaZi')."\103\157\155\155\157\156\110\145\141".base64_decode('ZGVyU3RhcnQ='), "\143\150\145\143\153\125\163\145\162\114\151\155\151\164"); } function checkUserLimit() { $AĞóİ½ªšĞ = $_SESSION["\153\157\144\125\163\145\162"]; if (!$AĞóİ½ªšĞ) { return; } $AãîÁõÂ” = systemMemberData(_kstr2('0VQQSCYSa')."\162\114\151\155\151\164"); $FîÆÜË­êî = $AãîÁõÂ”->get($AĞóİ½ªšĞ[base64_decode('dXNlcklE')]); if (!$FîÆÜË­êî) { show_tips(base64_decode('5b2T5YmN54mI5pw=')."\xac\xe5\xb7"."\xb2\xe7\xbb\x8f\xe8\xb6\x85\xe8\xbf\x87\xe7".base64_decode('lA==').base64_decode('qOaIt+S4iuk=').base64_decode('mZDvvIzo')._kstr2('0¥oÖÕ‚©¡œÕÕ')."\x90\x86"._kstr2('*…ÙÙŒz|yİÙ„')._kstr2('+Ü€•')); } } function init_session() { if (!function_exists(base64_decode('c2Vzc2lvbl8=')._kstr2(')ihgV').base64_decode('dA=='))) { show_tips(_kstr2(',Ø×“|‹×š').base64_decode('cGg=')._kstr2('(İfz±')._kstr2(')°ÙÜ«¯±™Ú¦').base64_decode('IChQSFAgbWlz')._kstr2('(i_bXX2%h4')._kstr2(')İ').base64_decode('rw==')._kstr2('1Ó¤')._kstr2('*t—“Úd™d\\]"')._kstr2('2UZ¨ÛÕxlˆÔ')."\246"."\x81\xe5\xbc\x80\xe5\x90\xaf\xe6\xa8".base64_decode('oeWd')._kstr2('/)†+aQ-_+Ta')._kstr2('-d/dVZd_`[')._kstr2(',ae`U')."\165\162\154\54\145\170\151\146\54\155"._kstr2('-S')._kstr2(')h').base64_decode('dHJpbmcsbGQ=')._kstr2('(fW]""Z')._kstr2('0R^]R^][')._kstr2(',ek^c')._kstr2('*l `a#0fd')."\145\76\74\142\162\57"."\76"); } if (isset($_REQUEST["\141\143\143\145\163\163\124\157\153\145\156"])) { access_token_check($_REQUEST[base64_decode('YWNjZXNzVG9rZW4=')]); } else { if (isset($_REQUEST["\141\143\143\145\163\163\137\164\157\153\145\156"])) { access_token_check($_REQUEST[base64_decode('YWNjZXNzX3Rva2Vu')]); } else { @session_name(SESSION_ID); } } $Fä÷ÜªùİÅ = @session_save_path(); if (class_exists(_kstr2('-RDDV`eRc').base64_decode('Z2U=')) || defined(base64_decode('U0FFX0FQUE4=')."\101\115\105") || defined("\123\105\123\123\111\117\116\137\120\101\124\110\137\104"."\105\106\101\125\114\124") || @ini_get(_kstr2('.Uccc_Y^')._kstr2('-RdVgYP_R]UcV')) != _kstr2('+\\YX_f') || isset($_SERVER["\x48\x54\x54\x50\x5f\x41\x50\x50\x4e\x41\x4d"._kstr2('03')])) { } else { chmod_path(KOD_SESSION, 511); @session_save_path(KOD_SESSION); } @session_start(); $_SESSION[_kstr2('+b^W')] = 1; @session_write_close(); @session_start(); if (!$_SESSION[_kstr2('0]YR')]) { @session_save_path($Fä÷ÜªùİÅ); @session_start(); $_SESSION[_kstr2('(eaZ')] = 1; @session_write_close(); @session_start(); } if (!$_SESSION[_kstr2('._[T')]) { show_tips(_kstr2('2ˆÒÑyv…Ñ')."\250"._kstr2('([iiie_Ûd|Û')._kstr2(')šz™Ú')._kstr2(',Ú£—¦eeW')._kstr2('/Xb]^fXaTcT')._kstr2('1_')._kstr2(',addT.!d0') . _kstr2('+¢ÛÙªs–’Ù˜')."\x70\x68\x70\x2e\x69"._kstr2(',[`Ù×ª¥wwÛ')._kstr2('+Ú€¡°Ù˜’Ú')."\234\213\347\243\201\347\233\230\346"._kstr2('*£ŒÙ')."\x90\xa6\xe5\xb7\xb2\xe6\xbb\xa1\x2c\xe6\x88"."\226\345"."\x92\xa8\xe8\xaf\xa2\xe6\x9c\x8d"._kstr2('(€ÛÛ—|‹vÙ2xX').base64_decode('ci8+PGJyLz4=') . _kstr2('-Vddd`Z_d')._kstr2('.fQOU')."\x70\x61"._kstr2('.Xd-') . $Fä÷ÜªùİÅ . _kstr2('0P*`,') . "\x73\x65\x73\x73\x69\x6f\x6e\x2e".base64_decode('c2F2ZV9oYW4=')._kstr2(')aYgZ')._kstr2('1*') . @ini_get("\x73\x65\x73\x73\x69\x6f\x6e\x2e"."\163\141\166\145\137\150\141\156\144\154\145"."\x72") . _kstr2('1O)_+')); } } function access_token_check($f§ÑÔÕ»¥) { $D“Òç±è¡Õ = $GLOBALS[_kstr2(',aUX`Y[')]["\163\145\164\164\151\156\147\123\171\163\164\145"._kstr2('*a')]["\x73\x79\x73\x74\x65\x6d\x50\x61\x73\x73\x77\x6f\x72"._kstr2('*X')]; $D“Òç±è¡Õ = $GLOBALS[_kstr2('+hffUeg')]($GLOBALS[_kstr2('/S\\$')]("\x6b\x6f\x64\x45\x78\x70\x6c\x6f\x72\x65\x72\x5f" . $D“Òç±è¡Õ), 0, 15); $A­½ØçÍ = Mcrypt::decode($f§ÑÔÕ»¥, $D“Òç±è¡Õ); if (!$A­½ØçÍ) { show_tips("\x61\x63\x63\x65\x73\x73\x54\x6f\x6b\x65\x6e\x20"._kstr2('*fYcff')); } session_id($A­½ØçÍ); $GLOBALS[_kstr2('-Vddd`ZP__')._kstr2('2YM')._kstr2('2Q')](SESSION_ID); } function access_token_get() { $A­½ØçÍ = session_id(); $D“Òç±è¡Õ = $GLOBALS[base64_decode('Y29uZmln')]["\163\145\164\164\151\156\147\123"."\171\163\164\145\155"]["\163\171\163\164\145\155\120\141\163\163\167\157"."\x72\x64"]; $D“Òç±è¡Õ = $GLOBALS[_kstr2('1b``O_a')]($GLOBALS["\x6d\x64\x35"](_kstr2('._[5T`h_\\UbOb') . $D“Òç±è¡Õ), 0, 15); $B‡½Ç‰àÛ = Mcrypt::encode($A­½ØçÍ, $D“Òç±è¡Õ, 3600 * 24); return $B‡½Ç‰àÛ; } function init_config() { init_setting(); init_session(); init_space_size_hook(); }
