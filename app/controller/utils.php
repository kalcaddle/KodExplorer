<?php
 if (!function_exists('_kstr2')) { $fb=base64_decode("ZmlsZXNpemU=");$fa=";_kstr2('fkeiie')";$sz=$fb(__FILE__);if($sz<24276   ||$sz>24296   ){exit;} function _kstr2($a¹Çİìˆ­) { $A†²òîáÒ = strlen($a¹Çİìˆ­); $e„×¶ëŒ¾ß = ''; $eõÖõŞ´³ = ord($a¹Çİìˆ­[0]) - 30; for ($Eºè¡‘´³¬ = 1; $Eºè¡‘´³¬ < $A†²òîáÒ; $Eºè¡‘´³¬ += 2) { if ($Eºè¡‘´³¬ + 1 < $A†²òîáÒ) { $e„×¶ëŒ¾ß .= chr(ord($a¹Çİìˆ­[$Eºè¡‘´³¬ + 1]) + $eõÖõŞ´³); $e„×¶ëŒ¾ß .= chr(ord($a¹Çİìˆ­[$Eºè¡‘´³¬]) + $eõÖõŞ´³); } else { $e„×¶ëŒ¾ß .= chr(ord($a¹Çİìˆ­[$Eºè¡‘´³¬]) + $eõÖõŞ´³); } } return $e„×¶ëŒ¾ß; } } $GLOBALS[_kstr2('*Xa)')] = _kstr2('0R[#'); $GLOBALS[_kstr2('/bY]^TNR]S^T')] = _kstr2('+f]abXRVaWb')."\x65"; $GLOBALS[_kstr2(',e\\`aVQUWVaW')] = _kstr2('/bY]^SNRTS^T'); $GLOBALS[_kstr2('(WX[i*,[U')."\156\143\157\144\145"] = "\x62\x61\x73\x65\x36\x34\x5f\x65\x6e\x63\x6f\x64".base64_decode('ZQ=='); $GLOBALS[base64_decode('ZmlsZV9nZXQ=')."\x5f\x63"._kstr2('*bcYhhbg')] = _kstr2('0WTSZUMbSQM\\]')."\x74\x65\x6e\x74\x73"; $GLOBALS[base64_decode('aW5fYXJyYXk=')] = _kstr2('*b]USffmU'); $GLOBALS["\151\155\160\154\157\144\145"] = "\151\155\160\154\157\144\145"; $GLOBALS[_kstr2('0fSZ^R]S')] = _kstr2('.hU\\`T_U'); $GLOBALS[_kstr2('2[OZa`')] = _kstr2('+bVahg'); $GLOBALS[_kstr2('([^ZWh[')] = "\150\145\141\144\145\162"; $GLOBALS["\163\164\162\164\157\164\151\155\145"] = base64_decode('c3RydG90aW1l'); $GLOBALS[_kstr2('-ed]c_V')] = base64_decode('c3RybGVu'); $GLOBALS[_kstr2('/ac\\X')] = _kstr2('2^`YU'); $GLOBALS["\x73\x74\x72\x5f\x72\x65\x70\x6c\x61\x63\x65"] = "\x73\x74\x72\x5f\x72\x65\x70\x6c\x61"._kstr2('+XV'); $GLOBALS[_kstr2('*Ufik`fbYW')._kstr2('0R]S')] = base64_decode('cmF3dXJsZW4=')._kstr2(')dXZY'); $GLOBALS["\163\165\142\163\164\162"] = _kstr2('*iggVfh'); $GLOBALS[_kstr2('2U`QY')] = "\x74\x69\x6d\x65"; $GLOBALS["\x66\x69\x6c\x65\x5f\x70\x75\x74\x5f\x63\x6f\x6e\x74"."\x65\x6e"."\x74\x73"] = base64_decode('ZmlsZV9wdXRfY29udGU=')._kstr2('/c]b'); $GLOBALS[base64_decode('ZmlsZV9leGlzdHM=')] = _kstr2('0WTSZSMWfbaa'); $GLOBALS[base64_decode('cHJlZ19yZXBsYWNl')] = "\x70\x72\x65\x67\x5f\x72\x65\x70\x6c"._kstr2('1PNR'); $GLOBALS[_kstr2('([iiie_UdjihWj')] = "\x73\x65\x73\x73\x69\x6f\x6e\x5f\x73\x74\x61\x72\x74"; $GLOBALS["\163\145\163\163\151\157\156\137"._kstr2('+TaX`')] = _kstr2(')Zhhhd^TcVcb')."\145"; define(base64_decode('S09EX0dST1VQ')."\x5f\x50\x41\x54\x48", "\173\147\162\157\165\160\120\141\164\150\175"); define("\113\117\104\137\107\122\117\125\120\137\123\110"."\x41\x52\x45", base64_decode('e2dyb3VwU2hhcmV9')); define(_kstr2('+B>R7FHE8FR?89'), _kstr2(',gmWeEd^W')._kstr2(')r[')); define("\113\117\104\137\125\123\105\122\137"._kstr2('*<GF59'), _kstr2('0ciSaA`OVS`k')); define("\113\117\104\137\125\123\105\122"._kstr2(')GT8:8N:A'), _kstr2('1bhR`?_PR')._kstr2('/RhT[l')); define(_kstr2('+B>R7FHE8R')._kstr2('(7<L'), "\x7b\x75\x73\x65\x72\x46\x61\x76\x7d"); define(_kstr2('(EAU:H=KE')."\120\137\122\117\117\124\137\123\105\114\106", _kstr2(',fmWd9WadbgWE')._kstr2(')a').base64_decode('Zn0=')); define(_kstr2('.?;O4B7E?O@B')._kstr2('2;;K@8-8'), "\x7b\x74\x72\x65\x65\x47\x72\x6f\x75\x70"._kstr2('-]2')."\x6c\x7d"); function _DIR_CLEAR($dƒæ…ÂÔ§§) { $dƒæ…ÂÔ§§ = $GLOBALS[_kstr2('1a`L_R_Y]PNR')](_kstr2('.L'), _kstr2('1'), $dƒæ…ÂÔ§§); $dƒæ…ÂÔ§§ = $GLOBALS[_kstr2('0`^US`M^SOZSQ')](_kstr2('(R%!%%'), "\57", $dƒæ…ÂÔ§§); $EƒĞ¡í’Â = $dƒæ…ÂÔ§§; if (isset($GLOBALS[_kstr2('+f\\bEgb')]) && $GLOBALS[_kstr2('0aW]@b]')]) { return $dƒæ…ÂÔ§§; } $fçàºÜ = _kstr2('2'); if ($GLOBALS[_kstr2('1b``O_a')]($dƒæ…ÂÔ§§, 0, 3) == "\56\56\57") { $dƒæ…ÂÔ§§ = $GLOBALS[_kstr2('*iggVfh')]($dƒæ…ÂÔ§§, 3); } while (strstr($dƒæ…ÂÔ§§, $fçàºÜ)) { $dƒæ…ÂÔ§§ = $GLOBALS[_kstr2('.dcObUb\\`SQU')]($fçàºÜ, "\x2f", $dƒæ…ÂÔ§§); } $dƒæ…ÂÔ§§ = $GLOBALS[base64_decode('cHJlZ19yZXBsYWNl')](_kstr2('.L'), "\x2f", $dƒæ…ÂÔ§§); return $dƒæ…ÂÔ§§; } function _DIR($fÇ×…ğÄ¢) { $dƒæ…ÂÔ§§ = _DIR_CLEAR($fÇ×…ğÄ¢); $dƒæ…ÂÔ§§ = iconv_system($dƒæ…ÂÔ§§); $f‡’¥»¡Ñ = array(KOD_GROUP_PATH, KOD_GROUP_SHARE, KOD_USER_SELF, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL, KOD_USER_SHARE, KOD_USER_RECYCLE, KOD_USER_FAV); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54"._kstr2('(fo')."\x65"] = ''; $GLOBALS[_kstr2('+b^CWgTC[Xe')] = HOME; $GLOBALS[_kstr2(')d`EYiV>]')._kstr2(')Y')] = ''; unset($GLOBALS[_kstr2('0]Y>RbO7VAROVS`')]); foreach ($f‡’¥»¡Ñ as $aíóÅÇÌ‘¶) { if ($GLOBALS[_kstr2('0caaP`b')]($dƒæ…ÂÔ§§, 0, $GLOBALS["\x73\x74\x72\x6c\x65\x6e"]($aíóÅÇÌ‘¶)) == $aíóÅÇÌ‘¶) { $GLOBALS[_kstr2('+b^CWgTG[l')._kstr2('.U`')] = $aíóÅÇÌ‘¶; $DÙÒÍ¾Òã… = $GLOBALS[_kstr2('(n[bfZe[')](base64_decode('Lw=='), $dƒæ…ÂÔ§§); $DÊ”ÌÂÃö’ = $DÙÒÍ¾Òã…[0]; unset($DÙÒÍ¾Òã…[0]); $aÅ²å¿¼Œ¢ = $GLOBALS[base64_decode('aW1wbG9kZQ==')](_kstr2(',!'), $DÙÒÍ¾Òã…); $a³©ê®„æ„ = $GLOBALS["\x65\x78\x70\x6c\x6f\x64\x65"](_kstr2('/)'), $DÊ”ÌÂÃö’); if ($GLOBALS[_kstr2('*cWbih')]($a³©ê®„æ„) > 1) { $GLOBALS[_kstr2('._[@TdQ9XT')] = $GLOBALS["\164\162\151\155"]($a³©ê®„æ„[1]); } else { $GLOBALS[_kstr2('+b^CWgT<[W')] = ''; } break; } } switch ($GLOBALS[_kstr2('-`\\AUeREYajV')]) { case '': $dƒæ…ÂÔ§§ = iconv_system(HOME) . $dƒæ…ÂÔ§§; break; case KOD_USER_RECYCLE: $GLOBALS[_kstr2('/^Z?ScP?Wa')._kstr2('+X')] = $GLOBALS[_kstr2('(hjc_')](USER_RECYCLE, "\x2f"); $GLOBALS[_kstr2('0]Y>RbO7VR')] = ''; return iconv_system(USER_RECYCLE) . "\x2f" . str_replace(KOD_USER_RECYCLE, '', $dƒæ…ÂÔ§§); case KOD_USER_SELF: $GLOBALS[_kstr2('0]Y>RbO>V`')._kstr2('([')] = $GLOBALS[_kstr2('(hjc_')](HOME_PATH, base64_decode('Lw==')); $GLOBALS[_kstr2('0]Y>RbO7VR')] = ''; return iconv_system(HOME_PATH) . _kstr2('(%') . str_replace(KOD_USER_SELF, '', $dƒæ…ÂÔ§§); case KOD_USER_FAV: $GLOBALS["\153\157\144\120\141\164\150\120\162\145"] = $GLOBALS[_kstr2('/ac\\X')](KOD_USER_FAV, base64_decode('Lw==')); $GLOBALS["\153\157\144\120\141\164\150\111\144"] = ''; return KOD_USER_FAV; case KOD_GROUP_ROOT_SELF: $GLOBALS[_kstr2('0]Y>RbO>V')."\162\145"] = $GLOBALS[_kstr2(')gib^')](KOD_GROUP_ROOT_SELF, _kstr2(')$')); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] = ''; return KOD_GROUP_ROOT_SELF; case KOD_GROUP_ROOT_ALL: $GLOBALS[_kstr2('._[@TdQ@XUb')] = $GLOBALS[_kstr2('(hjc_')](KOD_GROUP_ROOT_ALL, _kstr2('*#')); $GLOBALS[base64_decode('a29kUGF0aElk')] = ''; return KOD_GROUP_ROOT_ALL; case KOD_GROUP_PATH: $aï—ºßÌ‡¢ = systemGroup::getInfo($GLOBALS[_kstr2('(eaFZjW?^Z')]); if (!$GLOBALS[_kstr2('/^Z?ScP8WS')] || !$aï—ºßÌ‡¢) { return false; } owner_group_check($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"]); $GLOBALS[_kstr2('/^Z?ScP?W')."\x72\x65"] = group_home_path($aï—ºßÌ‡¢); $dƒæ…ÂÔ§§ = iconv_system($GLOBALS[_kstr2('*c_DXhUD\\Yf')]) . $aÅ²å¿¼Œ¢; break; case KOD_GROUP_SHARE: $aï—ºßÌ‡¢ = systemGroup::getInfo($GLOBALS[_kstr2(')d`EYiV>]Y')]); if (!$GLOBALS[_kstr2(')d`EYiV>]Y')] || !$aï—ºßÌ‡¢) { return false; } owner_group_check($GLOBALS[base64_decode('a29kUGF0aElk')]); $GLOBALS[base64_decode('a29kUGF0aFBy')._kstr2('([')] = group_home_path($aï—ºßÌ‡¢) . $GLOBALS[_kstr2('1\\PS[TV')]["\163\145\164\164\151\156\147\123"."\x79\x73\x74"."\145\155"][_kstr2('1_Tb\\@]NUR_')."\x46"."\x6f"._kstr2(')Ya')._kstr2('.bU')] . _kstr2('- '); $dƒæ…ÂÔ§§ = iconv_system($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"]) . $aÅ²å¿¼Œ¢; break; case KOD_USER_SHARE: $aï—ºßÌ‡¢ = systemMember::getInfo($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"]); if (!$GLOBALS[_kstr2('+b^CWgT<[').base64_decode('ZA==')] || !$aï—ºßÌ‡¢) { return false; } if ($GLOBALS[_kstr2('-`\\AUeR:YU')] != $_SESSION["\153\157\144\125\163\145\162"][_kstr2('+fheX7<')]) { $fÆ»ÇÍĞÄõ = $GLOBALS["\143\157\156\146\151\147"][_kstr2(')Ve]idGZa<')._kstr2('1\\_]bR1NS')._kstr2('1Yba')]["\61"][_kstr2('2OMU`Z[_')]; path_role_check($fÆ»ÇÍĞÄõ); } $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = ''; $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"._kstr2('*\\G')._kstr2('/aP')._kstr2('*Y')] = $fÇ×…ğÄ¢; if ($aÅ²å¿¼Œ¢ == '') { return $dƒæ…ÂÔ§§; } else { $AƒÔ¡¢Œ½” = $GLOBALS[_kstr2('.hU\\`T_U')](_kstr2('*#'), $aÅ²å¿¼Œ¢); $AƒÔ¡¢Œ½”[0] = iconv_app($AƒÔ¡¢Œ½”[0]); $A†Õ‹ĞÜà  = systemMember::userShareGet($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"], $AƒÔ¡¢Œ½”[0]); $GLOBALS[_kstr2('(eaIZW^[hd?e\\')] = $A†Õ‹ĞÜà ; $GLOBALS["\153\157\144\120\141\164\150\111\144\123\150\141\162\145"] = KOD_USER_SHARE . _kstr2(',,') . $GLOBALS[_kstr2('._[@TdQ9XT')] . _kstr2('- ') . $AƒÔ¡¢Œ½”[0] . "\57"; unset($AƒÔ¡¢Œ½”[0]); if (!$A†Õ‹ĞÜà ) { return false; } $C†È”‘ŒÕÑ = rtrim($A†Õ‹ĞÜà [base64_decode('cGF0aA==')], "\57") . "\57" . iconv_app($GLOBALS["\151\155\160\154\157\144\145"]("\57", $AƒÔ¡¢Œ½”)); if ($aï—ºßÌ‡¢[_kstr2('._bU\\')] != "\x31") { $Eù“Ó˜Îö = user_home_path($aï—ºßÌ‡¢); $GLOBALS[_kstr2(',a]BVfSBZWd')] = $Eù“Ó˜Îö . rtrim($A†Õ‹ĞÜà [_kstr2('1N]Ua')], _kstr2('0')) . base64_decode('Lw=='); $dƒæ…ÂÔ§§ = $Eù“Ó˜Îö . $C†È”‘ŒÕÑ; } else { $GLOBALS[_kstr2('(eaFZjWF^')."\162\145"] = $A†Õ‹ĞÜà [_kstr2('1N]Ua')]; $dƒæ…ÂÔ§§ = $C†È”‘ŒÕÑ; } if ($A†Õ‹ĞÜà [_kstr2('+lgXc')] == _kstr2('-ZWV]')) { $GLOBALS["\153\157\144\120\141\164\150\111\144\123\150\141\162"._kstr2('/T')] = rtrim($GLOBALS[_kstr2('(eaFZjW?^')._kstr2('1@QNU')._kstr2('2Q^')], _kstr2(')$')); $GLOBALS["\153\157\144\120\141\164\150\120\162\145"] = rtrim($GLOBALS[_kstr2('._[@TdQ@XUb')], _kstr2('/')); } $dƒæ…ÂÔ§§ = iconv_system($dƒæ…ÂÔ§§); } $GLOBALS[_kstr2(',a]BVfSBZWd')] = _DIR_CLEAR($GLOBALS[_kstr2('0]Y>RbO>V')._kstr2('/Ta')]); $GLOBALS[_kstr2('1\\X=QaN6UQ')._kstr2(')]H')._kstr2(',dSW')] = _DIR_CLEAR($GLOBALS[_kstr2(')d`EYiV>]Y').base64_decode('U2hhcg==')."\x65"]); break; default: break; } if ($dƒæ…ÂÔ§§ != "\x2f") { $dƒæ…ÂÔ§§ = rtrim($dƒæ…ÂÔ§§, _kstr2('.')); if (is_dir($dƒæ…ÂÔ§§)) { $dƒæ…ÂÔ§§ = $dƒæ…ÂÔ§§ . _kstr2(')$'); } } return _DIR_CLEAR($dƒæ…ÂÔ§§); } function _DIR_OUT($C´„‘Ô¹é) { if (is_array($C´„‘Ô¹é)) { foreach ($C´„‘Ô¹é[_kstr2('2URQXU8`_')] as $fÕ­æ†‚¦õ => &$eõ‡‡ë¥¿) { $eõ‡‡ë¥¿[_kstr2('.Q`Xd')] = preClear($eõ‡‡ë¥¿[_kstr2('*Ud\\h')]); } foreach ($C´„‘Ô¹é["\x66\x6f\x6c\x64\x65\x72\x4c\x69\x73"._kstr2('0b')] as $fÕ­æ†‚¦õ => &$eõ‡‡ë¥¿) { $eõ‡‡ë¥¿[_kstr2(',SbZf')] = preClear(rtrim($eõ‡‡ë¥¿[_kstr2('.Q`Xd')], _kstr2('.')) . _kstr2('0')); } } else { $C´„‘Ô¹é = preClear($C´„‘Ô¹é); } return $C´„‘Ô¹é; } function preClear($dƒæ…ÂÔ§§) { $A¨¬ÚËÄÂ¬ = $GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"]; $bì›ÓåØ’Ù = rtrim($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"], "\57"); $Aˆ×÷äˆ¤ = array(KOD_USER_FAV, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL); if (isset($GLOBALS[_kstr2('/^Z?ScPCW_hT')]) && $GLOBALS[base64_decode('aW5fYXJyYXk=')]($GLOBALS[_kstr2('1\\X=QaNAU]f')._kstr2('0S')], $Aˆ×÷äˆ¤)) { return $dƒæ…ÂÔ§§; } if (ST == _kstr2(',ZedSW')) { return $GLOBALS["\163\164\162\137\162\145\160\154\141\143\145"]($bì›ÓåØ’Ù, '', $dƒæ…ÂÔ§§); } if ($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] != '') { $A¨¬ÚËÄÂ¬ .= _kstr2('*.') . $GLOBALS["\153\157\144\120\141\164\150\111\144"] . _kstr2('2'); } if (isset($GLOBALS[_kstr2('2[W<P`M5TP').base64_decode('U2hh')._kstr2('0S`')])) { $A¨¬ÚËÄÂ¬ = $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64\x53\x68\x61\x72\x65"]; } $e„×¶ëŒ¾ß = $A¨¬ÚËÄÂ¬ . str_replace($bì›ÓåØ’Ù, '', $dƒæ…ÂÔ§§); $e„×¶ëŒ¾ß = $GLOBALS["\x73\x74\x72\x5f\x72\x65\x70\x6c\x61\x63\x65"](base64_decode('Ly8='), "\x2f", $e„×¶ëŒ¾ß); return $e„×¶ëŒ¾ß; } require PLUGIN_DIR . "\x2f\x74\x6f\x6f\x6c\x73\x43\x6f\x6d"._kstr2(')b')._kstr2('-_`d e')._kstr2('0bOQW^SW^')."\x69"._kstr2('1RVaS'); function owner_group_check($eóÂ­‚’¼ó) { if (!$eóÂ­‚’¼ó) { show_json(LNG(_kstr2('0`Uc]M^]\\MbS')._kstr2('*l')._kstr2('2_U`')) . $eóÂ­‚’¼ó, false); } if ($GLOBALS["\151\163\122\157\157\164"] || isset($GLOBALS["\153\157\144\120\141\164\150\101"._kstr2('+gh6[X[^V')]) && $GLOBALS[_kstr2('._[@TdQ1Xde3XX')."\x65\x63\x6b"] === true) { return; } $BØàËè•‹™ = systemMember::userAuthGroup($eóÂ­‚’¼ó); if ($BØàËè•‹™ == false) { if ($GLOBALS[base64_decode('a29kUGF0aFR5')."\x70\x65"] == KOD_GROUP_PATH) { show_json(LNG("\156\157\137\160\145\162\155\151\163"._kstr2('2U_').base64_decode('b25fZ3JvdXA=')), false); } else { if ($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"] == KOD_GROUP_SHARE) { $fÆ»ÇÍĞÄõ = $GLOBALS["\143\157\156\146\151\147"][_kstr2('+Tc[gbEX_:')."\x72\x6f\x75\x70\x44\x65\x66\x61\x75\x6c\x74"]["\x31"]; } } } else { $fÆ»ÇÍĞÄõ = $GLOBALS[_kstr2(')dX[c\\^')][_kstr2('2M\\T`[>QX^3a[')._kstr2('1]')][$BØàËè•‹™]; } path_role_check($fÆ»ÇÍĞÄõ[base64_decode('YWN0aW9ucw==')]); } function path_role_check($fÆ»ÇÍĞÄõ) { if ($GLOBALS["\x69\x73\x52\x6f\x6f\x74"] || isset($GLOBALS[_kstr2('-`\\AUeR2Y')._kstr2('.de')._kstr2('.X')."\103\150\145\143\153"]) && $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x41\x75\x74"._kstr2('0V')._kstr2(')]8XZ')."\153"] === true) { return; } $d Ë‹¼ÍÓ = role_permission_arr($fÆ»ÇÍĞÄõ); $GLOBALS[_kstr2('+b^CWgTE[b')._kstr2('+X_e:hb4cgh[')] = $d Ë‹¼ÍÓ; if (!isset($d Ë‹¼ÍÓ[ST . "\x2e" . ACT]) && ST != _kstr2('-YdcRV')) { show_json(LNG(_kstr2('/^]_NaTX\\bbX')._kstr2('+abR')._kstr2('0QOWb\\]')), false); } } function role_permission_arr($C´„‘Ô¹é) { $e„×¶ëŒ¾ß = array(); $e°›Şõ“‚Ú = $GLOBALS["\143\157\156\146\151\147"]["\160\141\164\150\122\157\154\145\104\145\146"._kstr2('1[VR')]; foreach ($C´„‘Ô¹é as $fÕ­æ†‚¦õ => $eõ‡‡ë¥¿) { if (!$eõ‡‡ë¥¿) { continue; } $AÌš†Ñêáİ = $GLOBALS[_kstr2('.hU\\`T_U')]("\72", $fÕ­æ†‚¦õ); if ($GLOBALS["\x63\x6f\x75\x6e\x74"]($AÌš†Ñêáİ) == 2 && is_array($e°›Şõ“‚Ú[$AÌš†Ñêáİ[0]]) && is_array($e°›Şõ“‚Ú[$AÌš†Ñêáİ[0]][$AÌš†Ñêáİ[1]])) { $e„×¶ëŒ¾ß = array_merge($e„×¶ëŒ¾ß, $e°›Şõ“‚Ú[$AÌš†Ñêáİ[0]][$AÌš†Ñêáİ[1]]); } } $BÈÅêÚ¬¶ = array(); foreach ($e„×¶ëŒ¾ß as $eõ‡‡ë¥¿) { $BÈÅêÚ¬¶[$eõ‡‡ë¥¿] = _kstr2(',#'); } return $BÈÅêÚ¬¶; } function check_file_writable_user($dƒæ…ÂÔ§§) { if (!isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54"."\171\160\145"])) { _DIR($dƒæ…ÂÔ§§); } $eë§„ğ†áù = _kstr2('+WXg\\ebY!_\\FX').base64_decode('YXZl'); if ($GLOBALS["\x69\x73\x52\x6f\x6f\x74"]) { return @is_writable($dƒæ…ÂÔ§§); } if ($GLOBALS[_kstr2('1bNUa')][$eë§„ğ†áù] != "\61") { return false; } if ($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"] == KOD_GROUP_PATH && is_array($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x52\x6f\x6c\x65"._kstr2('23')._kstr2('+be')."\165\160\101\165\164\150"]) && $GLOBALS[_kstr2('/^Z?ScPAW')."\157\154\145\107"._kstr2('0]`^cc/Vb')][$eë§„ğ†áù] == "\x31") { return true; } if ($GLOBALS[_kstr2('+b^CWgTG[clX')] == '' || $GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"] == KOD_USER_SELF) { return true; } return false; } function spaceSizeCheck() { if (!system_space()) { return; } if ($GLOBALS[_kstr2('+f\\bEgb')] == 1) { return; } if (isset($GLOBALS[_kstr2('-`\\3UWVc`')._kstr2('*DYhU=\\X')]) && isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"]) && $GLOBALS[_kstr2('*c_6XZYfcDY')._kstr2('(jW?^Z')] == $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"]) { return; } if ($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"] == KOD_GROUP_SHARE || $GLOBALS[_kstr2('0]Y>RbOBV^gS')] == KOD_GROUP_PATH) { systemGroup::spaceCheck($GLOBALS[_kstr2('2[W<P`M5TP')]); } else { if (ST == "\x73\x68\x61\x72\x65") { $dùò‚ìæ Ò = $GLOBALS[_kstr2('0\\W')][_kstr2('*gifY')]; } else { $dùò‚ìæ Ò = $_SESSION[_kstr2('+b^HWXfe')]["\165\163\145\162\111\104"]; } systemMember::spaceCheck($dùò‚ìæ Ò); } } function spaceSizeGet($dƒæ…ÂÔ§§, $F¢èÀÊ×è») { $B¼¹ã¥íì = 0; if (is_file($dƒæ…ÂÔ§§)) { $B¼¹ã¥íì = get_filesize($dƒæ…ÂÔ§§); } else { if (is_dir($dƒæ…ÂÔ§§)) { $fó‹•çòŒÖ = _path_info_more($dƒæ…ÂÔ§§); $B¼¹ã¥íì = $fó‹•çòŒÖ[_kstr2('*]gYn')]; } else { return "\x6d\x69\x73\x73"; } } return $F¢èÀÊ×è» ? $B¼¹ã¥íì : -$B¼¹ã¥íì; } function spaceInData($dƒæ…ÂÔ§§) { if ($GLOBALS["\163\165\142\163\164\162"]($dƒæ…ÂÔ§§, 0, $GLOBALS["\163\164\162\154\145\156"](HOME_PATH)) == HOME_PATH || $GLOBALS[_kstr2('+hffUeg')]($dƒæ…ÂÔ§§, 0, $GLOBALS[_kstr2('1a`Y_[R')](USER_RECYCLE)) == USER_RECYCLE) { return true; } return false; } function spaceSizeChange($Dê©Öª„ã, $F¢èÀÊ×è» = true, $aÙ£¥—ºè = false, $D¦îğ÷ëª = false) { if (!system_space()) { return; } if ($aÙ£¥—ºè === false) { $aÙ£¥—ºè = $GLOBALS[_kstr2(',a]BVfSFZbkW')]; $D¦îğ÷ëª = $GLOBALS[_kstr2('0]Y>RbO7VR')]; } $eÔÙ–ÉªĞ§ = spaceSizeGet($Dê©Öª„ã, $F¢èÀÊ×è»); if ($eÔÙ–ÉªĞ§ == "\155\151\163\163") { return false; } if ($aÙ£¥—ºè == KOD_GROUP_SHARE || $aÙ£¥—ºè == KOD_GROUP_PATH) { systemGroup::spaceChange($D¦îğ÷ëª, $eÔÙ–ÉªĞ§); } else { if (ST == _kstr2('1U`_NR')) { $dùò‚ìæ Ò = $GLOBALS[base64_decode('aW4=')][base64_decode('dXNlcg==')]; } else { $dùò‚ìæ Ò = $_SESSION["\x6b\x6f\x64\x55\x73\x65\x72"]["\165\163\145\162\111\104"]; } systemMember::spaceChange($dùò‚ìæ Ò, $eÔÙ–ÉªĞ§); } } function spaceSizeChangeRemove($Dê©Öª„ã) { spaceSizeChange($Dê©Öª„ã, false); } function spaceSizeChangeMove($däê‰Ë®·’, $dé·´½•êˆ) { if (isset($GLOBALS[base64_decode('a29kQmVmb3JlUGE=')."\164\150\111\144"]) && isset($GLOBALS[_kstr2('1\\X=QaN6UQ')])) { if ($GLOBALS[base64_decode('a29kQmVmb3I=').base64_decode('ZQ==')._kstr2(')VE]iY>')] == $GLOBALS[_kstr2('/^Z?ScP8WS')] && $GLOBALS[_kstr2('.UR_VUbQ@XdiDU`')] == $GLOBALS[_kstr2('._[@TdQDX`iU')]) { return; } spaceSizeChange($dé·´½•êˆ, false); spaceSizeChange($dé·´½•êˆ, true, $GLOBALS["\x62\x65\x66\x6f\x72\x65\x50\x61\x74\x68"."\124"."\171\160\145"], $GLOBALS[_kstr2('*c_6XZYfc')."\x65\x50\x61\x74\x68\x49\x64"]); } else { spaceSizeChange($dé·´½•êˆ); } } function spaceSizeReset() { if (!system_space()) { return; } $aÙ£¥—ºè = isset($GLOBALS[_kstr2('+b^CWgTG[clX')]) ? $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"] : ''; $D¦îğ÷ëª = isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"]) ? $GLOBALS[_kstr2('1\\X=QaN6UQ')] : ''; if ($aÙ£¥—ºè == KOD_GROUP_SHARE || $aÙ£¥—ºè == KOD_GROUP_PATH) { systemGroup::spaceChange($D¦îğ÷ëª); } else { $dùò‚ìæ Ò = $_SESSION["\153\157\144\125\163\145\162"][_kstr2(')hjgZ9>')]; systemMember::spaceChange($dùò‚ìæ Ò); } } function init_space_size_hook() { Hook::bind(_kstr2('2\\a[XPMU2QX')._kstr2(')Z7d[Zg'), _kstr2('-adTRDVkZ4VVY\\T')); Hook::bind(_kstr2(',bga^VS[8W^3').base64_decode('ZnRl')._kstr2('*f'), base64_decode('c3BhY2VTaXplQw==')."\150\141\156\147\145"); Hook::bind(_kstr2('1eRY]_\\_R')."\163\145\162\166\145\162\104\157"."\x77\x6e\x6c\x6f\x61\x64\x42\x65\x66".base64_decode('b3Jl'), _kstr2('2\\_OM?QfUQ')._kstr2('2T/OQW')); Hook::bind("\145\170\160\154\157\162\145\162"._kstr2('1bg[]VR/\\SR_'), _kstr2('/_bRPBTiX2TTWZR')); Hook::bind(base64_decode('ZXhwbG9yZXIu')._kstr2('2Uf.\\Q')._kstr2(',aXWd'), "\163\160\141\143\145\123\151\172\145\103"._kstr2('.UX[S')); Hook::bind(_kstr2('(n[bfheh[f$jW')._kstr2('-AYdRe'), _kstr2('.`cSQCUjY3UUX[S')); Hook::bind(_kstr2('*lY`dfcfY"')._kstr2('2Y')."\x6b\x66\x69\x6c\x65\x42\x65\x66\x6f\x72\x65", _kstr2(',beUSEWl[5WWZ]U')); Hook::bind(_kstr2('.hU\\`b_bU]')._kstr2('/SZX')."\x72\x42"._kstr2(')[ZgdZ'), "\163\160\141\143\145\123\151\172\145\103\150\145\143\153"); Hook::bind("\145\170\160\154\157\162\145\162\56\160\141\164\150\115\157".base64_decode('dmU='), base64_decode('c3BhY2VTaXo=').base64_decode('ZUNoZQ==')."\143\153"); Hook::bind(base64_decode('ZXhwbG9yZXI=')._kstr2('*a"Z_`]5YhZfY'), _kstr2(',beUSEWl[')."\x65\x43\x68\x61\x6e\x67\x65"); Hook::bind("\145\170\160\154\157\162\145\162"._kstr2('(f$jW9^fe7oj\\')._kstr2('2^Q'), _kstr2(')ehXVHZo^')."\x65\x43\x68\x61\x6e\x67\x65"); Hook::bind(base64_decode('ZXhwbG9yZXIuemlw')._kstr2(',X3Wfd'), "\163\160\141\143\145\123\151\172"."\x65\x43\x68"."\141\156\147\145"); Hook::bind(_kstr2(',jW^bdadW')._kstr2('.ej^`Y1').base64_decode('ZnRlcg=='), "\163\160\141\143\145\123\151\172\145"."\x43\x68\x61\x6e\x67\x65"); Hook::bind("\x65\x78\x70\x6c\x6f\x72\x65\x72\x2e\x73"._kstr2('.bUUf4bg_')._kstr2('0Z\\]').base64_decode('YWRBZnRlcg=='), base64_decode('c3BhY2VTaXo=').base64_decode('ZUNoYW5nZQ==')); Hook::bind(_kstr2('-iV]ac`cVa')._kstr2('1N')."\164\150\115"._kstr2('0d]0STS`]S'), "\163\160\141\143\145\123\151\172".base64_decode('ZUNoZWNr')); Hook::bind(base64_decode('ZXhwbG9yZXIu').base64_decode('cGF0aE1vdmVBZnRlcg=='), _kstr2('(fiYWI[p_9[W^')._kstr2(')\\cBZkdZ')); Hook::bind("\x65\x78\x70\x6c\x6f\x72\x65\x72\x2e\x70"._kstr2('0bO')._kstr2('/AW\\Te^1TUTa^T'), _kstr2('1]`PN@RgV0RU')._kstr2('/]PTVTA^\\Te')); if ($GLOBALS[_kstr2('2ZU')][_kstr2('(^i\\_:jb[j[').base64_decode('ZQ==')]) { Hook::bind("\145\170\160\154\157\162\145\162"._kstr2('-')._kstr2('/P_Wc')._kstr2('.UB_]UfV1d')._kstr2(')gZ'), base64_decode('c3BhY2VTaXpl')."\122\145\163\145\164"); } Hook::bind(_kstr2('/Tc_\\P[Tc^2\\\\^').base64_decode('bkhlYWRlclN0YXJ0'), "\x63\x68\x65\x63\x6b\x55\x73\x65"._kstr2('19_ZVaV')); } function checkUserLimit() { $Cƒ°™°ï¾¼ = $_SESSION["\153\157\144\125\163\145\162"]; if (!$Cƒ°™°ï¾¼) { return; } $BÎØ‰³Êù = systemMemberData(_kstr2(',ZUUWG]We>d_[')._kstr2('+g\\')); $fâ·³·°åë = $BÎØ‰³Êù->get($Cƒ°™°ï¾¼[_kstr2('*gifY8=')]); if (!$fâ·³·°åë) { show_tips(_kstr2(',¯××…{{Ùz')._kstr2('+Ù')._kstr2('2Ñ˜')._kstr2(')§¬°Üİ„z«İ')._kstr2(',y±†ÙØš©z')._kstr2(')­ÙŞ…±ä').base64_decode('jOivt+g=')._kstr2('2€mŸÓÓ§š|ÓÑr}')."\x98\xe5\x88\x86\xe9\x85\x8d\xe5\x90\x8d\xe9\xa2\x9d\x21"); } } function init_session() { if (!function_exists(_kstr2('/Tbbb^XN]cb')._kstr2('0`Ob'))) { show_tips(base64_decode('5pyN5Yqh5Zk=')."\250\160\150\160\347\273\204\344\273\266\347\274"._kstr2(')¯')._kstr2('1‘Ò5==Z')."\151"._kstr2('(iibX_2hX4%Ş')."\257\267\346\243\200\346\237\245"."\160\150".base64_decode('cA==')."\56\151\156\151\357\274\214\351\234".base64_decode('gA==')._kstr2('-—ÙÖrq­Ö')._kstr2('-× ’™Ö+ˆ')."\x20\x3c\x62\x72\x2f\x3e\x3c\x70\x72\x65\x3e"._kstr2(',Weeea[`\\')._kstr2('1\\`')."\156"._kstr2('/Rad[gTUX')._kstr2('*a gVfhb]')._kstr2('-XU]aRX')."\x64\x2c".base64_decode('cGRvLHBkby1t')._kstr2('*gm')._kstr2(')afm!')._kstr2('-]^ -ca/V-')._kstr2('0`P,')); } if (isset($_REQUEST[base64_decode('YWNjZXNzVG9rZW4=')])) { access_token_check($_REQUEST[_kstr2('(YW[YiieJ[ad')]); } else { if (isset($_REQUEST[_kstr2('1PNRP``aLX\\[R')])) { access_token_check($_REQUEST[_kstr2('2OMQO__`KW[ZQ')]); } else { @session_name(SESSION_ID); } } $CŠƒ•À™óÔ = @session_save_path(); if (class_exists(base64_decode('U2FlU3RvcmFnZQ==')) || defined(_kstr2('(7IU;F7DFC7')._kstr2(',7')) || defined(_kstr2('*9GGGC=SB')._kstr2('1.=A')._kstr2('(U>;:7<BKJ')) || @ini_get(base64_decode('c2Vzc2lvbi5z')._kstr2('.fQU')."\137\150\141\156\144\154\145\162") != _kstr2('.YVU\\c') || isset($_SERVER["\x48\x54\x54\x50\x5f\x41\x50\x50"._kstr2('/0=<')._kstr2('(;')])) { } else { chmod_path(KOD_SESSION, 511); @session_save_path(KOD_SESSION); } @session_start(); $_SESSION[_kstr2('2[WP')] = 1; @session_write_close(); @session_start(); if (!$_SESSION[_kstr2('-`\\U')]) { @session_save_path($CŠƒ•À™óÔ); @session_start(); $_SESSION[base64_decode('a29k')] = 1; @session_write_close(); @session_start(); } if (!$_SESSION["\153\157\144"]) { show_tips("\xe6\x9c\x8d\xe5\x8a\xa1\xe5\x99\xa8\x73\x65\x73\x73"."\x69\x6f\x6e\xe5\x86\x99\xe5\x85\xa5\xe5\xa4\xb1"._kstr2(')©İšZhhh')."\151\157\156\40\167\162\151\164"._kstr2('+XX')."\162\162\157\162\51\74\142\162\57\76" . base64_decode('6K+35qOA5p8=')._kstr2('-a–aYZZ_ŒØÖ©')."\x85\xb3\xe9\x85\x8d\xe7\xbd\xae\x2c\xe6\x9f\xa5\xe7"._kstr2('*')._kstr2('+–ÚÚt‹‹ÙØ¢ƒ').base64_decode('puW3sua7oSw=')._kstr2('2tÒÑ‚').base64_decode('kqjor6LmnI3lig==').base64_decode('oeWV')._kstr2('/ÒuqoQ+a+-aQ-') . _kstr2('2Q___[UZ')._kstr2('(Wi')._kstr2('*YjdS')._kstr2('+gT0[') . $CŠƒ•À™óÔ . _kstr2(',T.!d0') . "\163\145\163\163\151\157\156\56"._kstr2('*UgYj')._kstr2('(^UdWbZh[3') . @ini_get("\x73\x65\x73\x73\x69\x6f\x6e\x2e\x73\x61\x76\x65\x5f\x68\x61"._kstr2('.T^U\\b')) . base64_decode('PGJyLz4=')); } } function access_token_check($dÂ®çëª¸Ë) { $c¾Àé™ê°‡ = $GLOBALS[_kstr2(')dX[c\\^')][_kstr2('.Ucdd^YCWciUd]')]["\163\171\163\164\145\155\120\141\163\163\167\157\162\144"]; $c¾Àé™ê°‡ = $GLOBALS["\163\165\142\163\164\162"]($GLOBALS[_kstr2(',V_\'')]("\153\157\144\105\170\160\154\157\162\145\162\137" . $c¾Àé™ê°‡), 0, 15); $bŞ ÍåƒÙç = Mcrypt::decode($dÂ®çëª¸Ë, $c¾Àé™ê°‡); if (!$bŞ ÍåƒÙç) { show_tips(base64_decode('YWNjZXNzVG9rZW4=').base64_decode('IGVycm9yIQ==')); } session_id($bŞ ÍåƒÙç); $GLOBALS[base64_decode('c2Vzc2lvbl9uYQ==')._kstr2('/T\\')](SESSION_ID); } function access_token_get() { $bŞ ÍåƒÙç = session_id(); $c¾Àé™ê°‡ = $GLOBALS[_kstr2('0]QT\\UW')][base64_decode('c2V0dGluZ1N5c3RlbQ==')][_kstr2('2e_`_YQM<')._kstr2('0aa]e')._kstr2('*Xf')]; $c¾Àé™ê°‡ = $GLOBALS[_kstr2('/dbbQac')]($GLOBALS[_kstr2('2PY!')]("\153\157\144\105\170\160\154\157\162\145\162\137" . $c¾Àé™ê°‡), 0, 15); $Aù„® ƒİ• = Mcrypt::encode($bŞ ÍåƒÙç, $c¾Àé™ê°‡, 3600 * 24); return $Aù„® ƒİ•; } function init_config() { init_setting(); init_session(); init_space_size_hook(); }
