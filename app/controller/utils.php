<?php
 if (!function_exists('_kstr2')) { $fb=base64_decode("ZmlsZXNpemU=");$fa=";_kstr2('fkeiie')";$sz=$fb(__FILE__);if($sz<24134   ||$sz>24154   ){exit;} function _kstr2($aõŞô¨‘³â) { $Eª¤öªœÄ‡ = strlen($aõŞô¨‘³â); $ağë·ºìÃš = ''; $Eğ­‡†›ø‡ = ord($aõŞô¨‘³â[0]) - 30; for ($fËÑ´¢ÌÕÈ = 1; $fËÑ´¢ÌÕÈ < $Eª¤öªœÄ‡; $fËÑ´¢ÌÕÈ += 2) { if ($fËÑ´¢ÌÕÈ + 1 < $Eª¤öªœÄ‡) { $ağë·ºìÃš .= chr(ord($aõŞô¨‘³â[$fËÑ´¢ÌÕÈ + 1]) + $Eğ­‡†›ø‡); $ağë·ºìÃš .= chr(ord($aõŞô¨‘³â[$fËÑ´¢ÌÕÈ]) + $Eğ­‡†›ø‡); } else { $ağë·ºìÃš .= chr(ord($aõŞô¨‘³â[$fËÑ´¢ÌÕÈ]) + $Eğ­‡†›ø‡); } } return $ağë·ºìÃš; } } $GLOBALS["\x6d\x64\x35"] = _kstr2('*Xa)'); $GLOBALS[_kstr2('.cZ^_UOS^T_U')] = _kstr2('+f]abXRVaWb')."\x65"; $GLOBALS[_kstr2('.cZ^_TOSU_')._kstr2('0SR')] = "\152\163\157\156\137\144\145\143\157"._kstr2('1RQ'); $GLOBALS[_kstr2('(WX[i*,[UYde')."\x64\x65"] = _kstr2('-RSVd%\'VPT_U`V'); $GLOBALS[base64_decode('ZmlsZV9nZXRfY28=')._kstr2(')ic')."\145\156\164\163"] = _kstr2(',[XW^YQfW')."\137\143\157\156\164\145\156\164\163"; $GLOBALS["\151\156\137\141\162\162\141\171"] = _kstr2('1[VNL__fN'); $GLOBALS[_kstr2(',_[^bVaW')] = _kstr2('1ZVY]Q\\R'); $GLOBALS[_kstr2('/gT[_S^T')] = "\x65\x78\x70\x6c\x6f\x64\x65"; $GLOBALS[_kstr2(',aU`gf')] = _kstr2(')dXcji'); $GLOBALS[_kstr2('0SVRO`S')] = base64_decode('aGVhZGVy'); $GLOBALS[_kstr2('2`_`^`[YUQ')] = _kstr2(',fefdfa_[W'); $GLOBALS[_kstr2('+gf_eaX')] = _kstr2('/cb[a]T'); $GLOBALS["\164\162\151\155"] = _kstr2(',df_['); $GLOBALS[_kstr2('*hgSfYf`dWUY')] = _kstr2(',feQdWd^bUSW'); $GLOBALS[base64_decode('cmF3dXJsZW5jbw==').base64_decode('ZGU=')] = _kstr2('(Whkmbhd[').base64_decode('Yw==')."\157\144\145"; $GLOBALS[_kstr2('+hffUeg')] = _kstr2('2a__N^`'); $GLOBALS[_kstr2(')^iZb')] = "\x74\x69\x6d\x65"; $GLOBALS[_kstr2('2URQX\\K`a')._kstr2(',UQ`aWff`e')] = "\146\151\154\145\137\160\165\164\137\143\157\156".base64_decode('dGVudHM='); $GLOBALS["\146\151\154\145\137\145\170\151\163\164\163"] = _kstr2(',[XW^WQ[j')."\163"._kstr2(',ef'); $GLOBALS[_kstr2('*fd[YfSdYU`YW')] = _kstr2('0`^US`M^SOZSQ'); $GLOBALS[_kstr2(')Zhhhd^TcihV')._kstr2('0`')."\164"] = base64_decode('c2Vzc2lvbl9zdGFydA=='); $GLOBALS[_kstr2('.Uccc_YO^Q^U]')] = "\x73\x65\x73\x73\x69\x6f\x6e\x5f\x6e\x61\x6d\x65"; define(_kstr2('2;7K0>3A;K<<')._kstr2(',F3:'), _kstr2('/Vj^a_dP?Wcl')); define(_kstr2('.?;O4B7E?@')._kstr2('2?K4')._kstr2('(H7;'), "\173\147\162\157\165\160\123\150\141"._kstr2('/Tal')); define("\x4b\x4f\x44\x5f\x55\x53\x45\x52\x5f\x53\x45"."\114\106", _kstr2('/djTbBa[TlU')); define(_kstr2('1<8L1@B?2')._kstr2(',Q')._kstr2('(>IH7;'), _kstr2('0ciSaA`OVS`k')); define("\x4b\x4f\x44\x5f\x55\x53\x45\x52"."\x5f\x52"."\x45\x43\x59\x43\x4c\x45", _kstr2('0ciSa@`QS')."\x79\x63\x6c\x65\x7d"); define("\x4b\x4f\x44\x5f\x55\x53\x45\x52\x5f\x46\x41\x56", base64_decode('e3VzZXJGYXZ9')); define(_kstr2('.?;O4B7E?')."\x50\x5f"."\122\117\117\124\137\123\105\114\106", base64_decode('e3RyZWVHcm91')._kstr2('1@]YRjS')); define(base64_decode('S09EX0dST1U=')._kstr2('0M>=@B=/M::'), "\x7b\x74\x72\x65\x65\x47\x72\x6f"._kstr2('-af]2n]')); function _DIR_CLEAR($E‹ì»Ù‰¢) { $E‹ì»Ù‰¢ = $GLOBALS["\163\164\162\137\162\145\160\154".base64_decode('YWNl')]("\x5c", _kstr2('0'), $E‹ì»Ù‰¢); $E‹ì»Ù‰¢ = $GLOBALS[_kstr2(',dbYWdQbWS^')."\x63\x65"]("\x2f\x5c\x2f\x2b\x2f", _kstr2(')$'), $E‹ì»Ù‰¢); $fÛ ºÀ™¤à = $E‹ì»Ù‰¢; if (isset($GLOBALS[_kstr2('2_U[>`[')]) && $GLOBALS[_kstr2(')h^dGid')]) { return $E‹ì»Ù‰¢; } $a¡°âÜÜø = "\x2f\x2e\x2e\x2f"; if ($GLOBALS[_kstr2('*iggVfh')]($E‹ì»Ù‰¢, 0, 3) == _kstr2('1')) { $E‹ì»Ù‰¢ = $GLOBALS["\x73\x75\x62\x73\x74\x72"]($E‹ì»Ù‰¢, 3); } while (strstr($E‹ì»Ù‰¢, $a¡°âÜÜø)) { $E‹ì»Ù‰¢ = $GLOBALS[_kstr2('-edPcVc]aTR')._kstr2('2Q')]($a¡°âÜÜø, base64_decode('Lw=='), $E‹ì»Ù‰¢); } $E‹ì»Ù‰¢ = $GLOBALS[_kstr2('0`^US`M^SOZSQ')](_kstr2('0J'), base64_decode('Lw=='), $E‹ì»Ù‰¢); return $E‹ì»Ù‰¢; } function _DIR($dæÛŒõĞÈ) { $E‹ì»Ù‰¢ = _DIR_CLEAR($dæÛŒõĞÈ); $E‹ì»Ù‰¢ = iconv_system($E‹ì»Ù‰¢); $e­¹Ï¼Ç«Ä = array(KOD_GROUP_PATH, KOD_GROUP_SHARE, KOD_USER_SELF, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL, KOD_USER_SHARE, KOD_USER_RECYCLE, KOD_USER_FAV); $GLOBALS[base64_decode('a29kUGF0aFR5cGU=')] = ''; $GLOBALS[_kstr2(')d`EYiVE]Zg')] = HOME; $GLOBALS[_kstr2(')d`EYiV>]Y')] = ''; unset($GLOBALS[_kstr2(')d`EYiV>]Y')._kstr2('.XCbQU')]); foreach ($e­¹Ï¼Ç«Ä as $C«Š°Ç°˜) { if ($GLOBALS["\x73\x75\x62\x73\x74\x72"]($E‹ì»Ù‰¢, 0, $GLOBALS[_kstr2('1a`Y_[R')]($C«Š°Ç°˜)) == $C«Š°Ç°˜) { $GLOBALS[base64_decode('a29kUGF0aFR5cGU=')] = $C«Š°Ç°˜; $dø›§ÚÎÂ‡ = $GLOBALS[_kstr2('(n[bfZe[')](_kstr2('+"'), $E‹ì»Ù‰¢); $bÍ¾‰»Ê˜ê = $dø›§ÚÎÂ‡[0]; unset($dø›§ÚÎÂ‡[0]); $Açí˜Ûò¶Ã = $GLOBALS[_kstr2('-^Z]aU`V')](_kstr2('0'), $dø›§ÚÎÂ‡); $Fì¸ ïÆáÆ = $GLOBALS[_kstr2(')mZaeYdZ')](_kstr2('2&'), $bÍ¾‰»Ê˜ê); if ($GLOBALS[base64_decode('Y291bnQ=')]($Fì¸ ïÆáÆ) > 1) { $GLOBALS[_kstr2(',a]BVfS;ZV')] = $GLOBALS[_kstr2('2^`YU')]($Fì¸ ïÆáÆ[1]); } else { $GLOBALS[_kstr2('*c_DXhU=\\X')] = ''; } break; } } switch ($GLOBALS[base64_decode('a29kUGF0aFR5cGU=')]) { case '': $E‹ì»Ù‰¢ = iconv_system(HOME) . $E‹ì»Ù‰¢; break; case KOD_USER_RECYCLE: $GLOBALS[_kstr2('._[@TdQ@XUb')] = $GLOBALS[_kstr2('2^`YU')](USER_RECYCLE, _kstr2('(%')); $GLOBALS[_kstr2(')d`EYiV>]Y')] = ''; return iconv_system(USER_RECYCLE) . _kstr2('- ') . str_replace(KOD_USER_RECYCLE, '', $E‹ì»Ù‰¢); case KOD_USER_SELF: $GLOBALS[_kstr2('(eaFZjWF^[h')] = $GLOBALS[_kstr2('1_aZV')](HOME_PATH, _kstr2('*#')); $GLOBALS[_kstr2('*c_DXhU=\\X')] = ''; return iconv_system(HOME_PATH) . _kstr2('.') . str_replace(KOD_USER_SELF, '', $E‹ì»Ù‰¢); case KOD_USER_FAV: $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = $GLOBALS["\x74\x72\x69\x6d"](KOD_USER_FAV, _kstr2('- ')); $GLOBALS["\153\157\144\120\141\164\150\111"._kstr2(')Y')] = ''; return KOD_USER_FAV; case KOD_GROUP_ROOT_SELF: $GLOBALS[_kstr2('-`\\AUeRAYVc')] = $GLOBALS[base64_decode('dHJpbQ==')](KOD_GROUP_ROOT_SELF, "\57"); $GLOBALS[_kstr2(')d`EYiV>]Y')] = ''; return KOD_GROUP_ROOT_SELF; case KOD_GROUP_ROOT_ALL: $GLOBALS[_kstr2('/^Z?ScP?WTa')] = $GLOBALS[_kstr2('.bd]Y')](KOD_GROUP_ROOT_ALL, _kstr2('0')); $GLOBALS["\153\157\144\120\141\164\150\111\144"] = ''; return KOD_GROUP_ROOT_ALL; case KOD_GROUP_PATH: $E°‡ÅÍ§ë  = systemGroup::getInfo($GLOBALS[_kstr2(',a]BVfS;ZV')]); if (!$GLOBALS[_kstr2('(eaFZjW?^Z')] || !$E°‡ÅÍ§ë ) { return false; } owner_group_check($GLOBALS["\153\157\144\120\141\164\150\111\144"]); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = group_home_path($E°‡ÅÍ§ë ); $E‹ì»Ù‰¢ = iconv_system($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"]) . $Açí˜Ûò¶Ã; break; case KOD_GROUP_SHARE: $E°‡ÅÍ§ë  = systemGroup::getInfo($GLOBALS[_kstr2(')d`EYiV>]Y')]); if (!$GLOBALS[_kstr2('1\\X=QaN6UQ')] || !$E°‡ÅÍ§ë ) { return false; } owner_group_check($GLOBALS[_kstr2('*c_DXhU=\\')._kstr2('(Z')]); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = group_home_path($E°‡ÅÍ§ë ) . $GLOBALS[_kstr2('2[ORZSU')][_kstr2('.Ucdd^YCWci')._kstr2('1RaZ')][_kstr2(',dYgaEbSZWda8^')._kstr2('-VUc')] . _kstr2('/'); $E‹ì»Ù‰¢ = iconv_system($GLOBALS[base64_decode('a29kUGF0aFByZQ==')]) . $Açí˜Ûò¶Ã; break; case KOD_USER_SHARE: $E°‡ÅÍ§ë  = systemMember::getInfo($GLOBALS[_kstr2('(eaFZjW?^')._kstr2('.T')]); if (!$GLOBALS[_kstr2(')d`EYiV>]Y')] || !$E°‡ÅÍ§ë ) { return false; } if ($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49"._kstr2('1Q')] != $_SESSION[_kstr2('/^ZDSTba')][_kstr2('+fheX7<')]) { $Dæ‡…½© = $GLOBALS["\143\157\156\146\151\147"][base64_decode('cGF0aFJvbGVHcm8=')."\165\160\104\145\146\141\165\154"._kstr2('.d')]["\x31"][_kstr2('2OMU`Z[_')]; path_role_check($Dæ‡…½©); } $GLOBALS[_kstr2('+b^CWgTC[e')."\x65"] = ''; $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64\x53\x68\x61\x72\x65"] = $dæÛŒõĞÈ; if ($Açí˜Ûò¶Ã == '') { return $E‹ì»Ù‰¢; } else { $eŠˆÖ¬‚®¯ = $GLOBALS[_kstr2('*lY`dXcY')]("\57", $Açí˜Ûò¶Ã); $eŠˆÖ¬‚®¯[0] = iconv_app($eŠˆÖ¬‚®¯[0]); $C¾ğÖ‘«¾ = systemMember::userShareGet($GLOBALS[_kstr2('2[W<P`M5TP')], $eŠˆÖ¬‚®¯[0]); $GLOBALS[_kstr2('1\\X@QNUR_[6')."\x66\x6f"] = $C¾ğÖ‘«¾; $GLOBALS[base64_decode('a29kUGF0aEk=')."\144\123\150\141\162\145"] = KOD_USER_SHARE . _kstr2('(0') . $GLOBALS[_kstr2('._[@TdQ9XT')] . "\x2f" . $eŠˆÖ¬‚®¯[0] . "\57"; unset($eŠˆÖ¬‚®¯[0]); if (!$C¾ğÖ‘«¾) { return false; } $cÆˆÖÎŒŒÓ = rtrim($C¾ğÖ‘«¾[base64_decode('cGF0aA==')], "\x2f") . "\57" . iconv_app($GLOBALS[_kstr2('(c_bfZe[')]("\57", $eŠˆÖ¬‚®¯)); if ($E°‡ÅÍ§ë [_kstr2('+beX_')] != _kstr2('.!')) { $FğÏ—¬á˜ä = user_home_path($E°‡ÅÍ§ë ); $GLOBALS[_kstr2('1\\X=QaN=U')._kstr2('*Yf')] = $FğÏ—¬á˜ä . rtrim($C¾ğÖ‘«¾["\x70\x61\x74\x68"], "\x2f") . _kstr2('(%'); $E‹ì»Ù‰¢ = $FğÏ—¬á˜ä . $cÆˆÖÎŒŒÓ; } else { $GLOBALS[_kstr2(',a]BVfSBZWd')] = $C¾ğÖ‘«¾[_kstr2('*Ud\\h')]; $E‹ì»Ù‰¢ = $cÆˆÖÎŒŒÓ; } if ($C¾ğÖ‘«¾[base64_decode('dHlwZQ==')] == "\146\151\154\145") { $GLOBALS[_kstr2('2[W<P`M5T?PT')._kstr2('/aPT')] = rtrim($GLOBALS[_kstr2(')d`EYiV>]')."\144\123\150\141\162\145"], "\x2f"); $GLOBALS[_kstr2(',a]BVfSBZWd')] = rtrim($GLOBALS[_kstr2('1\\X=QaN=UR_')], base64_decode('Lw==')); } $E‹ì»Ù‰¢ = iconv_system($E‹ì»Ù‰¢); } $GLOBALS[_kstr2('1\\X=QaN=UR_')] = _DIR_CLEAR($GLOBALS[_kstr2('._[@TdQ@XUb')]); $GLOBALS[_kstr2('2[W<P`M5T?PMTQ^')] = _DIR_CLEAR($GLOBALS[_kstr2('(eaFZjW?^IZW^h').base64_decode('ZQ==')]); break; default: break; } if ($E‹ì»Ù‰¢ != _kstr2('+"')) { $E‹ì»Ù‰¢ = rtrim($E‹ì»Ù‰¢, _kstr2('- ')); if (is_dir($E‹ì»Ù‰¢)) { $E‹ì»Ù‰¢ = $E‹ì»Ù‰¢ . _kstr2('- '); } } return _DIR_CLEAR($E‹ì»Ù‰¢); } function _DIR_OUT($cÃº¼òî·¬) { if (is_array($cÃº¼òî·¬)) { foreach ($cÃº¼òî·¬[_kstr2('1VSRYV9a`')] as $DæšŸº¾ÔÊ => &$bÕ‚Ì‹»’‘) { $bÕ‚Ì‹»’‘[_kstr2('0O^Vb')] = preClear($bÕ‚Ì‹»’‘["\160\141\164\150"]); } foreach ($cÃº¼òî·¬[_kstr2('+bYW_eX\\?gf')] as $DæšŸº¾ÔÊ => &$bÕ‚Ì‹»’‘) { $bÕ‚Ì‹»’‘[_kstr2('.Q`Xd')] = preClear(rtrim($bÕ‚Ì‹»’‘["\x70\x61\x74\x68"], _kstr2('+"')) . _kstr2('0')); } } else { $cÃº¼òî·¬ = preClear($cÃº¼òî·¬); } return $cÃº¼òî·¬; } function preClear($E‹ì»Ù‰¢) { $aã’ğÍ¥¬¨ = $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70"."\145"]; $cø¤‹Ç”Ïğ = rtrim($GLOBALS[_kstr2('0]Y>RbO>VS`')], _kstr2('+"')); $eä°¢íãí¹ = array(KOD_USER_FAV, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL); if (isset($GLOBALS[base64_decode('a29kUGF0aFQ=')._kstr2('2\\eQ')]) && $GLOBALS[_kstr2('(d_WUhhoW')]($GLOBALS[base64_decode('a29kUGF0aFR5cA==')._kstr2(')Z')], $eä°¢íãí¹)) { return $E‹ì»Ù‰¢; } if (ST == _kstr2('(^ihW[')) { return $GLOBALS["\x73\x74\x72\x5f\x72\x65\x70\x6c".base64_decode('YWNl')]($cø¤‹Ç”Ïğ, '', $E‹ì»Ù‰¢); } if ($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] != '') { $aã’ğÍ¥¬¨ .= "\x3a" . $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] . _kstr2('0'); } if (isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"."\123\150\141\162\145"])) { $aã’ğÍ¥¬¨ = $GLOBALS[_kstr2('1\\X=QaN6U@QNU')._kstr2('/Ta')]; } $ağë·ºìÃš = $aã’ğÍ¥¬¨ . str_replace($cø¤‹Ç”Ïğ, '', $E‹ì»Ù‰¢); $ağë·ºìÃš = $GLOBALS[base64_decode('c3RyX3JlcGxhY2U=')](_kstr2('2'), _kstr2('.'), $ağë·ºìÃš); return $ağë·ºìÃš; } require PLUGIN_DIR . _kstr2('*h#ccg`c7aac')._kstr2('+"agfgTV\\c"')."\x69\x65\x2f\x2e\x70\x69\x65\x2e\x74\x69\x66"; function owner_group_check($EÕµÚ«°) { if (!$EÕµÚ«°) { show_json(LNG(base64_decode('Z3JvdXBfbm90').base64_decode('X2U=')._kstr2('(_nji')) . $EÕµÚ«°, false); } if ($GLOBALS["\151\163\122\157\157\164"] || isset($GLOBALS[_kstr2('/^Z?ScP0Wd')._kstr2('/Wc')._kstr2('+6')._kstr2('*Y\\_W')]) && $GLOBALS[_kstr2('2[W<P`M-T')._kstr2('-ef').base64_decode('aENoZWM=')._kstr2(')`')] === true) { return; } $BÔ‰‘·ÔÄ = systemMember::userAuthGroup($EÕµÚ«°); if ($BÔ‰‘·ÔÄ == false) { if ($GLOBALS[_kstr2('._[@TdQDX`iU')] == KOD_GROUP_PATH) { show_json(LNG("\x6e\x6f\x5f\x70\x65\x72\x6d\x69"._kstr2('(ii_')."\x6f\x6e\x5f\x67\x72\x6f\x75\x70"), false); } else { if ($GLOBALS[_kstr2(',a]BVfSFZbkW')] == KOD_GROUP_SHARE) { $Dæ‡…½© = $GLOBALS[base64_decode('Y29uZmln')][_kstr2('/P_Wc^AT[')._kstr2('(h=')._kstr2(',ga6bXWgSf^')][_kstr2('.!')]; } } } else { $Dæ‡…½© = $GLOBALS["\x63\x6f\x6e\x66\x69\x67"]["\x70\x61\x74\x68\x52\x6f\x6c\x65\x47\x72\x6f\x75\x70"][$BÔ‰‘·ÔÄ]; } path_role_check($Dæ‡…½©[base64_decode('YWN0aW9ucw==')]); } function path_role_check($Dæ‡…½©) { if ($GLOBALS[_kstr2('2_U[>`[')] || isset($GLOBALS[base64_decode('a29kUGF0aEE=')._kstr2('/cd2WTWZR')]) && $GLOBALS[_kstr2(',a]BVfS3Zfg5ZZ')."\145\143".base64_decode('aw==')] === true) { return; } $CÖÚ‹ù¹ÏÅ = role_permission_arr($Dæ‡…½©); $GLOBALS["\153\157\144\120\141\164\150\122\157\154\145"."\x47\x72\x6f\x75"."\x70\x41\x75\x74\x68"] = $CÖÚ‹ù¹ÏÅ; if (!isset($CÖÚ‹ù¹ÏÅ[ST . base64_decode('Lg==') . ACT]) && ST != _kstr2('2T_^MQ')) { show_json(LNG(_kstr2('._^`ObUY]cc_Y')._kstr2('2KZ')._kstr2(')XV^icd')), false); } } function role_permission_arr($cÃº¼òî·¬) { $ağë·ºìÃš = array(); $cËªê½ÒÙ  = $GLOBALS[_kstr2('._SV^WY')][base64_decode('cGF0aFJvbGVEZWY=').base64_decode('aQ==')._kstr2(')Zc')]; foreach ($cÃº¼òî·¬ as $DæšŸº¾ÔÊ => $bÕ‚Ì‹»’‘) { if (!$bÕ‚Ì‹»’‘) { continue; } $DÑ¿Èä¢à = $GLOBALS[_kstr2('0fSZ^R]S')]("\72", $DæšŸº¾ÔÊ); if ($GLOBALS[_kstr2('(eYdkj')]($DÑ¿Èä¢à) == 2 && is_array($cËªê½ÒÙ [$DÑ¿Èä¢à[0]]) && is_array($cËªê½ÒÙ [$DÑ¿Èä¢à[0]][$DÑ¿Èä¢à[1]])) { $ağë·ºìÃš = array_merge($ağë·ºìÃš, $cËªê½ÒÙ [$DÑ¿Èä¢à[0]][$DÑ¿Èä¢à[1]]); } } $b¶Ñ¹«èŠƒ = array(); foreach ($ağë·ºìÃš as $bÕ‚Ì‹»’‘) { $b¶Ñ¹«èŠƒ[$bÕ‚Ì‹»’‘] = _kstr2('2'); } return $b¶Ñ¹«èŠƒ; } function check_file_writable_user($E‹ì»Ù‰¢) { if (!isset($GLOBALS["\153\157\144\120\141\164\150\124"."\x79\x70\x65"])) { _DIR($E‹ì»Ù‰¢); } $ağÍÜñ°÷× = base64_decode('ZWRpdG9yLmZpbA==').base64_decode('ZVNhdg==')._kstr2('*Y'); if ($GLOBALS[_kstr2('*g]cFhc')]) { return @is_writable($E‹ì»Ù‰¢); } if ($GLOBALS[_kstr2('0cOVb')][$ağÍÜñ°÷×] != _kstr2('.!')) { return false; } if ($GLOBALS[_kstr2('2[W<P`M@T\\eQ')] == KOD_GROUP_PATH && is_array($GLOBALS[_kstr2(')d`EYiVG]')._kstr2('*`c;Ycfdii5\\h')]) && $GLOBALS[_kstr2('+b^CWgTE[b').base64_decode('bA==')."\x65\x47\x72\x6f\x75\x70\x41\x75\x74\x68"][$ağÍÜñ°÷×] == _kstr2(')&')) { return true; } if ($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"] == '' || $GLOBALS[_kstr2('-`\\AUeREYaj')._kstr2('([')] == KOD_USER_SELF) { return true; } return false; } function spaceSizeCheck() { if (!system_space()) { return; } if ($GLOBALS[_kstr2(')h^dGid')] == 1) { return; } if (isset($GLOBALS[_kstr2('1\\X/QSR_\\R')."\120\141\164\150\111\144"]) && isset($GLOBALS[_kstr2('0]Y>RbO7VR')]) && $GLOBALS[base64_decode('a29kQmVmb3JlUGE=')."\x74\x68\x49"._kstr2('2P')] == $GLOBALS[_kstr2(',a]BVfS;ZV')]) { return; } if ($GLOBALS[_kstr2('1\\X=QaNAU]f')._kstr2('/T')] == KOD_GROUP_SHARE || $GLOBALS[base64_decode('a29kUGF0aFR5')._kstr2('*d')._kstr2('*Y')] == KOD_GROUP_PATH) { systemGroup::spaceCheck($GLOBALS[base64_decode('a29kUGF0aElk')]); } else { if (ST == _kstr2('+[feTX')) { $FÇæÙãÍ©Ù = $GLOBALS[base64_decode('aW4=')]["\x75\x73\x65\x72"]; } else { $FÇæÙãÍ©Ù = $_SESSION[_kstr2('*c_IXYgf')][_kstr2('(ikh[:?')]; } systemMember::spaceCheck($FÇæÙãÍ©Ù); } } function spaceSizeGet($E‹ì»Ù‰¢, $FÔ§ ôƒ) { $D¨‘àí¼šÎ = 0; if (is_file($E‹ì»Ù‰¢)) { $D¨‘àí¼šÎ = get_filesize($E‹ì»Ù‰¢); } else { if (is_dir($E‹ì»Ù‰¢)) { $B©šŒœ»·Œ = _path_info_more($E‹ì»Ù‰¢); $D¨‘àí¼šÎ = $B©šŒœ»·Œ[_kstr2('-ZdVk')]; } else { return "\x6d\x69\x73\x73"; } } return $FÔ§ ôƒ ? $D¨‘àí¼šÎ : -$D¨‘àí¼šÎ; } function spaceInData($E‹ì»Ù‰¢) { if ($GLOBALS["\x73\x75\x62\x73\x74\x72"]($E‹ì»Ù‰¢, 0, $GLOBALS[_kstr2('2`_X^ZQ')](HOME_PATH)) == HOME_PATH || $GLOBALS[base64_decode('c3Vic3Ry')]($E‹ì»Ù‰¢, 0, $GLOBALS[_kstr2(')ihagcZ')](USER_RECYCLE)) == USER_RECYCLE) { return true; } return false; } function spaceSizeChange($fß‹•’¸, $FÔ§ ôƒ = true, $f¢ˆ‡Ì Û = false, $Fé½ÉªëÎ = false) { if (!system_space()) { return; } if ($f¢ˆ‡Ì Û === false) { $f¢ˆ‡Ì Û = $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"]; $Fé½ÉªëÎ = $GLOBALS[_kstr2('2[W<P`M5TP')]; } $fÔ±½›©Ü = spaceSizeGet($fß‹•’¸, $FÔ§ ôƒ); if ($fÔ±½›©Ü == _kstr2('(_cii')) { return false; } if ($f¢ˆ‡Ì Û == KOD_GROUP_SHARE || $f¢ˆ‡Ì Û == KOD_GROUP_PATH) { systemGroup::spaceChange($Fé½ÉªëÎ, $fÔ±½›©Ü); } else { if (ST == _kstr2('+[feTX')) { $FÇæÙãÍ©Ù = $GLOBALS["\151\156"][_kstr2('*gifY')]; } else { $FÇæÙãÍ©Ù = $_SESSION["\x6b\x6f\x64\x55\x73\x65\x72"][base64_decode('dXNlcklE')]; } systemMember::spaceChange($FÇæÙãÍ©Ù, $fÔ±½›©Ü); } } function spaceSizeChangeRemove($fß‹•’¸) { spaceSizeChange($fß‹•’¸, false); } function spaceSizeChangeMove($fµ‹Ÿ‘õîĞ, $cí·åî©ğö) { if (isset($GLOBALS[_kstr2('-`\\3UWVc`AVR')._kstr2(',Zf')._kstr2('(Z?')]) && isset($GLOBALS[_kstr2('0]Y>RbO7VR')])) { if ($GLOBALS[base64_decode('a29kQmVmb3JlUGE=')._kstr2('+[gW<')] == $GLOBALS[_kstr2('(eaFZjW?^Z')] && $GLOBALS[_kstr2('+XUbYXeTC')."\164\150"."\x54\x79\x70"._kstr2(',W')] == $GLOBALS[_kstr2('(eaFZjWJ^fo')._kstr2(',W')]) { return; } spaceSizeChange($cí·åî©ğö, false); spaceSizeChange($cí·åî©ğö, true, $GLOBALS["\142\145\146\157\162\145\120\141\164\150\124\171".base64_decode('cGU=')], $GLOBALS["\x6b\x6f\x64\x42\x65\x66\x6f\x72"._kstr2('.@UQ')._kstr2('2T`')."\111\144"]); } else { spaceSizeChange($cí·åî©ğö); } } function spaceSizeReset() { if (!system_space()) { return; } $f¢ˆ‡Ì Û = isset($GLOBALS[_kstr2('+b^CWgTG[')._kstr2(')enZ')]) ? $GLOBALS[_kstr2('(eaFZjWJ^fo[')] : ''; $Fé½ÉªëÎ = isset($GLOBALS[_kstr2('2[W<P`M5TP')]) ? $GLOBALS["\153\157\144\120\141\164\150\111\144"] : ''; if ($f¢ˆ‡Ì Û == KOD_GROUP_SHARE || $f¢ˆ‡Ì Û == KOD_GROUP_PATH) { systemGroup::spaceChange($Fé½ÉªëÎ); } else { $FÇæÙãÍ©Ù = $_SESSION["\153\157\144\125\163\145\162"][_kstr2('1`b_R16')]; systemMember::spaceChange($FÇæÙãÍ©Ù); } } function init_space_size_hook() { Hook::bind(base64_decode('dXBsb2FkRmk=')._kstr2('-V]V3W')._kstr2('2^[Q'), _kstr2('0^aQOAShW1SSVYQ')); Hook::bind("\165\160\154\157\141\144\106\151\154\145"._kstr2('*5')."\146\164"."\x65\x72", _kstr2('2\\_OM?QfU')."\x65\x43\x68\x61\x6e"."\x67\x65"); Hook::bind(base64_decode('ZXhwbG9yZXI=')."\56\163\145\162\166\145\162\104"."\157\167\156\154\157\141\144"._kstr2('([8e\\[h'), _kstr2(',beUSEWl[5WZ')._kstr2('+VX^')); Hook::bind(_kstr2('2dQX\\^[^QaZ')."\x7a\x69\x70\x42\x65\x66\x6f\x72\x65", "\x73\x70\x61\x63\x65\x53\x69\x7a"."\x65\x43\x68\x65"."\143\153"); Hook::bind(_kstr2(')mZaegdgZ')._kstr2('.j`YU2_VUb'), "\x73\x70\x61\x63\x65\x53\x69\x7a\x65\x43\x68\x65\x63\x6b"); Hook::bind("\x65\x78\x70\x6c\x6f\x72\x65\x72\x2e\x70\x61\x74\x68"."\120"._kstr2('*gUh'), "\x73\x70\x61\x63\x65\x53\x69\x7a\x65\x43\x68"._kstr2('*WY_')); Hook::bind("\145\170\160\154\157\162\145\162"._kstr2('/')._kstr2(',]_')._kstr2(')^[').base64_decode('bGU=')."\102\145\146\157\162\145", _kstr2('.`cSQCUjY3UUX')."\143\153"); Hook::bind(_kstr2('1eRY]_\\_RZQX').base64_decode('aQ==')._kstr2('(8h\\[he['), _kstr2(',beUSEWl[5W')._kstr2('/TWZR')); Hook::bind(_kstr2('+kX_cebeX!')."\x70\x61\x74\x68\x4d\x6f\x76\x65", "\x73\x70\x61\x63\x65\x53\x69\x7a\x65\x43".base64_decode('aGVjaw==')); Hook::bind(_kstr2('-iV]ac`cV^W\\]ZV')._kstr2('0T/Sb`'), "\163\160\141\143\145\123\151\172\145\103\150\141"."\x6e\x67\x65"); Hook::bind(base64_decode('ZXhwbG9yZXI=')._kstr2(')e#V')._kstr2('*\\hc7mdZ5h')."\145\162", base64_decode('c3BhY2VTaXplQw==')._kstr2('+T[ZaX')); Hook::bind("\145\170\160\154\157\162\145\162"."\x2e\x7a\x69"._kstr2(')6ei[gZ'), _kstr2('2\\_OM?QfU/QT')._kstr2(',`SY')."\145"); Hook::bind("\x65\x78\x70\x6c\x6f\x72\x65\x72\x2e\x75"."\156\172"."\151\160\101\146\164\145\162", _kstr2('1]`PN@RgV0RNU')."\x6e\x67\x65"); Hook::bind(_kstr2('+kX_cebeX')."\56\163\145\162\166\145\162\104\157\167\156\154"._kstr2(',Sa')._kstr2('2-P`R^Q'), _kstr2('*dgWUGYn]7Y')."\x68\x61\x6e\x67\x65"); Hook::bind(_kstr2('(n[bfheh[f$')._kstr2(',fS?Zha4WW')._kstr2('.V').base64_decode('b3Jl'), "\163\160\141\143\145\123\151\172\145"._kstr2('+[6VX^')); Hook::bind(_kstr2('1eRY]_\\_R]N')._kstr2('+[gb@XiY4Xge'), _kstr2('(fiYWI[p_9[W^]d')._kstr2('1:Rc\\R')); Hook::bind("\x65\x78\x70\x6c\x6f\x72\x65\x72".base64_decode('LnBhdGhSZW0=')._kstr2('*jc6YZYfcY'), _kstr2(')ehXVHZo^Z').base64_decode('Q2hh')._kstr2(',`')."\147\145"._kstr2('1R?\\ZRc')); if ($GLOBALS[base64_decode('aW4=')][_kstr2('2T_RU0`XQ').base64_decode('ZQ==')."\164".base64_decode('ZQ==')]) { Hook::bind(_kstr2(')mZaegdgZ#')._kstr2('*Ud\\hYFcaYj5')._kstr2('0bT`S'), _kstr2('*dgWUGYn]FYgYhY')); } Hook::bind(_kstr2(',Wfb_S^Wfa5')._kstr2('*a')."\155\157\156\110\145\141\144\145\162\123\164\141\162"."\164", _kstr2('.XSSUE[Uc<b')."\x69"."\x6d".base64_decode('aXQ=')); } function checkUserLimit() { $c±ĞÄ‰½›Ô = $_SESSION[_kstr2('0]YCRSa`')]; if (!$c±ĞÄ‰½›Ô) { return; } $F½ï‹Ğ†ö¯ = systemMemberData(_kstr2(',ZUUWG]We>d_[f[')); $CƒÕ»êÕö = $F½ï‹Ğ†ö¯->get($c±ĞÄ‰½›Ô[_kstr2('*gifY8=')]); if (!$CƒÕ»êÕö) { show_tips(base64_decode('5b2T5YmN54mI5pw=')."\xac\xe5\xb7\xb2\xe7\xbb\x8f\xe8\xb6\x85\xe8"._kstr2('+²')._kstr2('+Úz')._kstr2('+›‡{Ù×ª}«Ü')._kstr2('-Š­àÙ}¨ rÙ').base64_decode('lOezu+euoeeQhuWR')._kstr2('(Û|~{ßÛƒƒ†')._kstr2('*–İ‘')); } } function init_session() { if (!function_exists(_kstr2('+Xfffb\\Ragf')."\x61\x72\x74")) { show_tips(_kstr2('-×Ö~’{ŠÖa™aY¬Ø')._kstr2('-Õu§¬­ØÖ«¢•')."\x20\x28\x50\x48\x50\x20\x6d\x69\x73"._kstr2('+f')._kstr2('1VYO')."\74\142\162\57\76\350\257\267"._kstr2('+–ÙÙs˜’[c!ca\\')."\x69\xef\xbc\x8c\xe9\x9c\x80\xe8\xa6\x81\xe5\xbc\x80"._kstr2('/ÔÕ—ŒÔ†')._kstr2(',,T.!d.0')."\x70\x72\x65\x3e\x73\x65"._kstr2('-dd`Z_d[_`')."\x63\x75\x72\x6c"._kstr2('1RVeSOZ`')._kstr2('+eg\\')._kstr2('1T[')._kstr2('2XMP\\PS')._kstr2('2P\\')._kstr2('0]R^]g[_a')._kstr2('+_`k/_c"Xe').base64_decode('Pjxici8+')); } if (isset($_REQUEST[_kstr2(',USWUeeaFW]')._kstr2('-_')])) { access_token_check($_REQUEST[_kstr2('*WUYWggcH')._kstr2(')`').base64_decode('ZQ==')._kstr2('+a')]); } else { if (isset($_REQUEST[_kstr2('-TRVTddeP')._kstr2('+b')._kstr2('1RX[')])) { access_token_check($_REQUEST[base64_decode('YWNjZXNzX3Rvaw==')._kstr2('+aX')]); } else { @session_name(SESSION_ID); } } $fŞøİ®œõ = @session_save_path(); if (class_exists(_kstr2('2M??Q[`M^')._kstr2('2QS')) || defined(_kstr2(')6HT:E6CEB6:')) || defined(_kstr2(',7EEEA;Q@3B:F')._kstr2('(:U<;K7JB')) || @ini_get("\163\145\163\163\151\157\156\56\163\141"._kstr2('0d')."\x65\x5f\x68\x61\x6e\x64\x6c\x65\x72") != "\146\151\154\145\163" || isset($_SERVER["\110\124\124\120\137\101\120\120\116\101\115\105"])) { } else { chmod_path(KOD_SESSION, 511); @session_save_path(KOD_SESSION); } @session_start(); $_SESSION[base64_decode('a29k')] = 1; @session_write_close(); @session_start(); if (!$_SESSION[_kstr2(')d`Y')]) { @session_save_path($fŞøİ®œõ); @session_start(); $_SESSION["\x6b\x6f\x64"] = 1; @session_write_close(); @session_start(); } if (!$_SESSION["\153\157\144"]) { show_tips("\xe6\x9c\x8d\xe5\x8a\xa1\xe5\x99\xa8".base64_decode('c2Vz')."\163\151\157\156\345\206\231\345".base64_decode('haXlpLHotKUh').base64_decode('IA==')._kstr2('.ccUYc^_').base64_decode('IA==')._kstr2(',dif[WdWd')._kstr2('+eb/eU')."\x2f\x3e" . _kstr2('(¥ŞÜ­v™•Ü›')."\160\150\160\56\151\156\151\347\233\270\345\205\263"."\351\205\215\347\275\256\54\346"."\x9f"._kstr2('1Ô’x‰ÔÔn…ˆ…Óœ')._kstr2('(†ÛÛœ¨­±Ü')._kstr2('-’y×Ö‡™ƒÙ')._kstr2('-“ ')._kstr2('(’ÜÛƒ')._kstr2('0xƒÓÑtpnP*`*,')._kstr2(')gW3$') . base64_decode('c2Vzc2lvbi5zYXZl')."\137\160\141\164\150\75" . $fŞøİ®œõ . "\x3c\x62\x72\x2f\x3e" . _kstr2('.Uccc_Y^QcUfO')."\150\141\156\144\154\145\162\75" . @ini_get("\163\145\163\163\151\157\156\56"."\163\141\166"._kstr2('2KQMTPZQX^')) . base64_decode('PGJyLz4=')); } } function access_token_check($dšÊ‹¬Üó†) { $dŠì¾îŒœÉ = $GLOBALS[_kstr2(',aUX`Y[')][_kstr2('/Tbcc]XBVbhTc\\')][_kstr2('.icdc]UQ@cc').base64_decode('d29yZA==')]; $dŠì¾îŒœÉ = $GLOBALS[_kstr2('.eccRbd')]($GLOBALS["\155\144\65"](_kstr2('+b^8Wckb_').base64_decode('cmVyXw==') . $dŠì¾îŒœÉ), 0, 15); $CÚî¤ãã = Mcrypt::decode($dšÊ‹¬Üó†, $dŠì¾îŒœÉ); if (!$CÚî¤ãã) { show_tips(_kstr2('.SQUScc_D')._kstr2('/TZ]aT^aa')); } session_id($CÚî¤ãã); $GLOBALS["\163\145\163\163\151\157\156\137\156\141\155\145"](SESSION_ID); } function access_token_get() { $CÚî¤ãã = session_id(); $dŠì¾îŒœÉ = $GLOBALS["\x63\x6f\x6e\x66\x69\x67"]["\x73\x65\x74\x74\x69\x6e\x67\x53\x79\x73\x74".base64_decode('ZW0=')][base64_decode('c3lzdGVtUGFzc3dvcmQ=')]; $dŠì¾îŒœÉ = $GLOBALS[_kstr2('-fddSce')]($GLOBALS[_kstr2(',V_\'')](_kstr2(')d`:Yemdag')._kstr2('/aTN') . $dŠì¾îŒœÉ), 0, 15); $D²Ëœ”–¬ = Mcrypt::encode($CÚî¤ãã, $dŠì¾îŒœÉ, 3600 * 24); return $D²Ëœ”–¬; } function init_config() { init_setting(); init_session(); init_space_size_hook(); }
