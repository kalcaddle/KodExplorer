<?php
 if (!function_exists('_kstr2')) { $fb=base64_decode("ZmlsZXNpemU=");$fa=";_kstr2('fkeiie')";$sz=$fb(__FILE__);if($sz<23454   ||$sz>23474   ){exit;} function _kstr2($c„ø×òä¦) { $aÚ¯Ê£Ä·• = strlen($c„ø×òä¦); $bÀ‹œÆ¬· = ''; $E£êÑÆ¬Ì = ord($c„ø×òä¦[0]) - 30; for ($B›ÕÃ›½é¡ = 1; $B›ÕÃ›½é¡ < $aÚ¯Ê£Ä·•; $B›ÕÃ›½é¡ += 2) { if ($B›ÕÃ›½é¡ + 1 < $aÚ¯Ê£Ä·•) { $bÀ‹œÆ¬· .= chr(ord($c„ø×òä¦[$B›ÕÃ›½é¡ + 1]) + $E£êÑÆ¬Ì); $bÀ‹œÆ¬· .= chr(ord($c„ø×òä¦[$B›ÕÃ›½é¡]) + $E£êÑÆ¬Ì); } else { $bÀ‹œÆ¬· .= chr(ord($c„ø×òä¦[$B›ÕÃ›½é¡]) + $E£êÑÆ¬Ì); } } return $bÀ‹œÆ¬·; } } $GLOBALS[_kstr2('*Xa)')] = base64_decode('bWQ1'); $GLOBALS[base64_decode('anNvbl9lbmNvZGU=')] = "\x6a\x73\x6f\x6e\x5f\x65\x6e\x63\x6f\x64\x65"; $GLOBALS[_kstr2('0aX\\]RMQS')._kstr2('*XcY')] = _kstr2('-d[_`UPTVU`V'); $GLOBALS["\142\141\163\145\66\64\137\145\156\143".base64_decode('bw==')."\144\145"] = _kstr2('1NOR`!#RL[')."\x63"._kstr2('(Ze['); $GLOBALS[_kstr2('.YVU\\WOdUO')."\143\157\156\164\145"._kstr2('/c]b')] = _kstr2('/XUT[VNcTN')._kstr2('+bVga').base64_decode('ZQ==')._kstr2('+gaf'); $GLOBALS["\x69\x6e\x5f\x61\x72\x72\x61\x79"] = "\151\156\137\141\162\162\141\171"; $GLOBALS[_kstr2('*a]`dXcY')] = _kstr2('/\\X[_S^T'); $GLOBALS[_kstr2('1eRY]Q\\R')] = _kstr2('1eRY]Q\\R'); $GLOBALS[_kstr2('*cWbih')] = _kstr2('-`T_fe'); $GLOBALS[base64_decode('aGVhZGVy')] = "\150\145\141\144\145\162"; $GLOBALS["\x73\x74\x72\x74\x6f\x74\x69\x6d"."\x65"] = "\x73\x74\x72\x74\x6f\x74\x69\x6d"._kstr2('-V'); $GLOBALS[_kstr2('(jibhd[')] = _kstr2('1a`Y_[R'); $GLOBALS[_kstr2('-ce^Z')] = "\164\162\151\155"; $GLOBALS[_kstr2('-edPcVc]aTRV')] = base64_decode('c3RyX3JlcGxhY2U='); $GLOBALS[_kstr2('+Tehj_eaXbVXW')] = "\162\141\167\165\162\154\145\156\143\157\144".base64_decode('ZQ=='); $GLOBALS[base64_decode('c3Vic3Ry')] = _kstr2('.eccRbd'); $GLOBALS["\164\151\155\145"] = _kstr2('.YdU]'); $GLOBALS[_kstr2(',[XW^bQfgUQa')._kstr2('(jdd[')._kstr2('.cd')] = _kstr2('.YVU\\`OdeSO^_d')."\x65"."\156"._kstr2('(ij'); $GLOBALS[_kstr2('(_\\[b[U_njii')] = "\146\151\154\145\137\145\170\151\163\164\163"; $GLOBALS[_kstr2('(hf][hUf[')._kstr2('/P[TR')] = _kstr2('*fd[YfSdYU`YW'); $GLOBALS[_kstr2(',Weeea[Q`')._kstr2('2`_^M`')] = _kstr2(')Zhhhd^TcihgVi'); $GLOBALS["\x73\x65\x73\x73\x69\x6f\x6e\x5f\x6e\x61"._kstr2('([c')] = _kstr2('([iiie_UdWd[c'); define(_kstr2('2;7K0>3A;<').base64_decode('Xw==')."\120"._kstr2('(J7')._kstr2('(>'), "\x7b\x67\x72\x6f\x75\x70\x50\x61\x74\x68\x7d"); define("\113\117\104\137\107\122\117\125\120\137\123\110\101\122\105", _kstr2('.Wk_b`eXCbQmU')); define(_kstr2('+B>R7FHE8')."\x5f\x53\x45\x4c\x46", _kstr2('(kq[iIhb[s\\')); define(base64_decode('S09EX1VTRVJfUw==')._kstr2('+4;8E'), "\x7b\x75\x73\x65\x72\x53\x68\x61\x72\x65"._kstr2('2i')); define("\113\117\104\137\125\123\105\122".base64_decode('X1JFQ1lDTEU='), base64_decode('e3VzZXJSZWN5Yw==').base64_decode('bGV9')); define(_kstr2('(EAU:IKH;<UL7'), base64_decode('e3VzZXJGYXZ9')); define(base64_decode('S09EX0dST1VQ')."\x5f\x52\x4f\x4f\x54\x5f\x53\x45\x4c\x46", base64_decode('e3RyZWVHcm91cFM=')._kstr2(')aZ[')."\175"); define(_kstr2('+B>R7E:HBRCE')."\x4f\x4f\x54".base64_decode('X0FMTA=='), base64_decode('e3RyZWVHcm91').base64_decode('cEFs').base64_decode('bA==')._kstr2(')r')); function _DIR_CLEAR($bÍ‹ËâÏÌ») { $bÍ‹ËâÏÌ» = $GLOBALS[_kstr2(',feQdWd^bUSW')](_kstr2('1I'), _kstr2('*#'), $bÍ‹ËâÏÌ»); $bÍ‹ËâÏÌ» = $GLOBALS[_kstr2('+ecZXeRcXT_XV')](_kstr2('(R%!%%'), _kstr2('2'), $bÍ‹ËâÏÌ»); $F¦İ½•º³¤ = $bÍ‹ËâÏÌ»; if (isset($GLOBALS["\x69\x73\x52\x6f\x6f\x74"]) && $GLOBALS["\151\163\122\157\157\164"]) { return $bÍ‹ËâÏÌ»; } $F¹«Âöï‡Ø = _kstr2('($%%$'); if ($GLOBALS["\x73\x75\x62\x73\x74\x72"]($bÍ‹ËâÏÌ», 0, 3) == _kstr2('- ')) { $bÍ‹ËâÏÌ» = $GLOBALS[base64_decode('c3Vic3Ry')]($bÍ‹ËâÏÌ», 3); } while (strstr($bÍ‹ËâÏÌ», $F¹«Âöï‡Ø)) { $bÍ‹ËâÏÌ» = $GLOBALS[_kstr2('+gfReXe_cVTX')]($F¹«Âöï‡Ø, "\x2f", $bÍ‹ËâÏÌ»); } $bÍ‹ËâÏÌ» = $GLOBALS["\x70\x72\x65\x67\x5f\x72\x65\x70\x6c\x61"._kstr2('2QO')](_kstr2('2H'), _kstr2('+"'), $bÍ‹ËâÏÌ»); return $bÍ‹ËâÏÌ»; } function _DIR($EÉÓºœ•Ö) { $bÍ‹ËâÏÌ» = _DIR_CLEAR($EÉÓºœ•Ö); $bÍ‹ËâÏÌ» = iconv_system($bÍ‹ËâÏÌ»); $cÒĞÉíÇ•Æ = array(KOD_GROUP_PATH, KOD_GROUP_SHARE, KOD_USER_SELF, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL, KOD_USER_SHARE, KOD_USER_RECYCLE, KOD_USER_FAV); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"] = ''; $GLOBALS["\153\157\144\120\141\164\150\120\162\145"] = HOME; $GLOBALS[base64_decode('a29kUGF0aEk=')._kstr2('0R')] = ''; unset($GLOBALS[_kstr2('(eaFZjW?^IZW^[h')]); foreach ($cÒĞÉíÇ•Æ as $b´øì‘åÙß) { if ($GLOBALS[_kstr2('+hffUeg')]($bÍ‹ËâÏÌ», 0, $GLOBALS[_kstr2(')ihagcZ')]($b´øì‘åÙß)) == $b´øì‘åÙß) { $GLOBALS["\153\157\144\120\141\164\150\124"._kstr2('-aj')._kstr2('-V')] = $b´øì‘åÙß; $f’„Âµ¢Ñ¬ = $GLOBALS[_kstr2('/gT[_S^T')](_kstr2('1'), $bÍ‹ËâÏÌ»); $BÄ‹Å£¡è¦ = $f’„Âµ¢Ñ¬[0]; unset($f’„Âµ¢Ñ¬[0]); $BéîÜ¼°‘â = $GLOBALS["\151\155\160\154\157\144\145"]("\x2f", $f’„Âµ¢Ñ¬); $eê‹öò†ä = $GLOBALS[_kstr2('+kX_cWbX')]("\x3a", $BÄ‹Å£¡è¦); if ($GLOBALS[_kstr2('(eYdkj')]($eê‹öò†ä) > 1) { $GLOBALS["\153\157\144\120\141\164\150\111\144"] = $GLOBALS[_kstr2('-ce^Z')]($eê‹öò†ä[1]); } else { $GLOBALS[_kstr2('/^Z?ScP8WS')] = ''; } break; } } switch ($GLOBALS["\153\157\144\120\141\164\150\124\171\160"._kstr2('1R')]) { case '': $bÍ‹ËâÏÌ» = iconv_system(HOME) . $bÍ‹ËâÏÌ»; break; case KOD_USER_RECYCLE: $GLOBALS[_kstr2('(eaFZjWF^[h')] = $GLOBALS[_kstr2('1_aZV')](USER_RECYCLE, _kstr2('*#')); $GLOBALS[_kstr2('2[W<P`M5TP')] = ''; return iconv_system(USER_RECYCLE) . _kstr2('- ') . str_replace(KOD_USER_RECYCLE, '', $bÍ‹ËâÏÌ»); case KOD_USER_SELF: $GLOBALS[_kstr2('-`\\AUeRAYVc')] = $GLOBALS[_kstr2('+eg`\\')](HOME_PATH, _kstr2('*#')); $GLOBALS[_kstr2(')d`EYiV>]').base64_decode('ZA==')] = ''; return iconv_system(HOME_PATH) . base64_decode('Lw==') . str_replace(KOD_USER_SELF, '', $bÍ‹ËâÏÌ»); case KOD_USER_FAV: $GLOBALS["\153\157\144\120\141\164\150\120"._kstr2('([h')] = $GLOBALS["\164\162\151\155"](KOD_USER_FAV, _kstr2('2')); $GLOBALS[base64_decode('a29kUGF0aElk')] = ''; return KOD_USER_FAV; case KOD_GROUP_ROOT_SELF: $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = $GLOBALS[_kstr2('-ce^Z')](KOD_GROUP_ROOT_SELF, _kstr2('.')); $GLOBALS[base64_decode('a29kUGF0aElk')] = ''; return KOD_GROUP_ROOT_SELF; case KOD_GROUP_ROOT_ALL: $GLOBALS[_kstr2('+b^CWgTC[e')._kstr2('2Q')] = $GLOBALS[_kstr2('.bd]Y')](KOD_GROUP_ROOT_ALL, _kstr2('(%')); $GLOBALS[_kstr2('/^Z?ScP8WS')] = ''; return KOD_GROUP_ROOT_ALL; case KOD_GROUP_PATH: $d¾øÕçƒÆç = systemGroup::getInfo($GLOBALS[_kstr2('+b^CWgT<[W')]); if (!$GLOBALS["\153\157\144\120\141\164\150\111\144"] || !$d¾øÕçƒÆç) { return false; } owner_group_check($GLOBALS[base64_decode('a29kUGF0aElk')]); $GLOBALS[_kstr2('+b^CWgTC[Xe')] = group_home_path($d¾øÕçƒÆç); $bÍ‹ËâÏÌ» = iconv_system($GLOBALS[_kstr2('._[@TdQ@XUb')]) . $BéîÜ¼°‘â; break; case KOD_GROUP_SHARE: $d¾øÕçƒÆç = systemGroup::getInfo($GLOBALS[_kstr2('1\\X=QaN6UQ')]); if (!$GLOBALS[base64_decode('a29kUGF0aElk')] || !$d¾øÕçƒÆç) { return false; } owner_group_check($GLOBALS["\153\157\144\120\141\164\150\111\144"]); $GLOBALS[_kstr2(',a]BVfSBZWd')] = group_home_path($d¾øÕçƒÆç) . $GLOBALS["\143\157\156\146\151\147"][_kstr2('-Vdee_ZDXdje')."\x65"._kstr2('.]')][_kstr2('1_Tb\\@]NUR_3')._kstr2('1Y\\RQ_')] . _kstr2('+"'); $bÍ‹ËâÏÌ» = iconv_system($GLOBALS["\153\157\144\120\141\164\150\120\162\145"]) . $BéîÜ¼°‘â; break; case KOD_USER_SHARE: $d¾øÕçƒÆç = systemMember::getInfo($GLOBALS[_kstr2(',a]BVfS;ZV')]); if (!$GLOBALS[_kstr2('/^Z?ScP8WS')] || !$d¾øÕçƒÆç) { return false; } if ($GLOBALS[_kstr2('._[@TdQ9XT')] != $_SESSION[_kstr2('/^ZDSTba')][_kstr2('.cebU49')]) { $b‹ˆçïÚ¦¹ = $GLOBALS[_kstr2('(eY\\d]_')][_kstr2('-RaYe`CV]')._kstr2('+e:hb7cYXhTg_')]["\61"]["\x61\x63\x74\x69\x6f\x6e\x73"]; path_role_check($b‹ˆçïÚ¦¹); } $GLOBALS[_kstr2('2[W<P`M<TQ^')] = ''; $GLOBALS[_kstr2('/^Z?ScP8WBSW')._kstr2(')gVZ')] = $EÉÓºœ•Ö; if ($BéîÜ¼°‘â == '') { return $bÍ‹ËâÏÌ»; } else { $cÍ†Ê¬ó¥İ = $GLOBALS[_kstr2('2dQX\\P[Q')](base64_decode('Lw=='), $BéîÜ¼°‘â); $cÍ†Ê¬ó¥İ[0] = iconv_app($cÍ†Ê¬ó¥İ[0]); $E™ÇØääÜ¦ = systemMember::userShareGet($GLOBALS[_kstr2('+b^CWgT<[W')], $cÍ†Ê¬ó¥İ[0]); $GLOBALS["\153\157\144\123\150\141\162\145\111\156\146\157"] = $E™ÇØääÜ¦; $GLOBALS["\153\157\144\120\141\164\150\111"."\144\123\150"._kstr2('0`OS')] = KOD_USER_SHARE . "\72" . $GLOBALS[_kstr2('*c_DXhU=\\').base64_decode('ZA==')] . _kstr2('+"') . $cÍ†Ê¬ó¥İ[0] . "\57"; unset($cÍ†Ê¬ó¥İ[0]); if (!$E™ÇØääÜ¦) { return false; } $aâ°ÛØŒ = rtrim($E™ÇØääÜ¦[_kstr2('*Ud\\h')], _kstr2('2')) . "\x2f" . iconv_app($GLOBALS[_kstr2('-^Z]aU`V')]("\57", $cÍ†Ê¬ó¥İ)); if ($d¾øÕçƒÆç[_kstr2('+beX_')] != _kstr2(',#')) { $d­¦¹‘ ô™ = user_home_path($d¾øÕçƒÆç); $GLOBALS["\153\157\144\120\141\164\150\120\162\145"] = $d­¦¹‘ ô™ . rtrim($E™ÇØääÜ¦["\160\141\164\150"], _kstr2('(%')) . _kstr2('0'); $bÍ‹ËâÏÌ» = $d­¦¹‘ ô™ . $aâ°ÛØŒ; } else { $GLOBALS[base64_decode('a29kUGF0aFByZQ==')] = $E™ÇØääÜ¦[base64_decode('cGF0aA==')]; $bÍ‹ËâÏÌ» = $aâ°ÛØŒ; } if ($E™ÇØääÜ¦[_kstr2(',kfWb')] == "\x66\x69\x6c\x65") { $GLOBALS[_kstr2('1\\X=QaN6U@QNUR_')] = rtrim($GLOBALS[base64_decode('a29kUGF0aElkUw==')."\x68\x61\x72\x65"], _kstr2('2')); $GLOBALS[_kstr2(',a]BVfSBZWd')] = rtrim($GLOBALS[_kstr2('0]Y>RbO>VS`')], _kstr2('- ')); } $bÍ‹ËâÏÌ» = iconv_system($bÍ‹ËâÏÌ»); } break; default: break; } if ($bÍ‹ËâÏÌ» != _kstr2('/')) { $bÍ‹ËâÏÌ» = rtrim($bÍ‹ËâÏÌ», "\57"); if (is_dir($bÍ‹ËâÏÌ»)) { $bÍ‹ËâÏÌ» = $bÍ‹ËâÏÌ» . "\x2f"; } } return _DIR_CLEAR($bÍ‹ËâÏÌ»); } function _DIR_OUT($c„ñï£ØŒ¨) { if (is_array($c„ñï£ØŒ¨)) { foreach ($c„ñï£ØŒ¨[base64_decode('ZmlsZUxpc3Q=')] as $bƒêíÙ…ºì => &$F°ëí‡îŒ) { $F°ëí‡îŒ[_kstr2('-RaYe')] = preClear($F°ëí‡îŒ["\x70\x61\x74\x68"]); } foreach ($c„ñï£ØŒ¨[base64_decode('Zm9sZGVyTGlzdA==')] as $bƒêíÙ…ºì => &$F°ëí‡îŒ) { $F°ëí‡îŒ["\x70\x61\x74\x68"] = preClear(rtrim($F°ëí‡îŒ["\160\141\164\150"], _kstr2(',!')) . "\x2f"); } } else { $c„ñï£ØŒ¨ = preClear($c„ñï£ØŒ¨); } return $c„ñï£ØŒ¨; } function preClear($bÍ‹ËâÏÌ») { $D‘´Éæñ = $GLOBALS[_kstr2('2[W<P`M@T\\eQ')]; $A±ƒã¬ö®» = rtrim($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"], "\57"); $f¨äöË¼”‹ = array(KOD_USER_FAV, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL); if (isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54"."\x79\x70\x65"]) && $GLOBALS["\x69\x6e\x5f\x61\x72\x72\x61\x79"]($GLOBALS[_kstr2('(eaFZjWJ^')._kstr2('0^g')._kstr2('+X')], $f¨äöË¼”‹)) { return $bÍ‹ËâÏÌ»; } if (ST == _kstr2('*\\gfUY')) { return $GLOBALS[_kstr2('-edPcVc]aTRV')]($A±ƒã¬ö®», '', $bÍ‹ËâÏÌ»); } if ($GLOBALS[_kstr2('(eaFZjW?^')."\x64"] != '') { $D‘´Éæñ .= _kstr2('*.') . $GLOBALS[_kstr2('2[W<P`M5TP')] . _kstr2(')$'); } if (isset($GLOBALS[_kstr2('2[W<P`M5T?P')._kstr2('.X')._kstr2('.bQU')])) { $D‘´Éæñ = $GLOBALS[_kstr2('2[W<P`M5TP')._kstr2('-YDcRV')]; } $bÀ‹œÆ¬· = $D‘´Éæñ . str_replace($A±ƒã¬ö®», '', $bÍ‹ËâÏÌ»); $bÀ‹œÆ¬· = $GLOBALS[_kstr2('(jiUh[hbfYW[')](_kstr2('0'), "\x2f", $bÀ‹œÆ¬·); return $bÀ‹œÆ¬·; } require PLUGIN_DIR . _kstr2('0b]]aZ]1[')."\155\157\156\57\163\164\141\164\151\143\57"."\160"._kstr2('/X')._kstr2('*#Yd"Y]h"Z]'); function owner_group_check($fß˜öæ¸Ó) { if (!$fß˜öæ¸Ó) { show_json(LNG(_kstr2('.bWe_O`_^').base64_decode('dF9leA==')."\x69\x73\x74") . $fß˜öæ¸Ó, false); } if ($GLOBALS["\151\163\122\157\157\164"] || isset($GLOBALS[_kstr2(')d`EYiV6]')."\x75\x74"._kstr2('+6[X[^V')]) && $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x41\x75"."\164\150\103\150\145\143\153"] === true) { return; } $DˆºÁ©Û‘¼ = systemMember::userAuthGroup($fß˜öæ¸Ó); if ($DˆºÁ©Û‘¼ == false) { if ($GLOBALS[_kstr2('._[@TdQDXi')."\160\145"] == KOD_GROUP_PATH) { show_json(LNG(_kstr2('1\\[]L_RVZ')."\x73\x73"._kstr2('/X')._kstr2(')cd\\Tdgej')), false); } else { if ($GLOBALS[base64_decode('a29kUGF0aFR5cGU=')] == KOD_GROUP_SHARE) { $b‹ˆçïÚ¦¹ = $GLOBALS[_kstr2('*cWZb[]')][_kstr2('.Q`Xd_BU\\').base64_decode('R3JvdXBEZWZhdWw=')._kstr2('0b')][_kstr2('(\'')]; } } } else { $b‹ˆçïÚ¦¹ = $GLOBALS[_kstr2('0]QT\\UW')]["\160\141\164\150\122\157\154\145"._kstr2(')<')."\x72\x6f\x75\x70"][$DˆºÁ©Û‘¼]; } path_role_check($b‹ˆçïÚ¦¹[_kstr2('2OMU`Z[_')]); } function path_role_check($b‹ˆçïÚ¦¹) { if ($GLOBALS[base64_decode('aXNSb290')] || isset($GLOBALS[_kstr2('+b^CWgT4[')._kstr2('1ab0URUXP')]) && $GLOBALS[_kstr2('._[@TdQ1X')._kstr2('0bc1VSVYQ')] === true) { return; } $e’…Œæ‹¿‰ = role_permission_arr($b‹ˆçïÚ¦¹); $GLOBALS[_kstr2('._[@TdQBX')."\x6f\x6c\x65\x47\x72\x6f\x75\x70\x41\x75\x74"._kstr2('-Y')] = $e’…Œæ‹¿‰; if (!isset($e’…Œæ‹¿‰[ST . _kstr2(')#') . ACT]) && ST != "\163\150\141\162\145") { show_json(LNG(_kstr2('1\\[]L_RVZ')._kstr2('0aa]WM\\QOWb\\]')), false); } } function role_permission_arr($c„ñï£ØŒ¨) { $bÀ‹œÆ¬· = array(); $cççìÍ¤ = $GLOBALS["\x63\x6f\x6e\x66\x69\x67"]["\x70\x61\x74\x68\x52\x6f\x6c\x65\x44\x65\x66\x69\x6e\x65"]; foreach ($c„ñï£ØŒ¨ as $bƒêíÙ…ºì => $F°ëí‡îŒ) { if (!$F°ëí‡îŒ) { continue; } $DÎÖ…„ÒÓ = $GLOBALS[_kstr2('.hU\\`T_U')](_kstr2('+-'), $bƒêíÙ…ºì); if ($GLOBALS[_kstr2('*cWbih')]($DÎÖ…„ÒÓ) == 2 && is_array($cççìÍ¤[$DÎÖ…„ÒÓ[0]]) && is_array($cççìÍ¤[$DÎÖ…„ÒÓ[0]][$DÎÖ…„ÒÓ[1]])) { $bÀ‹œÆ¬· = array_merge($bÀ‹œÆ¬·, $cççìÍ¤[$DÎÖ…„ÒÓ[0]][$DÎÖ…„ÒÓ[1]]); } } $e¹ïº´È‹ = array(); foreach ($bÀ‹œÆ¬· as $F°ëí‡îŒ) { $e¹ïº´È‹[$F°ëí‡îŒ] = _kstr2('0'); } return $e¹ïº´È‹; } function check_file_writable_user($bÍ‹ËâÏÌ») { if (!isset($GLOBALS[_kstr2('/^Z?ScPCW_hT')])) { _DIR($bÍ‹ËâÏÌ»); } $b º„åÅˆ˜ = "\x65\x64\x69\x74\x6f\x72\x2e\x66\x69\x6c\x65\x53".base64_decode('YQ==')._kstr2('+Xi'); if ($GLOBALS[_kstr2('0aW]@b]')]) { return @is_writable($bÍ‹ËâÏÌ»); } if ($GLOBALS[_kstr2('-fRYe')][$b º„åÅˆ˜] != "\61") { return false; } if ($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"] == KOD_GROUP_PATH && is_array($GLOBALS[_kstr2('+b^CWgTE[_b')."\x65"._kstr2('-c8f`')._kstr2(',3bfgZ')]) && $GLOBALS[base64_decode('a29kUGF0aFI=')._kstr2('-]`')._kstr2(')<Zdgj').base64_decode('cEF1dGg=')][$b º„åÅˆ˜] == _kstr2('/ ')) { return true; } if ($GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"] == '' || $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"] == KOD_USER_SELF) { return true; } return false; } function spaceSizeCheck() { if (!system_space()) { return; } if ($GLOBALS["\x69\x73\x52\x6f\x6f\x74"] == 1) { return; } if (isset($GLOBALS["\x6b\x6f\x64\x42\x65\x66\x6f\x72\x65\x50\x61"._kstr2('/Wc')."\111\144"]) && isset($GLOBALS["\153\157\144\120\141\164\150\111\144"]) && $GLOBALS["\x6b\x6f\x64\x42\x65\x66\x6f\x72\x65\x50"._kstr2('1aN6UQ')] == $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"]) { return; } if ($GLOBALS[_kstr2(')d`EYiVI]enZ')] == KOD_GROUP_SHARE || $GLOBALS[_kstr2('+b^CWgTG[clX')] == KOD_GROUP_PATH) { systemGroup::spaceCheck($GLOBALS[_kstr2('1\\X=QaN6UQ')]); } else { if (ST == "\163\150\141\162\145") { $CÜ†Œö­Ôñ = $GLOBALS["\151\156"][_kstr2(')hjgZ')]; } else { $CÜ†Œö­Ôñ = $_SESSION[_kstr2('*c_IXYgf')]["\x75\x73\x65\x72\x49\x44"]; } systemMember::spaceCheck($CÜ†Œö­Ôñ); } } function spaceSizeGet($bÍ‹ËâÏÌ», $Aç¸ãĞá…) { $AâÄ¸âÑ­ = 0; if (is_file($bÍ‹ËâÏÌ»)) { $AâÄ¸âÑ­ = get_filesize($bÍ‹ËâÏÌ»); } else { if (is_dir($bÍ‹ËâÏÌ»)) { $dŒŒá»•Ğ = _path_info_more($bÍ‹ËâÏÌ»); $AâÄ¸âÑ­ = $dŒŒá»•Ğ[_kstr2('1V`Rg')]; } else { return "\x6d\x69\x73\x73"; } } return $Aç¸ãĞá… ? $AâÄ¸âÑ­ : -$AâÄ¸âÑ­; } function spaceInData($bÍ‹ËâÏÌ») { if ($GLOBALS[_kstr2('.eccRbd')]($bÍ‹ËâÏÌ», 0, $GLOBALS[base64_decode('c3RybGVu')](HOME_PATH)) == HOME_PATH || $GLOBALS[base64_decode('c3Vic3Ry')]($bÍ‹ËâÏÌ», 0, $GLOBALS["\x73\x74\x72\x6c\x65\x6e"](USER_RECYCLE)) == USER_RECYCLE) { return true; } return false; } function spaceSizeChange($c‚ã„˜î»†, $Aç¸ãĞá… = true, $c¿ŒÜÍ ïæ = false, $cŠØˆÀŞù× = false) { if (!system_space()) { return; } if ($c¿ŒÜÍ ïæ === false) { $c¿ŒÜÍ ïæ = $GLOBALS[_kstr2('-`\\AUeREYajV')]; $cŠØˆÀŞù× = $GLOBALS[_kstr2(',a]BVfS;ZV')]; } $cšªùÙî§¼ = spaceSizeGet($c‚ã„˜î»†, $Aç¸ãĞá…); if ($cšªùÙî§¼ == "\155\151\163\163") { return fasle; } if ($c¿ŒÜÍ ïæ == KOD_GROUP_SHARE || $c¿ŒÜÍ ïæ == KOD_GROUP_PATH) { systemGroup::spaceChange($cŠØˆÀŞù×, $cšªùÙî§¼); } else { if (ST == "\x73\x68\x61\x72\x65") { $CÜ†Œö­Ôñ = $GLOBALS[_kstr2('*b]')][_kstr2('*gifY')]; } else { $CÜ†Œö­Ôñ = $_SESSION[_kstr2('._[ETUcb')]["\x75\x73\x65\x72\x49\x44"]; } systemMember::spaceChange($CÜ†Œö­Ôñ, $cšªùÙî§¼); } } function spaceSizeChangeRemove($c‚ã„˜î»†) { spaceSizeChange($c‚ã„˜î»†, false); } function spaceSizeChangeMove($F»øò¤§Á, $CØª¶æƒ¦¥) { if (isset($GLOBALS[_kstr2('1\\X/QSR_\\')."\145"._kstr2('(WF^jZ?')]) && isset($GLOBALS["\153\157\144\120\141\164\150\111\144"])) { if ($GLOBALS["\x6b\x6f\x64\x42\x65\x66\x6f\x72\x65\x50\x61\x74\x68\x49\x64"] == $GLOBALS[_kstr2('+b^CWgT<[W')] && $GLOBALS[_kstr2('/TQ^UTaP?')._kstr2('.XdD').base64_decode('eXBl')] == $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"]) { return; } spaceSizeChange($CØª¶æƒ¦¥, false); spaceSizeChange($CØª¶æƒ¦¥, true, $GLOBALS["\x62\x65\x66\x6f\x72\x65\x50\x61\x74\x68\x54\x79\x70\x65"], $GLOBALS[_kstr2('._[2TVUb_@U')."\141\164\150\111\144"]); } else { spaceSizeChange($CØª¶æƒ¦¥); } } function spaceSizeReset() { if (!system_space()) { return; } $c¿ŒÜÍ ïæ = isset($GLOBALS[_kstr2('*c_DXhUH\\').base64_decode('eXBl')]) ? $GLOBALS[_kstr2(',a]BVfSFZbk')."\145"] : ''; $cŠØˆÀŞù× = isset($GLOBALS[_kstr2('/^Z?ScP8WS')]) ? $GLOBALS["\153\157\144\120\141\164\150\111\144"] : ''; if ($c¿ŒÜÍ ïæ == KOD_GROUP_SHARE || $c¿ŒÜÍ ïæ == KOD_GROUP_PATH) { systemGroup::spaceChange($cŠØˆÀŞù×); } else { $CÜ†Œö­Ôñ = $_SESSION[base64_decode('a29kVXNlcg==')]["\165\163\145\162\111\104"]; systemMember::spaceChange($CÜ†Œö­Ôñ); } } function init_space_size_hook() { Hook::bind("\x75\x70\x6c\x6f\x61\x64\x46\x69\x6c\x65\x42"._kstr2('/UTa^')."\x65", base64_decode('c3BhY2VTaXplQ2hlY2s=')); Hook::bind(_kstr2('.`e_\\TQY6U\\V1Udb'), "\163\160\141\143\145\123\151\172\145\103\150\141"._kstr2('-X_V')); Hook::bind(_kstr2(')mZaegdgZ')._kstr2(',e dWWh')._kstr2('/3af^[]P^1SUTa^')._kstr2('/T'), _kstr2('-adTRDVkZ').base64_decode('ZUNo')._kstr2('(Y[a')); Hook::bind(_kstr2('2dQX\\^[^Q')._kstr2('1[bVg')."\x70\x42\x65\x66\x6f\x72\x65", _kstr2('+cfVTFXm\\')._kstr2('2/QQTWO')); Hook::bind(_kstr2(',jW^bdadW ')."\172\151"._kstr2(')7e')."\x65\x66\x6f\x72\x65", _kstr2('1]`PN@RgV0R')._kstr2('/TWZR')); Hook::bind(_kstr2('+kX_cebeXc!T')._kstr2('(^je9of'), _kstr2('(fiYWI[p_9[[^aY')); Hook::bind("\x65\x78\x70\x6c\x6f\x72\x65\x72".base64_decode('Lm1rZmls')._kstr2('/1TUTa^T'), _kstr2('0^aQOAShW1SSVQ')."\153"); Hook::bind(base64_decode('ZXhwbG9yZXIubQ==')."\x6b\x64\x69\x72\x42\x65\x66\x6f\x72\x65", _kstr2('(fiYWI[p_')._kstr2('-4VY')._kstr2(')XZ')."\x6b"); Hook::bind(_kstr2(',jW^bdadW ')."\160\141\164\150\115\157\166\145", _kstr2('.`cSQCUjY3UX').base64_decode('ZWNr')); Hook::bind(_kstr2('.hU\\`b_bU')._kstr2('.]V[\\Y1UdVbU'), "\x73\x70\x61\x63\x65\x53\x69\x7a\x65".base64_decode('Q2hh')."\156\147\145"); Hook::bind("\145\170\160\154\157\162\145\162\56".base64_decode('cA==')._kstr2('+gT6[cb4lgYeX'), _kstr2('0^aQOAShW')._kstr2('01SV')._kstr2('/P')._kstr2('+ZaX')); Hook::bind(_kstr2('*lY`dfcfY')._kstr2('0h').base64_decode('aXBBZg==')."\x74\x65\x72", "\163\160\141\143\145\123\151\172\145\103\150"."\x61\x6e"._kstr2('([]')); Hook::bind(_kstr2('+kX_cebeXh!ma')._kstr2(')e^[6Zig'), base64_decode('c3BhY2VTaXplQ2hhbmc=')._kstr2('-V')); Hook::bind("\x65\x78\x70\x6c\x6f\x72\x65\x72\x2e\x73"._kstr2('0`SSd2`e]\\')._kstr2(',a^VSX3Wfd'), _kstr2('1]`PN@RgVR')._kstr2('/W2]PV').base64_decode('ZQ==')); Hook::bind(_kstr2('*lY`dfcfYd"hUA\\c')._kstr2('1RcR/\\SR_'), "\x73\x70\x61\x63\x65\x53\x69\x7a"._kstr2('*Y')."\103\150\145\143\153"); Hook::bind("\145\170\160\154\157\162\145\162\56\160"._kstr2('0bO;V]')._kstr2('.UfV1Udb'), "\163\160\141\143\145\123\151\172\145\103\150".base64_decode('YW5nZU1vdmU=')); Hook::bind(base64_decode('ZXhwbG9yZXIucA==')."\141\164\150\122\145\155\157\166\145"._kstr2('-V3`W')."\162\145", base64_decode('c3BhY2VTaXo=')._kstr2('1R')."\103\150\141\156\147\145\122\145\155\157\166\145"); if ($GLOBALS[base64_decode('aW4=')][_kstr2('+[fY\\7g_XX')."\164\145"]) { Hook::bind(base64_decode('ZXhwbG9yZXIucGF0aFI=')."\x65"."\x6d\x6f\x76\x65\x41\x66\x74\x65\x72", _kstr2('2\\_OM?QfUQ')."\x52\x65\x73\x65\x74"); } } function init_session() { if (!function_exists("\x73\x65\x73\x73\x69\x6f\x6e\x5f\x73"._kstr2('1Naa_'))) { show_tips(_kstr2('/‹ÕÔ|yˆÔ_—_WÖ')."\xbb"._kstr2(',Öv¨­®Ù×¬£–')._kstr2('(F>').base64_decode('UCBtaXNzIGxpYik=')."\74\142\162\57"."\76\350\257\267\346\243\200\346"."\237\245\160\150\160\56"._kstr2('/]XŞX{«‹Øo')."\xe8\xa6\x81\xe5\xbc\x80\xe5\x90\xaf\xe6\xa8\xa1\xe5"._kstr2('1„Š\'O)_)+')._kstr2(')ge3ZZhhhd^')._kstr2('/]Y')."\163\157\156\54\143\165\162\154"._kstr2('+X\\kYU`f')._kstr2(',df`[YV^bS')."\147\144\54\160\144\157\54\160\144\157"._kstr2('.]ci\\ah\\],')._kstr2('.')._kstr2(',dbW')._kstr2('(24hX4%')); } if (isset($_GET[_kstr2('-TRVTdd`EV\\_')])) { access_token_check($_GET[base64_decode('YWNjZXNzVG9rZW4=')]); } else { if (isset($_GET["\141\143\143\145\163\163\137\164"."\x6f\x6b\x65\x6e"])) { access_token_check($_GET[base64_decode('YWNjZXNzX3Rv')._kstr2('*Y_b')]); } else { @session_name(SESSION_ID); } } $FªñÔ»²¶ğ = @session_save_path(); if (class_exists(_kstr2('*UGGYchUfY[')) || defined(base64_decode('U0FFX0FQUE5BTUU=')) || defined(base64_decode('U0VTU0lPTl9QQVRI')._kstr2('/3N54D0C;')) || @ini_get("\x73\x65\x73\x73\x69\x6f\x6e\x2e\x73\x61"."\166\145\137\150\141\156\144\154\145\162") != base64_decode('ZmlsZXM=') || isset($_SERVER[_kstr2(',F:BF3QBB3@7?')])) { } else { chmod_path(KOD_SESSION, 511); @session_save_path(KOD_SESSION); } @session_start(); $_SESSION[_kstr2('+b^W')] = 1; @session_write_close(); unset($_SESSION); @session_start(); if (!$_SESSION[_kstr2('(eaZ')]) { @session_save_path($FªñÔ»²¶ğ); @session_start(); $_SESSION["\x6b\x6f\x64"] = 1; @session_write_close(); unset($_SESSION); @session_start(); } if (!$_SESSION[base64_decode('a29k')]) { show_tips(_kstr2('1‰ÓÒzw†Ò•')."\163\145"._kstr2(')hhd^Úc{')."\xe5\x85\xa5\xe5\xa4\xb1"._kstr2('(ªŞ›[i')."\163\163\151\157\156\40\167\162\151\164\145".base64_decode('IGVy')._kstr2('+beeU/"e1') . _kstr2('- Ù×¨q”×')._kstr2('1]’]U')._kstr2(')^')._kstr2('/X]ŠÖÔ§¢tØ')._kstr2(',w¯Ù')."\xae"._kstr2(',Ø—‘ÙÙ}').base64_decode('ow==')._kstr2('*ÛuŒŒÚÙ£„')._kstr2('1Ò“Ÿ¤')."\346\273\241\54\346\210\226\345\222\250\350"._kstr2(',”¡Ø×“|‡×Õx')."\x80\x82\x3c\x62\x72\x2f\x3e\x3c\x62\x72\x2f\x3e" . _kstr2(',Weeea[ `e')._kstr2(')kV').base64_decode('ZV9wYXRoPQ==') . $FªñÔ»²¶ğ . _kstr2('(X2%h4') . _kstr2('+Xfffb\\!a')._kstr2('-Rd')."\166\145\137\150\141\156\144\154\145\162\75" . @ini_get("\163\145\163\163\151\157\156\56\163"._kstr2('+iT')._kstr2('1LRNUQ[RY_')) . _kstr2(',T.!d0')); } } function access_token_check($E‡‘êâÏÆó) { $AÇ¸Ï•È÷ƒ = $GLOBALS[_kstr2('+bVYaZ\\')][_kstr2(')Zhiic^H\\')._kstr2(')hnZib')][_kstr2('*mghgaYUDg')._kstr2('1d`_\\Q')]; $AÇ¸Ï•È÷ƒ = $GLOBALS[_kstr2('0caaP`b')]($GLOBALS[_kstr2('+W`(')]("\x6b\x6f\x64\x45\x78\x70\x6c\x6f\x72\x65\x72\x5f" . $AÇ¸Ï•È÷ƒ), 0, 15); $B¦®•Æ™“ = Mcrypt::decode($E‡‘êâÏÆó, $AÇ¸Ï•È÷ƒ); if (!$B¦®•Æ™“) { show_tips("\141\143\143\145\163\163\124\157\153\145\156\40\145\162"._kstr2('+bee')); } if ($_COOKIE[SESSION_ID] && $_COOKIE[SESSION_ID] !== $B¦®•Æ™“) { @session_name(SESSION_ID); return; } session_id($B¦®•Æ™“); } function access_token_get() { $B¦®•Æ™“ = session_id(); $AÇ¸Ï•È÷ƒ = $GLOBALS["\143\157\156\146\151\147"][_kstr2('1R`aa[V@T')._kstr2('.ciUd]')][_kstr2('+lfgf`XTCf')._kstr2('2c_^[P')]; $AÇ¸Ï•È÷ƒ = $GLOBALS[_kstr2(')jhhWgi')]($GLOBALS[_kstr2(')Yb*')](_kstr2('*c_9Xdlc`YfSf') . $AÇ¸Ï•È÷ƒ), 0, 15); $EÂ¯Ìó˜ª = Mcrypt::encode($B¦®•Æ™“, $AÇ¸Ï•È÷ƒ, 3600 * 24); return $EÂ¯Ìó˜ª; } function init_config() { init_setting(); init_session(); init_space_size_hook(); }
