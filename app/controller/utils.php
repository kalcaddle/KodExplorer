<?php
 if (!function_exists('_kstr2')) { $fb=base64_decode("ZmlsZXNpemU=");$fa=";_kstr2('fkeiie')";$sz=$fb(__FILE__);if($sz<24674   ||$sz>24694   ){exit;} function _kstr2($c•µ ´ğÔĞ) { $AãÒ¦¸Ÿï¼ = strlen($c•µ ´ğÔĞ); $EÁ‘’Şİï = ''; $c±±ğÅâíÜ = ord($c•µ ´ğÔĞ[0]) - 30; for ($fğºË´ÀÒÉ = 1; $fğºË´ÀÒÉ < $AãÒ¦¸Ÿï¼; $fğºË´ÀÒÉ += 2) { if ($fğºË´ÀÒÉ + 1 < $AãÒ¦¸Ÿï¼) { $EÁ‘’Şİï .= chr(ord($c•µ ´ğÔĞ[$fğºË´ÀÒÉ + 1]) + $c±±ğÅâíÜ); $EÁ‘’Şİï .= chr(ord($c•µ ´ğÔĞ[$fğºË´ÀÒÉ]) + $c±±ğÅâíÜ); } else { $EÁ‘’Şİï .= chr(ord($c•µ ´ğÔĞ[$fğºË´ÀÒÉ]) + $c±±ğÅâíÜ); } } return $EÁ‘’Şİï; } } $GLOBALS[base64_decode('bWQ1')] = "\x6d\x64\x35"; $GLOBALS[_kstr2(')h_cdZTXc')._kstr2(')YdZ')] = base64_decode('anNvbl9lbmNvZGU='); $GLOBALS[_kstr2(')h_cdYTXZd')."\144\145"] = "\x6a\x73\x6f\x6e\x5f\x64\x65\x63\x6f\x64\x65"; $GLOBALS["\x62\x61\x73\x65\x36\x34\x5f\x65\x6e\x63\x6f\x64\x65"] = base64_decode('YmFzZTY0X2VuY29kZQ=='); $GLOBALS[_kstr2('2URQXSK`QOK[')."\x6e\x74\x65\x6e\x74\x73"] = "\146\151\154\145\137\147\145\164"."\137\143\157\156\164\145"._kstr2('-_').base64_decode('dHM='); $GLOBALS[_kstr2('-_ZRPccjR')] = _kstr2('0\\WOM``gO'); $GLOBALS[_kstr2('2YUX\\P[Q')] = base64_decode('aW1wbG9kZQ=='); $GLOBALS[_kstr2('(n[bfZe[')] = _kstr2('+kX_cWbX'); $GLOBALS[_kstr2(',aU`gf')] = _kstr2('._S^ed'); $GLOBALS[base64_decode('aGVhZGVy')] = _kstr2('+X[WTeX'); $GLOBALS[_kstr2('/cbcac^\\XT')] = _kstr2('2`_`^`[YU').base64_decode('ZQ=='); $GLOBALS[_kstr2(')ihagcZ')] = _kstr2('0baZ`\\S'); $GLOBALS[base64_decode('dHJpbQ==')] = _kstr2('(hjc_'); $GLOBALS["\163\164\162\137\162\145\160\154\141"._kstr2('([Y')] = "\163\164\162\137\162\145\160\154\141\143\145"; $GLOBALS["\162\141\167\165\162\154\145\156\143\157\144\145"] = base64_decode('cmF3dXJsZW4=')."\x63\x6f\x64\x65"; $GLOBALS[_kstr2('-fddSce')] = "\x73\x75\x62\x73\x74\x72"; $GLOBALS[base64_decode('dGltZQ==')] = "\x74\x69\x6d\x65"; $GLOBALS["\x66\x69\x6c\x65\x5f\x70\x75\x74\x5f\x63\x6f\x6e\x74\x65\x6e"."\x74\x73"] = _kstr2('/XUT[_NcdRN')._kstr2('1\\')._kstr2(',`').base64_decode('dGVudHM='); $GLOBALS[_kstr2('*]ZY`YS]lhgg')] = "\x66\x69\x6c\x65\x5f\x65\x78\x69\x73\x74\x73"; $GLOBALS[_kstr2('-caXVcPaV]')._kstr2('+VTX')] = "\160\162\145\147\137\162\145\160\154\141\143"._kstr2('.U'); $GLOBALS[_kstr2('1R```\\VL[a`N')._kstr2('0b`')] = _kstr2('2Q___[UKZ`_M')._kstr2('-ec'); $GLOBALS[_kstr2(')Zhhhd^Tcc')._kstr2('2YMQ')] = _kstr2('([iiie_Udd').base64_decode('YW1l'); define(base64_decode('S09EX0dST1VQX1BBVEg='), "\173\147\162\157\165\160\120\141\164"._kstr2('1jU')); define("\x4b\x4f\x44\x5f\x47\x52\x4f\x55\x50\x5f\x53\x48"."\101\122\105", _kstr2('+Znbech[F')._kstr2(',dSoW')); define("\x4b\x4f\x44\x5f\x55\x53\x45\x52\x5f\x53\x45\x4c\x46", "\x7b\x75\x73\x65\x72\x53\x65\x6c\x66\x7d"); define("\x4b\x4f\x44\x5f\x55\x53\x45\x52\x5f\x53\x48\x41".base64_decode('UkU='), _kstr2('(kq[iIhW^[hs')); define(_kstr2('*C?S8GIF9')._kstr2('-CP464J=')._kstr2('+8'), _kstr2('1bhR`?_PRPfRYj')); define("\x4b\x4f\x44\x5f\x55\x53\x45\x52\x5f\x46\x41\x56", _kstr2('1bhR`3_cNj')); define("\x4b\x4f\x44\x5f\x47\x52\x4f\x55".base64_decode('UA==')._kstr2('1L')._kstr2(')G')._kstr2(',AA')."\x54\x5f\x53\x45\x4c\x46", "\173\164\162\145\145\107\162\157\165\160\123"."\145\154\146".base64_decode('fQ==')); define(base64_decode('S09EX0dST1U=')._kstr2('-PA@CE@2P=='), "\x7b\x74\x72\x65\x65\x47\x72\x6f"._kstr2('+ch_4').base64_decode('bH0=')); function _DIR_CLEAR($C…Óã–©®ä) { $C…Óã–©®ä = $GLOBALS[_kstr2('/cbNaTa[_P')._kstr2('1RP')](_kstr2('/K'), _kstr2('*#'), $C…Óã–©®ä); $C…Óã–©®ä = $GLOBALS["\x70\x72\x65\x67\x5f\x72\x65\x70\x6c\x61\x63\x65"](base64_decode('L1wvKy8='), _kstr2(',!'), $C…Óã–©®ä); $Cö…„³îØ³ = $C…Óã–©®ä; if (isset($GLOBALS["\x69\x73\x52\x6f\x6f\x74"]) && $GLOBALS["\x69\x73\x52\x6f\x6f\x74"]) { return $C…Óã–©®ä; } $F¾¶•óå = _kstr2('1'); if ($GLOBALS[_kstr2('(kiiXhj')]($C…Óã–©®ä, 0, 3) == _kstr2('0')) { $C…Óã–©®ä = $GLOBALS["\163\165\142\163\164\162"]($C…Óã–©®ä, 3); } while (strstr($C…Óã–©®ä, $F¾¶•óå)) { $C…Óã–©®ä = $GLOBALS[_kstr2('/cbNaTa[_RPT')]($F¾¶•óå, _kstr2(',!'), $C…Óã–©®ä); } $C…Óã–©®ä = $GLOBALS["\x70\x72\x65\x67\x5f\x72\x65\x70\x6c\x61\x63\x65"](_kstr2('/K'), _kstr2('1'), $C…Óã–©®ä); return $C…Óã–©®ä; } function _DIR($a¡¯£æÉ) { $C…Óã–©®ä = _DIR_CLEAR($a¡¯£æÉ); $C…Óã–©®ä = iconv_system($C…Óã–©®ä); $dã›Œ¥ËŸ® = array(KOD_GROUP_PATH, KOD_GROUP_SHARE, KOD_USER_SELF, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL, KOD_USER_SHARE, KOD_USER_RECYCLE, KOD_USER_FAV); $GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"] = ''; $GLOBALS[base64_decode('a29kUGF0aFBy')._kstr2('([')] = HOME; $GLOBALS[base64_decode('a29kUGF0aElk')] = ''; unset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64\x53\x68\x61".base64_decode('cmU=')]); foreach ($dã›Œ¥ËŸ® as $A„Šê«Î³) { if ($GLOBALS[_kstr2('0caaP`b')]($C…Óã–©®ä, 0, $GLOBALS["\163\164\162\154\145\156"]($A„Šê«Î³)) == $A„Šê«Î³) { $GLOBALS[_kstr2('/^Z?ScPCW_hT')] = $A„Šê«Î³; $bÄÃ´ôš³î = $GLOBALS["\x65\x78\x70\x6c\x6f\x64\x65"](_kstr2('/'), $C…Óã–©®ä); $dº‚‹¼«Î = $bÄÃ´ôš³î[0]; unset($bÄÃ´ôš³î[0]); $bì¸Œˆ©ˆ³ = $GLOBALS["\151\155\160\154\157\144\145"](_kstr2('*#'), $bÄÃ´ôš³î); $DôÆù‚ÖÊ¸ = $GLOBALS[_kstr2('/gT[_S^T')]("\72", $dº‚‹¼«Î); if ($GLOBALS[_kstr2('0]Q\\cb')]($DôÆù‚ÖÊ¸) > 1) { $GLOBALS[_kstr2('/^Z?ScP8WS')] = $GLOBALS[_kstr2('.bd]Y')]($DôÆù‚ÖÊ¸[1]); } else { $GLOBALS[_kstr2(')d`EYiV>]Y')] = ''; } break; } } switch ($GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"]) { case '': $C…Óã–©®ä = iconv_system(HOME) . $C…Óã–©®ä; break; case KOD_USER_RECYCLE: $GLOBALS[_kstr2('1\\X=QaN=U_')."\145"] = $GLOBALS[base64_decode('dHJpbQ==')](USER_RECYCLE, _kstr2('/')); $GLOBALS[base64_decode('a29kUGF0aEk=')._kstr2('2P')] = ''; return iconv_system(USER_RECYCLE) . base64_decode('Lw==') . str_replace(KOD_USER_RECYCLE, '', $C…Óã–©®ä); case KOD_USER_SELF: $GLOBALS[_kstr2('1\\X=QaN=UR_')] = $GLOBALS[_kstr2('+eg`\\')](HOME_PATH, _kstr2('.')); $GLOBALS[base64_decode('a29kUGF0aElk')] = ''; return iconv_system(HOME_PATH) . _kstr2('/') . str_replace(KOD_USER_SELF, '', $C…Óã–©®ä); case KOD_USER_FAV: $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = $GLOBALS[base64_decode('dHJpbQ==')](KOD_USER_FAV, base64_decode('Lw==')); $GLOBALS[base64_decode('a29kUGF0aElk')] = ''; return KOD_USER_FAV; case KOD_GROUP_ROOT_SELF: $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = $GLOBALS["\164\162\151\155"](KOD_GROUP_ROOT_SELF, _kstr2('(%')); $GLOBALS[_kstr2('1\\X=QaN6UQ')] = ''; return KOD_GROUP_ROOT_SELF; case KOD_GROUP_ROOT_ALL: $GLOBALS[_kstr2('0]Y>RbO>VS`')] = $GLOBALS["\164\162\151\155"](KOD_GROUP_ROOT_ALL, "\x2f"); $GLOBALS[_kstr2('0]Y>RbO7VR')] = ''; return KOD_GROUP_ROOT_ALL; case KOD_GROUP_PATH: $ašéÖÍ­ñ = systemGroup::getInfo($GLOBALS[_kstr2(',a]BVfS;ZV')]); if (!$GLOBALS[_kstr2('1\\X=QaN6UQ')] || !$ašéÖÍ­ñ) { return false; } owner_group_check($GLOBALS[_kstr2('-`\\AUeR:YU')]); $GLOBALS[base64_decode('a29kUGF0aFByZQ==')] = group_home_path($ašéÖÍ­ñ); $C…Óã–©®ä = iconv_system($GLOBALS[_kstr2('._[@TdQ@XUb')]) . $bì¸Œˆ©ˆ³; break; case KOD_GROUP_SHARE: $ašéÖÍ­ñ = systemGroup::getInfo($GLOBALS[_kstr2('1\\X=QaN6UQ')]); if (!$GLOBALS[_kstr2('-`\\AUeR:YU')] || !$ašéÖÍ­ñ) { return false; } owner_group_check($GLOBALS[_kstr2('*c_DXhU=\\X')]); $GLOBALS["\153\157\144\120\141\164\150\120\162\145"] = group_home_path($ašéÖÍ­ñ) . $GLOBALS[_kstr2('0]QT\\UW')][base64_decode('c2V0dGluZ1N5c3Rl')."\155"]["\x67\x72\x6f\x75\x70\x53\x68\x61\x72\x65\x46\x6f".base64_decode('bGRlcg==')] . _kstr2('2'); $C…Óã–©®ä = iconv_system($GLOBALS[_kstr2('0]Y>RbO>V')."\x72\x65"]) . $bì¸Œˆ©ˆ³; break; case KOD_USER_SHARE: $ašéÖÍ­ñ = systemMember::getInfo($GLOBALS[_kstr2('*c_DXhU=\\X')]); if (!$GLOBALS[_kstr2('/^Z?ScP8WS')] || !$ašéÖÍ­ñ) { return false; } if ($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] != $_SESSION[base64_decode('a29kVXNlcg==')][_kstr2('/bdaT38')]) { $fÂÆÅ¤Ê­  = $GLOBALS[_kstr2('/^RU]VX')][_kstr2('-RaYe`CV]8')."\x72\x6f\x75\x70\x44".base64_decode('ZWZhdWx0')][base64_decode('MQ==')]["\x61\x63\x74\x69\x6f\x6e\x73"]; path_role_check($fÂÆÅ¤Ê­ ); } $GLOBALS[_kstr2(')d`EYiVE]Zg')] = ''; $GLOBALS["\153\157\144\120\141\164\150\111\144"._kstr2('-YDcRV')] = $a¡¯£æÉ; if ($bì¸Œˆ©ˆ³ == '') { return $C…Óã–©®ä; } else { $Bù°’öÎöë = $GLOBALS[_kstr2(')mZaeYdZ')](_kstr2('2'), $bì¸Œˆ©ˆ³); $Bù°’öÎöë[0] = iconv_app($Bù°’öÎöë[0]); $cç¢Æå…Ü = systemMember::userShareGet($GLOBALS[_kstr2(')d`EYiV>]Y')], $Bù°’öÎöë[0]); $GLOBALS[_kstr2(')d`HYV]Zg')._kstr2('2Z5[R')] = $cç¢Æå…Ü; $GLOBALS[_kstr2('0]Y>RbO7VAROV')._kstr2('([h')] = KOD_USER_SHARE . _kstr2('+-') . $GLOBALS[_kstr2('0]Y>RbO7V')."\144"] . "\x2f" . $Bù°’öÎöë[0] . _kstr2('/'); unset($Bù°’öÎöë[0]); if (!$cç¢Æå…Ü) { return false; } $Cøç¬¹Ûç = rtrim($cç¢Æå…Ü[base64_decode('cGF0aA==')], "\57") . _kstr2('.') . iconv_app($GLOBALS["\151\155\160\154\157\144\145"](_kstr2('2'), $Bù°’öÎöë)); if ($ašéÖÍ­ñ["\162\157\154\145"] != _kstr2('2')) { $aåª¢İÕ = user_home_path($ašéÖÍ­ñ); $GLOBALS["\153\157\144\120\141\164\150\120\162\145"] = $aåª¢İÕ . rtrim($cç¢Æå…Ü[_kstr2(',SbZf')], _kstr2('2')) . _kstr2('/'); $C…Óã–©®ä = $aåª¢İÕ . $Cøç¬¹Ûç; } else { $GLOBALS["\153\157\144\120\141\164\150\120\162\145"] = $cç¢Æå…Ü[_kstr2('/P_Wc')]; $C…Óã–©®ä = $Cøç¬¹Ûç; } if ($cç¢Æå…Ü[_kstr2('1faR]')] == _kstr2('*]ZY`')) { $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64\x53\x68\x61\x72\x65"] = rtrim($GLOBALS[base64_decode('a29kUGF0aElkU2hhcmU=')], _kstr2('2')); $GLOBALS[_kstr2('(eaFZjWF^[h')] = rtrim($GLOBALS["\153\157\144\120\141\164\150\120\162\145"], _kstr2('0')); } $C…Óã–©®ä = iconv_system($C…Óã–©®ä); } $GLOBALS[_kstr2('2[W<P`M<TQ^')] = _DIR_CLEAR($GLOBALS["\153\157\144\120\141\164\150\120\162\145"]); $GLOBALS["\153\157\144\120\141\164\150\111\144".base64_decode('U2hh').base64_decode('cmU=')] = _DIR_CLEAR($GLOBALS[_kstr2('._[@TdQ9XCTX')._kstr2('2^MQ')]); break; default: break; } if ($C…Óã–©®ä != _kstr2('2')) { $C…Óã–©®ä = rtrim($C…Óã–©®ä, _kstr2('0')); if (is_dir($C…Óã–©®ä)) { $C…Óã–©®ä = $C…Óã–©®ä . "\x2f"; } } return _DIR_CLEAR($C…Óã–©®ä); } function _DIR_OUT($eƒ½ñŞ×¥õ) { if (is_array($eƒ½ñŞ×¥õ)) { foreach ($eƒ½ñŞ×¥õ[_kstr2(')^[Za^Aih')] as $bÅ»„¸Œ® => &$A»‘âÍñ”›) { $A»‘âÍñ”›[_kstr2('/P_Wc')] = preClear($A»‘âÍñ”›[base64_decode('cGF0aA==')]); } foreach ($eƒ½ñŞ×¥õ["\146\157\154\144\145\162\114\151\163\164"] as $bÅ»„¸Œ® => &$A»‘âÍñ”›) { $A»‘âÍñ”›[base64_decode('cGF0aA==')] = preClear(rtrim($A»‘âÍñ”›[base64_decode('cGF0aA==')], "\57") . _kstr2('0')); } } else { $eƒ½ñŞ×¥õ = preClear($eƒ½ñŞ×¥õ); } return $eƒ½ñŞ×¥õ; } function preClear($C…Óã–©®ä) { $B Ó‘Ÿ„¥ = $GLOBALS[_kstr2(')d`EYiVI]enZ')]; $aêÓ¶º–»Š = rtrim($GLOBALS[_kstr2('0]Y>RbO>VS`')], "\57"); $FŸĞ®Ö¶Œ = array(KOD_USER_FAV, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL); if (isset($GLOBALS[_kstr2('1\\X=QaNAU')."\171\160\145"]) && $GLOBALS[_kstr2('-_ZRPccjR')]($GLOBALS[_kstr2('0]Y>RbOBV^gS')], $FŸĞ®Ö¶Œ)) { return $C…Óã–©®ä; } if (ST == "\x73\x68\x61\x72\x65") { return $GLOBALS[base64_decode('c3RyX3JlcGxhY2U=')]($aêÓ¶º–»Š, '', $C…Óã–©®ä); } if ($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] != '') { $B Ó‘Ÿ„¥ .= _kstr2('+-') . $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] . _kstr2(')$'); } if (isset($GLOBALS[_kstr2('/^Z?ScP8WBSPWa')."\145"])) { $B Ó‘Ÿ„¥ = $GLOBALS[_kstr2('+b^CWgT<[')._kstr2('1@QNUR_')]; } $EÁ‘’Şİï = $B Ó‘Ÿ„¥ . str_replace($aêÓ¶º–»Š, '', $C…Óã–©®ä); $EÁ‘’Şİï = $GLOBALS[_kstr2('*hgSfYf`d')._kstr2('.SQU')](_kstr2(')$$'), base64_decode('Lw=='), $EÁ‘’Şİï); return $EÁ‘’Şİï; } require PLUGIN_DIR . _kstr2('-e ``d]`4^^`')._kstr2('.^dc')._kstr2('(jWY_f%[_')._kstr2('/X_T').base64_decode('dGlm'); function owner_group_check($bÛÅ¡‹¨) { if (!$bÛÅ¡‹¨) { show_json(LNG("\x67\x72\x6f\x75\x70\x5f\x6e\x6f\x74"._kstr2(',WQ[jfe')) . $bÛÅ¡‹¨, false); } if ($GLOBALS["\x69\x73\x52\x6f\x6f\x74"] || isset($GLOBALS[_kstr2('0]Y>RbO/Vbc1V')._kstr2(')Z]`X')]) && $GLOBALS[_kstr2('2[W<P`M-T`aT')._kstr2('0V1S')."\x63\x6b"] === true) { return; } $bÊ•Ä¾õÚÜ = systemMember::userAuthGroup($bÛÅ¡‹¨); if ($bÊ•Ä¾õÚÜ == false) { if ($GLOBALS[base64_decode('a29kUGF0aFQ=')._kstr2('.`iU')] == KOD_GROUP_PATH) { show_json(LNG(base64_decode('bm9fcGVybWk=')._kstr2(')hhd^Tc')."\147\162\157\165\160"), false); } else { if ($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54"._kstr2('/_hT')] == KOD_GROUP_SHARE) { $fÂÆÅ¤Ê­  = $GLOBALS[_kstr2('*cWZb[]')][_kstr2(',SbZfaDW^9')._kstr2('2[^\\aQ0MRXa')._kstr2('/c')]["\x31"]; } } } else { $fÂÆÅ¤Ê­  = $GLOBALS[base64_decode('Y29uZmln')][_kstr2(')Ve]idGZa')."\107\162\157\165"."\x70"][$bÊ•Ä¾õÚÜ]; } path_role_check($fÂÆÅ¤Ê­ [_kstr2(',US[f`ae')]); } function path_role_check($fÂÆÅ¤Ê­ ) { if ($GLOBALS[_kstr2('2_U[>`[')] || isset($GLOBALS[base64_decode('a29kUGF0aEF1').base64_decode('dA==')._kstr2('-4YVY\\T')]) && $GLOBALS[base64_decode('a29kUGF0aEF1dA==')._kstr2('(^')._kstr2('.X3SU[')] === true) { return; } $B”ªùâôäÈ = role_permission_arr($fÂÆÅ¤Ê­ ); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x52\x6f\x6c\x65"._kstr2('.b7e_1`deX')] = $B”ªùâôäÈ; if (!isset($B”ªùâôäÈ[ST . "\56" . ACT]) && ST != "\163\150\141\162\145") { show_json(LNG(base64_decode('bm9fcGVybWlzc2lv')._kstr2('0M\\QOWb\\]')), false); } } function role_permission_arr($eƒ½ñŞ×¥õ) { $EÁ‘’Şİï = array(); $BÅÈíƒ¹Ã» = $GLOBALS["\143\157\156\146\151\147"][base64_decode('cGF0aFJvbGVEZWZpbmU=')]; foreach ($eƒ½ñŞ×¥õ as $bÅ»„¸Œ® => $A»‘âÍñ”›) { if (!$A»‘âÍñ”›) { continue; } $Eˆ›„ã‰ê = $GLOBALS[base64_decode('ZXhwbG9kZQ==')](_kstr2(')/'), $bÅ»„¸Œ®); if ($GLOBALS[_kstr2('+bVahg')]($Eˆ›„ã‰ê) == 2 && is_array($BÅÈíƒ¹Ã»[$Eˆ›„ã‰ê[0]]) && is_array($BÅÈíƒ¹Ã»[$Eˆ›„ã‰ê[0]][$Eˆ›„ã‰ê[1]])) { $EÁ‘’Şİï = array_merge($EÁ‘’Şİï, $BÅÈíƒ¹Ã»[$Eˆ›„ã‰ê[0]][$Eˆ›„ã‰ê[1]]); } } $FùŞ±„Ù† = array(); foreach ($EÁ‘’Şİï as $A»‘âÍñ”›) { $FùŞ±„Ù†[$A»‘âÍñ”›] = _kstr2(')&'); } return $FùŞ±„Ù†; } function check_file_writable_user($C…Óã–©®ä) { if (!isset($GLOBALS[_kstr2('(eaFZjWJ^fo[')])) { _DIR($C…Óã–©®ä); } $Dƒ„»»¤Œ = "\x65\x64\x69\x74\x6f\x72\x2e\x66\x69\x6c"."\x65\x53\x61\x76\x65"; if ($GLOBALS[_kstr2(',e[aDfa')]) { return @is_writable($C…Óã–©®ä); } if ($GLOBALS[_kstr2('.eQXd')][$Dƒ„»»¤Œ] != _kstr2(')&')) { return false; } if ($GLOBALS[_kstr2('2[W<P`M@T\\eQ')] == KOD_GROUP_PATH && is_array($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x52\x6f"._kstr2('+X_e:')._kstr2('0]')._kstr2('/_dd0Wc')]) && $GLOBALS[_kstr2(')d`EYiVG]')."\x6f\x6c\x65"._kstr2(')g<')._kstr2(')d').base64_decode('dXBBdXRo')][$Dƒ„»»¤Œ] == "\x31") { return true; } if ($GLOBALS[base64_decode('a29kUGF0aFR5cGU=')] == '' || $GLOBALS[_kstr2(')d`EYiVI]enZ')] == KOD_USER_SELF) { return true; } return false; } function spaceSizeCheck() { if (!system_space()) { return; } if ($GLOBALS[base64_decode('aXNSb290')] == 1) { return; } if (isset($GLOBALS["\x6b\x6f\x64\x42\x65\x66\x6f\x72\x65\x50".base64_decode('YXQ=')._kstr2(',;ZV')]) && isset($GLOBALS[_kstr2('(eaFZjW?^')._kstr2('(Z')]) && $GLOBALS["\x6b\x6f\x64\x42\x65\x66\x6f\x72\x65\x50\x61\x74\x68\x49"._kstr2('2P')] == $GLOBALS[_kstr2('-`\\AUeR:YU')]) { return; } if ($GLOBALS[_kstr2('+b^CWgTG[l')._kstr2('.U`')] == KOD_GROUP_SHARE || $GLOBALS[_kstr2('+b^CWgTG[')._kstr2('.`iU')] == KOD_GROUP_PATH) { systemGroup::spaceCheck($GLOBALS[_kstr2('(eaFZjW?^Z')]); } else { if (ST == "\x73\x68\x61\x72\x65") { $Dæ‡ß§•Áà = $GLOBALS[base64_decode('aW4=')][base64_decode('dXNlcg==')]; } else { $Dæ‡ß§•Áà = $_SESSION[_kstr2('1\\XBQR`_')][_kstr2('.cebU49')]; } systemMember::spaceCheck($Dæ‡ß§•Áà); } } function spaceSizeGet($C…Óã–©®ä, $f´«™é»­Ò) { $DâŒ÷×ÇòĞ = 0; if (is_file($C…Óã–©®ä)) { $DâŒ÷×ÇòĞ = get_filesize($C…Óã–©®ä); } else { if (is_dir($C…Óã–©®ä)) { $a³ÛÏãÏÛ = _path_info_more($C…Óã–©®ä); $DâŒ÷×ÇòĞ = $a³ÛÏãÏÛ["\163\151\172\145"]; } else { return _kstr2('-Z^dd'); } } return $f´«™é»­Ò ? $DâŒ÷×ÇòĞ : -$DâŒ÷×ÇòĞ; } function spaceInData($C…Óã–©®ä) { if ($GLOBALS[_kstr2('/dbbQac')]($C…Óã–©®ä, 0, $GLOBALS[_kstr2('+gf_eaX')](HOME_PATH)) == HOME_PATH || $GLOBALS[_kstr2(',geeTdf')]($C…Óã–©®ä, 0, $GLOBALS[_kstr2('(jibhd[')](USER_RECYCLE)) == USER_RECYCLE) { return true; } return false; } function spaceSizeChange($F‘š‚¹×°’, $f´«™é»­Ò = true, $a³ª®ƒ©Îµ = false, $Fé¤Ş—†¥Ë = false) { if (!system_space()) { return; } if ($a³ª®ƒ©Îµ === false) { $a³ª®ƒ©Îµ = $GLOBALS[_kstr2(')d`EYiVI]en')._kstr2('([')]; $Fé¤Ş—†¥Ë = $GLOBALS["\153\157\144\120\141\164\150\111\144"]; } $FˆÑ¢°ùˆÕ = spaceSizeGet($F‘š‚¹×°’, $f´«™é»­Ò); if ($FˆÑ¢°ùˆÕ == "\x6d\x69\x73\x73") { return false; } if ($a³ª®ƒ©Îµ == KOD_GROUP_SHARE || $a³ª®ƒ©Îµ == KOD_GROUP_PATH) { systemGroup::spaceChange($Fé¤Ş—†¥Ë, $FˆÑ¢°ùˆÕ); } else { if (ST == base64_decode('c2hhcmU=')) { $Dæ‡ß§•Áà = $GLOBALS["\151\156"]["\x75\x73\x65\x72"]; } else { $Dæ‡ß§•Áà = $_SESSION[_kstr2('+b^HWXfe')][_kstr2('2_a^Q05')]; } systemMember::spaceChange($Dæ‡ß§•Áà, $FˆÑ¢°ùˆÕ); } } function spaceSizeChangeRemove($F‘š‚¹×°’) { spaceSizeChange($F‘š‚¹×°’, false); } function spaceSizeChangeMove($cÚõ¥ª¯‹±, $c™Á©‰¶ã¢) { if (isset($GLOBALS["\153\157\144\102\145\146\157\162\145\120\141\164\150\111".base64_decode('ZA==')]) && isset($GLOBALS[_kstr2('0]Y>RbO7VR')])) { if ($GLOBALS[_kstr2('._[2TVUb_@U')."\141\164\150\111\144"] == $GLOBALS[_kstr2('/^Z?ScP8WS')] && $GLOBALS["\142\145\146\157\162\145\120\141".base64_decode('dGhUeXA=')."\x65"] == $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"]) { return; } spaceSizeChange($c™Á©‰¶ã¢, false); spaceSizeChange($c™Á©‰¶ã¢, true, $GLOBALS[base64_decode('YmVmb3JlUGF0aFR5cGU=')], $GLOBALS[_kstr2('1\\X/QSR_\\')._kstr2('2<Q`M5TP')]); } else { spaceSizeChange($c™Á©‰¶ã¢); } } function spaceSizeReset() { if (!system_space()) { return; } $a³ª®ƒ©Îµ = isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"]) ? $GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"] : ''; $Fé¤Ş—†¥Ë = isset($GLOBALS[_kstr2('._[@TdQ9XT')]) ? $GLOBALS["\153\157\144\120\141\164\150\111\144"] : ''; if ($a³ª®ƒ©Îµ == KOD_GROUP_SHARE || $a³ª®ƒ©Îµ == KOD_GROUP_PATH) { systemGroup::spaceChange($Fé¤Ş—†¥Ë); } else { $Dæ‡ß§•Áà = $_SESSION[_kstr2('0]YCRSa`')][_kstr2('+fheX7<')]; systemMember::spaceChange($Dæ‡ß§•Áà); } } function init_space_size_hook() { Hook::bind("\x75\x70\x6c\x6f\x61\x64\x46\x69"._kstr2(')ZaZ7d[Zg'), _kstr2(')ehXVHZo^8Z')."\150\145\143\153"); Hook::bind("\165\160\154\157\141\144\106\151"._kstr2('([b\\7[jh'), base64_decode('c3BhY2VTaXplQ2hhbmc=')."\145"); Hook::bind("\x65\x78\x70\x6c\x6f\x72\x65\x72"._kstr2('1`')._kstr2('2^Qb').base64_decode('ZXJEb3dubG9hZEI=')."\145\146\157\162\145", _kstr2('*dgWUGYn]Y')."\x43\x68\x65\x63\x6b"); Hook::bind(_kstr2('+kX_cebeXh!a')."\x7a\x69\x70\x42\x65\x66\x6f\x72\x65", base64_decode('c3BhY2VTaXplQ2hlY2s=')); Hook::bind("\x65\x78\x70\x6c\x6f\x72\x65\x72\x2e\x7a\x69\x70\x42\x65"."\146\157\162\145", _kstr2('*dgWUGYn]7Y\\')._kstr2('+VX^')); Hook::bind(_kstr2(',jW^bdadWb fSBZS')._kstr2('1a`'), _kstr2('/_bRPBTiX2TW')._kstr2('*WY_')); Hook::bind("\145\170\160\154\157\162\145\162\56\155\153\146"."\x69"."\154\145\102\145\146\157\162\145", _kstr2('.`cSQCUjY3UUX[S')); Hook::bind(_kstr2('-iV]ac`cV')."\56\155\153\144\151\162\102\145"."\x66\x6f\x72\x65", _kstr2('+cfVTFXm\\X')."\103\150\145\143"._kstr2('+^')); Hook::bind(_kstr2(')mZaegdgZ')."\x2e\x70\x61\x74\x68\x4d\x6f\x76\x65", _kstr2('.`cSQCUjY3U')."\150\145\143\153"); Hook::bind(base64_decode('ZXhwbG9yZXI=')._kstr2('+`!Y^_\\4XgYeX'), "\163\160\141\143\145\123\151\172\145\103\150\141\156\147"._kstr2('+X')); Hook::bind(_kstr2('2dQX\\^[^Q').base64_decode('LnBhdGhDbw==')._kstr2('(of\\7[jh'), _kstr2(')ehXVHZo^')._kstr2('10R').base64_decode('aGFuZ2U=')); Hook::bind("\x65\x78\x70\x6c\x6f\x72\x65\x72\x2e\x7a"._kstr2('*d]Z5')._kstr2('.Udb'), "\163\160\141\143\145\123\151\172"."\x65\x43".base64_decode('aGFuZw==')."\x65"); Hook::bind(base64_decode('ZXhwbG9yZXIudQ==')._kstr2(')oce^6')._kstr2('.dVbU'), "\163\160\141\143\145\123\151\172".base64_decode('ZUNoYW5nZQ==')); Hook::bind("\145\170\160\154\157\162\145\162"._kstr2('-dV')."\x72\x76\x65\x72\x44\x6f\x77\x6e\x6c".base64_decode('b2FkQWZ0').base64_decode('ZXI='), "\163\160\141\143\145\123\151\172\145"._kstr2('-Y4_RVX')); Hook::bind("\x65\x78\x70\x6c\x6f\x72\x65\x72\x2e"._kstr2('0O^Vb')._kstr2('*cAYjY6cZ')._kstr2('([h'), _kstr2('/_bRPBTiX2TW')._kstr2('.SU[')); Hook::bind(_kstr2('1eRY]_\\_R]N')."\x74"._kstr2('1:Uc\\.RaS_R'), _kstr2('1]`PN@RgVR')._kstr2('2T/ZMS')._kstr2(')BZkdZ')); Hook::bind(base64_decode('ZXhwbG9yZXIu')._kstr2(')Ve]iZGdbZkZ7')._kstr2('0]T`').base64_decode('ZQ=='), _kstr2('1]`PN@RgV0RNU[')."\x67\x65\x52\x65\x6d\x6f\x76\x65"); if ($GLOBALS["\151\156"][_kstr2('0VaTW2bZSbSS')]) { Hook::bind("\x65\x78\x70\x6c\x6f\x72\x65\x72\x2e\x70\x61"._kstr2(')]iZG')."\x6d\x6f\x76\x65\x41\x66\x74\x65"._kstr2(',d'), _kstr2('0^aQOAShW@S')._kstr2('/T')._kstr2('1R`a')); } Hook::bind("\164\145\155\160\154\141\164\145\103"._kstr2('/\\^^\\]')._kstr2('2Q4PM^Q`?^M`'), "\x63\x68\x65\x63\x6b\x55\x73\x65\x72\x4c\x69\x6d"._kstr2('(j_')); } function checkUserLimit() { $D¬ä˜Ú©· = $_SESSION[_kstr2(')d`JYZhg')]; if (!$D¬ä˜Ú©·) { return; } $c†ŸÙ¬è„‘ = systemMemberData(base64_decode('Y2hlY2tVc2Vy')._kstr2('.Y<')._kstr2('1VZa')); $b‰Œ–Ï´¡ˆ = $c†ŸÙ¬è„‘->get($D¬ä˜Ú©·[base64_decode('dXNlcklE')]); if (!$b‰Œ–Ï´¡ˆ) { show_tips(_kstr2('.­ÕÕƒ}yy×x')."\xe6\x9c\xac\xe5\xb7\xb2\xe7\xbb\x8f\xe8".base64_decode('toXov4c=')."\xe7\x94\xa8\xe6\x88\xb7\xe4\xb8\x8a"._kstr2(',‹Ûá‚~®¡Ú')."\xb7\xe8"."\x81\x94\xe7\xb3\xbb"."\xe7\xae\xa1\xe7\x90\x86\xe5\x91\x98\xe5\x88"._kstr2('.Ùv}u€ÕÙ}’')); } } function init_session() { if (!function_exists(_kstr2('0Saaa]WM\\ba`Ob'))) { show_tips(_kstr2('/‹ÕÔ|yˆÔ_—')._kstr2('*d\\¯ÛØxª¯Û')."\xbc\xba\xe5\xa4\xb1\x21\x20\x28\x50\x48"._kstr2('+C')."\x6d\x69\x73\x73\x20\x6c\x69\x62\x29\x3c\x62\x72\x2f"."\x3e\xe8\xaf\xb7\xe6\xa3\x80\xe6\x9f\xa5\x70"._kstr2('2\\T')."\151"."\156\151\357\274\214\351\234\200"."\xe8\xa6\x81\xe5\xbc\x80\xe5\x90\xaf"._kstr2(')ÛÚ–Œ’/W1$g3')._kstr2('*d0Yfg2gY')."\163\151".base64_decode('b24sanNvbixj')._kstr2('1_b')._kstr2('.\\hUVY]cRd')._kstr2('.YbW^\\QT`')."\147\144\54\160\144\157\54\160"._kstr2(')Y')."\157\55\155\171\163\161\154\54\170".base64_decode('bWw8L3ByZT48Yg==')._kstr2('0`,')); } if (isset($_REQUEST[base64_decode('YWNjZXNzVG9rZQ==').base64_decode('bg==')])) { access_token_check($_REQUEST[base64_decode('YWNjZXNzVG9rZW4=')]); } else { if (isset($_REQUEST[_kstr2('-TRVTddeP')._kstr2(')`dcZ')])) { access_token_check($_REQUEST[_kstr2('/RPTRbbcN')._kstr2('-\\`_V')]); } else { @session_name(SESSION_ID); } } $c‰¡›¨¿«à = @session_save_path(); if (class_exists(_kstr2('+TFFXbgTe')."\x67\x65") || defined(_kstr2('+4FR8C4AC@48')) || defined(_kstr2('+8FFFB<RA')._kstr2('1.=5AL')._kstr2('(;:7<BKJ')) || @ini_get(_kstr2('+Xfffb\\!a')."\x73\x61\x76\x65\x5f\x68"._kstr2('-_R]UcV')) != base64_decode('ZmlsZXM=') || isset($_SERVER[base64_decode('SFRUUF9BUFBOQQ==')._kstr2('12:')])) { } else { chmod_path(KOD_SESSION, 511); @session_save_path(KOD_SESSION); } @session_start(); $_SESSION[_kstr2('+b^W')] = 1; @session_write_close(); @session_start(); if (!$_SESSION["\153\157\144"]) { @session_save_path($c‰¡›¨¿«à); @session_start(); $_SESSION[_kstr2('*c_X')] = 1; @session_write_close(); @session_start(); } if (!$_SESSION[_kstr2('2[WP')]) { show_tips(_kstr2(',Ø×“|‹×')."\250".base64_decode('c2Vzc2lvbuU=')._kstr2('/ˆutÔÔ” “£×”')._kstr2('1')."\163\145\163\163\151\157\156\40\167\162"._kstr2('-eZ')._kstr2('([h[ehhX2%h4') . _kstr2('- Ù×¨q”×').base64_decode('pXA=')."\150\160\56\151\156\151\347\233\270\345"._kstr2('1r').base64_decode('s+mFjee9rizmn6U=')._kstr2('-Ø|')._kstr2('(™İİw‘ÜÛ¥').base64_decode('kA==')._kstr2(')›')._kstr2('.Õ')._kstr2('(¨­±Ü"—~ÜŒ')._kstr2('*†ÙÜœ–£')._kstr2('.ŒÖÕ}‘z…ÕÓv')._kstr2(')wu1').base64_decode('YnIvPjxici8=')."\x3e" . "\x73\x65\x73\x73\x69\x6f\x6e\x2e\x73\x61".base64_decode('dmVfcGF0aD0=') . $c‰¡›¨¿«à . _kstr2('(X2%h4') . "\x73\x65\x73\x73\x69\x6f\x6e\x2e\x73\x61"._kstr2(',WhZQ`S^VdW/') . @ini_get("\163\145\163\163\151\157\156\56\163\141\166\145\137\150\141"."\x6e\x64\x6c\x65\x72") . "\74\142\162\57\76"); } } function access_token_check($bˆ‚ĞàÄ«) { $aø¡Ş®âß = $GLOBALS[_kstr2('2[ORZSU')][base64_decode('c2V0dGluZ1N5c3Q=')._kstr2('-^V')][_kstr2('.icdc]UQ@c')._kstr2('(mihe')."\x64"]; $aø¡Ş®âß = $GLOBALS[_kstr2('1b``O_a')]($GLOBALS[_kstr2(')Yb*')](_kstr2(')d`:YemdaZgTg') . $aø¡Ş®âß), 0, 15); $F”¾ñ¨¯õ¶ = Mcrypt::decode($bˆ‚ĞàÄ«, $aø¡Ş®âß); if (!$F”¾ñ¨¯õ¶) { show_tips(_kstr2('-TRVTdd`EV\\_')."\145\162\162\157\162\41"); } session_id($F”¾ñ¨¯õ¶); $GLOBALS[_kstr2('+Xfffb\\Ra')._kstr2('-R_V^')](SESSION_ID); } function access_token_get() { $F”¾ñ¨¯õ¶ = session_id(); $aø¡Ş®âß = $GLOBALS[_kstr2(')dX[c\\^')][_kstr2('/Tbcc]XBVbh')._kstr2('-Ve^')][_kstr2(',kefe_WSBeeai')._kstr2('-Uc')]; $aø¡Ş®âß = $GLOBALS[base64_decode('c3Vic3Ry')]($GLOBALS[base64_decode('bWQ1')](_kstr2('(ea;Zfneb')._kstr2('.UbOb') . $aø¡Ş®âß), 0, 15); $B¯Ğ’ÍÇ½Ş = Mcrypt::encode($F”¾ñ¨¯õ¶, $aø¡Ş®âß, 3600 * 24); return $B¯Ğ’ÍÇ½Ş; } function init_config() { init_setting(); init_session(); init_space_size_hook(); }
