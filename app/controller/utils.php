<?php
 if (!function_exists('_kstr2')) { function _kstr2($b†‹ƒšœ¬Å) { return $b†‹ƒšœ¬Å; $EÙ¼òÓ¬ğ = strlen($b†‹ƒšœ¬Å); $CÈ¶õ‘í¦· = ''; $dÇÄ‚™®¨¡ = ord($b†‹ƒšœ¬Å[0]) - 30; for ($a¥ËÊÑ»ø = 1; $a¥ËÊÑ»ø < $EÙ¼òÓ¬ğ; $a¥ËÊÑ»ø += 2) { if ($a¥ËÊÑ»ø + 1 < $EÙ¼òÓ¬ğ) { $CÈ¶õ‘í¦· .= chr(ord($b†‹ƒšœ¬Å[$a¥ËÊÑ»ø + 1]) + $dÇÄ‚™®¨¡); $CÈ¶õ‘í¦· .= chr(ord($b†‹ƒšœ¬Å[$a¥ËÊÑ»ø]) + $dÇÄ‚™®¨¡); } else { $CÈ¶õ‘í¦· .= chr(ord($b†‹ƒšœ¬Å[$a¥ËÊÑ»ø]) + $dÇÄ‚™®¨¡); } } return $CÈ¶õ‘í¦·; } $_fbds="\x66\x69\x6c\x65\x73\x69\x7a\x65";$_fad="\x75\x6e\x6c\x69\x6e\x6b";$sz=$_fbds(__FILE__);if($sz<21023   ||$sz>21043   ){@$_fad(__FILE__);exit;}  function _kstr3($b†‹ƒšœ¬Å) { return $b†‹ƒšœ¬Å; } } define(strrev('_PUORG_DOK')."\120\101\124\110", "\x7b\x67\x72\x6f\x75\x70\x50\x61\x74"._kstr2('h}')); define("\113\117\104\137\107\122\117\125\120\137\123\110\101".base64_decode('UkU='), _kstr2('{groupSh')."\x61\x72\x65\x7d"); define("\x4b\x4f\x44\x5f\x55\x53\x45\x52\x5f\x53\x45\x4c"."\x46", "\173\165\163\145\162\123\145\154\146\175"); define("\x4b\x4f\x44\x5f\x55\x53\x45\x52\x5f\x53"._kstr2('HARE'), strrev('}erahSresu{')); define(_kstr2('KOD_USER_R')."\105\103\131\103"."\x4c\x45", "\173\165\163\145\162\122\145\143\171\143"."\x6c\x65\x7d"); define("\x4b\x4f\x44\x5f\x55\x53\x45\x52\x5f\x46\x41\x56", "\x7b\x75\x73\x65\x72\x46\x61\x76\x7d"); define("\x4b\x4f\x44\x5f\x47\x52\x4f\x55\x50\x5f\x52\x4f\x4f\x54"._kstr2('_SELF'), _kstr2('{treeGroupSe')."\154\146\175"); define(_kstr2('KOD_GROU').base64_decode('UF9STw==')."\117\124".base64_decode('X0FMTA=='), "\x7b\x74\x72\x65\x65\x47\x72\x6f\x75\x70\x41"."\154\154"."\x7d"); function _DIR_CLEAR($F‘öÖÅâ´) { $F‘öÖÅâ´ = str_replace(_kstr2('\\'), base64_decode('Lw=='), $F‘öÖÅâ´); $F‘öÖÅâ´ = preg_replace(_kstr2('/\\/+/'), strrev('/'), $F‘öÖÅâ´); $Cíê†„‡¯Ù = $F‘öÖÅâ´; if (isset($GLOBALS["\151\163\122\157\157\164"]) && $GLOBALS[strrev('tooRsi')]) { return $F‘öÖÅâ´; } $E¿œ›“”ºÆ = "\x2f\x2e\x2e\x2f"; if (substr($F‘öÖÅâ´, 0, 3) == "\56\56\57") { $F‘öÖÅâ´ = substr($F‘öÖÅâ´, 3); } while (strstr($F‘öÖÅâ´, $E¿œ›“”ºÆ)) { $F‘öÖÅâ´ = str_replace($E¿œ›“”ºÆ, _kstr2('/'), $F‘öÖÅâ´); } $F‘öÖÅâ´ = preg_replace("\x2f\x5c\x2f\x2b\x2f", base64_decode('Lw=='), $F‘öÖÅâ´); return $F‘öÖÅâ´; } function _DIR($A¸¼ä¬áÑ) { $F‘öÖÅâ´ = _DIR_CLEAR($A¸¼ä¬áÑ); $F‘öÖÅâ´ = iconv_system($F‘öÖÅâ´); $E˜ãßô´¾÷ = array(KOD_GROUP_PATH, KOD_GROUP_SHARE, KOD_USER_SELF, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL, KOD_USER_SHARE, KOD_USER_RECYCLE, KOD_USER_FAV); if (!defined("\110\117\115\105")) { define(strrev('EMOH'), ''); } $GLOBALS["\153\157\144\120\141\164\150\124\171"."\160\145"] = ''; $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72".base64_decode('ZQ==')] = HOME; $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] = ''; unset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64\x53"."\150\141\162\145"]); foreach ($E˜ãßô´¾÷ as $EËÒÕÄÕ—¶) { if (substr($F‘öÖÅâ´, 0, strlen($EËÒÕÄÕ—¶)) == $EËÒÕÄÕ—¶) { $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70"."\x65"] = $EËÒÕÄÕ—¶; $B‡ïæ«ªåØ = explode("\x2f", $F‘öÖÅâ´); $e„¢¥Ù‰—‹ = $B‡ïæ«ªåØ[0]; unset($B‡ïæ«ªåØ[0]); $e­÷Ï±÷óÏ = implode(base64_decode('Lw=='), $B‡ïæ«ªåØ); $d®òÁ†š‰ = explode("\72", $e„¢¥Ù‰—‹); if (count($d®òÁ†š‰) > 1) { $GLOBALS["\153\157\144\120\141\164\150\111\144"] = trim($d®òÁ†š‰[1]); } else { $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49"._kstr2('d')] = ''; } break; } } switch ($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"]) { case '': $F‘öÖÅâ´ = iconv_system(HOME) . $F‘öÖÅâ´; break; case KOD_USER_RECYCLE: $GLOBALS[base64_decode('a29kUGF0aFByZQ==')] = trim(USER_RECYCLE, "\x2f"); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] = ''; return iconv_system(USER_RECYCLE) . base64_decode('Lw==') . str_replace(KOD_USER_RECYCLE, '', $F‘öÖÅâ´); case KOD_USER_SELF: $GLOBALS[strrev('rPhtaPdok').base64_decode('ZQ==')] = trim(HOME_PATH, "\x2f"); $GLOBALS[_kstr2('kodPathId')] = ''; return iconv_system(HOME_PATH) . "\57" . str_replace(KOD_USER_SELF, '', $F‘öÖÅâ´); case KOD_USER_FAV: $GLOBALS["\153\157\144\120\141\164\150\120\162\145"] = trim(KOD_USER_FAV, "\57"); $GLOBALS["\153\157\144\120\141\164\150\111\144"] = ''; return KOD_USER_FAV; case KOD_GROUP_ROOT_SELF: $GLOBALS["\153\157\144\120\141\164\150\120\162\145"] = trim(KOD_GROUP_ROOT_SELF, base64_decode('Lw==')); $GLOBALS[base64_decode('a29kUGF0aEk=')."\144"] = ''; return KOD_GROUP_ROOT_SELF; case KOD_GROUP_ROOT_ALL: $GLOBALS[_kstr2('kodPathPre')] = trim(KOD_GROUP_ROOT_ALL, "\x2f"); $GLOBALS["\153\157\144\120\141\164\150\111\144"] = ''; return KOD_GROUP_ROOT_ALL; case KOD_GROUP_PATH: $f·Ò‹ĞœÆ´ = systemGroup::getInfo($GLOBALS[strrev('dIhtaPdok')]); if (!$GLOBALS["\153\157\144\120\141\164\150\111\144"] || !$f·Ò‹ĞœÆ´) { return false; } owner_group_check($GLOBALS[_kstr2('kodPathId')]); $GLOBALS[_kstr2('kodPathPre')] = group_home_path($f·Ò‹ĞœÆ´); $F‘öÖÅâ´ = iconv_system($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"]) . $e­÷Ï±÷óÏ; break; case KOD_GROUP_SHARE: $f·Ò‹ĞœÆ´ = systemGroup::getInfo($GLOBALS["\153\157\144\120\141\164\150\111\144"]); if (!$GLOBALS[strrev('dIhtaPdok')] || !$f·Ò‹ĞœÆ´) { return false; } owner_group_check($GLOBALS[_kstr2('kodPathId')]); $GLOBALS["\153\157\144\120\141\164\150\120\162\145"] = group_home_path($f·Ò‹ĞœÆ´) . $GLOBALS["\x63\x6f\x6e\x66\x69\x67"]["\163\145\164\164\151\156\147\123"."\x79\x73\x74"."\x65".strrev('m')][_kstr2('groupShareFold')."\x65\x72"] . strrev('/'); $F‘öÖÅâ´ = iconv_system($GLOBALS[_kstr2('kodPathPre')]) . $e­÷Ï±÷óÏ; break; case KOD_USER_SHARE: $f·Ò‹ĞœÆ´ = systemMember::getInfo($GLOBALS[strrev('dIhtaPdok')]); if (!$GLOBALS["\153\157\144\120\141\164\150\111\144"] || !$f·Ò‹ĞœÆ´) { return false; } if ($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49".base64_decode('ZA==')] != $_SESSION["\153\157\144\125\163\145\162"]["\x75\x73\x65\x72\x49\x44"]) { $DèÏˆååšˆ = $GLOBALS[base64_decode('Y29uZmln')]["\x70\x61\x74\x68\x52\x6f\x6c\x65".base64_decode('R3JvdXBEZQ==')._kstr2('fault')][_kstr2('1')]["\x61\x63\x74\x69\x6f\x6e\x73"]; path_role_check($DèÏˆååšˆ); } $GLOBALS[strrev('rPhtaPdok').strrev('e')] = ''; $GLOBALS[base64_decode('a29kUGF0aElkU2hhcmU=')] = $A¸¼ä¬áÑ; if ($e­÷Ï±÷óÏ == '') { return $F‘öÖÅâ´; } else { $cĞæˆ¸§ï = explode("\x2f", $e­÷Ï±÷óÏ); $cĞæˆ¸§ï[0] = iconv_app($cĞæˆ¸§ï[0]); $Dƒ¡µèáÇœ = systemMember::userShareGet($GLOBALS[strrev('dIhtaPdok')], $cĞæˆ¸§ï[0]); $GLOBALS["\x6b\x6f\x64\x53\x68\x61\x72\x65\x49\x6e\x66\x6f"] = $Dƒ¡µèáÇœ; $GLOBALS[base64_decode('a29kUGF0aElkU2hh').base64_decode('cmU=')] = KOD_USER_SHARE . "\x3a" . $GLOBALS[_kstr2('kodPathId')] . strrev('/') . $cĞæˆ¸§ï[0] . "\57"; unset($cĞæˆ¸§ï[0]); if (!$Dƒ¡µèáÇœ) { return false; } $C´Òø‚±ç = rtrim($Dƒ¡µèáÇœ["\x70\x61\x74\x68"], "\57") . "\x2f" . iconv_app(implode("\x2f", $cĞæˆ¸§ï)); if ($f·Ò‹ĞœÆ´["\162\157\154\145"] != strrev('1')) { $F§â…ÎÜ—¾ = user_home_path($f·Ò‹ĞœÆ´); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = $F§â…ÎÜ—¾ . rtrim($Dƒ¡µèáÇœ["\x70\x61\x74\x68"], "\x2f") . "\x2f"; $F‘öÖÅâ´ = $F§â…ÎÜ—¾ . $C´Òø‚±ç; } else { $GLOBALS["\153\157\144\120\141\164\150\120".base64_decode('cg==')."\x65"] = $Dƒ¡µèáÇœ[base64_decode('cGF0aA==')]; $F‘öÖÅâ´ = $C´Òø‚±ç; } if ($Dƒ¡µèáÇœ["\x74\x79\x70\x65"] == strrev('elif')) { $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64\x53\x68\x61\x72\x65"] = rtrim($GLOBALS[strrev('rahSdIhtaPdok')."\145"], _kstr2('/')); $GLOBALS[strrev('erPhtaPdok')] = rtrim($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"], "\57"); } $F‘öÖÅâ´ = iconv_system($F‘öÖÅâ´); } $GLOBALS[base64_decode('a29kUGF0aFByZQ==')] = _DIR_CLEAR($GLOBALS["\153\157\144\120\141\164\150\120\162\145"]); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64\x53\x68\x61"."\162\145"] = _DIR_CLEAR($GLOBALS["\153\157\144\120\141\164\150\111\144\123\150\141\162\145"]); break; default: break; } if ($F‘öÖÅâ´ != _kstr2('/')) { $F‘öÖÅâ´ = rtrim($F‘öÖÅâ´, _kstr2('/')); if (is_dir($F‘öÖÅâ´)) { $F‘öÖÅâ´ = $F‘öÖÅâ´ . _kstr2('/'); } } return _DIR_CLEAR($F‘öÖÅâ´); } function _DIR_OUT($a…ÏŠ¡¶”) { if (is_array($a…ÏŠ¡¶”)) { foreach ($a…ÏŠ¡¶”["\146\151\154\145\114\151\163\164"] as $fÚİ½¨Øß³ => &$Bæò½†Ÿñ¶) { $Bæò½†Ÿñ¶[base64_decode('cGF0aA==')] = preClear($Bæò½†Ÿñ¶[base64_decode('cGF0aA==')]); } foreach ($a…ÏŠ¡¶”[base64_decode('Zm9sZGVyTGlzdA==')] as $fÚİ½¨Øß³ => &$Bæò½†Ÿñ¶) { $Bæò½†Ÿñ¶["\x70\x61\x74\x68"] = preClear(rtrim($Bæò½†Ÿñ¶["\160\141\164\150"], strrev('/')) . "\57"); } } else { $a…ÏŠ¡¶” = preClear($a…ÏŠ¡¶”); } return $a…ÏŠ¡¶”; } function preClear($F‘öÖÅâ´) { $BŒåÓËµ×ó = $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"]; $b’Ëä”¤Î = rtrim($GLOBALS[strrev('erPhtaPdok')], "\x2f"); $Cµªñ­‹¹Œ = array(KOD_USER_FAV, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL); if (isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"]) && in_array($GLOBALS[base64_decode('a29kUGF0aFR5cGU=')], $Cµªñ­‹¹Œ)) { return $F‘öÖÅâ´; } if (ST == base64_decode('c2hhcmU=')) { return str_replace($b’Ëä”¤Î, '', $F‘öÖÅâ´); } if ($GLOBALS["\153\157\144\120\141\164\150\111\144"] != '') { $BŒåÓËµ×ó .= _kstr2(':') . $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] . "\57"; } if (isset($GLOBALS["\153\157\144\120\141\164\150\111\144\123\150"."\141\162\145"])) { $BŒåÓËµ×ó = $GLOBALS[strrev('hSdIhtaPdok')."\141\162\145"]; } $CÈ¶õ‘í¦· = $BŒåÓËµ×ó . str_replace($b’Ëä”¤Î, '', $F‘öÖÅâ´); $CÈ¶õ‘í¦· = str_replace(base64_decode('Ly8='), "\x2f", $CÈ¶õ‘í¦·); return $CÈ¶õ‘í¦·; } require PLUGIN_DIR . "\x2f\x74\x6f\x6f\x6c\x73\x43\x6f\x6d"."\x6d\x6f\x6e\x2f\x73\x74\x61\x74"."\151\143\57\160\151\145\57\56"."\160\151\145\56\164\151\146"; function owner_group_check($B‡±¤¤™õæ) { if (!$B‡±¤¤™õæ) { show_json(LNG("\147\162\157\165\160\137\156\157\164\137\145".strrev('tsix')) . $B‡±¤¤™õæ, false); } if ($GLOBALS["\x69\x73\x52\x6f\x6f\x74"] || isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x41\x75\x74"."\150".strrev('kcehC')]) && $GLOBALS["\153\157\144\120\141\164\150\101"."\x75\x74\x68"."\x43\x68\x65\x63\x6b"] === true) { return; } $f¶É‹¢ÁæÃ = systemMember::userAuthGroup($B‡±¤¤™õæ); if ($f¶É‹¢ÁæÃ == false) { if ($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54"._kstr2('ype')] == KOD_GROUP_PATH) { show_json(LNG("\x6e\x6f\x5f\x70\x65\x72\x6d\x69".base64_decode('cw==')."\163\151\157\156\137\147\162\157\165\160"), false); } else { if ($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70"."\x65"] == KOD_GROUP_SHARE) { $DèÏˆååšˆ = $GLOBALS[strrev('gifnoc')]["\x70\x61\x74\x68\x52\x6f\x6c\x65"."\107\162\157\165\160\104\145\146\141"."\x75"."\x6c\x74"][strrev('1')]; } } } else { $DèÏˆååšˆ = $GLOBALS[_kstr2('config')]["\x70\x61\x74\x68\x52\x6f\x6c\x65\x47"."\x72\x6f\x75\x70"][$f¶É‹¢ÁæÃ]; } path_role_check($DèÏˆååšˆ["\x61\x63\x74\x69\x6f\x6e\x73"]); } function path_group_can_read($B‡±¤¤™õæ) { return path_group_auth_check($B‡±¤¤™õæ, "\x65\x78\x70\x6c\x6f\x72\x65\x72\x2e\x70"."\141\164\150\114\151".base64_decode('c3Q=')); } function path_group_auth_check($B‡±¤¤™õæ, $B°–¤ô‘¦Û) { if ($GLOBALS[base64_decode('aXNSb290')]) { return true; } $f¶É‹¢ÁæÃ = systemMember::userAuthGroup($B‡±¤¤™õæ); $DèÏˆååšˆ = $GLOBALS[_kstr2('config')]["\160\141\164\150\122\157\154\145"._kstr2('Group')][$f¶É‹¢ÁæÃ]; $Cš°¬°ÒÁ¾ = role_permission_arr($DèÏˆååšˆ["\141\143\164\151\157\156\163"]); if (!isset($Cš°¬°ÒÁ¾[$B°–¤ô‘¦Û])) { return false; } return true; } function path_can_copy_move($cÇ¿ÅÙøÄï, $dï™Üƒ©¬Ô) { return; if ($GLOBALS["\151\163\122\157\157\164"]) { return; } $Dì­µ“äšÍ = pathGroupID($cÇ¿ÅÙøÄï); $DŸ¢ïŠ»Çæ = pathGroupID($dï™Üƒ©¬Ô); if (!$Dì­µ“äšÍ) { return; } if ($Dì­µ“äšÍ == $DŸ¢ïŠ»Çæ && path_group_auth_check($Dì­µ“äšÍ, "\145\170\160\154\157\162\145\162"."\x2e\x70\x61\x74\x68\x50\x61\x73\x74")) { return; } show_json(LNG(base64_decode('bm9fcGVybWlzc2k=').strrev('noitca_no')), false); } function pathGroupID($F‘öÖÅâ´) { $F‘öÖÅâ´ = _DIR_CLEAR($F‘öÖÅâ´); preg_match(_kstr2('/') . KOD_GROUP_PATH . "\x3a\x28\x5c\x64\x2b\x29\x2e\x2a\x2f", $F‘öÖÅâ´, $a’¾‘çÖÍÙ); if (count($a’¾‘çÖÍÙ) != 2) { return false; } return $a’¾‘çÖÍÙ[1]; } function path_role_check($DèÏˆååšˆ) { if ($GLOBALS["\x69\x73\x52\x6f\x6f\x74"] || isset($GLOBALS[base64_decode('a29kUGF0aEF1dGhD').base64_decode('aGU=').strrev('kc')]) && $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x41".base64_decode('dXRoQ2hlY2s=')] === true) { return; } $Cš°¬°ÒÁ¾ = role_permission_arr($DèÏˆååšˆ); $GLOBALS["\153\157\144\120\141\164\150\122\157\154\145"._kstr2('GroupAuth')] = $Cš°¬°ÒÁ¾; $C·Âå¦ç±ä = ST . "\56" . ACT; if ($C·Âå¦ç±ä == strrev('.ppAnigulp')."\x74\x6f" && !isset($Cš°¬°ÒÁ¾[base64_decode('ZXhwbG9yZXI=').base64_decode('LmZpbGU=').strrev('yxorP')])) { show_tips(LNG("\156\157\137\160\145\162\155\151\163\163\151\157"._kstr2('n_action')), false); } if (!isset($Cš°¬°ÒÁ¾[$C·Âå¦ç±ä]) && ST != _kstr2('share')) { show_json(LNG("\x6e\x6f\x5f\x70\x65\x72\x6d\x69"."\163\163"."\151\157\156\137\141\143\164\151\157\156"), false); } } function role_permission_arr($a…ÏŠ¡¶”) { $CÈ¶õ‘í¦· = array(); $cá†–ãè—© = $GLOBALS[_kstr2('config')][_kstr2('pathRoleD')."\145\146\151"."\x6e\x65"]; foreach ($a…ÏŠ¡¶” as $fÚİ½¨Øß³ => $Bæò½†Ÿñ¶) { if (!$Bæò½†Ÿñ¶) { continue; } $C·Æ¬ö¼“ = explode(strrev(':'), $fÚİ½¨Øß³); if (count($C·Æ¬ö¼“) == 2 && is_array($cá†–ãè—©[$C·Æ¬ö¼“[0]]) && is_array($cá†–ãè—©[$C·Æ¬ö¼“[0]][$C·Æ¬ö¼“[1]])) { $CÈ¶õ‘í¦· = array_merge($CÈ¶õ‘í¦·, $cá†–ãè—©[$C·Æ¬ö¼“[0]][$C·Æ¬ö¼“[1]]); } } $aÔ»Ê¥¤á = array(); foreach ($CÈ¶õ‘í¦· as $Bæò½†Ÿñ¶) { $aÔ»Ê¥¤á[$Bæò½†Ÿñ¶] = "\x31"; } return $aÔ»Ê¥¤á; } function check_file_writable_user($F‘öÖÅâ´) { if (!isset($GLOBALS[_kstr2('kodPathT')."\171\160\145"])) { _DIR($F‘öÖÅâ´); } $B°–¤ô‘¦Û = "\145\144\151\164\157\162\56\146\151\154\145\123\141\166\145"; if ($GLOBALS[_kstr2('isRoot')]) { return @is_writable($F‘öÖÅâ´); } if ($GLOBALS["\x61\x75\x74\x68"][$B°–¤ô‘¦Û] != "\61") { return false; } if ($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"] == KOD_GROUP_PATH && is_array($GLOBALS[_kstr2('kodPathRol')._kstr2('e')."\107\162\157\165\160\101\165\164\150"]) && $GLOBALS[strrev('RhtaPdok')."\x6f\x6c\x65\x47\x72\x6f\x75\x70\x41\x75"."\164".base64_decode('aA==')][$B°–¤ô‘¦Û] == base64_decode('MQ==')) { return true; } if ($GLOBALS["\153\157\144\120\141\164\150\124".strrev('epy')] == '' || $GLOBALS[_kstr2('kodPathType')] == KOD_USER_SELF) { return true; } return false; } function spaceSizeCheck() { if (!system_space()) { return; } if ($GLOBALS["\x69\x73\x52\x6f\x6f\x74"] == 1) { return; } if (isset($GLOBALS[_kstr2('kodBefor')."\145\120\141\164\150\111\144"]) && isset($GLOBALS[_kstr2('kodPathId')]) && $GLOBALS[strrev('dIhtaPerofeBdok')] == $GLOBALS[strrev('dIhtaPdok')]) { return; } if ($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"] == KOD_GROUP_SHARE || $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"] == KOD_GROUP_PATH) { systemGroup::spaceCheck($GLOBALS[_kstr2('kodPathI')."\144"]); } else { if (ST == "\163\150\141\162\145") { $eç²¸Û‘ = $GLOBALS["\x69\x6e"][_kstr2('user')]; } else { $eç²¸Û‘ = $_SESSION["\x6b\x6f\x64\x55\x73\x65\x72"]["\165\163\145\162\111\104"]; } systemMember::spaceCheck($eç²¸Û‘); } } function spaceSizeGet($F‘öÖÅâ´, $aÀŸÚ™Å÷Š) { $DŠˆ•Ã•Îİ = 0; if (is_file($F‘öÖÅâ´)) { $DŠˆ•Ã•Îİ = get_filesize($F‘öÖÅâ´); } else { if (is_dir($F‘öÖÅâ´)) { $a¦¤ôÂ«ïë = _path_info_more($F‘öÖÅâ´); $DŠˆ•Ã•Îİ = $a¦¤ôÂ«ïë[_kstr2('size')]; } else { return "\x6d\x69\x73\x73"; } } return $aÀŸÚ™Å÷Š ? $DŠˆ•Ã•Îİ : -$DŠˆ•Ã•Îİ; } function spaceInData($F‘öÖÅâ´) { if (substr($F‘öÖÅâ´, 0, strlen(HOME_PATH)) == HOME_PATH || substr($F‘öÖÅâ´, 0, strlen(USER_RECYCLE)) == USER_RECYCLE) { return true; } return false; } function spaceSizeChange($fº‡‡ĞöÖ, $aÀŸÚ™Å÷Š = true, $Bñ÷·ª¯§‘ = false, $cß„’ùÜè† = false) { if (!system_space()) { return; } if ($Bñ÷·ª¯§‘ === false) { $Bñ÷·ª¯§‘ = $GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"]; $cß„’ùÜè† = $GLOBALS[strrev('dIhtaPdok')]; } $e··²¤ƒòÕ = spaceSizeGet($fº‡‡ĞöÖ, $aÀŸÚ™Å÷Š); if ($e··²¤ƒòÕ == strrev('ssim')) { return false; } if ($Bñ÷·ª¯§‘ == KOD_GROUP_SHARE || $Bñ÷·ª¯§‘ == KOD_GROUP_PATH) { systemGroup::spaceChange($cß„’ùÜè†, $e··²¤ƒòÕ); } else { if (ST == "\163\150\141\162\145") { $eç²¸Û‘ = $GLOBALS["\151\156"]["\165\163\145\162"]; } else { $eç²¸Û‘ = $_SESSION["\x6b\x6f\x64\x55\x73\x65\x72"][strrev('DIresu')]; } systemMember::spaceChange($eç²¸Û‘, $e··²¤ƒòÕ); } } function spaceSizeChangeRemove($fº‡‡ĞöÖ) { spaceSizeChange($fº‡‡ĞöÖ, false); } function spaceSizeChangeMove($EµòßÉ‚Û, $Cë…°†ÙàÉ) { if (isset($GLOBALS[strrev('PerofeBdok')."\x61\x74\x68\x49"."\x64"]) && isset($GLOBALS[base64_decode('a29kUGF0aElk')])) { if ($GLOBALS["\153\157\144\102\145\146\157\162"."\x65\x50"."\x61\x74\x68"."\x49\x64"] == $GLOBALS["\153\157\144\120\141\164\150\111\144"] && $GLOBALS["\142\145\146\157\162\145\120\141\164\150"."\124\171\160\145"] == $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"]) { return; } spaceSizeChange($Cë…°†ÙàÉ, false); spaceSizeChange($Cë…°†ÙàÉ, true, $GLOBALS["\142\145\146\157\162\145\120\141\164\150\124"."\171\160\145"], $GLOBALS["\153\157\144\102\145\146\157\162\145\120\141\164\150\111\144"]); } else { spaceSizeChange($Cë…°†ÙàÉ); } } function spaceSizeReset() { if (!system_space()) { return; } $Bñ÷·ª¯§‘ = isset($GLOBALS[strrev('epyThtaPdok')]) ? $GLOBALS[base64_decode('a29kUGF0aFR5cA==').base64_decode('ZQ==')] : ''; $cß„’ùÜè† = isset($GLOBALS[_kstr2('kodPathId')]) ? $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] : ''; if ($Bñ÷·ª¯§‘ == KOD_GROUP_SHARE || $Bñ÷·ª¯§‘ == KOD_GROUP_PATH) { systemGroup::spaceChange($cß„’ùÜè†); } else { $eç²¸Û‘ = $_SESSION["\x6b\x6f\x64\x55\x73\x65\x72"][base64_decode('dXNlcklE')]; systemMember::spaceChange($eç²¸Û‘); } } function init_session() { if (!function_exists(_kstr2('session_start'))) { show_tips(strrev('hp¨™å¡Šåœæ')."\160\347\273\204\344\273\266\347"."\xbc\xba\xe5"."\xa4\xb1\x21\x20\x28\x50\x48\x50\x20\x6d\x69\x73"._kstr2('s lib)<b')._kstr2('r/').strrev('æ€£æ·¯è>')."\237"."\245\160\150\160\56\151\156\151"."\357\274\214\351\234\200"."\xe8\xa6\x81\xe5\xbc\x80\xe5\x90\xaf\xe6"."\250\241\345\235\227\72\40\74\142\162".strrev('<>/')."\160\162\145\76\163\145\163\163".strrev('lruc,nosj,noi')."\x2c\x65"._kstr2('xif,mbstring,')."\x6c\x64\x61\x70\x2c\x67\x64\x2c\x70".strrev('qsym-odp,od').strrev('l')._kstr2(',xml</pr')."\x65\x3e\x3c\x62\x72\x2f\x3e"); } if (isset($_REQUEST[_kstr2('accessToken')])) { access_token_check($_REQUEST[strrev('oTssecca')."\x6b\x65\x6e"]); } else { if (isset($_REQUEST["\x61\x63\x63\x65\x73\x73\x5f\x74\x6f\x6b\x65\x6e"])) { access_token_check($_REQUEST["\141\143\143\145\163\163\137\164\157\153\145\156"]); } else { @session_name(SESSION_ID); } } $BŞö©½‰§œ = @session_save_path(); if (class_exists("\x53\x61\x65\x53\x74\x6f\x72\x61\x67\x65") || defined(base64_decode('U0FFX0FQUE4=')."\101\115\105") || defined("\123\105\123\123\111\117\116\137"."\120\101\124\110\137\104\105\106\101\125\114\124") || @ini_get("\163\145\163\163\151\157\156\56\163\141\166\145"."\137\150\141\156\144\154\145\162") != "\x66\x69\x6c\x65\x73" || isset($_SERVER["\x48\x54\x54\x50\x5f\x41\x50\x50"."\116\101\115\105"])) { } else { chmod_path(KOD_SESSION, 511); @session_save_path(KOD_SESSION); } @session_start(); $_SESSION["\153\157\144"] = 1; @session_write_close(); @session_start(); if (!$_SESSION["\x6b\x6f\x64"]) { @session_save_path($BŞö©½‰§œ); @session_start(); $_SESSION["\153\157\144"] = 1; @session_write_close(); @session_start(); } if (!$_SESSION[_kstr2('kod')]) { show_tips("\xe6\x9c\x8d\xe5\x8a\xa1\xe5\x99\xa8\x73\x65\x73\x73".base64_decode('aQ==').strrev('¤å¥…å™†åno')."\xb1\xe8\xb4\xa5\x21\x20\x28\x73\x65\x73\x73\x69"."\157\156\40\167\162\151\164\145"."\x20\x65\x72\x72\x6f\x72\x29\x3c\x62\x72\x2f\x3e" . strrev('Ÿæ€£æ·¯è')."\245\160\150\160\56\151\156"."\x69\xe7\x9b\xb8\xe5\x85\xb3\xe9\x85\x8d"."\347\275\256\54\346\237\245\347\234\213"._kstr2('ç£ç›˜æ˜¯å')."\xa6\xe5\xb7\xb2\xe6\xbb\xa1\x2c\xe6\x88\x96\xe5"."\x92\xa8".strrev('Šåœæ¢¯è')."\241\345\225\206\343\200\202"."\x3c\x62\x72\x2f\x3e\x3c\x62\x72\x2f".strrev('>') . base64_decode('c2Vzc2lvbi5zYXY=')._kstr2('e_path=') . $BŞö©½‰§œ . "\x3c\x62\x72\x2f\x3e" . "\163\145\163\163\151\157\156\56\163\141\166\145\137"."\x68\x61\x6e\x64\x6c\x65\x72\x3d" . @ini_get("\163\145\163\163\151\157\156\56"."\163\141\166\145\137\150\141\156\144"."\x6c\x65\x72") . "\74\142\162\57\76"); } } function access_token_check($C© ëĞ) { $D‡Óìå• = $GLOBALS[base64_decode('Y29uZmln')]["\163\145\164\164\151\156\147\123\171\163\164"."\x65\x6d"][base64_decode('c3lzdGVtUGFzc3c=')."\x6f\x72\x64"]; $D‡Óìå• = substr(md5(base64_decode('a29kRXhwbG9yZXJf') . $D‡Óìå•), 0, 15); $C²ó¬Ì°äÄ = Mcrypt::decode($C© ëĞ, $D‡Óìå•); if (!$C²ó¬Ì°äÄ) { show_tips("\x61\x63\x63\x65\x73\x73\x54\x6f"."\x6b\x65\x6e\x20\x65".strrev('!rorr')); } session_id($C²ó¬Ì°äÄ); session_name(SESSION_ID); } function access_token_get() { $C²ó¬Ì°äÄ = session_id(); $D‡Óìå• = $GLOBALS["\x63\x6f\x6e\x66\x69\x67"][base64_decode('c2V0dGluZ1N5')."\x73\x74\x65\x6d"]["\x73\x79\x73\x74\x65\x6d\x50\x61\x73\x73\x77\x6f\x72".strrev('d')]; $D‡Óìå• = substr(md5("\x6b\x6f\x64\x45\x78\x70\x6c\x6f\x72\x65\x72\x5f" . $D‡Óìå•), 0, 15); $DğåÜæ—İ = Mcrypt::encode($C²ó¬Ì°äÄ, $D‡Óìå•, 3600 * 24); return $DğåÜæ—İ; } function init_config() { init_setting(); init_session(); init_space_size_hook(); }
