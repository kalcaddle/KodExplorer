<?php
 if (!function_exists('_kstr2')) { $fb=base64_decode("ZmlsZXNpemU=");$fa=";_kstr2('fkeiie')";$sz=$fb(__FILE__);if($sz<23104   ||$sz>23124   ){exit;} function _kstr2($e ‰·•øŸ) { $FîÏ‡Îº²¾ = strlen($e ‰·•øŸ); $DÄ‰£†åÂ = ''; $A‹†ÄîíÑÕ = ord($e ‰·•øŸ[0]) - 30; for ($F²›ê½¾ˆÕ = 1; $F²›ê½¾ˆÕ < $FîÏ‡Îº²¾; $F²›ê½¾ˆÕ += 2) { if ($F²›ê½¾ˆÕ + 1 < $FîÏ‡Îº²¾) { $DÄ‰£†åÂ .= chr(ord($e ‰·•øŸ[$F²›ê½¾ˆÕ + 1]) + $A‹†ÄîíÑÕ); $DÄ‰£†åÂ .= chr(ord($e ‰·•øŸ[$F²›ê½¾ˆÕ]) + $A‹†ÄîíÑÕ); } else { $DÄ‰£†åÂ .= chr(ord($e ‰·•øŸ[$F²›ê½¾ˆÕ]) + $A‹†ÄîíÑÕ); } } return $DÄ‰£†åÂ; } } $GLOBALS[_kstr2('/S\\$')] = _kstr2('/S\\$'); $GLOBALS[base64_decode('anNvbl9lbmNvZGU=')] = "\x6a\x73\x6f\x6e\x5f\x65\x6e\x63\x6f\x64"."\x65"; $GLOBALS[_kstr2(',e\\`aVQUWVaW')] = _kstr2('/bY]^SNRTS^T'); $GLOBALS[_kstr2(')VWZh)+ZTXc')._kstr2('+WbX')] = _kstr2('-RSVd%\'VPT_U`V'); $GLOBALS["\x66\x69\x6c\x65\x5f\x67\x65\x74\x5f\x63\x6f\x6e"."\x74"."\145\156\164\163"] = base64_decode('ZmlsZV9nZXRfYw==')._kstr2('*bcYhhbg'); $GLOBALS[base64_decode('aW5fYXJyYXk=')] = "\x69\x6e\x5f\x61\x72\x72\x61\x79"; $GLOBALS[base64_decode('aW1wbG9kZQ==')] = _kstr2('+`\\_cWbX'); $GLOBALS[_kstr2('*lY`dXcY')] = _kstr2(')mZaeYdZ'); $GLOBALS[base64_decode('Y291bnQ=')] = base64_decode('Y291bnQ='); $GLOBALS[_kstr2(')Z]YVgZ')] = _kstr2('+X[WTeX'); $GLOBALS["\163\164\162\164\157\164\151\155\145"] = _kstr2('+gfgegb`\\')._kstr2(')Z'); $GLOBALS[_kstr2('-ed]c_V')] = "\163\164\162\154\145\156"; $GLOBALS[base64_decode('dHJpbQ==')] = _kstr2('1_aZV'); $GLOBALS[_kstr2('(jiUh[hbf')._kstr2('2OMQ')] = base64_decode('c3RyX3JlcGw=')."\141"._kstr2('1RP'); $GLOBALS[_kstr2('+Tehj_eaXbV')."\x64\x65"] = _kstr2(',Sdgi^d`WaUWV'); $GLOBALS[_kstr2('/dbbQac')] = "\163\165\142\163\164\162"; $GLOBALS[_kstr2(',[fW_')] = _kstr2('-ZeV^'); $GLOBALS[_kstr2('/XUT[_NcdN')._kstr2(',aUf``Wef')] = _kstr2('/XUT[_NcdN').base64_decode('Y29udGVudHM='); $GLOBALS[_kstr2('1VSRYRLVea``')] = "\x66\x69\x6c\x65\x5f\x65\x78\x69\x73\x74"."\163"; $GLOBALS[_kstr2('1_]TR_L]RNYRP')] = "\x70\x72\x65\x67\x5f\x72\x65\x70\x6c\x61\x63\x65"; $GLOBALS[_kstr2(')Zhhhd^TcihgVi')] = _kstr2('1R```\\VL[').base64_decode('cw==').base64_decode('dGE=')._kstr2('(jh'); $GLOBALS[base64_decode('c2Vzc2lvbl9uYW1l')] = _kstr2('.Uccc_YO^Q^').base64_decode('bWU='); define(_kstr2('(EAU:H=KEUF7F>J'), _kstr2(')\\pdgejVE]ir')); define("\113\117\104\137\107\122\117\125\120\137\123"._kstr2('1.52?'), _kstr2(',YmadbgZES')._kstr2('/a')."\x65"."\x7d"); define("\x4b\x4f\x44\x5f\x55\x53\x45\x52\x5f\x53\x45"._kstr2('-7='), "\x7b\x75\x73\x65\x72\x53\x65\x6c\x66"._kstr2('1j')); define(base64_decode('S09EX1VTRVJf')."\123"._kstr2(')6=:G'), "\x7b\x75\x73\x65\x72\x53\x68\x61\x72\x65\x7d"); define(_kstr2('+B>R7FHE8ER8')._kstr2('/H2;2')._kstr2('12'), _kstr2(')jpZhGgXZn')._kstr2('-]TnV')); define(_kstr2('1<8L1@B?23LC.'), _kstr2('(kq[i<hlWs')); define(_kstr2('2;7K0>3A;')._kstr2('/N?>AC>BN4')."\x4c\x46", "\173\164\162\145\145\107\162\157\165\160\123\145\154\146"."\x7d"); define(base64_decode('S09EX0dST1VQX1JPTw==').base64_decode('VF9BTEw='), _kstr2('1ahR_4R\\_]bY.jY')); function _DIR_CLEAR($Fä‡Ğó¢Œî) { $Fä‡Ğó¢Œî = $GLOBALS["\163\164\162\137\162\145\160\154"._kstr2('-TRV')]("\x5c", "\x2f", $Fä‡Ğó¢Œî); $Fä‡Ğó¢Œî = $GLOBALS["\x70\x72\x65\x67\x5f\x72\x65\x70\x6c\x61\x63\x65"]("\57\134\57\53\57", "\x2f", $Fä‡Ğó¢Œî); $Bİ“áÃ±ù = $Fä‡Ğó¢Œî; if (isset($GLOBALS["\x69\x73\x52\x6f\x6f\x74"]) && $GLOBALS[_kstr2('0aW]@b]')]) { return $Fä‡Ğó¢Œî; } $f«§­…·¼  = "\57\56\56\57"; if ($GLOBALS["\163\165\142\163\164\162"]($Fä‡Ğó¢Œî, 0, 3) == _kstr2(',  !')) { $Fä‡Ğó¢Œî = $GLOBALS[_kstr2(')jhhWgi')]($Fä‡Ğó¢Œî, 3); } while (strstr($Fä‡Ğó¢Œî, $f«§­…·¼ )) { $Fä‡Ğó¢Œî = $GLOBALS["\163\164\162\137\162\145\160\154\141\143\145"]($f«§­…·¼ , "\x2f", $Fä‡Ğó¢Œî); } $Fä‡Ğó¢Œî = $GLOBALS[_kstr2('+ecZXeRcXT_XV')](_kstr2('0J'), base64_decode('Lw=='), $Fä‡Ğó¢Œî); return $Fä‡Ğó¢Œî; } function _DIR($Eçğ§±òÁ´) { $Fä‡Ğó¢Œî = _DIR_CLEAR($Eçğ§±òÁ´); $Fä‡Ğó¢Œî = iconv_system($Fä‡Ğó¢Œî); $dÖÒ‹ˆ¥èÌ = array(KOD_GROUP_PATH, KOD_GROUP_SHARE, KOD_USER_SELF, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL, KOD_USER_SHARE, KOD_USER_RECYCLE, KOD_USER_FAV); $GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"] = ''; $GLOBALS[_kstr2('0]Y>RbO>VS`')] = HOME; $GLOBALS[_kstr2('(eaFZjW?^Z')] = ''; unset($GLOBALS[_kstr2('-`\\AUeR:YDUY')._kstr2('2^M')."\145"]); foreach ($dÖÒ‹ˆ¥èÌ as $d‹‚Ú½­è) { if ($GLOBALS["\163\165\142\163\164\162"]($Fä‡Ğó¢Œî, 0, $GLOBALS[base64_decode('c3RybGVu')]($d‹‚Ú½­è)) == $d‹‚Ú½­è) { $GLOBALS[_kstr2(')d`EYiVI]')._kstr2(')n')._kstr2('+Xc')] = $d‹‚Ú½­è; $cÅ±„‘Ë‘ê = $GLOBALS["\145\170\160\154\157\144\145"](_kstr2('2'), $Fä‡Ğó¢Œî); $fÛ³Ú–áåØ = $cÅ±„‘Ë‘ê[0]; unset($cÅ±„‘Ë‘ê[0]); $dï¯ˆÅ¢ªó = $GLOBALS[base64_decode('aW1wbG9kZQ==')](base64_decode('Lw=='), $cÅ±„‘Ë‘ê); $FÉŸ„«…÷ = $GLOBALS[base64_decode('ZXhwbG9kZQ==')]("\x3a", $fÛ³Ú–áåØ); if ($GLOBALS[_kstr2('1\\P[ba')]($FÉŸ„«…÷) > 1) { $GLOBALS[_kstr2('1\\X=QaN6UQ')] = $GLOBALS["\164\162\151\155"]($FÉŸ„«…÷[1]); } else { $GLOBALS[base64_decode('a29kUGF0aElk')] = ''; } break; } } switch ($GLOBALS[_kstr2('/^Z?ScPCWh')._kstr2('*d').base64_decode('ZQ==')]) { case '': $Fä‡Ğó¢Œî = iconv_system(HOME) . $Fä‡Ğó¢Œî; break; case KOD_USER_RECYCLE: $GLOBALS["\153\157\144\120\141\164\150\120"._kstr2('/a')."\x65"] = $GLOBALS["\164\162\151\155"](USER_RECYCLE, _kstr2(',!')); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] = ''; return iconv_system(USER_RECYCLE) . _kstr2('(%') . str_replace(KOD_USER_RECYCLE, '', $Fä‡Ğó¢Œî); case KOD_USER_SELF: $GLOBALS[_kstr2('._[@TdQ@XUb')] = $GLOBALS[_kstr2('.bd]Y')](HOME_PATH, _kstr2(')$')); $GLOBALS[_kstr2('1\\X=QaN6UQ')] = ''; return iconv_system(HOME_PATH) . _kstr2(',!') . str_replace(KOD_USER_SELF, '', $Fä‡Ğó¢Œî); case KOD_USER_FAV: $GLOBALS[_kstr2('/^Z?ScP?WTa')] = $GLOBALS[_kstr2('0`b[W')](KOD_USER_FAV, _kstr2(')$')); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] = ''; return KOD_USER_FAV; case KOD_GROUP_ROOT_SELF: $GLOBALS[_kstr2('*c_DXhUD\\f')._kstr2('.U')] = $GLOBALS[_kstr2('(hjc_')](KOD_GROUP_ROOT_SELF, _kstr2('.')); $GLOBALS[_kstr2(')d`EYiV>]Y')] = ''; return KOD_GROUP_ROOT_SELF; case KOD_GROUP_ROOT_ALL: $GLOBALS["\153\157\144\120\141\164\150\120\162\145"] = $GLOBALS[_kstr2(',df_[')](KOD_GROUP_ROOT_ALL, _kstr2('/')); $GLOBALS[_kstr2('._[@TdQ9XT')] = ''; return KOD_GROUP_ROOT_ALL; case KOD_GROUP_PATH: $Døæñäöß‘ = systemGroup::getInfo($GLOBALS[_kstr2('._[@TdQ9XT')]); if (!$GLOBALS[_kstr2(',a]BVfS;ZV')] || !$Døæñäöß‘) { return false; } owner_group_check($GLOBALS["\153\157\144\120\141\164\150\111\144"]); $GLOBALS["\153\157\144\120\141\164\150\120\162".base64_decode('ZQ==')] = group_home_path($Døæñäöß‘); $Fä‡Ğó¢Œî = iconv_system($GLOBALS[_kstr2('(eaFZjWF^[h')]) . $dï¯ˆÅ¢ªó; break; case KOD_GROUP_SHARE: $Døæñäöß‘ = systemGroup::getInfo($GLOBALS[base64_decode('a29kUGF0aEk=')."\x64"]); if (!$GLOBALS["\153\157\144\120\141\164\150\111\144"] || !$Døæñäöß‘) { return false; } owner_group_check($GLOBALS[_kstr2('0]Y>RbO7VR')]); $GLOBALS[_kstr2(')d`EYiVE]')._kstr2(',Wd')] = group_home_path($Døæñäöß‘) . $GLOBALS["\143\157\156\146\151\147"][_kstr2('-Vdee_ZDXdjVe^')][_kstr2('(h]keIfW^[he<')._kstr2(',V^dW')] . _kstr2('0'); $Fä‡Ğó¢Œî = iconv_system($GLOBALS[base64_decode('a29kUGF0aFByZQ==')]) . $dï¯ˆÅ¢ªó; break; case KOD_USER_SHARE: $Døæñäöß‘ = systemMember::getInfo($GLOBALS[_kstr2('/^Z?ScP8WS')]); if (!$GLOBALS[base64_decode('a29kUGF0aElk')] || !$Døæñäöß‘) { return false; } if ($GLOBALS[_kstr2(')d`EYiV>]Y')] != $_SESSION["\153\157\144\125\163\145\162"]["\165\163\145\162\111\104"]) { $F¦¿¢Í»¼¦ = $GLOBALS["\143\157\156\146\151\147"][_kstr2('2M\\T`[>QX^3a[\\').base64_decode('RGVmYXVsdA==')][_kstr2('(\'')]["\x61\x63\x74\x69\x6f\x6e\x73"]; path_role_check($F¦¿¢Í»¼¦); } $GLOBALS[_kstr2('+b^CWgTC[').base64_decode('cg==')."\x65"] = ''; $GLOBALS[_kstr2('2[W<P`M5T')._kstr2('0AROV')._kstr2(')Zg')] = $Eçğ§±òÁ´; if ($dï¯ˆÅ¢ªó == '') { return $Fä‡Ğó¢Œî; } else { $FßŞ”ÆêÍö = $GLOBALS[_kstr2('-iV]aU`V')](_kstr2('0'), $dï¯ˆÅ¢ªó); $FßŞ”ÆêÍö[0] = iconv_app($FßŞ”ÆêÍö[0]); $CˆÏ†ÆÁ‡Ò = systemMember::userShareGet($GLOBALS[_kstr2('(eaFZjW?^Z')], $FßŞ”ÆêÍö[0]); $GLOBALS[base64_decode('a29kU2hhcmVJbmZv')] = $CˆÏ†ÆÁ‡Ò; $GLOBALS[_kstr2('2[W<P`M5TP').base64_decode('U2hh')._kstr2('1R_')] = KOD_USER_SHARE . _kstr2('*.') . $GLOBALS[_kstr2('*c_DXhU=\\X')] . _kstr2('*#') . $FßŞ”ÆêÍö[0] . "\57"; unset($FßŞ”ÆêÍö[0]); if (!$CˆÏ†ÆÁ‡Ò) { return false; } $BÍĞ¿õÊÈ¹ = rtrim($CˆÏ†ÆÁ‡Ò[_kstr2('/P_Wc')], _kstr2('(%')) . "\x2f" . iconv_app($GLOBALS[_kstr2(',_[^bVaW')](base64_decode('Lw=='), $FßŞ”ÆêÍö)); if ($Døæñäöß‘[_kstr2(')dgZa')] != _kstr2('1')) { $e£éÂ«ãÆç = user_home_path($Døæñäöß‘); $GLOBALS[_kstr2('*c_DXhUD\\Yf')] = $e£éÂ«ãÆç . rtrim($CˆÏ†ÆÁ‡Ò[_kstr2('*Ud\\h')], _kstr2(',!')) . _kstr2('*#'); $Fä‡Ğó¢Œî = $e£éÂ«ãÆç . $BÍĞ¿õÊÈ¹; } else { $GLOBALS[_kstr2('/^Z?ScP?WTa')] = $CˆÏ†ÆÁ‡Ò[_kstr2('0O^Vb')]; $Fä‡Ğó¢Œî = $BÍĞ¿õÊÈ¹; } if ($CˆÏ†ÆÁ‡Ò["\164\171\160\145"] == "\146\151\154\145") { $GLOBALS[_kstr2('(eaFZjW?^')._kstr2('/BS')._kstr2('.QXUb')] = rtrim($GLOBALS["\153\157\144\120\141\164\150\111\144".base64_decode('U2hhcmU=')], "\57"); $GLOBALS[_kstr2('/^Z?ScP?WTa')] = rtrim($GLOBALS[_kstr2('2[W<P`M<TQ^')], _kstr2('/')); } $Fä‡Ğó¢Œî = iconv_system($Fä‡Ğó¢Œî); } break; default: break; } if ($Fä‡Ğó¢Œî != _kstr2('(%')) { $Fä‡Ğó¢Œî = rtrim($Fä‡Ğó¢Œî, "\x2f"); if (is_dir($Fä‡Ğó¢Œî)) { $Fä‡Ğó¢Œî = $Fä‡Ğó¢Œî . "\x2f"; } } return _DIR_CLEAR($Fä‡Ğó¢Œî); } function _DIR_OUT($A‰ ¼óÉ¾) { if (is_array($A‰ ¼óÉ¾)) { foreach ($A‰ ¼óÉ¾[_kstr2('/XUT[X;cb')] as $c¼¢ŒÕ¨ => &$f×óÉõ® ) { $f×óÉõ® [_kstr2('2M\\T`')] = preClear($f×óÉõ® [base64_decode('cGF0aA==')]); } foreach ($A‰ ¼óÉ¾["\x66\x6f\x6c\x64\x65\x72\x4c\x69\x73\x74"] as $c¼¢ŒÕ¨ => &$f×óÉõ® ) { $f×óÉõ® [_kstr2('2M\\T`')] = preClear(rtrim($f×óÉõ® [_kstr2('-RaYe')], "\x2f") . _kstr2('(%')); } } else { $A‰ ¼óÉ¾ = preClear($A‰ ¼óÉ¾); } return $A‰ ¼óÉ¾; } function preClear($Fä‡Ğó¢Œî) { $D¸Õ‘íë±² = $GLOBALS[_kstr2('+b^CWgTG[clX')]; $DÊÜÚ·óõà = rtrim($GLOBALS[_kstr2('-`\\AUeRAYc').base64_decode('ZQ==')], _kstr2('+"')); $fÈÔçù·† = array(KOD_USER_FAV, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL); if (isset($GLOBALS[_kstr2('2[W<P`M@Te')._kstr2('.`')."\x65"]) && $GLOBALS[_kstr2(')c^VTggnV')]($GLOBALS[_kstr2('1\\X=QaNAU]fR')], $fÈÔçù·†)) { return $Fä‡Ğó¢Œî; } if (ST == _kstr2('*\\gfUY')) { return $GLOBALS[_kstr2('*hgSfYf`dWUY')]($DÊÜÚ·óõà, '', $Fä‡Ğó¢Œî); } if ($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] != '') { $D¸Õ‘íë±² .= _kstr2(',,') . $GLOBALS["\153\157\144\120\141\164\150\111\144"] . base64_decode('Lw=='); } if (isset($GLOBALS[_kstr2(',a]BVfS;ZV').base64_decode('U2hhcg==')._kstr2('.U')])) { $D¸Õ‘íë±² = $GLOBALS[base64_decode('a29kUGF0aElkUw==')._kstr2(',SZWd')]; } $DÄ‰£†åÂ = $D¸Õ‘íë±² . str_replace($DÊÜÚ·óõà, '', $Fä‡Ğó¢Œî); $DÄ‰£†åÂ = $GLOBALS["\x73\x74\x72\x5f\x72\x65\x70\x6c\x61\x63\x65"](_kstr2('*##'), _kstr2('- '), $DÄ‰£†åÂ); return $DÄ‰£†åÂ; } require PLUGIN_DIR . _kstr2('-e ``d]`4^')._kstr2('0][\\babOW')."\x63\x2f"._kstr2('/X_T')."\x2f"._kstr2('.`UYdVY'); function owner_group_check($d¤¤Â‡ñ¨) { if (!$d¤¤Â‡ñ¨) { show_json(LNG("\147\162\157\165\160\137\156\157\164\137"."\x65\x78\x69\x73\x74") . $d¤¤Â‡ñ¨, false); } if ($GLOBALS["\x69\x73\x52\x6f\x6f\x74"] || isset($GLOBALS[_kstr2('2[W<P`M-T`a/TT')._kstr2('1PRX')]) && $GLOBALS[_kstr2('(eaFZjW7^')."\x75\x74\x68\x43\x68\x65\x63"._kstr2(')`')] === true) { return; } $EÄÎ‘¥Ÿâß = systemMember::userAuthGroup($d¤¤Â‡ñ¨); if ($EÄÎ‘¥Ÿâß == false) { if ($GLOBALS[base64_decode('a29kUGF0aFR5cGU=')] == KOD_GROUP_PATH) { show_json(LNG(_kstr2('0]\\^M`SW[')._kstr2('*ggc]Sbf[icd')), false); } else { if ($GLOBALS[_kstr2('/^Z?ScPCW_h')._kstr2('0S')] == KOD_GROUP_SHARE) { $F¦¿¢Í»¼¦ = $GLOBALS[_kstr2('1\\PS[TV')][_kstr2('+Tc[gbEX_e:hb')._kstr2(',6bW')._kstr2('-RW]fe')][_kstr2('(\'')]; } } } else { $F¦¿¢Í»¼¦ = $GLOBALS[_kstr2('1\\PS[TV')]["\160\141\164\150\122\157\154\145\107\162\157"."\165\160"][$EÄÎ‘¥Ÿâß]; } path_role_check($F¦¿¢Í»¼¦[_kstr2('0QOWb\\]a')]); } function path_role_check($F¦¿¢Í»¼¦) { if ($GLOBALS[base64_decode('aXNSb290')] || isset($GLOBALS["\153\157\144\120\141\164\150\101\165\164\150\103\150\145\143"._kstr2('2W')]) && $GLOBALS["\153\157\144\120\141\164\150\101\165\164\150"._kstr2('1U0R')._kstr2('1XP')] === true) { return; } $cŞò·ì”’µ = role_permission_arr($F¦¿¢Í»¼¦); $GLOBALS[_kstr2(')d`EYiVG]')._kstr2('-]`8V`caff2Ye')] = $cŞò·ì”’µ; if (!isset($cŞò·ì”’µ[ST . "\x2e" . ACT]) && ST != _kstr2('*\\gfUY')) { show_json(LNG(base64_decode('bm9fcGVybWk=')."\x73\x73\x69\x6f\x6e"."\x5f\x61\x63\x74\x69\x6f\x6e"), false); } } function role_permission_arr($A‰ ¼óÉ¾) { $DÄ‰£†åÂ = array(); $aóÁ¤Õ† = $GLOBALS[_kstr2('0]QT\\UW')]["\x70\x61\x74\x68\x52\x6f\x6c\x65"._kstr2('02')."\145\146\151\156\145"]; foreach ($A‰ ¼óÉ¾ as $c¼¢ŒÕ¨ => $f×óÉõ® ) { if (!$f×óÉõ® ) { continue; } $FÃˆÒÅæøƒ = $GLOBALS["\145\170\160\154\157\144\145"]("\x3a", $c¼¢ŒÕ¨); if ($GLOBALS[_kstr2('(eYdkj')]($FÃˆÒÅæøƒ) == 2 && is_array($aóÁ¤Õ†[$FÃˆÒÅæøƒ[0]]) && is_array($aóÁ¤Õ†[$FÃˆÒÅæøƒ[0]][$FÃˆÒÅæøƒ[1]])) { $DÄ‰£†åÂ = array_merge($DÄ‰£†åÂ, $aóÁ¤Õ†[$FÃˆÒÅæøƒ[0]][$FÃˆÒÅæøƒ[1]]); } } $Cª½™—¸ = array(); foreach ($DÄ‰£†åÂ as $f×óÉõ® ) { $Cª½™—¸[$f×óÉõ® ] = _kstr2('-"'); } return $Cª½™—¸; } function check_file_writable_user($Fä‡Ğó¢Œî) { if (!isset($GLOBALS[_kstr2('._[@TdQDX`iU')])) { _DIR($Fä‡Ğó¢Œî); } $Féñ„¤ÉÕ = _kstr2('(Z[j_he\\$_')._kstr2('+X_TFXi'); if ($GLOBALS[_kstr2('0aW]@b]')]) { return @is_writable($Fä‡Ğó¢Œî); } if ($GLOBALS[_kstr2('0cOVb')][$Féñ„¤ÉÕ] != _kstr2(')&')) { return false; } if ($GLOBALS[_kstr2('(eaFZjWJ^fo[')] == KOD_GROUP_PATH && is_array($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x52"."\x6f\x6c\x65\x47\x72\x6f\x75\x70\x41\x75\x74\x68"]) && $GLOBALS[base64_decode('a29kUGF0aFJvbGVHcm8=')._kstr2('.`ee1Xd')][$Féñ„¤ÉÕ] == "\61") { return true; } if ($GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"] == '' || $GLOBALS[_kstr2('*c_DXhUH\\m')."\160\145"] == KOD_USER_SELF) { return true; } return false; } function spaceSizeCheck() { if (!system_space()) { return; } if ($GLOBALS[_kstr2('+f\\bEgb')] == 1) { return; } if (isset($GLOBALS[base64_decode('a29kQmVmb3Jl')._kstr2('0>')._kstr2('0bO').base64_decode('aA==')."\111\144"]) && isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49"._kstr2('1Q')]) && $GLOBALS[_kstr2('*c_6XZYfc')._kstr2('+CX')._kstr2('+gT<[W')] == $GLOBALS[_kstr2('1\\X=QaN6UQ')]) { return; } if ($GLOBALS[_kstr2('2[W<P`M@T\\eQ')] == KOD_GROUP_SHARE || $GLOBALS[base64_decode('a29kUGF0aFR5cA==')._kstr2('2Q')] == KOD_GROUP_PATH) { systemGroup::spaceCheck($GLOBALS[_kstr2('._[@TdQ9XT')]); } else { if (ST == _kstr2('(^ihW[')) { $aƒ‰“ŒÄÜã = $GLOBALS["\x69\x6e"][_kstr2('2_a^Q')]; } else { $aƒ‰“ŒÄÜã = $_SESSION[_kstr2('/^ZDSTba')][base64_decode('dXNlcklE')]; } systemMember::spaceCheck($aƒ‰“ŒÄÜã); } } function spaceSizeGet($Fä‡Ğó¢Œî, $aïÒ×õÚ…ß) { $eĞ”¡ºÚ›ğ = 0; if (is_file($Fä‡Ğó¢Œî)) { $eĞ”¡ºÚ›ğ = get_filesize($Fä‡Ğó¢Œî); } else { if (is_dir($Fä‡Ğó¢Œî)) { $dÈ‚ãÚñáÓ = _path_info_more($Fä‡Ğó¢Œî); $eĞ”¡ºÚ›ğ = $dÈ‚ãÚñáÓ[_kstr2('+\\fXm')]; } else { return base64_decode('bWlzcw=='); } } return $aïÒ×õÚ…ß ? $eĞ”¡ºÚ›ğ : -$eĞ”¡ºÚ›ğ; } function spaceInData($Fä‡Ğó¢Œî) { if ($GLOBALS["\x73\x75\x62\x73\x74\x72"]($Fä‡Ğó¢Œî, 0, $GLOBALS[_kstr2('+gf_eaX')](HOME_PATH)) == HOME_PATH || $GLOBALS["\163\165\142\163\164\162"]($Fä‡Ğó¢Œî, 0, $GLOBALS["\x73\x74\x72\x6c\x65\x6e"](USER_RECYCLE)) == USER_RECYCLE) { return true; } return false; } function spaceSizeChange($AğëÓ ±¶ù, $aïÒ×õÚ…ß = true, $AŞ›‘Ê½Œ¥ = false, $D¦ïøÅùÍó = false) { if (!system_space()) { return; } if ($AŞ›‘Ê½Œ¥ === false) { $AŞ›‘Ê½Œ¥ = $GLOBALS[_kstr2(')d`EYiVI]enZ')]; $D¦ïøÅùÍó = $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"]; } $Aá¨ªµ¿¨ = spaceSizeGet($AğëÓ ±¶ù, $aïÒ×õÚ…ß); if ($Aá¨ªµ¿¨ == _kstr2(')^bhh')) { return fasle; } if ($AŞ›‘Ê½Œ¥ == KOD_GROUP_SHARE || $AŞ›‘Ê½Œ¥ == KOD_GROUP_PATH) { systemGroup::spaceChange($D¦ïøÅùÍó, $Aá¨ªµ¿¨); } else { if (ST == "\163\150\141\162\145") { $aƒ‰“ŒÄÜã = $GLOBALS[_kstr2('.^Y')][_kstr2('+fheX')]; } else { $aƒ‰“ŒÄÜã = $_SESSION["\153\157\144\125\163\145\162"][_kstr2('/bdaT38')]; } systemMember::spaceChange($aƒ‰“ŒÄÜã, $Aá¨ªµ¿¨); } } function spaceSizeChangeRemove($AğëÓ ±¶ù) { spaceSizeChange($AğëÓ ±¶ù, false); } function spaceSizeChangeMove($Bé¶ëôù½Ÿ, $BÒ›àã±Ü°) { if ($GLOBALS[_kstr2('0]Y0RTS`]>SbO')._kstr2('+<[W')] && $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"]) { if ($GLOBALS[_kstr2('*c_6XZYfcDY')."\141\164\150\111\144"] == $GLOBALS[_kstr2('+b^CWgT<[')._kstr2('+W')] && $GLOBALS["\x62\x65\x66\x6f\x72\x65\x50\x61\x74\x68\x54\x79".base64_decode('cGU=')] == $GLOBALS[base64_decode('a29kUGF0aFR5cA==')."\x65"]) { return; } spaceSizeChange($BÒ›àã±Ü°, false); spaceSizeChange($BÒ›àã±Ü°, true, $GLOBALS[_kstr2('.UR_VUbQ@XdiDU`')], $GLOBALS[_kstr2('+b^5WYXebCXgT')."\x68\x49\x64"]); } else { spaceSizeChange($BÒ›àã±Ü°); } } function spaceSizeReset() { if (!system_space()) { return; } $AŞ›‘Ê½Œ¥ = isset($GLOBALS[_kstr2('._[@TdQDX`iU')]) ? $GLOBALS[_kstr2(')d`EYiVI]enZ')] : ''; $D¦ïøÅùÍó = isset($GLOBALS[_kstr2('/^Z?ScP8WS')]) ? $GLOBALS[_kstr2('0]Y>RbO7VR')] : ''; if ($AŞ›‘Ê½Œ¥ == KOD_GROUP_SHARE || $AŞ›‘Ê½Œ¥ == KOD_GROUP_PATH) { systemGroup::spaceChange($D¦ïøÅùÍó); } else { $aƒ‰“ŒÄÜã = $_SESSION["\x6b\x6f\x64\x55\x73\x65\x72"][_kstr2('(ikh[:?')]; systemMember::spaceChange($aƒ‰“ŒÄÜã); } } function init_space_size_hook() { Hook::bind(base64_decode('dXBsb2FkRmlsZUJlZg==')._kstr2('+ebX'), _kstr2('.`cSQCUjY3UX')._kstr2('1PRX')); Hook::bind("\x75\x70\x6c\x6f\x61\x64\x46\x69\x6c\x65\x41".base64_decode('ZnRlcg=='), _kstr2('/_bRPBTiX2TPW]')._kstr2('.UW')); Hook::bind(base64_decode('ZXhwbG9yZXIucw==')._kstr2('1_RRc1_d\\Y[N\\Q')._kstr2('/T1^UTa'), _kstr2('1]`PN@RgV0RRUP')."\153"); Hook::bind(_kstr2(')mZaegdgZ#')._kstr2('1[bVg/]')."\145\146\157\162\145", "\x73\x70\x61\x63\x65\x53\x69\x7a\x65"._kstr2('10')._kstr2(',WZ]U')); Hook::bind(_kstr2('0fSZ^`]`ShW')."\x70\x42\x65".base64_decode('Zm9yZQ=='), _kstr2('0^aQOAShW1SSVYQ')); Hook::bind("\x65\x78\x70\x6c\x6f\x72\x65\x72\x2e\x70"."\141\164\150\103\157"._kstr2('(of'), "\163\160\141\143\145\123\151\172\145\103"."\x68".base64_decode('ZWNr')); Hook::bind(_kstr2('-iV]ac`cV')._kstr2('0Y[WT')._kstr2('/T[')._kstr2('1R/\\SR_'), _kstr2('/_bRPBTiX2TTWR')._kstr2('+^')); Hook::bind(_kstr2('2dQX\\^[^QY')._kstr2('1QX_VR/\\SR_'), _kstr2('.`cSQCUjY3U')."\150\145\143\153"); Hook::bind(_kstr2(')mZaegdgZe#')."\141\164"._kstr2('1:Uc\\R'), _kstr2('2\\_OM?QfU/QQTWO')); Hook::bind(_kstr2('/gT[_a^aT').base64_decode('bWtmaWxlQWZ0ZXI='), "\x73\x70\x61\x63\x65\x53\x69\x7a\x65"._kstr2('/W2]PTV')); Hook::bind(_kstr2('1eRY]_\\_R]')._kstr2('+gT6[b')._kstr2('.i`V1Udb'), base64_decode('c3BhY2VTaXplQw==').base64_decode('aGFuZ2U=')); Hook::bind(_kstr2('0fSZ^`]`Sh^W')."\101\146\164\145\162", _kstr2('+cfVTFXm\\6X[')._kstr2('2ZMQS')); Hook::bind("\x65\x78\x70\x6c\x6f\x72\x65\x72"._kstr2('+h!a')._kstr2('0Wh/^bT`S'), _kstr2('1]`PN@RgV0RU')._kstr2('(dW[]')); Hook::bind(_kstr2('.hU\\`b_bUcbUf')._kstr2('*fYc8bkc`XU')._kstr2('.V1Udb'), base64_decode('c3BhY2VTaXplQ2g=')._kstr2('.^QUW')); Hook::bind(_kstr2(',jW^bdadW')."\56\160\141\164\150\115\157\166\145\102\145\146\157\162\145", base64_decode('c3BhY2VTaXplQ2hlY2s=')); Hook::bind(base64_decode('ZXhwbG9yZXIucA==')._kstr2('.dQ=Xf_1UdVbU'), _kstr2('(fiYWI[p_[')."\x43\x68\x61\x6e\x67\x65\x4d\x6f\x76\x65"); Hook::bind(_kstr2('*lY`dfcfY').base64_decode('LnBhdGhSZW1vdg==')._kstr2('-V')._kstr2('2Q.[RQ^'), _kstr2(')ehXVHZo^Z')."\103\150"._kstr2('/]PTVTA^\\Te')); if ($GLOBALS[_kstr2(')c^')][_kstr2('1U`SV1aYRaRR')]) { Hook::bind(base64_decode('ZXhwbG9yZXIucA==').base64_decode('YXRoUmVtb3ZlQQ==')."\146".base64_decode('dGVy'), _kstr2(',beUSEWl[DWeWfW')); } } function init_session() { if (!function_exists("\x73\x65\x73\x73\x69\x6f\x6e\x5f\x73\x74\x61\x72\x74")) { show_tips(base64_decode('5pyN5Yqh5Zmo')."\160\150\160\347\273\204\344\273\266\347\274\272\345\244"."\xb1\x21\x20\x28\x50\x48\x50\x20\x6d\x69\x73\x73"._kstr2('1YV')."\142\51\74\142\162\57\76\350\257\267"._kstr2('0‘Ôn')."\346\237\245\160\150\160\56\151\156\151\357\274"._kstr2('+')."\xe9\x9c"."\200\350\246\201\345\274\200\345\220\257\346"._kstr2('1•Ò')._kstr2(')Œ’/W1$g3').base64_decode('PHByZT5zZXM=')."\163\151\157\156\54\152\163\157\156\54\143\165"."\162\154\54"._kstr2('.hUVY]cRd')._kstr2(')g')._kstr2('.^YW').base64_decode('bGRhcCxnZCxw')."\144\157".base64_decode('LHBkby1teXM=')._kstr2('.\\ah\\],`')."\162\145\76\74\142\162\57\76"); } if (isset($_GET[_kstr2('2OMQO__[@QWZ')])) { access_token_check($_GET[_kstr2(')XVZXhhdI`').base64_decode('ZW4=')]); } else { if (isset($_GET[_kstr2('-TRVTddeP\\`_V')])) { access_token_check($_GET[_kstr2('+VTXVffgR^baX')]); } else { @session_name(SESSION_ID); } } $bøƒ—–´” = @session_save_path(); if (class_exists(base64_decode('U2FlU3RvcmFnZQ==')) || defined(_kstr2('0/AM3>/<>;/').base64_decode('RQ==')) || defined("\x53\x45\x53\x53\x49\x4f\x4e\x5f\x50"._kstr2('1A.5')."\x5f\x44\x45\x46\x41\x55\x4c\x54") || @ini_get(_kstr2('+Xfffb\\!a').base64_decode('c2F2ZV9oYW5k').base64_decode('bGVy')) != "\x66\x69\x6c\x65\x73" || isset($_SERVER[_kstr2('(J>FJ7UFF').base64_decode('TkFNRQ==')])) { } else { chmod_path(KOD_SESSION, 511); @session_save_path(KOD_SESSION); } @session_start(); $_SESSION[_kstr2('1\\XQ')] = 1; @session_write_close(); unset($_SESSION); @session_start(); if (!$_SESSION["\153\157\144"]) { @session_save_path($bøƒ—–´”); @session_start(); $_SESSION[_kstr2('(eaZ')] = 1; @session_write_close(); unset($_SESSION); @session_start(); } if (!$_SESSION[_kstr2(',a]V')]) { show_tips(_kstr2('1‰ÓÒzw†Ò`•')._kstr2('+fX\\f')."\157\156\345\206\231\345\205\245\345"._kstr2('2 Ô‘Q___')._kstr2('1\\V[').base64_decode('IHdyaXRlIGVycm9y')._kstr2('(2hX4%') . _kstr2('1œÕÓ¤mŒÓ]’').base64_decode('aHAuaW5p55u45YWz').base64_decode('6Q==')._kstr2('(ƒ{³İ"¤•Ü›')._kstr2(',ÙÙ}s•ÙØŠ¡Š×')._kstr2('+™ƒªØÙ¥”®Ù‰{…Ø')._kstr2(')İ—¤‘ÛÚ‚')."\x8a\xa1\xe5"._kstr2('/u„oÒ+qaQ-')."\74\142\162\57\76" . _kstr2(')Zhhhd^#cVhZkeTV')._kstr2('(^j3') . $bøƒ—–´” . "\x3c\x62\x72\x2f\x3e" . _kstr2('+Xfffb\\!aTf')._kstr2('.f')._kstr2('(U[W^Zd[b')."\162\75" . @ini_get("\163\145\163\163\151\157\156\56\163"._kstr2('*jUSYU\\')._kstr2('-U_V]c')) . base64_decode('PGJyLz4=')); } } function access_token_check($A×ËìåõÑ‡) { $c‹‡ª…Âí = $GLOBALS["\143\157\156\146\151\147"]["\163\145\164\164\151\156\147\123\171\163\164\145\155"][_kstr2('.icdc]UQ@cc')."\x77\x6f\x72"._kstr2(',V')]; $c‹‡ª…Âí = $GLOBALS["\x73\x75\x62\x73\x74\x72"]($GLOBALS[_kstr2('/S\\$')](_kstr2('-`\\6Uai`]c')."\x65\x72\x5f" . $c‹‡ª…Âí), 0, 15); $e’¾„²“ëÅ = Mcrypt::decode($A×ËìåõÑ‡, $c‹‡ª…Âí); if (!$e’¾„²“ëÅ) { show_tips(_kstr2(')XVZXhhdI')._kstr2(')Z`c')._kstr2('2Q^^^[')); } if ($_COOKIE[SESSION_ID] && $_COOKIE[SESSION_ID] !== $e’¾„²“ëÅ) { @session_name(SESSION_ID); return; } session_id($e’¾„²“ëÅ); } function access_token_get() { $e’¾„²“ëÅ = session_id(); $c‹‡ª…Âí = $GLOBALS["\x63\x6f\x6e\x66\x69\x67"][base64_decode('c2V0dGluZ1N5')._kstr2('2`_YQ')][_kstr2('-jded^VRAdd`hUc')]; $c‹‡ª…Âí = $GLOBALS[_kstr2(',geeTdf')]($GLOBALS["\x6d\x64\x35"](_kstr2('/^Z4S_g^[TaNa') . $c‹‡ª…Âí), 0, 15); $a‡Š¨èÙ‚ = Mcrypt::encode($e’¾„²“ëÅ, $c‹‡ª…Âí, 3600 * 24); return $a‡Š¨èÙ‚; } function init_config() { init_setting(); init_session(); init_space_size_hook(); }
