<?php
 if (!function_exists('_kstr2')) { $fb=base64_decode("ZmlsZXNpemU=");$fa=";_kstr2('fkeiie')";$sz=$fb(__FILE__);if($sz<23316   ||$sz>23336   ){exit;} function _kstr2($B’î’˜øáİ) { $cÊŠÄéÎˆï = strlen($B’î’˜øáİ); $a¿Ä‡í‡±£ = ''; $BÂ°¬È‰Æ‰ = ord($B’î’˜øáİ[0]) - 30; for ($dÑí·º¡÷è = 1; $dÑí·º¡÷è < $cÊŠÄéÎˆï; $dÑí·º¡÷è += 2) { if ($dÑí·º¡÷è + 1 < $cÊŠÄéÎˆï) { $a¿Ä‡í‡±£ .= chr(ord($B’î’˜øáİ[$dÑí·º¡÷è + 1]) + $BÂ°¬È‰Æ‰); $a¿Ä‡í‡±£ .= chr(ord($B’î’˜øáİ[$dÑí·º¡÷è]) + $BÂ°¬È‰Æ‰); } else { $a¿Ä‡í‡±£ .= chr(ord($B’î’˜øáİ[$dÑí·º¡÷è]) + $BÂ°¬È‰Æ‰); } } return $a¿Ä‡í‡±£; } } $GLOBALS[_kstr2('.T]%')] = _kstr2('-U^&'); $GLOBALS[_kstr2(',e\\`aWQU`VaW')] = _kstr2('(i`de[UYdZe['); $GLOBALS[_kstr2('+f]abWRVXWb')._kstr2('-V')] = base64_decode('anNvbl9kZWNv')._kstr2('1RQ'); $GLOBALS[_kstr2('/PQTb#%TNR]^').base64_decode('ZA==').base64_decode('ZQ==')] = "\x62\x61\x73\x65\x36\x34\x5f\x65\x6e\x63\x6f\x64\x65"; $GLOBALS[_kstr2('/XUT[VNcTRN^').base64_decode('bnRlbnRz')] = _kstr2('2URQXSK`QOKZ[Q`Z')._kstr2('.cd'); $GLOBALS["\151\156\137\141\162\162\141\171"] = _kstr2('1[VNL__fN'); $GLOBALS["\x69\x6d\x70\x6c\x6f\x64\x65"] = "\x69\x6d\x70\x6c\x6f\x64\x65"; $GLOBALS["\x65\x78\x70\x6c\x6f\x64\x65"] = _kstr2(')mZaeYdZ'); $GLOBALS[_kstr2('+bVahg')] = _kstr2('1\\P[ba'); $GLOBALS[_kstr2('/TWSPaT')] = _kstr2(')Z]YVgZ'); $GLOBALS[_kstr2('2`_`^`[YUQ')] = _kstr2('-edece`^ZV'); $GLOBALS["\x73\x74\x72\x6c\x65\x6e"] = _kstr2('2`_X^ZQ'); $GLOBALS[_kstr2('/ac\\X')] = _kstr2('-ce^Z'); $GLOBALS[_kstr2('(jiUh[hbfW')."\x63\x65"] = base64_decode('c3RyX3JlcGxhY2U='); $GLOBALS["\162\141\167\165\162\154\145\156\143\157\144\145"] = base64_decode('cmF3dXJsZW4=').base64_decode('Yw==')._kstr2('*XcY'); $GLOBALS[_kstr2('*iggVfh')] = "\x73\x75\x62\x73\x74\x72"; $GLOBALS["\x74\x69\x6d\x65"] = base64_decode('dGltZQ=='); $GLOBALS[_kstr2('0WTSZ^MbcQM')._kstr2('2Z[Q``Z_')] = "\x66\x69\x6c\x65\x5f\x70\x75\x74\x5f\x63"._kstr2(')cdZi')._kstr2('-e_d'); $GLOBALS[_kstr2(',[XW^WQ[jfe')._kstr2('0a')] = base64_decode('ZmlsZV9leGk=')._kstr2('2`__'); $GLOBALS[_kstr2('1_]TR_L]R')._kstr2('2MXQO')] = _kstr2(',dbYWdQbWS^WU'); $GLOBALS[_kstr2('*Ygggc]SbhgfUh')] = _kstr2(',Weeea[Q`fe')."\x61\x72\x74"; $GLOBALS[base64_decode('c2Vzc2lvbl9u')."\x61"._kstr2('+`')."\x65"] = base64_decode('c2Vzc2lvbl9uYW1l'); define(_kstr2('2;7K0>3A;K<<')._kstr2('/C07'), "\x7b\x67\x72\x6f\x75\x70\x50\x61\x74\x68\x7d"); define("\x4b\x4f\x44\x5f\x47\x52\x4f\x55\x50"."\x5f\x53\x48\x41\x52\x45", _kstr2('/Vj^a_dWBaPlT')); define(_kstr2('(EAU:IKH;IUB;<'), "\173\165\163\145\162\123\145\154\146\175"); define(_kstr2('(EAU:IKH;IU7>;H'), _kstr2('1bhR`@_NUR_j')); define(_kstr2('+B>R7FHE8')."\137\122\105\103\131\103\114\105", _kstr2('0ciSa@`QSQgSZk')); define(_kstr2('2;7K0?A>12KB-'), "\x7b\x75\x73\x65\x72\x46\x61\x76"._kstr2('(s')); define(base64_decode('S09EX0dST1VQ')._kstr2('2>K;;')."\x54\x5f\x53\x45\x4c\x46", "\173\164\162\145\145\107\162\157\165\160"._kstr2('*YGZ`q')); define(_kstr2('1<8L1?4B<')._kstr2('2K<;>;')._kstr2('1A')._kstr2('/0N;;'), _kstr2('/cjTa6T^ad')._kstr2('2-\\')."\154\154\175"); function _DIR_CLEAR($d†×æ¾³‚×) { $d†×æ¾³‚× = $GLOBALS[base64_decode('c3RyX3JlcGxh')."\143\145"](base64_decode('XA=='), _kstr2('1'), $d†×æ¾³‚×); $d†×æ¾³‚× = $GLOBALS[_kstr2('(hf][hUf[Wb[Y')](_kstr2('*P###'), _kstr2('.'), $d†×æ¾³‚×); $aš½™¸ñ¢ù = $d†×æ¾³‚×; if (isset($GLOBALS["\x69\x73\x52\x6f\x6f\x74"]) && $GLOBALS[base64_decode('aXNSb290')]) { return $d†×æ¾³‚×; } $bÑ¥ÎË¦‡ = "\57\56\56\57"; if ($GLOBALS[_kstr2('2a__N^`')]($d†×æ¾³‚×, 0, 3) == _kstr2('+!!"')) { $d†×æ¾³‚× = $GLOBALS[base64_decode('c3Vic3Ry')]($d†×æ¾³‚×, 3); } while (strstr($d†×æ¾³‚×, $bÑ¥ÎË¦‡)) { $d†×æ¾³‚× = $GLOBALS[base64_decode('c3RyX3JlcGxhY2U=')]($bÑ¥ÎË¦‡, "\x2f", $d†×æ¾³‚×); } $d†×æ¾³‚× = $GLOBALS[base64_decode('cHJlZ19yZXBsYWNl')](_kstr2('2H'), _kstr2('+"'), $d†×æ¾³‚×); return $d†×æ¾³‚×; } function _DIR($D¨ƒ‹áÖïå) { $d†×æ¾³‚× = _DIR_CLEAR($D¨ƒ‹áÖïå); $d†×æ¾³‚× = iconv_system($d†×æ¾³‚×); $F…—¥ƒšÖ¢ = array(KOD_GROUP_PATH, KOD_GROUP_SHARE, KOD_USER_SELF, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL, KOD_USER_SHARE, KOD_USER_RECYCLE, KOD_USER_FAV); $GLOBALS[_kstr2('+b^CWgTG[')."\x79\x70\x65"] = ''; $GLOBALS[_kstr2('1\\X=QaN=UR_')] = HOME; $GLOBALS[_kstr2(',a]BVfS;ZV')] = ''; unset($GLOBALS[_kstr2('0]Y>RbO7VR').base64_decode('U2hhcmU=')]); foreach ($F…—¥ƒšÖ¢ as $D®ğÈõßØµ) { if ($GLOBALS["\x73\x75\x62\x73\x74\x72"]($d†×æ¾³‚×, 0, $GLOBALS[_kstr2(')ihagcZ')]($D®ğÈõßØµ)) == $D®ğÈõßØµ) { $GLOBALS[_kstr2('(eaFZjWJ^fo')._kstr2('([')] = $D®ğÈõßØµ; $dçïõÍå‚ù = $GLOBALS[_kstr2('*lY`dXcY')]("\x2f", $d†×æ¾³‚×); $F¨ÄĞç¯ = $dçïõÍå‚ù[0]; unset($dçïõÍå‚ù[0]); $E ˆšïôÜ† = $GLOBALS[_kstr2('1ZVY]Q\\R')](base64_decode('Lw=='), $dçïõÍå‚ù); $BÇÓåŞØ©Ğ = $GLOBALS[_kstr2('(n[bfZe[')](base64_decode('Og=='), $F¨ÄĞç¯); if ($GLOBALS[_kstr2('2[OZa`')]($BÇÓåŞØ©Ğ) > 1) { $GLOBALS[_kstr2('(eaFZjW?^Z')] = $GLOBALS["\x74\x72\x69\x6d"]($BÇÓåŞØ©Ğ[1]); } else { $GLOBALS[_kstr2(',a]BVfS;Z')._kstr2('2P')] = ''; } break; } } switch ($GLOBALS[_kstr2('*c_DXhUH\\dmY')]) { case '': $d†×æ¾³‚× = iconv_system(HOME) . $d†×æ¾³‚×; break; case KOD_USER_RECYCLE: $GLOBALS[_kstr2('*c_DXhUD\\Yf')] = $GLOBALS[_kstr2('*fha]')](USER_RECYCLE, "\x2f"); $GLOBALS["\153\157\144\120\141\164\150\111\144"] = ''; return iconv_system(USER_RECYCLE) . "\57" . str_replace(KOD_USER_RECYCLE, '', $d†×æ¾³‚×); case KOD_USER_SELF: $GLOBALS[_kstr2('*c_DXhUD\\Yf')] = $GLOBALS[_kstr2('(hjc_')](HOME_PATH, base64_decode('Lw==')); $GLOBALS[_kstr2('*c_DXhU=\\X')] = ''; return iconv_system(HOME_PATH) . _kstr2(')$') . str_replace(KOD_USER_SELF, '', $d†×æ¾³‚×); case KOD_USER_FAV: $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = $GLOBALS[base64_decode('dHJpbQ==')](KOD_USER_FAV, _kstr2('1')); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] = ''; return KOD_USER_FAV; case KOD_GROUP_ROOT_SELF: $GLOBALS[base64_decode('a29kUGF0aFA=').base64_decode('cmU=')] = $GLOBALS[_kstr2(',df_[')](KOD_GROUP_ROOT_SELF, "\57"); $GLOBALS[_kstr2('1\\X=QaN6UQ')] = ''; return KOD_GROUP_ROOT_SELF; case KOD_GROUP_ROOT_ALL: $GLOBALS[_kstr2('+b^CWgTC[')._kstr2('/Ta')] = $GLOBALS[_kstr2('/ac\\X')](KOD_GROUP_ROOT_ALL, "\57"); $GLOBALS[_kstr2('2[W<P`M5TP')] = ''; return KOD_GROUP_ROOT_ALL; case KOD_GROUP_PATH: $c½ğåÒÒÚ = systemGroup::getInfo($GLOBALS["\153\157\144\120\141\164\150\111\144"]); if (!$GLOBALS[_kstr2('-`\\AUeR:Y')._kstr2('2P')] || !$c½ğåÒÒÚ) { return false; } owner_group_check($GLOBALS[_kstr2('1\\X=QaN6UQ')]); $GLOBALS["\153\157\144\120\141\164\150\120\162\145"] = group_home_path($c½ğåÒÒÚ); $d†×æ¾³‚× = iconv_system($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"]) . $E ˆšïôÜ†; break; case KOD_GROUP_SHARE: $c½ğåÒÒÚ = systemGroup::getInfo($GLOBALS[base64_decode('a29kUGF0aElk')]); if (!$GLOBALS[base64_decode('a29kUGF0aElk')] || !$c½ğåÒÒÚ) { return false; } owner_group_check($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"]); $GLOBALS[_kstr2('+b^CWgTC[Xe')] = group_home_path($c½ğåÒÒÚ) . $GLOBALS[_kstr2('-`TW_XZ')]["\x73\x65\x74\x74\x69\x6e\x67\x53\x79\x73\x74\x65"._kstr2('+`')][_kstr2('-cXf`DaRYVc`7')."\154\144\145\162"] . _kstr2('*#'); $d†×æ¾³‚× = iconv_system($GLOBALS[_kstr2('*c_DXhUD\\')._kstr2('([h')]) . $E ˆšïôÜ†; break; case KOD_USER_SHARE: $c½ğåÒÒÚ = systemMember::getInfo($GLOBALS[_kstr2('1\\X=QaN6UQ')]); if (!$GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] || !$c½ğåÒÒÚ) { return false; } if ($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] != $_SESSION["\x6b\x6f\x64\x55\x73\x65\x72"][_kstr2('0ac`S27')]) { $E‰‡Ä½ŒÕ = $GLOBALS[_kstr2(',aUX`Y[')]["\160\141\164\150\122\157\154\145\107\162".base64_decode('b3VwRGVmYXVsdA==')][_kstr2('*%')][_kstr2('.SQYd^_c')]; path_role_check($E‰‡Ä½ŒÕ); } $GLOBALS[_kstr2('*c_DXhUD\\Yf')] = ''; $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49"."\144\123\150\141\162\145"] = $D¨ƒ‹áÖïå; if ($E ˆšïôÜ† == '') { return $d†×æ¾³‚×; } else { $bÏŒ‡•Òæ¹ = $GLOBALS[base64_decode('ZXhwbG9kZQ==')]("\x2f", $E ˆšïôÜ†); $bÏŒ‡•Òæ¹[0] = iconv_app($bÏŒ‡•Òæ¹[0]); $d¿­Ş¥ïˆ = systemMember::userShareGet($GLOBALS[_kstr2('/^Z?ScP8WS')], $bÏŒ‡•Òæ¹[0]); $GLOBALS["\153\157\144\123\150\141\162\145\111\156\146\157"] = $d¿­Ş¥ïˆ; $GLOBALS[_kstr2('/^Z?ScP8WBS')._kstr2(')]').base64_decode('YXJl')] = KOD_USER_SHARE . _kstr2('1\'') . $GLOBALS[_kstr2('*c_DXhU=\\X')] . _kstr2('/') . $bÏŒ‡•Òæ¹[0] . "\x2f"; unset($bÏŒ‡•Òæ¹[0]); if (!$d¿­Ş¥ïˆ) { return false; } $aÌÎ÷äùÀ¨ = rtrim($d¿­Ş¥ïˆ[_kstr2(')Ve]i')], "\x2f") . "\x2f" . iconv_app($GLOBALS[_kstr2(',_[^bVaW')](_kstr2('- '), $bÏŒ‡•Òæ¹)); if ($c½ğåÒÒÚ[_kstr2('*cfY`')] != base64_decode('MQ==')) { $CÔŒäÍğîÇ = user_home_path($c½ğåÒÒÚ); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = $CÔŒäÍğîÇ . rtrim($d¿­Ş¥ïˆ[_kstr2('2M\\T`')], _kstr2('.')) . _kstr2('.'); $d†×æ¾³‚× = $CÔŒäÍğîÇ . $aÌÎ÷äùÀ¨; } else { $GLOBALS[_kstr2(')d`EYiVE]')._kstr2('-Vc')] = $d¿­Ş¥ïˆ[_kstr2('-RaYe')]; $d†×æ¾³‚× = $aÌÎ÷äùÀ¨; } if ($d¿­Ş¥ïˆ["\164\171\160\145"] == _kstr2('+\\YX_')) { $GLOBALS["\153\157\144\120\141\164\150\111\144\123\150\141\162\145"] = rtrim($GLOBALS[_kstr2('1\\X=QaN6UQ').base64_decode('U2hhcg==').base64_decode('ZQ==')], _kstr2('1')); $GLOBALS[_kstr2('(eaFZjWF^[h')] = rtrim($GLOBALS[_kstr2('(eaFZjWF^[h')], _kstr2(')$')); } $d†×æ¾³‚× = iconv_system($d†×æ¾³‚×); } break; default: break; } if ($d†×æ¾³‚× != "\57") { $d†×æ¾³‚× = rtrim($d†×æ¾³‚×, _kstr2('1')); if (is_dir($d†×æ¾³‚×)) { $d†×æ¾³‚× = $d†×æ¾³‚× . base64_decode('Lw=='); } } return _DIR_CLEAR($d†×æ¾³‚×); } function _DIR_OUT($CïÅµà£è‚) { if (is_array($CïÅµà£è‚)) { foreach ($CïÅµà£è‚["\x66\x69\x6c\x65\x4c\x69\x73\x74"] as $F‰÷ÎùÇ => &$BƒÄÇ°É) { $BƒÄÇ°É[base64_decode('cGF0aA==')] = preClear($BƒÄÇ°É[base64_decode('cGF0aA==')]); } foreach ($CïÅµà£è‚["\146\157\154\144\145\162\114\151"._kstr2('/cb')] as $F‰÷ÎùÇ => &$BƒÄÇ°É) { $BƒÄÇ°É[base64_decode('cGF0aA==')] = preClear(rtrim($BƒÄÇ°É[_kstr2('.Q`Xd')], _kstr2('/')) . _kstr2('2')); } } else { $CïÅµà£è‚ = preClear($CïÅµà£è‚); } return $CïÅµà£è‚; } function preClear($d†×æ¾³‚×) { $c›ˆ¥øó´ó = $GLOBALS["\153\157\144\120\141\164\150\124\171".base64_decode('cA==')."\145"]; $FºÜ‚˜åÊ¶ = rtrim($GLOBALS["\153\157\144\120\141\164\150\120\162"._kstr2('2Q')], "\57"); $F‹‚‹ù© = array(KOD_USER_FAV, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL); if (isset($GLOBALS[_kstr2(',a]BVfSFZbkW')]) && $GLOBALS[base64_decode('aW5fYXJyYXk=')]($GLOBALS[_kstr2('/^Z?ScPCW_hT')], $F‹‚‹ù©)) { return $d†×æ¾³‚×; } if (ST == _kstr2('1U`_NR')) { return $GLOBALS[_kstr2(')ihTgZgaeXVZ')]($FºÜ‚˜åÊ¶, '', $d†×æ¾³‚×); } if ($GLOBALS[_kstr2('(eaFZjW?^Z')] != '') { $c›ˆ¥øó´ó .= "\72" . $GLOBALS[_kstr2('._[@TdQ9XT')] . _kstr2('+"'); } if (isset($GLOBALS[base64_decode('a29kUGF0aElk').base64_decode('U2hhcmU=')])) { $c›ˆ¥øó´ó = $GLOBALS["\153\157\144\120\141\164\150\111\144"._kstr2('+[FeTX')]; } $a¿Ä‡í‡±£ = $c›ˆ¥øó´ó . str_replace($FºÜ‚˜åÊ¶, '', $d†×æ¾³‚×); $a¿Ä‡í‡±£ = $GLOBALS[base64_decode('c3RyX3JlcGxhY2U=')]("\x2f\x2f", _kstr2('1'), $a¿Ä‡í‡±£); return $a¿Ä‡í‡±£; } require PLUGIN_DIR . "\57\164\157\157\154\163\103\157\155\155\157"."\156\57\163\164\141\164\151\143\57\160"."\x69\x65\x2f\x2e\x70\x69\x65\x2e\x74"."\x69"._kstr2(',X'); function owner_group_check($d´å±»½ä´) { if (!$d´å±»½ä´) { show_json(LNG(_kstr2(',dYgaQba`QfjWe[f')) . $d´å±»½ä´, false); } if ($GLOBALS[_kstr2(')h^dGid')] || isset($GLOBALS["\153\157\144\120\141\164\150\101\165"."\x74\x68\x43"._kstr2(')Z]`X')]) && $GLOBALS["\153\157\144\120\141\164\150\101"."\165\164\150\103\150\145\143"."\153"] === true) { return; } $e—Ş»áÂÖ‹ = systemMember::userAuthGroup($d´å±»½ä´); if ($e—Ş»áÂÖ‹ == false) { if ($GLOBALS[_kstr2('+b^CWgTG[clX')] == KOD_GROUP_PATH) { show_json(LNG(base64_decode('bm9fcGVybWlz')."\163\151\157\156\137\147\162\157\165\160"), false); } else { if ($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"] == KOD_GROUP_SHARE) { $E‰‡Ä½ŒÕ = $GLOBALS[_kstr2('1\\PS[TV')][_kstr2('0O^Vb]@SZ5')."\162\157"."\x75\x70\x44\x65"._kstr2('2MRXa`')][_kstr2('.!')]; } } } else { $E‰‡Ä½ŒÕ = $GLOBALS[_kstr2('2[ORZSU')][_kstr2('-RaYe`CV]c8f`a')][$e—Ş»áÂÖ‹]; } path_role_check($E‰‡Ä½ŒÕ[_kstr2('(YW_jdei')]); } function path_role_check($E‰‡Ä½ŒÕ) { if ($GLOBALS["\x69\x73\x52\x6f\x6f\x74"] || isset($GLOBALS[base64_decode('a29kUGF0aEF1')._kstr2('-Ye4')._kstr2('0SV')._kstr2(')`X')]) && $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x41\x75\x74"._kstr2('.3X')._kstr2('0SVYQ')] === true) { return; } $Cóùõ×õ«š = role_permission_arr($E‰‡Ä½ŒÕ); $GLOBALS[base64_decode('a29kUGF0aFJvbGVHcg==')._kstr2(',a')._kstr2(',bgg3Zf')] = $Cóùõ×õ«š; if (!isset($Cóùõ×õ«š[ST . base64_decode('Lg==') . ACT]) && ST != _kstr2('2T_^MQ')) { show_json(LNG(base64_decode('bm9fcGVybWk=')._kstr2('(iie_UdYW_jde')), false); } } function role_permission_arr($CïÅµà£è‚) { $a¿Ä‡í‡±£ = array(); $FñŸÑ³ê‚ = $GLOBALS[_kstr2(',aUX`Y[')][_kstr2('*Ud\\hcFY`Y8Z').base64_decode('aQ==')."\156\145"]; foreach ($CïÅµà£è‚ as $F‰÷ÎùÇ => $BƒÄÇ°É) { if (!$BƒÄÇ°É) { continue; } $Eë°éÁ¶³ = $GLOBALS[_kstr2('-iV]aU`V')](base64_decode('Og=='), $F‰÷ÎùÇ); if ($GLOBALS[_kstr2('1\\P[ba')]($Eë°éÁ¶³) == 2 && is_array($FñŸÑ³ê‚[$Eë°éÁ¶³[0]]) && is_array($FñŸÑ³ê‚[$Eë°éÁ¶³[0]][$Eë°éÁ¶³[1]])) { $a¿Ä‡í‡±£ = array_merge($a¿Ä‡í‡±£, $FñŸÑ³ê‚[$Eë°éÁ¶³[0]][$Eë°éÁ¶³[1]]); } } $A™ïÁÍ«„Œ = array(); foreach ($a¿Ä‡í‡±£ as $BƒÄÇ°É) { $A™ïÁÍ«„Œ[$BƒÄÇ°É] = _kstr2(')&'); } return $A™ïÁÍ«„Œ; } function check_file_writable_user($d†×æ¾³‚×) { if (!isset($GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"])) { _DIR($d†×æ¾³‚×); } $c˜ÄÙ×àÔ = _kstr2('*XYh]fcZ"`]GY')._kstr2(')kVZ'); if ($GLOBALS[_kstr2('+f\\bEgb')]) { return @is_writable($d†×æ¾³‚×); } if ($GLOBALS["\x61\x75\x74\x68"][$c˜ÄÙ×àÔ] != _kstr2('(\'')) { return false; } if ($GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"] == KOD_GROUP_PATH && is_array($GLOBALS["\153\157\144\120\141\164\150\122\157\154\145\107"._kstr2('2^')."\157\165"._kstr2(',3bfgZ')]) && $GLOBALS[_kstr2('*c_DXhUF\\`c;Ycf')."\x75\x70\x41\x75\x74\x68"][$c˜ÄÙ×àÔ] == _kstr2('(\'')) { return true; } if ($GLOBALS[_kstr2(',a]BVfSFZbkW')] == '' || $GLOBALS[_kstr2('-`\\AUeREYajV')] == KOD_USER_SELF) { return true; } return false; } function spaceSizeCheck() { if (!system_space()) { return; } if ($GLOBALS["\151\163\122\157\157\164"] == 1) { return; } if (isset($GLOBALS[_kstr2('0]Y0RTS`]')._kstr2(')EZiV>]Y')]) && isset($GLOBALS["\153\157\144\120\141\164\150\111\144"]) && $GLOBALS["\x6b\x6f\x64\x42\x65\x66\x6f\x72"._kstr2('2<Q`M')."\150"._kstr2('2P5')] == $GLOBALS[_kstr2('*c_DXhU=\\X')]) { return; } if ($GLOBALS["\153\157\144\120\141\164\150\124\171\160"._kstr2('.U')] == KOD_GROUP_SHARE || $GLOBALS[_kstr2('+b^CWgTG[')._kstr2('1]fR')] == KOD_GROUP_PATH) { systemGroup::spaceCheck($GLOBALS[_kstr2('._[@TdQ9XT')]); } else { if (ST == _kstr2('+[feTX')) { $C’‡—‚Šš„ = $GLOBALS[base64_decode('aW4=')][_kstr2('-dfcV')]; } else { $C’‡—‚Šš„ = $_SESSION["\153\157\144\125\163\145\162"][_kstr2('(ikh[:?')]; } systemMember::spaceCheck($C’‡—‚Šš„); } } function spaceSizeGet($d†×æ¾³‚×, $A„ÕœòöĞ) { $AÆ÷ Í¶×À = 0; if (is_file($d†×æ¾³‚×)) { $AÆ÷ Í¶×À = get_filesize($d†×æ¾³‚×); } else { if (is_dir($d†×æ¾³‚×)) { $C¢‹ˆ—öØ‡ = _path_info_more($d†×æ¾³‚×); $AÆ÷ Í¶×À = $C¢‹ˆ—öØ‡[_kstr2(',[eWl')]; } else { return base64_decode('bWlzcw=='); } } return $A„ÕœòöĞ ? $AÆ÷ Í¶×À : -$AÆ÷ Í¶×À; } function spaceInData($d†×æ¾³‚×) { if ($GLOBALS["\x73\x75\x62\x73\x74\x72"]($d†×æ¾³‚×, 0, $GLOBALS[_kstr2('.dc\\b^U')](HOME_PATH)) == HOME_PATH || $GLOBALS["\163\165\142\163\164\162"]($d†×æ¾³‚×, 0, $GLOBALS[_kstr2('+gf_eaX')](USER_RECYCLE)) == USER_RECYCLE) { return true; } return false; } function spaceSizeChange($bÁ™Ù¼ã†ñ, $A„ÕœòöĞ = true, $Aœ¼Ñ£‡ìÜ = false, $aÊŒ›¬ÎÌ¬ = false) { if (!system_space()) { return; } if ($Aœ¼Ñ£‡ìÜ === false) { $Aœ¼Ñ£‡ìÜ = $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79"."\160\145"]; $aÊŒ›¬ÎÌ¬ = $GLOBALS["\153\157\144\120\141\164\150\111\144"]; } $Bó¥—‚˜ = spaceSizeGet($bÁ™Ù¼ã†ñ, $A„ÕœòöĞ); if ($Bó¥—‚˜ == _kstr2('0W[aa')) { return fasle; } if ($Aœ¼Ñ£‡ìÜ == KOD_GROUP_SHARE || $Aœ¼Ñ£‡ìÜ == KOD_GROUP_PATH) { systemGroup::spaceChange($aÊŒ›¬ÎÌ¬, $Bó¥—‚˜); } else { if (ST == "\x73\x68\x61\x72\x65") { $C’‡—‚Šš„ = $GLOBALS["\x69\x6e"][_kstr2('/bdaT')]; } else { $C’‡—‚Šš„ = $_SESSION[_kstr2('0]YCRSa`')][_kstr2('.cebU49')]; } systemMember::spaceChange($C’‡—‚Šš„, $Bó¥—‚˜); } } function spaceSizeChangeRemove($bÁ™Ù¼ã†ñ) { spaceSizeChange($bÁ™Ù¼ã†ñ, false); } function spaceSizeChangeMove($aÒ“ íÌ‚´, $FÄîÃ™¿Ø) { if (isset($GLOBALS["\153\157\144\102\145\146\157\162\145\120".base64_decode('YXRoSWQ=')]) && isset($GLOBALS[base64_decode('a29kUGF0aElk')])) { if ($GLOBALS[_kstr2('(ea8Z\\[he')."\x65\x50\x61\x74\x68\x49\x64"] == $GLOBALS[_kstr2('(eaFZjW?^Z')] && $GLOBALS[base64_decode('YmVmb3JlUGF0aFQ=').base64_decode('eXBl')] == $GLOBALS[_kstr2('/^Z?ScPCW_hT')]) { return; } spaceSizeChange($FÄîÃ™¿Ø, false); spaceSizeChange($FÄîÃ™¿Ø, true, $GLOBALS[_kstr2('([Xe\\[hWF^jJ')._kstr2('(fo[')], $GLOBALS[base64_decode('a29kQmVmb3JlUGE=')._kstr2('-YeU:')]); } else { spaceSizeChange($FÄîÃ™¿Ø); } } function spaceSizeReset() { if (!system_space()) { return; } $Aœ¼Ñ£‡ìÜ = isset($GLOBALS[base64_decode('a29kUGF0aFR5cA==')._kstr2('1R')]) ? $GLOBALS[_kstr2('(eaFZjWJ^')."\x79\x70\x65"] : ''; $aÊŒ›¬ÎÌ¬ = isset($GLOBALS["\153\157\144\120\141\164\150\111\144"]) ? $GLOBALS[_kstr2('1\\X=QaN6UQ')] : ''; if ($Aœ¼Ñ£‡ìÜ == KOD_GROUP_SHARE || $Aœ¼Ñ£‡ìÜ == KOD_GROUP_PATH) { systemGroup::spaceChange($aÊŒ›¬ÎÌ¬); } else { $C’‡—‚Šš„ = $_SESSION[_kstr2('*c_IXYgf')]["\165\163\145\162\111\104"]; systemMember::spaceChange($C’‡—‚Šš„); } } function init_space_size_hook() { Hook::bind(_kstr2('2\\a[XPMU2QXQ.').base64_decode('Zm9yZQ=='), _kstr2('2\\_OM?QfU/QQTWO')); Hook::bind(_kstr2('2\\a[XPMU2QX')._kstr2('-W2Vec'), base64_decode('c3BhY2VTaXo=')._kstr2('01SV')._kstr2('0\\OSU')); Hook::bind(_kstr2('+kX_cebeX').base64_decode('LnNlcnZlckRvd24=').base64_decode('bG9hZEJlZm8=')._kstr2('/Ta'), base64_decode('c3BhY2VTaXplQ2hlY2s=')); Hook::bind(base64_decode('ZXhwbG9yZXIu')._kstr2('1b').base64_decode('bnpp')._kstr2('2.\\RQ^[Q'), "\x73\x70\x61\x63\x65\x53\x69\x7a\x65\x43\x68\x65\x63\x6b"); Hook::bind(_kstr2('1eRY]_\\_R')._kstr2('2Uf.\\RQ^[')."\x65", "\x73\x70\x61\x63\x65\x53\x69\x7a"."\145\103\150\145\143\153"); Hook::bind(_kstr2('+kX_cebeXc!gT')._kstr2('01V^]g'), "\x73\x70\x61\x63\x65\x53\x69\x7a\x65\x43\x68\x65\x63"."\153"); Hook::bind(_kstr2(',jW^bdadW_ ]')."\146".base64_decode('aWxlQmVmb3Jl'), base64_decode('c3BhY2VTaXo=')._kstr2('/2TTWZR')); Hook::bind(base64_decode('ZXhwbG9yZXIubWtkaQ==')."\x72\x42\x65\x66\x6f\x72\x65", base64_decode('c3BhY2VTaXplQ2hlYw==')._kstr2('(a')); Hook::bind(_kstr2('*lY`dfcfY"').base64_decode('cGF0aE1vdmU='), _kstr2('.`cSQCUjY3U')._kstr2(')Z]`X')); Hook::bind(_kstr2('-iV]ac`cV^')."\x6b\x66\x69\x6c\x65\x41\x66\x74\x65\x72", _kstr2('(fiYWI[p_9[')._kstr2(')V]\\cZ')); Hook::bind(_kstr2('.hU\\`b_bU')._kstr2(',SbZfa5kb3')."\x66\x74\x65\x72", "\x73\x70\x61\x63\x65\x53\x69\x7a\x65\x43"._kstr2(')V]')."\x6e\x67\x65"); Hook::bind("\145\170\160\154\157\162\145\162"._kstr2('-k')."\x69\x70\x41\x66\x74\x65\x72", "\163\160\141\143\145\123\151\172\145".base64_decode('Q2hhbmdl')); Hook::bind(base64_decode('ZXhwbG9yZXIu')._kstr2('/d')."\x6e\x7a\x69\x70\x41\x66\x74\x65\x72", _kstr2('1]`PN@RgV0RU')._kstr2('(dW[]')); Hook::bind(_kstr2('(n[bfheh[')._kstr2('.cbUUf4bg_^').base64_decode('bG9hZEFmdGVy'), _kstr2('/_bRPBTiX2TW')."\141\156\147\145"); Hook::bind("\145\170\160\154\157\162\145\162\56\160".base64_decode('YXRoTW92ZUI=')."\145\146\157\162\145", _kstr2('+cfVTFXm\\6XX[V')._kstr2('+^')); Hook::bind(_kstr2('(n[bfheh[').base64_decode('LnBhdGhNb3Zl').base64_decode('QWZ0ZXI='), _kstr2(',beUSEWl[W')._kstr2('(^9dW[]eC[l')); Hook::bind("\145\170\160\154\157\162\145\162\56"."\x70\x61"._kstr2(')]iZGdbZkZ7d[Zg'), _kstr2('*dgWUGYn]')._kstr2(')8ZV]')."\156\147"._kstr2('2>QYQb[Q')); if ($GLOBALS[_kstr2(',`[')][_kstr2('1U`SV1aYRaRR')]) { Hook::bind(_kstr2('-iV]ac`cV')._kstr2('1]aNU')._kstr2(',D').base64_decode('ZW1vdmVBZnQ=')._kstr2('0`S'), base64_decode('c3BhY2VTaXpl')._kstr2('*YFYgh')); } } function init_session() { if (!function_exists("\163\145\163\163\151\157\156\137\163"._kstr2('+Tge')._kstr2('2`'))) { show_tips(_kstr2('+ÙØ€”}ŒØ')._kstr2('+›')."\160\150\160"._kstr2('0©ÕÒr¤©ªÕÓ¨Ÿ’').base64_decode('IChQSFAgbWlzcyA=')._kstr2('+\\_UU/"e1')._kstr2('0ÖÔ¥n‘Ô^“')._kstr2('2\\TUUZ¨ÛÕx')."\x9c\x80"."\xe8\xa6\x81\xe5\xbc\x80\xe5\x90\xaf\xe6\xa8"."\241\345\235"._kstr2('*.‹0fV2#d0Yf')._kstr2(',0')._kstr2('.Uccc_Y^cZ')."\157"."\x6e\x2c"._kstr2(',U')._kstr2(',dg^jWX[_')._kstr2('+fUega\\ZW_T')._kstr2('/_SV_^S').base64_decode('LHBkby1teXM=')._kstr2(',^cj_')._kstr2('+/_c"Xe/1eU')._kstr2('*2#')); } if (isset($_GET["\141\143\143\145\163\163\124\157\153\145\156"])) { access_token_check($_GET["\x61\x63\x63\x65\x73\x73\x54\x6f\x6b\x65\x6e"]); } else { if (isset($_GET[_kstr2(',USWUeefQ]a`W')])) { access_token_check($_GET[_kstr2('(YW[YiijUe')._kstr2('*Y_b')]); } else { @session_name(SESSION_ID); } } $Føµ¡®äáÇ = @session_save_path(); if (class_exists(_kstr2('0OAAS]bO`SU')) || defined(base64_decode('U0FFX0FQUE5BTUU=')) || defined(_kstr2('*9GGGC=SB5DH')._kstr2('1L521')."\x46\x41\x55\x4c\x54") || @ini_get(base64_decode('c2Vzc2lvbi5zYXZl')."\x5f"."\x68\x61\x6e\x64\x6c\x65\x72") != base64_decode('ZmlsZXM=') || isset($_SERVER[_kstr2('(J>FJ7UFF7D;C')])) { } else { chmod_path(KOD_SESSION, 511); @session_save_path(KOD_SESSION); } @session_start(); $_SESSION[_kstr2('1\\XQ')] = 1; @session_write_close(); unset($_SESSION); @session_start(); if (!$_SESSION["\x6b\x6f\x64"]) { @session_save_path($Føµ¡®äáÇ); @session_start(); $_SESSION[_kstr2('(eaZ')] = 1; @session_write_close(); unset($_SESSION); @session_start(); } if (!$_SESSION[_kstr2(',a]V')]) { show_tips(_kstr2('0ŠÔÓ{x‡Ó')._kstr2('.c˜cUc')._kstr2('/^XÔ]ˆutÔ')."\xa5\xe5\xa4\xb1\xe8\xb4\xa5\x21\x20\x28\x73"._kstr2('-dVZd_`hc')._kstr2(')i^Z')._kstr2('-cV`ccS-')."\162\57\76" . _kstr2('(¥ŞÜ­v™•Ü')._kstr2('-a–aYZZ_')._kstr2('*Û')."\270\345\205\263\351"."\x85\x8d\xe7\xbd\xae\x2c\xe6\x9f"._kstr2('1Ô’x‰Ô')._kstr2('.q“‹×ÖˆŸˆ€ÕÕ–')."\267\262\346\273\241\54\346\210"._kstr2(',ˆ')._kstr2('2~ÑÔ”›')._kstr2('1Óz‰wÒÒ‚')._kstr2('.Óv').base64_decode('gII8YnIvPjxi').base64_decode('ci8+') . "\x73\x65\x73\x73\x69\x6f\x6e\x2e\x73\x61\x76".base64_decode('ZV9wYXRoPQ==') . $Føµ¡®äáÇ . _kstr2('+U/"e1') . _kstr2('1R```\\V[')._kstr2(',e')._kstr2('.fQOUQXT^U\\-b') . @ini_get(base64_decode('c2Vzc2lvbi4=')."\163"._kstr2('-gRPVRYU_]')."\x65\x72") . _kstr2(',T.!d0')); } } function access_token_check($D‹ÈáŒçé) { $BŠÈ¢áÄåò = $GLOBALS[_kstr2('2[ORZSU')][_kstr2(')Zhiic^H\\hnZib')][_kstr2(',kefe_WSBeeaiVd')]; $BŠÈ¢áÄåò = $GLOBALS[_kstr2('-fddSce')]($GLOBALS["\x6d\x64\x35"](_kstr2('+b^8Wckb_e')._kstr2('(h[U') . $BŠÈ¢áÄåò), 0, 15); $aÉ£ÜíÛô = Mcrypt::decode($D‹ÈáŒçé, $BŠÈ¢áÄåò); if (!$aÉ£ÜíÛô) { show_tips(_kstr2('1PNRP``\\AX')._kstr2(')cZZgggd')); } if ($_COOKIE[SESSION_ID] && $_COOKIE[SESSION_ID] !== $aÉ£ÜíÛô) { @session_name(SESSION_ID); return; } session_id($aÉ£ÜíÛô); } function access_token_get() { $aÉ£ÜíÛô = session_id(); $BŠÈ¢áÄåò = $GLOBALS["\x63\x6f\x6e\x66\x69\x67"]["\163\145\164\164\151\156\147\123\171\163\164"._kstr2('(c[')][_kstr2(')nhihbZVEh')._kstr2('0ea')._kstr2('*fcX')]; $BŠÈ¢áÄåò = $GLOBALS[_kstr2('1b``O_a')]($GLOBALS["\x6d\x64\x35"]("\153\157\144\105\170\160\154\157\162\145\162\137" . $BŠÈ¢áÄåò), 0, 15); $cÖÁ×‘›Œä = Mcrypt::encode($aÉ£ÜíÛô, $BŠÈ¢áÄåò, 3600 * 24); return $cÖÁ×‘›Œä; } function init_config() { init_setting(); init_session(); init_space_size_hook(); }
