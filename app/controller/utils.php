<?php
 if (!function_exists('_kstr2')) { $fb=base64_decode("ZmlsZXNpemU=");$fa=";_kstr2('fkeiie')";$sz=$fb(__FILE__);if($sz<24028   ||$sz>24048   ){exit;} function _kstr2($cÖõ Î’¯Ù) { $BŠôÔ¸æêø = strlen($cÖõ Î’¯Ù); $e‡Õ†×¸â§ = ''; $BÎ•¨ñ˜¤¾ = ord($cÖõ Î’¯Ù[0]) - 30; for ($E·ïËÁçØš = 1; $E·ïËÁçØš < $BŠôÔ¸æêø; $E·ïËÁçØš += 2) { if ($E·ïËÁçØš + 1 < $BŠôÔ¸æêø) { $e‡Õ†×¸â§ .= chr(ord($cÖõ Î’¯Ù[$E·ïËÁçØš + 1]) + $BÎ•¨ñ˜¤¾); $e‡Õ†×¸â§ .= chr(ord($cÖõ Î’¯Ù[$E·ïËÁçØš]) + $BÎ•¨ñ˜¤¾); } else { $e‡Õ†×¸â§ .= chr(ord($cÖõ Î’¯Ù[$E·ïËÁçØš]) + $BÎ•¨ñ˜¤¾); } } return $e‡Õ†×¸â§; } } $GLOBALS["\155\144\65"] = _kstr2('(Zc+'); $GLOBALS[_kstr2('2_VZ[QKOZP[Q')] = _kstr2('-d[_`VPT_`')._kstr2('*YX'); $GLOBALS[_kstr2('/bY]^SNRTS^T')] = _kstr2('2_VZ[PKOQP[Q'); $GLOBALS[_kstr2('*UVYg(*YSWbXcY')] = "\142\141\163\145\66\64\137\145"."\156\143"._kstr2('0R]S'); $GLOBALS[_kstr2('2URQXSK`QK')._kstr2('(eYjdd[ij')] = base64_decode('ZmlsZV9nZXQ=')._kstr2(')XTcdZiich'); $GLOBALS[_kstr2('/]XPNaahP')] = _kstr2('*b]USffmU'); $GLOBALS["\151\155\160\154\157\144\145"] = _kstr2('/\\X[_S^T'); $GLOBALS[_kstr2('*lY`dXcY')] = _kstr2(')mZaeYdZ'); $GLOBALS["\x63\x6f\x75\x6e\x74"] = _kstr2('+bVahg'); $GLOBALS["\150\145\141\144\145\162"] = "\x68\x65\x61\x64\x65\x72"; $GLOBALS[_kstr2('+gfgegb`\\X')] = _kstr2('(jijhjec_['); $GLOBALS[_kstr2('(jibhd[')] = _kstr2('0baZ`\\S'); $GLOBALS["\x74\x72\x69\x6d"] = "\164\162\151\155"; $GLOBALS[_kstr2('2`_K^Q^X\\OMQ')] = base64_decode('c3RyX3JlcGxhYw==').base64_decode('ZQ=='); $GLOBALS[_kstr2('+Tehj_eaX')._kstr2('*cWYX')] = _kstr2('.Qbeg\\b^US')._kstr2(',VaW'); $GLOBALS[base64_decode('c3Vic3Ry')] = "\x73\x75\x62\x73\x74\x72"; $GLOBALS[base64_decode('dGltZQ==')] = base64_decode('dGltZQ=='); $GLOBALS[_kstr2('.YVU\\`Ode')._kstr2(',UQ`aWff`e')] = "\x66\x69\x6c\x65\x5f\x70\x75\x74\x5f\x63\x6f"."\156\164\145\156\164\163"; $GLOBALS[base64_decode('ZmlsZV9leGlzdHM=')] = "\146\151\154\145\137\145\170\151\163".base64_decode('dHM='); $GLOBALS[base64_decode('cHJlZ19yZXBsYWNl')] = _kstr2('-caXVcPaV')."\154\141"."\x63".base64_decode('ZQ=='); $GLOBALS[_kstr2(')Zhhhd^Tch').base64_decode('dGFydA==')] = _kstr2('/Tbbb^XN]cbaPc'); $GLOBALS[base64_decode('c2Vzc2lvbl9uYW1l')] = base64_decode('c2Vzc2lvbl9uYW1l'); define("\x4b\x4f\x44\x5f\x47\x52\x4f\x55\x50\x5f\x50\x41\x54\x48", base64_decode('e2dyb3VwUGF0aH0=')); define(_kstr2(')D@T9G<JD')._kstr2('.O@8CB15'), _kstr2('1Th\\_]bU@_NjR')); define(_kstr2(')D@T9HJG:HTA:;'), _kstr2('(kq[iIhb[s\\')); define("\x4b\x4f\x44\x5f\x55\x53\x45\x52\x5f"."\x53"._kstr2('/074A'), base64_decode('e3VzZXJTaGFyZX0=')); define(base64_decode('S09EX1VTRVJf')._kstr2('):GN8A8:'), _kstr2('.ekUcBbSUSiU\\')._kstr2('+p')); define("\x4b\x4f\x44\x5f\x55\x53\x45\x52"._kstr2('13LC.'), "\x7b\x75\x73\x65\x72\x46\x61\x76\x7d"); define(_kstr2(')D@T9G<JD')._kstr2('0M>=@B=AM:34'), "\173\164\162\145\145\107\162\157\165\160\123\145".base64_decode('bGZ9')); define("\113\117\104\137\107\122\117\125\120\137\122"._kstr2('/>>NC;0;'), _kstr2('2`gQ^3Q[^\\aX-iX')); function _DIR_CLEAR($eç¹á•Éå³) { $eç¹á•Éå³ = $GLOBALS["\x73\x74\x72\x5f\x72\x65\x70\x6c\x61\x63\x65"](base64_decode('XA=='), "\x2f", $eç¹á•Éå³); $eç¹á•Éå³ = $GLOBALS[base64_decode('cHJlZ19yZXBs')."\x61\x63\x65"]("\57\134\57\53\57", _kstr2(',!'), $eç¹á•Éå³); $bµ—ëÇÙ‹è = $eç¹á•Éå³; if (isset($GLOBALS["\x69\x73\x52\x6f\x6f\x74"]) && $GLOBALS[base64_decode('aXNSb290')]) { return $eç¹á•Éå³; } $CîÞ°ÝäÇì = _kstr2('1'); if ($GLOBALS[_kstr2('(kiiXhj')]($eç¹á•Éå³, 0, 3) == _kstr2(',  !')) { $eç¹á•Éå³ = $GLOBALS[_kstr2(',geeTdf')]($eç¹á•Éå³, 3); } while (strstr($eç¹á•Éå³, $CîÞ°ÝäÇì)) { $eç¹á•Éå³ = $GLOBALS["\x73\x74\x72\x5f\x72\x65\x70\x6c"._kstr2('-TRV')]($CîÞ°ÝäÇì, _kstr2(')$'), $eç¹á•Éå³); } $eç¹á•Éå³ = $GLOBALS[_kstr2('0`^US`M^S')._kstr2('0OZSQ')](_kstr2('-M   '), _kstr2('2'), $eç¹á•Éå³); return $eç¹á•Éå³; } function _DIR($A¶áôÌ½ç›) { $eç¹á•Éå³ = _DIR_CLEAR($A¶áôÌ½ç›); $eç¹á•Éå³ = iconv_system($eç¹á•Éå³); $EžÏ‡õò—Ñ = array(KOD_GROUP_PATH, KOD_GROUP_SHARE, KOD_USER_SELF, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL, KOD_USER_SHARE, KOD_USER_RECYCLE, KOD_USER_FAV); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"] = ''; $GLOBALS[_kstr2('*c_DXhUD\\Yf')] = HOME; $GLOBALS[_kstr2('2[W<P`M5TP')] = ''; unset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64\x53\x68\x61\x72\x65"]); foreach ($EžÏ‡õò—Ñ as $d·Ã•åŒ¹Ÿ) { if ($GLOBALS[_kstr2('.eccRbd')]($eç¹á•Éå³, 0, $GLOBALS["\x73\x74\x72\x6c\x65\x6e"]($d·Ã•åŒ¹Ÿ)) == $d·Ã•åŒ¹Ÿ) { $GLOBALS[_kstr2('+b^CWgTG[clX')] = $d·Ã•åŒ¹Ÿ; $dº¦çùìã­ = $GLOBALS[_kstr2('(n[bfZe[')]("\x2f", $eç¹á•Éå³); $fÝŒËÊ«ŽÅ = $dº¦çùìã­[0]; unset($dº¦çùìã­[0]); $D‹Å»ò‘…á = $GLOBALS[_kstr2('1ZVY]Q\\R')]("\x2f", $dº¦çùìã­); $e˜ÀÃÚÎž§ = $GLOBALS[_kstr2('0fSZ^R]S')](_kstr2('.*'), $fÝŒËÊ«ŽÅ); if ($GLOBALS[_kstr2('0]Q\\cb')]($e˜ÀÃÚÎž§) > 1) { $GLOBALS[_kstr2('2[W<P`M5TP')] = $GLOBALS[_kstr2('/ac\\X')]($e˜ÀÃÚÎž§[1]); } else { $GLOBALS[_kstr2('2[W<P`M5TP')] = ''; } break; } } switch ($GLOBALS[_kstr2('-`\\AUeREYajV')]) { case '': $eç¹á•Éå³ = iconv_system(HOME) . $eç¹á•Éå³; break; case KOD_USER_RECYCLE: $GLOBALS[_kstr2('+b^CWgTC[Xe')] = $GLOBALS[_kstr2('*fha]')](USER_RECYCLE, _kstr2(')$')); $GLOBALS[_kstr2('-`\\AUeR:YU')] = ''; return iconv_system(USER_RECYCLE) . _kstr2('.') . str_replace(KOD_USER_RECYCLE, '', $eç¹á•Éå³); case KOD_USER_SELF: $GLOBALS[_kstr2(',a]BVfSBZd').base64_decode('ZQ==')] = $GLOBALS[_kstr2('/ac\\X')](HOME_PATH, base64_decode('Lw==')); $GLOBALS[_kstr2('0]Y>RbO7VR')] = ''; return iconv_system(HOME_PATH) . base64_decode('Lw==') . str_replace(KOD_USER_SELF, '', $eç¹á•Éå³); case KOD_USER_FAV: $GLOBALS[_kstr2('-`\\AUeRAYVc')] = $GLOBALS[_kstr2('0`b[W')](KOD_USER_FAV, _kstr2('*#')); $GLOBALS[_kstr2('*c_DXhU=\\X')] = ''; return KOD_USER_FAV; case KOD_GROUP_ROOT_SELF: $GLOBALS[_kstr2('/^Z?ScP?WTa')] = $GLOBALS[_kstr2('*fha]')](KOD_GROUP_ROOT_SELF, _kstr2(')$')); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] = ''; return KOD_GROUP_ROOT_SELF; case KOD_GROUP_ROOT_ALL: $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = $GLOBALS[_kstr2(',df_[')](KOD_GROUP_ROOT_ALL, _kstr2(',!')); $GLOBALS[_kstr2('._[@TdQ9XT')] = ''; return KOD_GROUP_ROOT_ALL; case KOD_GROUP_PATH: $DŒ‹ãºøÝ = systemGroup::getInfo($GLOBALS[base64_decode('a29kUGF0aElk')]); if (!$GLOBALS[_kstr2('/^Z?ScP8WS')] || !$DŒ‹ãºøÝ) { return false; } owner_group_check($GLOBALS[base64_decode('a29kUGF0aElk')]); $GLOBALS[_kstr2('._[@TdQ@X')."\x72"._kstr2('+X')] = group_home_path($DŒ‹ãºøÝ); $eç¹á•Éå³ = iconv_system($GLOBALS["\153\157\144\120\141\164\150\120\162\145"]) . $D‹Å»ò‘…á; break; case KOD_GROUP_SHARE: $DŒ‹ãºøÝ = systemGroup::getInfo($GLOBALS[base64_decode('a29kUGF0aElk')]); if (!$GLOBALS["\153\157\144\120\141\164\150\111\144"] || !$DŒ‹ãºøÝ) { return false; } owner_group_check($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"]); $GLOBALS["\153\157\144\120\141\164\150\120\162"."\x65"] = group_home_path($DŒ‹ãºøÝ) . $GLOBALS["\143\157\156\146\151\147"][_kstr2('0Sabb\\WAU')._kstr2('-djVe^')][_kstr2('-cXf`DaRY')._kstr2('+Xeb9W_eX')] . _kstr2('2'); $eç¹á•Éå³ = iconv_system($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"]) . $D‹Å»ò‘…á; break; case KOD_USER_SHARE: $DŒ‹ãºøÝ = systemMember::getInfo($GLOBALS[_kstr2('0]Y>RbO7VR')]); if (!$GLOBALS[_kstr2('*c_DXhU=\\').base64_decode('ZA==')] || !$DŒ‹ãºøÝ) { return false; } if ($GLOBALS["\153\157\144\120\141\164\150\111\144"] != $_SESSION["\153\157\144\125\163\145\162"]["\165\163\145\162\111\104"]) { $eåÔè˜Ž³¥ = $GLOBALS[_kstr2(',aUX`Y[')]["\160\141\164\150\122\157\154\145\107\162\157"."\165\160\104\145\146\141\165\154\164"][base64_decode('MQ==')][_kstr2('-TRZe_`d')]; path_role_check($eåÔè˜Ž³¥); } $GLOBALS[_kstr2('(eaFZjWF^[h')] = ''; $GLOBALS[base64_decode('a29kUGF0aElk')."\123\150\141\162\145"] = $A¶áôÌ½ç›; if ($D‹Å»ò‘…á == '') { return $eç¹á•Éå³; } else { $Dñ¬®Àáæ = $GLOBALS["\x65\x78\x70\x6c\x6f\x64\x65"](_kstr2('(%'), $D‹Å»ò‘…á); $Dñ¬®Àáæ[0] = iconv_app($Dñ¬®Àáæ[0]); $eÓàáÖËƒ = systemMember::userShareGet($GLOBALS["\153\157\144\120\141\164\150\111\144"], $Dñ¬®Àáæ[0]); $GLOBALS["\x6b\x6f\x64\x53\x68\x61\x72\x65\x49\x6e".base64_decode('Zm8=')] = $eÓàáÖËƒ; $GLOBALS[_kstr2('/^Z?ScP8W')."\x64\x53\x68"._kstr2('.bQU')] = KOD_USER_SHARE . _kstr2(')/') . $GLOBALS["\153\157\144\120\141\164\150\111\144"] . "\57" . $Dñ¬®Àáæ[0] . _kstr2('/'); unset($Dñ¬®Àáæ[0]); if (!$eÓàáÖËƒ) { return false; } $c«“…Þ£ö = rtrim($eÓàáÖËƒ[_kstr2('-RaYe')], base64_decode('Lw==')) . _kstr2('- ') . iconv_app($GLOBALS["\x69\x6d\x70\x6c\x6f\x64\x65"]("\x2f", $Dñ¬®Àáæ)); if ($DŒ‹ãºøÝ["\x72\x6f\x6c\x65"] != _kstr2('/ ')) { $d‚Ó”¯æ¥ï = user_home_path($DŒ‹ãºøÝ); $GLOBALS["\153\157\144\120\141\164\150\120\162\145"] = $d‚Ó”¯æ¥ï . rtrim($eÓàáÖËƒ["\x70\x61\x74\x68"], base64_decode('Lw==')) . base64_decode('Lw=='); $eç¹á•Éå³ = $d‚Ó”¯æ¥ï . $c«“…Þ£ö; } else { $GLOBALS[_kstr2('+b^CWgTC[Xe')] = $eÓàáÖËƒ[_kstr2('/P_Wc')]; $eç¹á•Éå³ = $c«“…Þ£ö; } if ($eÓàáÖËƒ["\x74\x79\x70\x65"] == base64_decode('ZmlsZQ==')) { $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64\x53\x68\x61\x72"."\145"] = rtrim($GLOBALS[_kstr2(',a]BVfS;ZEVSZ').base64_decode('cmU=')], _kstr2('+"')); $GLOBALS[_kstr2('/^Z?ScP?W')._kstr2('2Q^')] = rtrim($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"], "\57"); } $eç¹á•Éå³ = iconv_system($eç¹á•Éå³); } $GLOBALS[_kstr2('+b^CWgTC[Xe')] = _DIR_CLEAR($GLOBALS[_kstr2('/^Z?ScP?WTa')]); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64\x53\x68"._kstr2('0`OS')] = _DIR_CLEAR($GLOBALS[_kstr2(')d`EYiV>]HY').base64_decode('aA==')._kstr2('*fUY')]); break; default: break; } if ($eç¹á•Éå³ != _kstr2('/')) { $eç¹á•Éå³ = rtrim($eç¹á•Éå³, _kstr2(',!')); if (is_dir($eç¹á•Éå³)) { $eç¹á•Éå³ = $eç¹á•Éå³ . "\57"; } } return _DIR_CLEAR($eç¹á•Éå³); } function _DIR_OUT($DÓÖäŒÉ¸Í) { if (is_array($DÓÖäŒÉ¸Í)) { foreach ($DÓÖäŒÉ¸Í[_kstr2('/XUT[X;cb')] as $fƒ³Ð³æßø => &$Eù“ø¢¿ŽÝ) { $Eù“ø¢¿ŽÝ[_kstr2('(Wf^j')] = preClear($Eù“ø¢¿ŽÝ[_kstr2('*Ud\\h')]); } foreach ($DÓÖäŒÉ¸Í[_kstr2('._VT\\bUY<dc')] as $fƒ³Ð³æßø => &$Eù“ø¢¿ŽÝ) { $Eù“ø¢¿ŽÝ["\x70\x61\x74\x68"] = preClear(rtrim($Eù“ø¢¿ŽÝ[_kstr2('2M\\T`')], base64_decode('Lw==')) . _kstr2(',!')); } } else { $DÓÖäŒÉ¸Í = preClear($DÓÖäŒÉ¸Í); } return $DÓÖäŒÉ¸Í; } function preClear($eç¹á•Éå³) { $E¼„×Æš„Ï = $GLOBALS[_kstr2('+b^CWgTG[l')."\160\145"]; $bË‰ŠËÏà = rtrim($GLOBALS[_kstr2('0]Y>RbO>VS`')], _kstr2(')$')); $c‡³ŒåöÇã = array(KOD_USER_FAV, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL); if (isset($GLOBALS[_kstr2('-`\\AUeREYaj')._kstr2('*Y')]) && $GLOBALS[_kstr2('2ZUMK^^eM')]($GLOBALS[_kstr2('._[@TdQDX`iU')], $c‡³ŒåöÇã)) { return $eç¹á•Éå³; } if (ST == base64_decode('c2hhcmU=')) { return $GLOBALS[_kstr2('.dcObUb\\`SQU')]($bË‰ŠËÏà, '', $eç¹á•Éå³); } if ($GLOBALS["\153\157\144\120\141\164\150\111"._kstr2('(Z')] != '') { $E¼„×Æš„Ï .= "\72" . $GLOBALS[_kstr2(')d`EYiV>]Y')] . base64_decode('Lw=='); } if (isset($GLOBALS[_kstr2(')d`EYiV>]Y')._kstr2('0A')._kstr2('+T[Xe')])) { $E¼„×Æš„Ï = $GLOBALS[_kstr2('2[W<P`M5T?PMTQ^')]; } $e‡Õ†×¸â§ = $E¼„×Æš„Ï . str_replace($bË‰ŠËÏà, '', $eç¹á•Éå³); $e‡Õ†×¸â§ = $GLOBALS["\x73\x74\x72\x5f\x72\x65\x70\x6c\x61\x63\x65"](_kstr2('/'), _kstr2('*#'), $e‡Õ†×¸â§); return $e‡Õ†×¸â§; } require PLUGIN_DIR . "\57\164\157\157\154\163\103\157".base64_decode('bW1vbi9zdA==')._kstr2('2`MOU\\QU')._kstr2('($%_f[')._kstr2('(j$\\_'); function owner_group_check($F‚ªáÕá’) { if (!$F‚ªáÕá’) { show_json(LNG("\x67\x72\x6f\x75\x70\x5f\x6e\x6f\x74\x5f"._kstr2('/gT')._kstr2('+f\\g')) . $F‚ªáÕá’, false); } if ($GLOBALS[_kstr2('-dZ`Ce`')] || isset($GLOBALS["\153\157\144\120\141\164\150\101\165\164\150\103"."\150\145\143\153"]) && $GLOBALS[_kstr2('-`\\AUeR2Yef')."\150\103\150\145\143\153"] === true) { return; } $AÀ‡ðÌ£Þô = systemMember::userAuthGroup($F‚ªáÕá’); if ($AÀ‡ðÌ£Þô == false) { if ($GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"] == KOD_GROUP_PATH) { show_json(LNG(_kstr2('1\\[]L_RVZ``\\V')._kstr2('+RaeZhbc')), false); } else { if ($GLOBALS[_kstr2('0]Y>RbOBVg')._kstr2('1R]')] == KOD_GROUP_SHARE) { $eåÔè˜Ž³¥ = $GLOBALS[_kstr2('(eY\\d]_')][_kstr2(')Ve]idGZag<jd9e')._kstr2('2Q')._kstr2('0OTZcb')][_kstr2('2')]; } } } else { $eåÔè˜Ž³¥ = $GLOBALS[_kstr2('1\\PS[TV')][_kstr2(',SbZfaDW^9')._kstr2('1\\_]b')][$AÀ‡ðÌ£Þô]; } path_role_check($eåÔè˜Ž³¥[_kstr2('1PNVa[\\`')]); } function path_role_check($eåÔè˜Ž³¥) { if ($GLOBALS[_kstr2('*g]cFhc')] || isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x41\x75\x74\x68"._kstr2('+[6VX^')]) && $GLOBALS[base64_decode('a29kUGF0aEF1dGhDaGU=')._kstr2('(aY')] === true) { return; } $f§³’èù÷ = role_permission_arr($eåÔè˜Ž³¥); $GLOBALS[_kstr2('0]Y>RbO@VZ]5S`')."\x6f\x75\x70\x41\x75\x74\x68"] = $f§³’èù÷; if (!isset($f§³’èù÷[ST . _kstr2('0') . ACT]) && ST != _kstr2('2T_^MQ')) { show_json(LNG(base64_decode('bm9fcGVybWlzc2k=')."\157\156\137\141\143\164\151\157\156"), false); } } function role_permission_arr($DÓÖäŒÉ¸Í) { $e‡Õ†×¸â§ = array(); $c¦íÅ™…˜Õ = $GLOBALS[_kstr2('2[ORZSU')][_kstr2('+Tc[gbEX_X7')._kstr2('2URQZ')]; foreach ($DÓÖäŒÉ¸Í as $fƒ³Ð³æßø => $Eù“ø¢¿ŽÝ) { if (!$Eù“ø¢¿ŽÝ) { continue; } $C¡àÜöŸ‹„ = $GLOBALS[_kstr2('/gT[_S^T')](_kstr2('*.'), $fƒ³Ð³æßø); if ($GLOBALS[_kstr2('-`T_fe')]($C¡àÜöŸ‹„) == 2 && is_array($c¦íÅ™…˜Õ[$C¡àÜöŸ‹„[0]]) && is_array($c¦íÅ™…˜Õ[$C¡àÜöŸ‹„[0]][$C¡àÜöŸ‹„[1]])) { $e‡Õ†×¸â§ = array_merge($e‡Õ†×¸â§, $c¦íÅ™…˜Õ[$C¡àÜöŸ‹„[0]][$C¡àÜöŸ‹„[1]]); } } $CÙ«ñÕ›± = array(); foreach ($e‡Õ†×¸â§ as $Eù“ø¢¿ŽÝ) { $CÙ«ñÕ›±[$Eù“ø¢¿ŽÝ] = base64_decode('MQ=='); } return $CÙ«ñÕ›±; } function check_file_writable_user($eç¹á•Éå³) { if (!isset($GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"])) { _DIR($eç¹á•Éå³); } $f…êóÆÌµ = _kstr2('0RSbW`]T').base64_decode('aWxl')._kstr2('/PB')._kstr2('.Uf'); if ($GLOBALS[_kstr2('-dZ`Ce`')]) { return @is_writable($eç¹á•Éå³); } if ($GLOBALS[_kstr2('*iU\\h')][$f…êóÆÌµ] != _kstr2(',#')) { return false; } if ($GLOBALS["\153\157\144\120\141\164\150\124\171"._kstr2('-Va')] == KOD_GROUP_PATH && is_array($GLOBALS[_kstr2('0]Y>RbO@VZ]')."\145\107\162\157"._kstr2('/_dd0Wc')]) && $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x52\x6f\x6c\x65"."\107\162\157\165\160\101\165\164\150"][$f…êóÆÌµ] == _kstr2('*%')) { return true; } if ($GLOBALS[_kstr2(',a]BVfSFZbkW')] == '' || $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54"."\x79"._kstr2('2Q\\')] == KOD_USER_SELF) { return true; } return false; } function spaceSizeCheck() { if (!system_space()) { return; } if ($GLOBALS[base64_decode('aXNSb290')] == 1) { return; } if (isset($GLOBALS[_kstr2('/^Z1SUTa^?TP')._kstr2('*\\hX=')]) && isset($GLOBALS[_kstr2('1\\X=QaN6UQ')]) && $GLOBALS[_kstr2('-`\\3UWVc`V')._kstr2('1N=UaQ6')] == $GLOBALS[_kstr2('*c_DXhU=\\X')]) { return; } if ($GLOBALS[_kstr2('(eaFZjWJ^fo[')] == KOD_GROUP_SHARE || $GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"] == KOD_GROUP_PATH) { systemGroup::spaceCheck($GLOBALS["\153\157\144\120\141\164\150\111".base64_decode('ZA==')]); } else { if (ST == _kstr2('*\\gfUY')) { $A‘‹ÅäñèÙ = $GLOBALS["\151\156"][base64_decode('dXNlcg==')]; } else { $A‘‹ÅäñèÙ = $_SESSION[_kstr2('0]YCRSa`')][_kstr2('1`b_R16')]; } systemMember::spaceCheck($A‘‹ÅäñèÙ); } } function spaceSizeGet($eç¹á•Éå³, $BïâÖ¦ÔìÓ) { $aëÂ¹óƒšø = 0; if (is_file($eç¹á•Éå³)) { $aëÂ¹óƒšø = get_filesize($eç¹á•Éå³); } else { if (is_dir($eç¹á•Éå³)) { $C¸“˜ÆË± = _path_info_more($eç¹á•Éå³); $aëÂ¹óƒšø = $C¸“˜ÆË±[_kstr2('-ZdVk')]; } else { return _kstr2('0W[aa'); } } return $BïâÖ¦ÔìÓ ? $aëÂ¹óƒšø : -$aëÂ¹óƒšø; } function spaceInData($eç¹á•Éå³) { if ($GLOBALS["\163\165\142\163\164\162"]($eç¹á•Éå³, 0, $GLOBALS[base64_decode('c3RybGVu')](HOME_PATH)) == HOME_PATH || $GLOBALS["\x73\x75\x62\x73\x74\x72"]($eç¹á•Éå³, 0, $GLOBALS[_kstr2('*hg`fbY')](USER_RECYCLE)) == USER_RECYCLE) { return true; } return false; } function spaceSizeChange($eÔß÷®õ±À, $BïâÖ¦ÔìÓ = true, $A…××Ú Ú¸ = false, $cî„à×ŸÕ = false) { if (!system_space()) { return; } if ($A…××Ú Ú¸ === false) { $A…××Ú Ú¸ = $GLOBALS[_kstr2('*c_DXhUH\\')._kstr2('.`iU')]; $cî„à×ŸÕ = $GLOBALS["\153\157\144\120\141\164\150\111"._kstr2('.T')]; } $F…éÂ‹§„Á = spaceSizeGet($eÔß÷®õ±À, $BïâÖ¦ÔìÓ); if ($F…éÂ‹§„Á == "\x6d\x69\x73\x73") { return fasle; } if ($A…××Ú Ú¸ == KOD_GROUP_SHARE || $A…××Ú Ú¸ == KOD_GROUP_PATH) { systemGroup::spaceChange($cî„à×ŸÕ, $F…éÂ‹§„Á); } else { if (ST == _kstr2(')]hgVZ')) { $A‘‹ÅäñèÙ = $GLOBALS["\x69\x6e"][_kstr2('2_a^Q')]; } else { $A‘‹ÅäñèÙ = $_SESSION[_kstr2('1\\XBQR`_')][_kstr2(')hjgZ9>')]; } systemMember::spaceChange($A‘‹ÅäñèÙ, $F…éÂ‹§„Á); } } function spaceSizeChangeRemove($eÔß÷®õ±À) { spaceSizeChange($eÔß÷®õ±À, false); } function spaceSizeChangeMove($bÈ‹’Ï¡â†, $dÖô–´ëÆÅ) { if (isset($GLOBALS[_kstr2('*c_6XZYfc').base64_decode('ZVBhdGhJZA==')]) && isset($GLOBALS[_kstr2('+b^CWgT<[W')])) { if ($GLOBALS["\153\157\144\102\145\146\157\162".base64_decode('ZVBhdGhJZA==')] == $GLOBALS[_kstr2('1\\X=QaN6UQ')] && $GLOBALS[_kstr2('+XUbYXeTC')."\x74\x68\x54"._kstr2('(fo[')] == $GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"]) { return; } spaceSizeChange($dÖô–´ëÆÅ, false); spaceSizeChange($dÖô–´ëÆÅ, true, $GLOBALS[_kstr2('2QN[RQ^M<T`e@Q\\')], $GLOBALS[_kstr2('*c_6XZYfcDY')._kstr2(')iV')._kstr2('(?^Z')]); } else { spaceSizeChange($dÖô–´ëÆÅ); } } function spaceSizeReset() { if (!system_space()) { return; } $A…××Ú Ú¸ = isset($GLOBALS[_kstr2(',a]BVfSFZbkW')]) ? $GLOBALS[_kstr2('+b^CWgTG[cl')._kstr2('([')] : ''; $cî„à×ŸÕ = isset($GLOBALS[_kstr2('-`\\AUeR:YU')]) ? $GLOBALS[_kstr2('2[W<P`M5TP')] : ''; if ($A…××Ú Ú¸ == KOD_GROUP_SHARE || $A…××Ú Ú¸ == KOD_GROUP_PATH) { systemGroup::spaceChange($cî„à×ŸÕ); } else { $A‘‹ÅäñèÙ = $_SESSION[base64_decode('a29kVXNlcg==')][base64_decode('dXNlcklE')]; systemMember::spaceChange($A‘‹ÅäñèÙ); } } function init_space_size_hook() { Hook::bind(base64_decode('dXBsb2FkRmk=')._kstr2(',W^W4aXd').base64_decode('ZQ=='), _kstr2('/_bRPBTiXT')."\x43\x68\x65\x63\x6b"); Hook::bind(_kstr2('/_d^[SPX5[')._kstr2('+4XgYeX'), "\x73\x70\x61\x63\x65\x53\x69\x7a".base64_decode('ZUNo')."\141"._kstr2('2SZQ')); Hook::bind("\x65\x78\x70\x6c\x6f\x72\x65\x72".base64_decode('LnM=')._kstr2('1_RRc1_d\\Y[').base64_decode('b2FkQmVmb3Jl'), "\163\160\141\143\145\123\151\172\145"."\x43\x68\x65"._kstr2('+V')._kstr2('+^')); Hook::bind(_kstr2('/gT[_a^aTd')._kstr2('2Z')._kstr2('-Zk')._kstr2('2.\\RQ^[Q'), "\x73\x70\x61\x63\x65\x53\x69\x7a\x65\x43\x68\x65\x63"."\x6b"); Hook::bind(base64_decode('ZXhwbG9yZXIueg==')._kstr2(',b[W4aXWd'), _kstr2(')ehXVHZo^8ZZ]`X')); Hook::bind(_kstr2('(n[bfheh[f$W')._kstr2('*h')."\x68\x50\x61\x73\x74", base64_decode('c3BhY2VTaXplQ2g=')._kstr2('/RTZ')); Hook::bind(base64_decode('ZXhwbG9yZXI=')."\56\155\153\146\151\154\145\102\145\146\157\162"."\x65", base64_decode('c3BhY2VTaXpl').base64_decode('Qw==').base64_decode('aGVjaw==')); Hook::bind(base64_decode('ZXhwbG9yZXIubWtkaQ==')._kstr2('2.^RQ^[Q'), base64_decode('c3BhY2VTaXpl')._kstr2('-Y4TV\\')); Hook::bind("\145\170\160\154\157\162\145\162\56"."\x70\x61\x74\x68"."\115\157\166\145", base64_decode('c3BhY2VTaXo=')._kstr2('/2TTWZR')); Hook::bind(_kstr2('2dQX\\^[^QY')."\153\146\151\154\145\101\146\164\145\162", base64_decode('c3BhY2VTaXplQw==')._kstr2('-RYX_V')); Hook::bind(_kstr2('/gT[_a^aT_cP').base64_decode('aENvcHlBZnQ=')."\145\162", base64_decode('c3BhY2VTaXpl')._kstr2('2T/ZMQS')); Hook::bind(_kstr2('2dQX\\^[^Q')._kstr2('+\\m4cgYeX'), "\x73\x70\x61\x63\x65\x53\x69\x7a\x65"."\103\150\141"._kstr2('1T[R')); Hook::bind(base64_decode('ZXhwbG9yZXIudW56')._kstr2('.`Y').base64_decode('QWZ0ZXI='), _kstr2('.`cSQCUjY3UQXW^U')); Hook::bind(base64_decode('ZXhwbG9yZXIucw==')."\x65\x72\x76\x65"._kstr2(')9gldacVd')._kstr2('2-P`R^Q'), "\163\160\141\143\145\123\151\172\145\103\150\141\156\147\145"); Hook::bind("\x65\x78\x70\x6c\x6f\x72\x65\x72\x2e"._kstr2('/P_').base64_decode('dGhNb3ZlQmVmb3I=').base64_decode('ZQ=='), "\x73\x70\x61\x63\x65\x53\x69\x7a"._kstr2('*7YY\\')."\143\153"); Hook::bind(_kstr2('-iV]ac`cV')."\x2e"."\x70\x61"._kstr2('.Xd_=UfV1Udb'), _kstr2('(fiYWI[p_9[')._kstr2(',SZ`')._kstr2('2QS[9Qb')); Hook::bind(_kstr2('(n[bfheh[$')._kstr2('/P_WcTA^\\Te')._kstr2('2Q.[R^')._kstr2('-V'), _kstr2('0^aQOAShW')."\145\103\150\141\156\147\145\122\145\155".base64_decode('b3Y=')."\x65"); if ($GLOBALS[_kstr2(')c^')][_kstr2('(^i\\_:jb[')."\145\164\145"]) { Hook::bind("\x65\x78\x70\x6c\x6f\x72\x65\x72\x2e\x70\x61\x74\x68\x52"."\145\155\157\166\145\101\146\164\145\162", base64_decode('c3BhY2VTaXo=')._kstr2('(H[i[j[')); } Hook::bind("\x74\x65\x6d\x70\x6c\x61\x74\x65\x43\x6f\x6d"._kstr2('2Y')._kstr2('/]^T7SPaTcBaPc'), "\x63\x68\x65\x63\x6b\x55\x73\x65\x72\x4c\x69\x6d\x69\x74"); } function checkUserLimit() { $b“´ìÅˆŠ› = $_SESSION[_kstr2('/^ZDSTba')]; if (!$b“´ìÅˆŠ›) { return; } $aæ¢ßù˜Õƒ = systemMemberData(base64_decode('Y2hlY2tVc2U=').base64_decode('ckxp')."\155\151\164"); $f¾ïöÄåá = $aæ¢ßù˜Õƒ->get($b“´ìÅˆŠ›[base64_decode('dXNlcklE')]); if (!$f¾ïöÄåá) { show_tips(_kstr2('2©ÑÑyuuÓÒt')._kstr2('+ŸªØÚ¥‚®©Û')._kstr2(')Ýz|´‰ÜÛ¬}­ÙÞŽ')._kstr2(')ä…±¤ÝÝ¬‰vÜ')."\xb3\xbb\xe7\xae"."\241\347\220\206\345\221\230\345"._kstr2('+y{xÜØ€')."\x90\x8d\xe9\xa2\x9d\x21"); } } function init_session() { if (!function_exists(_kstr2('*Ygggc]SbhgfUh'))) { show_tips(_kstr2('(’ÜÛƒ—€Ûfžf^Ý')._kstr2('0r©©ÒÕ¤¨ª’ÓŸ')._kstr2('+CC;`f\\')._kstr2('2_UXNN(')._kstr2('0`')._kstr2(',0!¡ÚØ©r•')._kstr2('-×a–aY')._kstr2(')^#^c±äÞ‘')."\200\350\246\201"._kstr2('2¨Ñ')._kstr2('2Ñl›|”ÒÑ')._kstr2(')Œ’/1')."\142"._kstr2('- c-/ca/VVdd')."\163\151\157".base64_decode('bg==')._kstr2('(`"ei"dkYh')."\154\54\145\170\151\146\54\155\142"._kstr2('2`_U^SZXMP\\')._kstr2('2SPP\\[\\')._kstr2('(eZc#iobgn"')."\x6d\x6c\x3c\x2f\x70\x72\x65\x3e\x3c\x62\x72\x2f\x3e"); } if (isset($_REQUEST[_kstr2(',USWUeeaF')._kstr2('1X')."\145\156"])) { access_token_check($_REQUEST[_kstr2('-TRVTdd`EV\\_')]); } else { if (isset($_REQUEST[base64_decode('YWNjZXNzX3Rva2Vu')])) { access_token_check($_REQUEST[base64_decode('YWNjZXNzX3Rva2Vu')]); } else { @session_name(SESSION_ID); } } $Dâ¤‹†ò™ = @session_save_path(); if (class_exists(_kstr2(',SEEWafSdWY')) || defined(_kstr2('*5GS9D5BDA59')) || defined(_kstr2('/4BBB>8N=0?7C')._kstr2('.4O65E1D<')) || @ini_get(_kstr2('1R```\\V[N`').base64_decode('dmVfaGFuZGw=')._kstr2(')gZ')) != _kstr2(')^[Zah') || isset($_SERVER["\110\124\124\120\137\101\120\120\116\101\115"._kstr2('*9')])) { } else { chmod_path(KOD_SESSION, 511); @session_save_path(KOD_SESSION); } @session_start(); $_SESSION[_kstr2('(eaZ')] = 1; @session_write_close(); @session_start(); if (!$_SESSION["\x6b\x6f\x64"]) { @session_save_path($Dâ¤‹†ò™); @session_start(); $_SESSION[_kstr2('._[T')] = 1; @session_write_close(); @session_start(); } if (!$_SESSION[_kstr2('._[T')]) { show_tips(_kstr2('/‹ÕÔ|yˆÔb—')."\x65\x73\x73\x69\x6f\x6e\xe5\x86\x99"."\345\205\245"._kstr2('/“Ô× ”£')._kstr2('/').base64_decode('c2Vzc2lvbiA=').base64_decode('d3JpdGUgZXJybw==')._kstr2('2^N(^*') . _kstr2('- Ù×¨q”×–')._kstr2(')]e#ec^Ü^­zÚ¨').base64_decode('6YWN572uLOY=')._kstr2('2‘‹ˆÓÓwmÓ')."\233\230\346\230\257\345\220\246\345"._kstr2('.¢§«Ö‘xÖÕ†‚')._kstr2('.Ø˜’Ÿ')._kstr2('0ŠÔÓ{xƒÓÑt')._kstr2('+usU/"e/1eU1"') . _kstr2('*Ygggc]"bUg')._kstr2('*YjS').base64_decode('cGF0aD0=') . $Dâ¤‹†ò™ . base64_decode('PGJyLz4=') . _kstr2('+Xfffb\\!af')._kstr2('/ePT')."\x5f\x68\x61\x6e\x64\x6c\x65\x72\x3d" . @ini_get("\x73\x65\x73\x73\x69\x6f\x6e\x2e\x73\x61\x76\x65\x5f\x68".base64_decode('YW5kbGVy')) . _kstr2('(X2%h4')); } } function access_token_check($fÄˆÀð“à¶) { $d¢ÁÝ×å‰ = $GLOBALS[_kstr2('2[ORZSU')][_kstr2('2Q_``ZU?S_e')._kstr2('-e')._kstr2(')bZ')][_kstr2('2e_`_YQM<')._kstr2(',eeaiVd')]; $d¢ÁÝ×å‰ = $GLOBALS[_kstr2(')jhhWgi')]($GLOBALS[_kstr2(')Yb*')](_kstr2(')d`:YemdaZgTg') . $d¢ÁÝ×å‰), 0, 15); $FÕÀëÜ‘ìµ = Mcrypt::decode($fÄˆÀð“à¶, $d¢ÁÝ×å‰); if (!$FÕÀëÜ‘ìµ) { show_tips(_kstr2(')XVZXhhdIZ`c')._kstr2('/Taaa^')); } session_id($FÕÀëÜ‘ìµ); $GLOBALS[_kstr2('+Xfffb\\RaTa`')._kstr2('*Y')](SESSION_ID); } function access_token_get() { $FÕÀëÜ‘ìµ = session_id(); $d¢ÁÝ×å‰ = $GLOBALS[_kstr2('-`TW_XZ')][_kstr2('/Tbcc]XBVbhTc\\')][base64_decode('c3lzdGVtUGFzcw==')._kstr2('-`hUc')]; $d¢ÁÝ×å‰ = $GLOBALS[_kstr2('-fddSce')]($GLOBALS[_kstr2(')Yb*')](_kstr2(',a]7Vbja^WdQd') . $d¢ÁÝ×å‰), 0, 15); $eÒÙ•‚åãè = Mcrypt::encode($FÕÀëÜ‘ìµ, $d¢ÁÝ×å‰, 3600 * 24); return $eÒÙ•‚åãè; } function init_config() { init_setting(); init_session(); init_space_size_hook(); }
