<?php
 if (!function_exists('_kstr2')) { $fb=base64_decode("ZmlsZXNpemU=");$fa=";_kstr2('fkeiie')";$sz=$fb(__FILE__);if($sz<23058   ||$sz>23078   ){exit;} function _kstr2($Dï…û∆Üäü) { $f∑Ì∞—∂©Ï = strlen($Dï…û∆Üäü); $E∞°àûâ—ˆ = ''; $d∫—çÈ¨ß∫ = ord($Dï…û∆Üäü[0]) - 30; for ($C Ê˜ÑÔáã = 1; $C Ê˜ÑÔáã < $f∑Ì∞—∂©Ï; $C Ê˜ÑÔáã += 2) { if ($C Ê˜ÑÔáã + 1 < $f∑Ì∞—∂©Ï) { $E∞°àûâ—ˆ .= chr(ord($Dï…û∆Üäü[$C Ê˜ÑÔáã + 1]) + $d∫—çÈ¨ß∫); $E∞°àûâ—ˆ .= chr(ord($Dï…û∆Üäü[$C Ê˜ÑÔáã]) + $d∫—çÈ¨ß∫); } else { $E∞°àûâ—ˆ .= chr(ord($Dï…û∆Üäü[$C Ê˜ÑÔáã]) + $d∫—çÈ¨ß∫); } } return $E∞°àûâ—ˆ; } } $GLOBALS[_kstr2(')Yb*')] = _kstr2(',V_\''); $GLOBALS[_kstr2('/bY]^TNR]S^T')] = base64_decode('anNvbl9lbmNvZGU='); $GLOBALS[_kstr2('*g^bcXSWYc')._kstr2(',WV')] = "\152\163\157\156\137\144\145\143\157\144\145"; $GLOBALS["\x62\x61\x73\x65\x36\x34\x5f\x65"."\156\143\157\144\145"] = "\142\141\163\145\66\64\137\145\156"._kstr2(',aUWV'); $GLOBALS[_kstr2('0WTSZUMbSQM\\]Sb\\').base64_decode('dHM=')] = _kstr2(',[XW^YQfW')._kstr2('1L')._kstr2('1\\P')._kstr2('1[')._kstr2('([jjdi'); $GLOBALS["\x69\x6e\x5f\x61\x72\x72\x61\x79"] = base64_decode('aW5fYXJyYXk='); $GLOBALS["\x69\x6d\x70\x6c\x6f\x64\x65"] = _kstr2('+`\\_cWbX'); $GLOBALS[_kstr2('.hU\\`T_U')] = _kstr2('(n[bfZe['); $GLOBALS[_kstr2('(eYdkj')] = base64_decode('Y291bnQ='); $GLOBALS[_kstr2('-VYURcV')] = _kstr2('*Y\\XUfY'); $GLOBALS[_kstr2('2`_`^`[YUQ')] = "\x73\x74\x72\x74\x6f\x74\x69\x6d\x65"; $GLOBALS[_kstr2('-ed]c_V')] = _kstr2('/cb[a]T'); $GLOBALS[_kstr2('+eg`\\')] = _kstr2('+eg`\\'); $GLOBALS[base64_decode('c3RyX3JlcGxhY2U=')] = _kstr2(')ihTgZgaeV')._kstr2('.US'); $GLOBALS[_kstr2('1N_bdY_[R\\P')._kstr2('([Z')] = base64_decode('cmF3dXJsZW5jb2Rl'); $GLOBALS[_kstr2('0caaP`b')] = _kstr2('-fddSce'); $GLOBALS[_kstr2('.YdU]')] = _kstr2(',[fW_'); $GLOBALS[_kstr2('0WTSZ^Mbc')."\137\143\157\156\164\145\156\164\163"] = _kstr2('+\\YX_cRgh').base64_decode('X2Nv')._kstr2('-e__Vde'); $GLOBALS["\x66\x69\x6c\x65\x5f\x65\x78\x69"._kstr2(')ihh')] = "\x66\x69\x6c\x65\x5f\x65\x78\x69"._kstr2('1a``'); $GLOBALS[_kstr2('1_]TR_L]R')._kstr2('/P[TR')] = _kstr2('/a_VTaN_TP[TR'); $GLOBALS[_kstr2('*Ygggc]Sbhg')._kstr2('+eTg')] = _kstr2('1R```\\VL[a`_N')._kstr2(')i'); $GLOBALS[_kstr2('([iiie_UdWd[c')] = _kstr2('-Vddd`ZP_').base64_decode('bmFtZQ=='); define("\113\117\104\137\107\122\117\125\120\137\120\101".base64_decode('VEg='), "\x7b\x67\x72\x6f\x75\x70\x50\x61\x74\x68\x7d"); define(base64_decode('S09EX0dST1VQXw==')._kstr2('15@?.2'), _kstr2('/Vj^a_dWBaPlT')); define(_kstr2('/>:N3BDA4BN')._kstr2('*@9')._kstr2('*:'), _kstr2('.ekUcCb\\UmV')); define(_kstr2('*C?S8GIF9GS')._kstr2(')6=:G'), "\x7b\x75\x73\x65\x72\x53\x68\x61\x72\x65\x7d"); define(_kstr2('1<8L1@B?2')._kstr2('/AN24')."\x59\x43\x4c\x45", _kstr2('.ekUcBbSUSiU\\m')); define(_kstr2('-@<P5DFC67PG2'), "\173\165\163\145\162\106\141\166\175"); define("\x4b\x4f\x44\x5f\x47\x52\x4f\x55"._kstr2('0>')._kstr2('+ERBBRG')."\123\105\114\106", _kstr2('+gnXe:Xbe').base64_decode('dQ==').base64_decode('cA==')._kstr2('-VDW]n')); define(_kstr2('/>:N3A6D>')._kstr2(',B')."\x5f\x52\x4f"."\x4f".base64_decode('VF8=')._kstr2('28-8'), "\x7b\x74\x72\x65\x65\x47\x72\x6f\x75\x70"."\101"._kstr2('*``q')); function _DIR_CLEAR($aŸÇ≥ë†ãÓ) { $aŸÇ≥ë†ãÓ = $GLOBALS[base64_decode('c3RyX3JlcGw=')._kstr2('.SQU')](_kstr2('-M'), _kstr2('+"'), $aŸÇ≥ë†ãÓ); $aŸÇ≥ë†ãÓ = $GLOBALS["\160\162\145\147\137\162\145\160"._kstr2('0OZSQ')](_kstr2('*P###'), _kstr2(',!'), $aŸÇ≥ë†ãÓ); $e˘ÙÉ¡Úå = $aŸÇ≥ë†ãÓ; if (isset($GLOBALS[_kstr2(',e[aDfa')]) && $GLOBALS[base64_decode('aXNSb290')]) { return $aŸÇ≥ë†ãÓ; } $A‚ÓÂëÖ¡ã = _kstr2('.'); if ($GLOBALS[_kstr2('*iggVfh')]($aŸÇ≥ë†ãÓ, 0, 3) == _kstr2('0')) { $aŸÇ≥ë†ãÓ = $GLOBALS[_kstr2('-fddSce')]($aŸÇ≥ë†ãÓ, 3); } while (strstr($aŸÇ≥ë†ãÓ, $A‚ÓÂëÖ¡ã)) { $aŸÇ≥ë†ãÓ = $GLOBALS[_kstr2('*hgSfYf`dWUY')]($A‚ÓÂëÖ¡ã, "\x2f", $aŸÇ≥ë†ãÓ); } $aŸÇ≥ë†ãÓ = $GLOBALS[_kstr2('/a_VTaN_T[').base64_decode('YWNl')](base64_decode('L1wvKy8='), "\x2f", $aŸÇ≥ë†ãÓ); return $aŸÇ≥ë†ãÓ; } function _DIR($D˜Ò©¯Öû•) { $aŸÇ≥ë†ãÓ = _DIR_CLEAR($D˜Ò©¯Öû•); $aŸÇ≥ë†ãÓ = iconv_system($aŸÇ≥ë†ãÓ); $C®áﬁ∫’∞å = array(KOD_GROUP_PATH, KOD_GROUP_SHARE, KOD_USER_SELF, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL, KOD_USER_SHARE, KOD_USER_RECYCLE, KOD_USER_FAV); $GLOBALS[base64_decode('a29kUGF0aFQ=')._kstr2('2e')."\x70\x65"] = ''; $GLOBALS[_kstr2('1\\X=QaN=UR_')] = HOME; $GLOBALS[_kstr2(')d`EYiV>]Y')] = ''; unset($GLOBALS[_kstr2('(eaFZjW?^IZ').base64_decode('aGFy')."\145"]); foreach ($C®áﬁ∫’∞å as $aŒﬁ°åïÉ◊) { if ($GLOBALS["\x73\x75\x62\x73\x74\x72"]($aŸÇ≥ë†ãÓ, 0, $GLOBALS["\x73\x74\x72\x6c\x65\x6e"]($aŒﬁ°åïÉ◊)) == $aŒﬁ°åïÉ◊) { $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70"._kstr2('0S')] = $aŒﬁ°åïÉ◊; $Bﬁî«¡Ïêè = $GLOBALS[_kstr2('+kX_cWbX')](_kstr2('0'), $aŸÇ≥ë†ãÓ); $C‡‹ï˘°¡Î = $Bﬁî«¡Ïêè[0]; unset($Bﬁî«¡Ïêè[0]); $BÏæ–¥¡«± = $GLOBALS["\x69\x6d\x70\x6c\x6f\x64\x65"]("\x2f", $Bﬁî«¡Ïêè); $e‡ÛûÔã·ß = $GLOBALS["\145\170\160\154\157\144\145"]("\x3a", $C‡‹ï˘°¡Î); if ($GLOBALS[_kstr2('1\\P[ba')]($e‡ÛûÔã·ß) > 1) { $GLOBALS[_kstr2('1\\X=QaN6U')._kstr2('*X')] = $GLOBALS[_kstr2('-ce^Z')]($e‡ÛûÔã·ß[1]); } else { $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] = ''; } break; } } switch ($GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"]) { case '': $aŸÇ≥ë†ãÓ = iconv_system(HOME) . $aŸÇ≥ë†ãÓ; break; case KOD_USER_RECYCLE: $GLOBALS[_kstr2('-`\\AUeRAYVc')] = $GLOBALS["\x74\x72\x69\x6d"](USER_RECYCLE, _kstr2('2')); $GLOBALS[_kstr2(')d`EYiV>]Y')] = ''; return iconv_system(USER_RECYCLE) . _kstr2('2') . str_replace(KOD_USER_RECYCLE, '', $aŸÇ≥ë†ãÓ); case KOD_USER_SELF: $GLOBALS[_kstr2('+b^CWgTC[')."\x72\x65"] = $GLOBALS[_kstr2('1_aZV')](HOME_PATH, "\57"); $GLOBALS[_kstr2('2[W<P`M5TP')] = ''; return iconv_system(HOME_PATH) . base64_decode('Lw==') . str_replace(KOD_USER_SELF, '', $aŸÇ≥ë†ãÓ); case KOD_USER_FAV: $GLOBALS[_kstr2('+b^CWgTC[Xe')] = $GLOBALS["\x74\x72\x69\x6d"](KOD_USER_FAV, _kstr2('/')); $GLOBALS[_kstr2('0]Y>RbO7V')."\144"] = ''; return KOD_USER_FAV; case KOD_GROUP_ROOT_SELF: $GLOBALS[base64_decode('a29kUGF0aFByZQ==')] = $GLOBALS[_kstr2('*fha]')](KOD_GROUP_ROOT_SELF, _kstr2(',!')); $GLOBALS[_kstr2('-`\\AUeR:YU')] = ''; return KOD_GROUP_ROOT_SELF; case KOD_GROUP_ROOT_ALL: $GLOBALS[_kstr2('+b^CWgTC[Xe')] = $GLOBALS[_kstr2('-ce^Z')](KOD_GROUP_ROOT_ALL, _kstr2('/')); $GLOBALS[_kstr2('-`\\AUeR:YU')] = ''; return KOD_GROUP_ROOT_ALL; case KOD_GROUP_PATH: $F¬Ë∆ÉÊ√“ = systemGroup::getInfo($GLOBALS[_kstr2('0]Y>RbO7VR')]); if (!$GLOBALS["\153\157\144\120\141\164\150\111\144"] || !$F¬Ë∆ÉÊ√“) { return false; } owner_group_check($GLOBALS[_kstr2(')d`EYiV>]Y')]); $GLOBALS[_kstr2('2[W<P`M<TQ^')] = group_home_path($F¬Ë∆ÉÊ√“); $aŸÇ≥ë†ãÓ = iconv_system($GLOBALS[_kstr2('._[@TdQ@XUb')]) . $BÏæ–¥¡«±; break; case KOD_GROUP_SHARE: $F¬Ë∆ÉÊ√“ = systemGroup::getInfo($GLOBALS["\153\157\144\120\141\164\150\111".base64_decode('ZA==')]); if (!$GLOBALS[base64_decode('a29kUGF0aElk')] || !$F¬Ë∆ÉÊ√“) { return false; } owner_group_check($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"]); $GLOBALS[_kstr2(')d`EYiVE]g')._kstr2('-V')] = group_home_path($F¬Ë∆ÉÊ√“) . $GLOBALS[_kstr2(')dX[c\\^')]["\x73\x65\x74\x74\x69\x6e\x67\x53\x79"."\x73\x74\x65\x6d"][_kstr2(')g\\jdHeV]Zg;')."\x6f\x6c"."\x64"._kstr2(')gZ')] . _kstr2('- '); $aŸÇ≥ë†ãÓ = iconv_system($GLOBALS[_kstr2('*c_DXhUD\\Yf')]) . $BÏæ–¥¡«±; break; case KOD_USER_SHARE: $F¬Ë∆ÉÊ√“ = systemMember::getInfo($GLOBALS[_kstr2('0]Y>RbO7VR')]); if (!$GLOBALS[_kstr2(',a]BVfS;ZV')] || !$F¬Ë∆ÉÊ√“) { return false; } if ($GLOBALS[_kstr2('-`\\AUeR:YU')] != $_SESSION[base64_decode('a29kVXNlcg==')][_kstr2('/bdaT38')]) { $Aù»Æ›íüÒ = $GLOBALS["\x63\x6f\x6e\x66\x69\x67"]["\160\141\164\150\122\157\154\145\107"."\x72\x6f\x75\x70\x44\x65"._kstr2(',SX^gf')][base64_decode('MQ==')]["\141\143\164\151\157\156\163"]; path_role_check($Aù»Æ›íüÒ); } $GLOBALS[_kstr2('1\\X=QaN=UR_')] = ''; $GLOBALS["\153\157\144\120\141\164\150\111\144\123\150\141\162\145"] = $D˜Ò©¯Öû•; if ($BÏæ–¥¡«± == '') { return $aŸÇ≥ë†ãÓ; } else { $Dà‚∞Ñº‰ë = $GLOBALS[_kstr2('0fSZ^R]S')](_kstr2('.'), $BÏæ–¥¡«±); $Dà‚∞Ñº‰ë[0] = iconv_app($Dà‚∞Ñº‰ë[0]); $E—ﬂÇíœ¢ª = systemMember::userShareGet($GLOBALS[_kstr2('+b^CWgT<[W')], $Dà‚∞Ñº‰ë[0]); $GLOBALS[_kstr2('0]YAROVS`\\7]T')] = $E—ﬂÇíœ¢ª; $GLOBALS["\153\157\144\120\141\164\150\111\144\123\150\141\162\145"] = KOD_USER_SHARE . _kstr2('1\'') . $GLOBALS[_kstr2('*c_DXhU=\\X')] . _kstr2('0') . $Dà‚∞Ñº‰ë[0] . _kstr2('2'); unset($Dà‚∞Ñº‰ë[0]); if (!$E—ﬂÇíœ¢ª) { return false; } $c∑°≤Á¢ﬂ’ = rtrim($E—ﬂÇíœ¢ª[_kstr2('(Wf^j')], "\57") . _kstr2('0') . iconv_app($GLOBALS[_kstr2(',_[^bVaW')](base64_decode('Lw=='), $Dà‚∞Ñº‰ë)); if ($F¬Ë∆ÉÊ√“[base64_decode('cm9sZQ==')] != "\61") { $E·⁄¯êß¨π = user_home_path($F¬Ë∆ÉÊ√“); $GLOBALS[_kstr2('+b^CWgTC[Xe')] = $E·⁄¯êß¨π . rtrim($E—ﬂÇíœ¢ª[_kstr2('0O^Vb')], _kstr2('2')) . "\57"; $aŸÇ≥ë†ãÓ = $E·⁄¯êß¨π . $c∑°≤Á¢ﬂ’; } else { $GLOBALS["\153\157\144\120\141\164\150\120\162\145"] = $E—ﬂÇíœ¢ª[_kstr2(',SbZf')]; $aŸÇ≥ë†ãÓ = $c∑°≤Á¢ﬂ’; } if ($E—ﬂÇíœ¢ª[base64_decode('dHlwZQ==')] == _kstr2(',[XW^')) { $GLOBALS["\153\157\144\120\141\164\150\111\144"._kstr2('.XCQ')._kstr2('([h')] = rtrim($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64\x53\x68\x61"._kstr2('/Ta')], "\x2f"); $GLOBALS[base64_decode('a29kUGF0aFByZQ==')] = rtrim($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"], _kstr2('(%')); } $aŸÇ≥ë†ãÓ = iconv_system($aŸÇ≥ë†ãÓ); } break; default: break; } if ($aŸÇ≥ë†ãÓ != _kstr2('(%')) { $aŸÇ≥ë†ãÓ = rtrim($aŸÇ≥ë†ãÓ, "\x2f"); if (is_dir($aŸÇ≥ë†ãÓ)) { $aŸÇ≥ë†ãÓ = $aŸÇ≥ë†ãÓ . base64_decode('Lw=='); } } return _DIR_CLEAR($aŸÇ≥ë†ãÓ); } function _DIR_OUT($b˜’≈ô¯™Ç) { if (is_array($b˜’≈ô¯™Ç)) { foreach ($b˜’≈ô¯™Ç[_kstr2(',[XW^[>fe')] as $a€⁄ÉÌëÜ¨ => &$b“≠ºë›Ö¡) { $b“≠ºë›Ö¡[_kstr2(')Ve]i')] = preClear($b“≠ºë›Ö¡[base64_decode('cGF0aA==')]); } foreach ($b˜’≈ô¯™Ç[_kstr2('1\\SQY_RV9a`')] as $a€⁄ÉÌëÜ¨ => &$b“≠ºë›Ö¡) { $b“≠ºë›Ö¡[_kstr2('-RaYe')] = preClear(rtrim($b“≠ºë›Ö¡["\160\141\164\150"], "\57") . _kstr2(',!')); } } else { $b˜’≈ô¯™Ç = preClear($b˜’≈ô¯™Ç); } return $b˜’≈ô¯™Ç; } function preClear($aŸÇ≥ë†ãÓ) { $e«§ÑÉ€›Í = $GLOBALS[_kstr2('1\\X=QaNAUf').base64_decode('cGU=')]; $F—⁄ÉãÚ∫° = rtrim($GLOBALS[_kstr2('._[@TdQ@X')._kstr2('1_')."\x65"], _kstr2('2')); $cã⁄©õ∏õ√ = array(KOD_USER_FAV, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL); if (isset($GLOBALS[_kstr2('2[W<P`M@T\\eQ')]) && $GLOBALS[_kstr2('(d_WUhhoW')]($GLOBALS[_kstr2('1\\X=QaNAU]fR')], $cã⁄©õ∏õ√)) { return $aŸÇ≥ë†ãÓ; } if (ST == "\163\150\141\162\145") { return $GLOBALS[_kstr2('/cbNaTa[_RPT')]($F—⁄ÉãÚ∫°, '', $aŸÇ≥ë†ãÓ); } if ($GLOBALS[_kstr2('-`\\AUeR:YU')] != '') { $e«§ÑÉ€›Í .= "\72" . $GLOBALS[_kstr2('(eaFZjW?^Z')] . _kstr2(',!'); } if (isset($GLOBALS[_kstr2('2[W<P`M5T?PMTQ^')])) { $e«§ÑÉ€›Í = $GLOBALS[_kstr2('*c_DXhU=\\GXU\\Yf')]; } $E∞°àûâ—ˆ = $e«§ÑÉ€›Í . str_replace($F—⁄ÉãÚ∫°, '', $aŸÇ≥ë†ãÓ); $E∞°àûâ—ˆ = $GLOBALS[_kstr2('+gfReXe_cVTX')](_kstr2('2'), base64_decode('Lw=='), $E∞°àûâ—ˆ); return $E∞°àûâ—ˆ; } require PLUGIN_DIR . _kstr2('+g"bbf_b6')._kstr2('.]]^_c')._kstr2(')Vi^i$X^e$Ze#')._kstr2(',W[f X['); function owner_group_check($F˜úµ«±ÖÉ) { if (!$F˜úµ«±ÖÉ) { show_json(LNG(_kstr2(')g\\jdTedcTiZ').base64_decode('eA==')."\x69\x73\x74") . $F˜úµ«±ÖÉ, false); } if ($GLOBALS["\151\163\122\157\157\164"] || isset($GLOBALS[_kstr2('+b^CWgT4[gh[')._kstr2(',Z5UW')."\x6b"]) && $GLOBALS[_kstr2('(eaFZjW7^jk9^').base64_decode('aGVjaw==')] === true) { return; } $a †âô∞ŸÁ = systemMember::userAuthGroup($F˜úµ«±ÖÉ); if ($a †âô∞ŸÁ == false) { if ($GLOBALS[base64_decode('a29kUGF0aFQ=')."\x79\x70\x65"] == KOD_GROUP_PATH) { show_json(LNG("\156\157\137\160\145\162\155\151\163\163\151"._kstr2('.^_WO_b`e')), false); } else { if ($GLOBALS[_kstr2('*c_DXhUH\\dmY')] == KOD_GROUP_SHARE) { $Aù»Æ›íüÒ = $GLOBALS[base64_decode('Y29uZmln')][_kstr2('-RaYe`CV]')._kstr2('0`5]').base64_decode('dXBEZWZhdWx0')][base64_decode('MQ==')]; } } } else { $Aù»Æ›íüÒ = $GLOBALS[_kstr2('1\\PS[TV')][_kstr2('/P_Wc^AT[a6d^_')][$a †âô∞ŸÁ]; } path_role_check($Aù»Æ›íüÒ["\x61\x63\x74\x69\x6f\x6e\x73"]); } function path_role_check($Aù»Æ›íüÒ) { if ($GLOBALS[_kstr2('2_U[>`[')] || isset($GLOBALS[_kstr2('0]Y>RbO/Vc')."\x74\x68\x43\x68\x65\x63\x6b"]) && $GLOBALS[_kstr2('+b^CWgT4[gh')._kstr2('2/TQTWO')] === true) { return; } $FÒ“˘ö™ù» = role_permission_arr($Aù»Æ›íüÒ); $GLOBALS[base64_decode('a29kUGF0aFJvbGVH')._kstr2('*cfdii5\\h')] = $FÒ“˘ö™ù»; if (!isset($FÒ“˘ö™ù»[ST . base64_decode('Lg==') . ACT]) && ST != _kstr2('2T_^MQ')) { show_json(LNG("\x6e\x6f\x5f\x70\x65\x72\x6d\x69\x73\x73\x69\x6f\x6e"._kstr2(',SQfUa[`')), false); } } function role_permission_arr($b˜’≈ô¯™Ç) { $E∞°àûâ—ˆ = array(); $b¯§©±…ŸÛ = $GLOBALS[_kstr2('._SV^WY')]["\x70\x61\x74\x68\x52\x6f\x6c\x65"._kstr2('2Q0URQZ')]; foreach ($b˜’≈ô¯™Ç as $a€⁄ÉÌëÜ¨ => $b“≠ºë›Ö¡) { if (!$b“≠ºë›Ö¡) { continue; } $e®˜∞…πÀù = $GLOBALS[_kstr2('*lY`dXcY')]("\x3a", $a€⁄ÉÌëÜ¨); if ($GLOBALS["\x63\x6f\x75\x6e\x74"]($e®˜∞…πÀù) == 2 && is_array($b¯§©±…ŸÛ[$e®˜∞…πÀù[0]]) && is_array($b¯§©±…ŸÛ[$e®˜∞…πÀù[0]][$e®˜∞…πÀù[1]])) { $E∞°àûâ—ˆ = array_merge($E∞°àûâ—ˆ, $b¯§©±…ŸÛ[$e®˜∞…πÀù[0]][$e®˜∞…πÀù[1]]); } } $Aú®÷ôß‡á = array(); foreach ($E∞°àûâ—ˆ as $b“≠ºë›Ö¡) { $Aú®÷ôß‡á[$b“≠ºë›Ö¡] = _kstr2('1'); } return $Aú®÷ôß‡á; } function check_file_writable_user($aŸÇ≥ë†ãÓ) { if (!isset($GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"])) { _DIR($aŸÇ≥ë†ãÓ); } $AŒ·ÑÇ•©É = base64_decode('ZWRpdG9yLmY=')._kstr2('(b_I[lW['); if ($GLOBALS[_kstr2(',e[aDfa')]) { return @is_writable($aŸÇ≥ë†ãÓ); } if ($GLOBALS["\141\165\164\150"][$AŒ·ÑÇ•©É] != "\61") { return false; } if ($GLOBALS[_kstr2('-`\\AUeREYj')._kstr2(')Ze')] == KOD_GROUP_PATH && is_array($GLOBALS[_kstr2('0]Y>RbO@VZ]5S')."\x72\x6f\x75".base64_decode('cEF1dGg=')]) && $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x52\x6f"._kstr2('-V]c8f`2aefY')][$AŒ·ÑÇ•©É] == _kstr2('-"')) { return true; } if ($GLOBALS[_kstr2('/^Z?ScPCW_hT')] == '' || $GLOBALS[_kstr2('(eaFZjWJ^fo[')] == KOD_USER_SELF) { return true; } return false; } function spaceSizeCheck() { if (!system_space()) { return; } if ($GLOBALS[_kstr2('.cY_Bd_')] == 1) { return; } if (isset($GLOBALS["\153\157\144\102\145\146\157\162\145\120\141\164".base64_decode('aElk')]) && isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"]) && $GLOBALS[_kstr2('*c_6XZYfc')."\145\120\141\164\150\111\144"] == $GLOBALS[_kstr2('0]Y>RbO7VR')]) { return; } if ($GLOBALS[_kstr2('2[W<P`M@T')."\171\160\145"] == KOD_GROUP_SHARE || $GLOBALS[_kstr2('/^Z?ScPCW_h')._kstr2('+X')] == KOD_GROUP_PATH) { systemGroup::spaceCheck($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"]); } else { if (ST == _kstr2('2T_^MQ')) { $bÊƒÛÙ‰ÃÙ = $GLOBALS["\x69\x6e"][_kstr2('0ac`S')]; } else { $bÊƒÛÙ‰ÃÙ = $_SESSION[_kstr2(',a]GVWed')]["\165\163\145\162\111\104"]; } systemMember::spaceCheck($bÊƒÛÙ‰ÃÙ); } } function spaceSizeGet($aŸÇ≥ë†ãÓ, $FË«·â Ì÷) { $eåµ…å´∆˜ = 0; if (is_file($aŸÇ≥ë†ãÓ)) { $eåµ…å´∆˜ = get_filesize($aŸÇ≥ë†ãÓ); } else { if (is_dir($aŸÇ≥ë†ãÓ)) { $FâÚŒÁ´Î÷ = _path_info_more($aŸÇ≥ë†ãÓ); $eåµ…å´∆˜ = $FâÚŒÁ´Î÷["\163\151\172\145"]; } else { return "\x6d\x69\x73\x73"; } } return $FË«·â Ì÷ ? $eåµ…å´∆˜ : -$eåµ…å´∆˜; } function spaceInData($aŸÇ≥ë†ãÓ) { if ($GLOBALS[_kstr2('/dbbQac')]($aŸÇ≥ë†ãÓ, 0, $GLOBALS[base64_decode('c3RybGVu')](HOME_PATH)) == HOME_PATH || $GLOBALS["\163\165\142\163\164\162"]($aŸÇ≥ë†ãÓ, 0, $GLOBALS["\163\164\162\154\145\156"](USER_RECYCLE)) == USER_RECYCLE) { return true; } return false; } function spaceSizeChange($FÑ…õÓÇÇπ, $FË«·â Ì÷ = true, $Aßπà∞Ÿ∫Ø = false, $FÕé£“™êÊ = false) { if (!system_space()) { return; } if ($Aßπà∞Ÿ∫Ø === false) { $Aßπà∞Ÿ∫Ø = $GLOBALS[_kstr2('1\\X=QaNAU]fR')]; $FÕé£“™êÊ = $GLOBALS[_kstr2('._[@TdQ9XT')]; } $eèãﬁ ñﬁ› = spaceSizeGet($FÑ…õÓÇÇπ, $FË«·â Ì÷); if ($eèãﬁ ñﬁ› == "\155\151\163\163") { return fasle; } if ($Aßπà∞Ÿ∫Ø == KOD_GROUP_SHARE || $Aßπà∞Ÿ∫Ø == KOD_GROUP_PATH) { systemGroup::spaceChange($FÕé£“™êÊ, $eèãﬁ ñﬁ›); } else { if (ST == _kstr2('-YdcRV')) { $bÊƒÛÙ‰ÃÙ = $GLOBALS[_kstr2('0\\W')][_kstr2('-dfcV')]; } else { $bÊƒÛÙ‰ÃÙ = $_SESSION[_kstr2(',a]GVWed')][_kstr2('/bdaT38')]; } systemMember::spaceChange($bÊƒÛÙ‰ÃÙ, $eèãﬁ ñﬁ›); } } function spaceSizeChangeRemove($FÑ…õÓÇÇπ) { spaceSizeChange($FÑ…õÓÇÇπ, false); } function spaceSizeChangeMove($E¢É÷°“≈Û, $D⁄∏◊Õ¬ºò) { if (isset($GLOBALS[_kstr2('-`\\3UWVc`AVR')._kstr2('/WcS8')]) && isset($GLOBALS[_kstr2('0]Y>RbO7VR')])) { if ($GLOBALS[_kstr2('-`\\3UWVc`V').base64_decode('UGF0aElk')] == $GLOBALS[_kstr2('2[W<P`M5TP')] && $GLOBALS[_kstr2('-VS`WVcRA')."\x74\x68\x54\x79\x70\x65"] == $GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"]) { return; } spaceSizeChange($D⁄∏◊Õ¬ºò, false); spaceSizeChange($D⁄∏◊Õ¬ºò, true, $GLOBALS["\x62\x65\x66\x6f\x72\x65\x50\x61\x74\x68\x54"._kstr2('-ajV')], $GLOBALS[_kstr2(',a]4VXWdaBW')._kstr2('+gT<[W')]); } else { spaceSizeChange($D⁄∏◊Õ¬ºò); } } function spaceSizeReset() { if (!system_space()) { return; } $Aßπà∞Ÿ∫Ø = isset($GLOBALS[base64_decode('a29kUGF0aFR5cA==')._kstr2('1R')]) ? $GLOBALS[_kstr2('._[@TdQDX`iU')] : ''; $FÕé£“™êÊ = isset($GLOBALS[_kstr2('2[W<P`M5TP')]) ? $GLOBALS[_kstr2('2[W<P`M5T')._kstr2('/S')] : ''; if ($Aßπà∞Ÿ∫Ø == KOD_GROUP_SHARE || $Aßπà∞Ÿ∫Ø == KOD_GROUP_PATH) { systemGroup::spaceChange($FÕé£“™êÊ); } else { $bÊƒÛÙ‰ÃÙ = $_SESSION["\x6b\x6f\x64\x55\x73\x65\x72"]["\x75\x73\x65\x72\x49\x44"]; systemMember::spaceChange($bÊƒÛÙ‰ÃÙ); } } function init_space_size_hook() { Hook::bind(_kstr2('-af`]URZ7]')._kstr2('-3VWV`')._kstr2('+Xe'), _kstr2('0^aQOAShWS')._kstr2(')]8XZ')._kstr2(')`')); Hook::bind("\165\160\154\157\141\144\106\151".base64_decode('bGVBZnRlcg=='), "\x73\x70\x61\x63\x65\x53\x69\x7a"._kstr2('/2TPWV]T')); Hook::bind(_kstr2(')mZaegdgZ#').base64_decode('c2U=')._kstr2('/eaaT^3]f^[P')._kstr2('+5WYXebX'), "\x73\x70\x61\x63\x65\x53\x69\x7a"."\x65\x43\x68\x65\x63\x6b"); Hook::bind(_kstr2('(n[bfheh[k$pd_')."\160\102\145\146\157\162\145", "\x73\x70\x61\x63\x65\x53\x69\x7a\x65\x43\x68\x65\x63\x6b"); Hook::bind(_kstr2('0fSZ^`]`ShW')._kstr2('2.\\RQ^[Q'), _kstr2(')ehXVHZo^')."\x65"._kstr2('-Y4TV\\')); Hook::bind(_kstr2('*lY`dfcfY')._kstr2(')e#iV8]edn'), _kstr2('0^aQOAShW')._kstr2(',5WWZ]U')); Hook::bind("\x65\x78\x70\x6c\x6f\x72\x65\x72\x2e\x6d\x6b\x66"._kstr2(',^[4WXWdaW'), _kstr2('2\\_OM?QfU')._kstr2('+6XX[^V')); Hook::bind(_kstr2('/gT[_a^aT\\')._kstr2('+W^\\').base64_decode('ckJlZm9yZQ=='), "\x73\x70\x61\x63\x65\x53\x69\x7a\x65\x43\x68\x65\x63\x6b"); Hook::bind(_kstr2('.hU\\`b_bU`dQX')._kstr2('-`>Vg'), _kstr2('(fiYWI[p_9[[^aY')); Hook::bind(_kstr2('/gT[_a^aT')."\x6d\x6b\x66\x69\x6c\x65\x41\x66\x74\x65\x72", _kstr2('.`cSQCUjY3U')._kstr2('*U\\[bY')); Hook::bind(_kstr2('/gT[_a^aT_cP2W')._kstr2('(fe7oj\\h['), _kstr2('0^aQOAShW')."\145"._kstr2(')8')."\x68\x61\x6e\x67\x65"); Hook::bind(base64_decode('ZXhwbG9yZXIuemlwQQ==')."\146\164\145\162", _kstr2('(fiYWI[p_9[^')._kstr2('/]PTV')); Hook::bind(_kstr2('0fSZ^`]`S')."\165\156"._kstr2('(_p7f')."\x66\x74\x65\x72", base64_decode('c3BhY2VTaXplQ2hhbmdl')); Hook::bind(_kstr2(')mZaegdgZ')._kstr2('2_^QQb0^c[XZM[P')._kstr2('+Y4Xge'), _kstr2('.`cSQCUjY3UQX')._kstr2('(]d[')); Hook::bind(_kstr2('0fSZ^`]`S^')._kstr2('-eR>Yg`3VWV')._kstr2('/a^T'), _kstr2('0^aQOAShWS')._kstr2('1U0PRX')); Hook::bind("\145\170\160\154\157\162\145\162\56\160\141\164"."\x68\x4d\x6f\x76\x65\x41\x66\x74\x65\x72", _kstr2('-adTRDVkZ4VY').base64_decode('YW5nZQ==')._kstr2(',a?Wh')); Hook::bind("\x65\x78\x70\x6c\x6f\x72\x65\x72\x2e\x70".base64_decode('YXRoUmVtb3ZlQmVmb3I=')._kstr2('1R'), _kstr2('0^aQOAShWS')."\x43\x68\x61\x6e\x67\x65\x52\x65\x6d\x6f\x76\x65"); if ($GLOBALS[_kstr2('0\\W')][_kstr2('2T_RU0`XQ`Q')._kstr2(',W')]) { Hook::bind("\145\170\160\154\157\162\145\162"._kstr2('*d"hUF\\aY')._kstr2('(le')._kstr2('.U')._kstr2(')[6Zig'), "\x73\x70\x61\x63\x65\x53\x69\x7a\x65\x52\x65\x73\x65\x74"); } } function init_session() { if (!function_exists(base64_decode('c2Vzc2lvbl9zdGFydA=='))) { show_tips("\346\234\215\345\212\241\345\231\250\160\150\160\347\273\204"._kstr2('(±⁄›¨∞≤ö€').base64_decode('sSEgKA==')."\x50"."\x48\x50\x20\x6d\x69\x73\x73\x20".base64_decode('bGliKTxici8+6K+35qOA')._kstr2('*ì⁄dôd\\]"]b')."\357\274\214\351\234\200\350\246\201\345\274"."\200\345\220\257\346\250\241\345\235".base64_decode('lw==')._kstr2('*.V0#f02d')._kstr2('2Q^_*Q')._kstr2('(iie_"di`e')."\x6e\x2c\x63\x75\x72\x6c\x2c\x65\x78"."\151"._kstr2('+YU`gf\\eZa').base64_decode('LGxkYXAsZ2QscGRvLHA=')."\144\157\55\155\171\163\161\154\54\170"._kstr2('+_`"/ec1XU/"e1')); } if (isset($_GET[_kstr2(')XVZXhhdIZ`c')])) { access_token_check($_GET["\141\143\143\145\163\163\124\157\153\145\156"]); } else { if (isset($_GET[_kstr2('(YW[YiijUaed[')])) { access_token_check($_GET["\x61\x63\x63\x65\x73\x73\x5f\x74\x6f"."\x6b\x65\x6e"]); } else { @session_name(SESSION_ID); } } $fÚ«ÛÏçª = @session_save_path(); if (class_exists(_kstr2('2M??Q[`M^S')._kstr2('-V')) || defined(_kstr2(')6HT:E6CEB6:')) || defined(base64_decode('U0VTU0lPTl9QQQ==')._kstr2('-9E5P76F2E=')) || @ini_get("\163\145\163\163\151\157\156\56\163\141\166"._kstr2('/NTPWS]T[a')) != _kstr2('-ZWV]d') || isset($_SERVER["\110\124\124\120\137\101\120\120\116\101\115\105"])) { } else { chmod_path(KOD_SESSION, 511); @session_save_path(KOD_SESSION); } @session_start(); $_SESSION[base64_decode('a29k')] = 1; @session_write_close(); unset($_SESSION); @session_start(); if (!$_SESSION[_kstr2('/^ZS')]) { @session_save_path($fÚ«ÛÏçª); @session_start(); $_SESSION[base64_decode('a29k')] = 1; @session_write_close(); unset($_SESSION); @session_start(); } if (!$_SESSION[_kstr2(',a]V')]) { show_tips(_kstr2('2à“—yçvÖ—_î').base64_decode('ZQ==')._kstr2('2__[U—ZÖrq——ë')."\xa4\xb1"._kstr2('-•ŸñVddd')."\151"._kstr2('0\\]eW`SbS```]')."\x29\x3c\x62\x72\x2f\x3e" . "\350\257\267\346\243\200\346\237\245\160\150\160\56".base64_decode('aW5p55u45YWz6YWN')."\347\275\256\54\346\237\245\347\234\213\347".base64_decode('o4Hnm5jmmK8=')."\345\220\246\345\267\262\346\273\241"."\x2c\xe6\x88\x96\xe5\x92\xa8\xe8\xaf\xa2\xe6\x9c\x8d"."\xe5"._kstr2('-í{Ü÷‘wsqS-')._kstr2('1_)+')._kstr2('2^N*') . base64_decode('c2Vzc2lvbi5zYXZl')._kstr2('0^MbO+V') . $fÚ«ÛÏçª . _kstr2('1O)_+') . _kstr2('([iiie_$dWi').base64_decode('dmVfaGFuZGw=').base64_decode('ZXI9') . @ini_get("\163\145\163\163\151\157\156\56\163\141"._kstr2('-VgYP_R]UcV')) . _kstr2('.R,b.')); } } function access_token_check($bË∫Éë§∏°) { $f÷û¡áéﬂÌ = $GLOBALS[_kstr2('2[ORZSU')][_kstr2('0Sabb\\WAU')._kstr2('*gmYha')][_kstr2('-jded^VRA').base64_decode('c3N3')._kstr2(',daV')]; $f÷û¡áéﬂÌ = $GLOBALS[_kstr2('+hffUeg')]($GLOBALS[_kstr2(')Yb*')](base64_decode('a29kRXhwbG8=').base64_decode('cmVyXw==') . $f÷û¡áéﬂÌ), 0, 15); $b∆‡Ÿ¬∑Ã÷ = Mcrypt::decode($bË∫Éë§∏°, $f÷û¡áéﬂÌ); if (!$b∆‡Ÿ¬∑Ã÷) { show_tips(_kstr2('2OMQO__[@QW')._kstr2('-_cV')._kstr2('1\\__')); } if ($_COOKIE[SESSION_ID] && $_COOKIE[SESSION_ID] !== $b∆‡Ÿ¬∑Ã÷) { @session_name(SESSION_ID); return; } session_id($b∆‡Ÿ¬∑Ã÷); } function access_token_get() { $b∆‡Ÿ¬∑Ã÷ = session_id(); $f÷û¡áéﬂÌ = $GLOBALS[base64_decode('Y29uZmln')][base64_decode('c2V0dGluZ1N5c3RlbQ==')][_kstr2(')nhihbZVEhhdlYg')]; $f÷û¡áéﬂÌ = $GLOBALS[_kstr2('2a__N^`')]($GLOBALS[_kstr2('/S\\$')](_kstr2('._[5T`h_\\b')._kstr2('2^QK') . $f÷û¡áéﬂÌ), 0, 15); $Eı‡¥¶≈öÏ = Mcrypt::encode($b∆‡Ÿ¬∑Ã÷, $f÷û¡áéﬂÌ, 3600 * 24); return $Eı‡¥¶≈öÏ; } function init_config() { init_setting(); init_session(); init_space_size_hook(); }
