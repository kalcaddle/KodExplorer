<?php
 if (!function_exists('_kstr2')) { $fb=base64_decode("ZmlsZXNpemU=");$fa=";_kstr2('fkeiie')";$sz=$fb(__FILE__);if($sz<23236   ||$sz>23256   ){exit;} function _kstr2($AÒÏõ¡öÜ) { $b·”¨‚„Š = strlen($AÒÏõ¡öÜ); $Eµ§…ºî¾ = ''; $eÔ¥‚ß×©Ã = ord($AÒÏõ¡öÜ[0]) - 30; for ($F—Àøêâ§ = 1; $F—Àøêâ§ < $b·”¨‚„Š; $F—Àøêâ§ += 2) { if ($F—Àøêâ§ + 1 < $b·”¨‚„Š) { $Eµ§…ºî¾ .= chr(ord($AÒÏõ¡öÜ[$F—Àøêâ§ + 1]) + $eÔ¥‚ß×©Ã); $Eµ§…ºî¾ .= chr(ord($AÒÏõ¡öÜ[$F—Àøêâ§]) + $eÔ¥‚ß×©Ã); } else { $Eµ§…ºî¾ .= chr(ord($AÒÏõ¡öÜ[$F—Àøêâ§]) + $eÔ¥‚ß×©Ã); } } return $Eµ§…ºî¾; } } $GLOBALS["\155\144\65"] = _kstr2(')Yb*'); $GLOBALS["\x6a\x73\x6f\x6e\x5f\x65\x6e\x63\x6f\x64\x65"] = "\152\163\157\156\137\145\156\143\157\144\145"; $GLOBALS[base64_decode('anNvbl9kZWNvZGU=')] = _kstr2('/bY]^SNRT^')._kstr2('-VU'); $GLOBALS["\x62\x61\x73\x65\x36\x34\x5f\x65\x6e"._kstr2('0]QSR')] = "\x62\x61\x73\x65\x36\x34\x5f\x65\x6e"."\143\157\144\145"; $GLOBALS[_kstr2('/XUT[VNcTN')._kstr2('*cWhbbYgh')] = "\x66\x69\x6c\x65\x5f\x67\x65\x74\x5f\x63\x6f"."\156\164\145\156\164\163"; $GLOBALS[_kstr2('(d_WUhhoW')] = "\x69\x6e\x5f\x61\x72\x72\x61\x79"; $GLOBALS[_kstr2(')b^aeYdZ')] = _kstr2('0[WZ^R]S'); $GLOBALS["\x65\x78\x70\x6c\x6f\x64\x65"] = _kstr2('/gT[_S^T'); $GLOBALS[_kstr2('2[OZa`')] = _kstr2('+bVahg'); $GLOBALS[base64_decode('aGVhZGVy')] = "\150\145\141\144\145\162"; $GLOBALS[_kstr2('1a`a_a\\ZV')._kstr2('([')] = base64_decode('c3RydG90aW1l'); $GLOBALS[base64_decode('c3RybGVu')] = _kstr2('0baZ`\\S'); $GLOBALS["\x74\x72\x69\x6d"] = "\164\162\151\155"; $GLOBALS["\163\164\162\137\162\145\160\154\141\143\145"] = "\163\164\162\137\162\145\160\154\141\143\145"; $GLOBALS[_kstr2(',Sdgi^d`W')._kstr2('+bVXW')] = _kstr2('2M^acX^ZQO')._kstr2('/S^T'); $GLOBALS[_kstr2('*iggVfh')] = base64_decode('c3Vic3Ry'); $GLOBALS["\164\151\155\145"] = "\164\151\155\145"; $GLOBALS[_kstr2('1VSRY]LabL')."\143\157\156\164\145\156\164\163"] = _kstr2('1VSRY]LabPL')._kstr2(',`aWff`e'); $GLOBALS[_kstr2(',[XW^WQ[jfee')] = _kstr2(',[XW^WQ[j')._kstr2('+gff'); $GLOBALS["\x70\x72\x65\x67\x5f\x72\x65\x70\x6c"._kstr2('.SQU')] = "\x70\x72\x65\x67\x5f\x72\x65\x70\x6c\x61"._kstr2('-VT'); $GLOBALS[_kstr2('-Vddd`ZP_')._kstr2('/b')._kstr2(',Sffd')] = _kstr2(')Zhhhd^TcihgVi'); $GLOBALS["\x73\x65\x73\x73\x69\x6f\x6e\x5f\x6e\x61\x6d\x65"] = base64_decode('c2Vzc2lvbl9uYQ==')."\155\145"; define(_kstr2('/>:N3A6D>N?')._kstr2('-2A9E'), "\173\147\162\157\165\160\120\141\164"._kstr2('2iT')); define("\x4b\x4f\x44\x5f\x47\x52\x4f\x55\x50\x5f\x53\x48\x41\x52\x45", "\x7b\x67\x72\x6f\x75\x70\x53\x68\x61\x72\x65\x7d"); define(_kstr2('/>:N3BDA4')._kstr2('.CO<56'), _kstr2('+hnXfFe_XpY')); define(_kstr2('(EAU:IKH;IU>')."\x41\x52\x45", _kstr2('+hnXfFeT[Xep')); define(base64_decode('S09EX1VTRVJfUg==')."\105\103\131\103\114"._kstr2('-6'), _kstr2('1bhR`?_PR')._kstr2('/RhT[')."\x7d"); define("\113\117\104\137\125\123\105\122\137\106\101\126", _kstr2('+hnXf9eiTp')); define(_kstr2('0=9M2@5C=>').base64_decode('X1JPTw==')._kstr2('.OD5C6<'), "\x7b\x74\x72\x65\x65\x47\x72\x6f"."\165\160\123\145\154\146\175"); define(base64_decode('S09EX0dST1U=')._kstr2(',QBADFA3Q')."\x4c\x4c", _kstr2('.dkUb7U_be')."\x70\x41\x6c\x6c\x7d"); function _DIR_CLEAR($C†¬ÅÊæÚ—) { $C†¬ÅÊæÚ— = $GLOBALS[_kstr2(',feQdWd^bUSW')](_kstr2('*P'), "\x2f", $C†¬ÅÊæÚ—); $C†¬ÅÊæÚ— = $GLOBALS[_kstr2(',dbYWdQbW')."\154\141"."\143\145"](base64_decode('L1wvKy8='), _kstr2('0'), $C†¬ÅÊæÚ—); $CÒÆ¬˜±± = $C†¬ÅÊæÚ—; if (isset($GLOBALS[_kstr2(',e[aDfa')]) && $GLOBALS["\151\163\122\157\157\164"]) { return $C†¬ÅÊæÚ—; } $e¯è„é´Õ¨ = "\57\56\56\57"; if ($GLOBALS[_kstr2('2a__N^`')]($C†¬ÅÊæÚ—, 0, 3) == base64_decode('Li4v')) { $C†¬ÅÊæÚ— = $GLOBALS["\163\165\142\163\164\162"]($C†¬ÅÊæÚ—, 3); } while (strstr($C†¬ÅÊæÚ—, $e¯è„é´Õ¨)) { $C†¬ÅÊæÚ— = $GLOBALS[_kstr2('(jiUh[hbf')._kstr2('-TRV')]($e¯è„é´Õ¨, _kstr2(',!'), $C†¬ÅÊæÚ—); } $C†¬ÅÊæÚ— = $GLOBALS[_kstr2('(hf][hUf[Wb[Y')]("\x2f\x5c\x2f\x2b\x2f", "\57", $C†¬ÅÊæÚ—); return $C†¬ÅÊæÚ—; } function _DIR($Bğ ’ÊÍÊ) { $C†¬ÅÊæÚ— = _DIR_CLEAR($Bğ ’ÊÍÊ); $C†¬ÅÊæÚ— = iconv_system($C†¬ÅÊæÚ—); $fŠ´——¨Ÿš = array(KOD_GROUP_PATH, KOD_GROUP_SHARE, KOD_USER_SELF, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL, KOD_USER_SHARE, KOD_USER_RECYCLE, KOD_USER_FAV); $GLOBALS[_kstr2('0]Y>RbOBV^gS')] = ''; $GLOBALS[_kstr2('+b^CWgTC[Xe')] = HOME; $GLOBALS[_kstr2('/^Z?ScP8WS')] = ''; unset($GLOBALS["\153\157\144\120\141\164\150\111\144\123\150\141\162\145"]); foreach ($fŠ´——¨Ÿš as $eÂø¶µ÷ƒ—) { if ($GLOBALS[_kstr2('-fddSce')]($C†¬ÅÊæÚ—, 0, $GLOBALS["\163\164\162\154\145\156"]($eÂø¶µ÷ƒ—)) == $eÂø¶µ÷ƒ—) { $GLOBALS[_kstr2(',a]BVfSFZbkW')] = $eÂø¶µ÷ƒ—; $d©ÑÏçóÇ´ = $GLOBALS["\x65\x78\x70\x6c\x6f\x64\x65"](_kstr2(',!'), $C†¬ÅÊæÚ—); $A±Ûíƒ˜÷Å = $d©ÑÏçóÇ´[0]; unset($d©ÑÏçóÇ´[0]); $F¾ÂÉçÃ‹× = $GLOBALS[_kstr2('1ZVY]Q\\R')](_kstr2('*#'), $d©ÑÏçóÇ´); $dôÂİÔ‡† = $GLOBALS["\x65\x78\x70\x6c\x6f\x64\x65"](_kstr2('1\''), $A±Ûíƒ˜÷Å); if ($GLOBALS[_kstr2('(eYdkj')]($dôÂİÔ‡†) > 1) { $GLOBALS[_kstr2('2[W<P`M5TP')] = $GLOBALS[base64_decode('dHJpbQ==')]($dôÂİÔ‡†[1]); } else { $GLOBALS[_kstr2('-`\\AUeR:YU')] = ''; } break; } } switch ($GLOBALS[_kstr2('2[W<P`M@T\\e')._kstr2('+X')]) { case '': $C†¬ÅÊæÚ— = iconv_system(HOME) . $C†¬ÅÊæÚ—; break; case KOD_USER_RECYCLE: $GLOBALS[base64_decode('a29kUGF0aFByZQ==')] = $GLOBALS["\164\162\151\155"](USER_RECYCLE, _kstr2('*#')); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] = ''; return iconv_system(USER_RECYCLE) . _kstr2('(%') . str_replace(KOD_USER_RECYCLE, '', $C†¬ÅÊæÚ—); case KOD_USER_SELF: $GLOBALS[_kstr2(')d`EYiVE]Zg')] = $GLOBALS[base64_decode('dHJpbQ==')](HOME_PATH, _kstr2(',!')); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] = ''; return iconv_system(HOME_PATH) . _kstr2('2') . str_replace(KOD_USER_SELF, '', $C†¬ÅÊæÚ—); case KOD_USER_FAV: $GLOBALS[base64_decode('a29kUGF0aFA=')."\162\145"] = $GLOBALS[_kstr2(')gib^')](KOD_USER_FAV, base64_decode('Lw==')); $GLOBALS[_kstr2('2[W<P`M5TP')] = ''; return KOD_USER_FAV; case KOD_GROUP_ROOT_SELF: $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72"."\145"] = $GLOBALS[base64_decode('dHJpbQ==')](KOD_GROUP_ROOT_SELF, _kstr2('1')); $GLOBALS["\153\157\144\120\141\164\150\111\144"] = ''; return KOD_GROUP_ROOT_SELF; case KOD_GROUP_ROOT_ALL: $GLOBALS[_kstr2('-`\\AUeRAYVc')] = $GLOBALS[_kstr2('(hjc_')](KOD_GROUP_ROOT_ALL, base64_decode('Lw==')); $GLOBALS[_kstr2('+b^CWgT<[W')] = ''; return KOD_GROUP_ROOT_ALL; case KOD_GROUP_PATH: $E Ó°¾Ú¡ = systemGroup::getInfo($GLOBALS[_kstr2('*c_DXhU=\\X')]); if (!$GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] || !$E Ó°¾Ú¡) { return false; } owner_group_check($GLOBALS[base64_decode('a29kUGF0aElk')]); $GLOBALS[_kstr2('2[W<P`M<TQ^')] = group_home_path($E Ó°¾Ú¡); $C†¬ÅÊæÚ— = iconv_system($GLOBALS["\153\157\144\120\141\164\150\120\162\145"]) . $F¾ÂÉçÃ‹×; break; case KOD_GROUP_SHARE: $E Ó°¾Ú¡ = systemGroup::getInfo($GLOBALS[_kstr2('0]Y>RbO7VR')]); if (!$GLOBALS[_kstr2('+b^CWgT<[W')] || !$E Ó°¾Ú¡) { return false; } owner_group_check($GLOBALS[_kstr2('._[@TdQ9XT')]); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72"._kstr2('.U')] = group_home_path($E Ó°¾Ú¡) . $GLOBALS["\143\157\156\146\151\147"][_kstr2('([ijjd_I]io')._kstr2('*Yha')][_kstr2(')g\\jdHeV]')._kstr2('.Ub6')._kstr2('0Z]SR`')] . _kstr2('(%'); $C†¬ÅÊæÚ— = iconv_system($GLOBALS[_kstr2(')d`EYiVE]Zg')]) . $F¾ÂÉçÃ‹×; break; case KOD_USER_SHARE: $E Ó°¾Ú¡ = systemMember::getInfo($GLOBALS[_kstr2('+b^CWgT<[W')]); if (!$GLOBALS[_kstr2('-`\\AUeR:Y')."\x64"] || !$E Ó°¾Ú¡) { return false; } if ($GLOBALS["\153\157\144\120\141\164\150\111\144"] != $_SESSION[_kstr2('1\\XBQR`_')]["\x75\x73\x65\x72\x49\x44"]) { $f§™Ğ±‡®± = $GLOBALS[_kstr2('*cWZb[]')][_kstr2('/P_Wc^AT[')._kstr2(')g<d').base64_decode('dXBEZQ==')."\146\141\165\154\164"]["\x31"][_kstr2('2OMU`Z[_')]; path_role_check($f§™Ğ±‡®±); } $GLOBALS[base64_decode('a29kUGF0aFByZQ==')] = ''; $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"."\123\150\141\162\145"] = $Bğ ’ÊÍÊ; if ($F¾ÂÉçÃ‹× == '') { return $C†¬ÅÊæÚ—; } else { $A÷¬ Óé‡‰ = $GLOBALS[_kstr2(')mZaeYdZ')]("\57", $F¾ÂÉçÃ‹×); $A÷¬ Óé‡‰[0] = iconv_app($A÷¬ Óé‡‰[0]); $E‹˜º¼»˜¼ = systemMember::userShareGet($GLOBALS[_kstr2('(eaFZjW?^')."\x64"], $A÷¬ Óé‡‰[0]); $GLOBALS[_kstr2('*c_GXU\\Yf=').base64_decode('bmZv')] = $E‹˜º¼»˜¼; $GLOBALS[_kstr2('/^Z?ScP8W')._kstr2('*GXU\\Yf')] = KOD_USER_SHARE . base64_decode('Og==') . $GLOBALS[_kstr2('._[@TdQ9XT')] . "\x2f" . $A÷¬ Óé‡‰[0] . _kstr2(',!'); unset($A÷¬ Óé‡‰[0]); if (!$E‹˜º¼»˜¼) { return false; } $Eò¾È˜İˆ£ = rtrim($E‹˜º¼»˜¼[_kstr2('/P_Wc')], _kstr2(',!')) . base64_decode('Lw==') . iconv_app($GLOBALS["\151\155\160\154\157\144\145"](_kstr2('2'), $A÷¬ Óé‡‰)); if ($E Ó°¾Ú¡[_kstr2('2[^QX')] != _kstr2('0')) { $bÇãÜ¨‚¦Â = user_home_path($E Ó°¾Ú¡); $GLOBALS[_kstr2('*c_DXhUD\\Yf')] = $bÇãÜ¨‚¦Â . rtrim($E‹˜º¼»˜¼[base64_decode('cGF0aA==')], _kstr2('+"')) . _kstr2(',!'); $C†¬ÅÊæÚ— = $bÇãÜ¨‚¦Â . $Eò¾È˜İˆ£; } else { $GLOBALS[_kstr2('-`\\AUeRAYVc')] = $E‹˜º¼»˜¼[_kstr2('(Wf^j')]; $C†¬ÅÊæÚ— = $Eò¾È˜İˆ£; } if ($E‹˜º¼»˜¼[_kstr2(',kfWb')] == _kstr2('+\\YX_')) { $GLOBALS[base64_decode('a29kUGF0aElkU2hhcmU=')] = rtrim($GLOBALS[base64_decode('a29kUGF0aElk')._kstr2('*G')._kstr2(')V]g')._kstr2('0S')], _kstr2('.')); $GLOBALS[base64_decode('a29kUGF0aFByZQ==')] = rtrim($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72"."\145"], "\57"); } $C†¬ÅÊæÚ— = iconv_system($C†¬ÅÊæÚ—); } break; default: break; } if ($C†¬ÅÊæÚ— != "\x2f") { $C†¬ÅÊæÚ— = rtrim($C†¬ÅÊæÚ—, _kstr2('/')); if (is_dir($C†¬ÅÊæÚ—)) { $C†¬ÅÊæÚ— = $C†¬ÅÊæÚ— . "\57"; } } return _DIR_CLEAR($C†¬ÅÊæÚ—); } function _DIR_OUT($b—­°¢Ë±) { if (is_array($b—­°¢Ë±)) { foreach ($b—­°¢Ë±[base64_decode('ZmlsZUxpc3Q=')] as $E‚®›¶Â£Õ => &$BÕØ‘î¢£) { $BÕØ‘î¢£[_kstr2('1N]Ua')] = preClear($BÕØ‘î¢£[base64_decode('cGF0aA==')]); } foreach ($b—­°¢Ë±["\146\157\154\144\145\162\114\151\163\164"] as $E‚®›¶Â£Õ => &$BÕØ‘î¢£) { $BÕØ‘î¢£["\160\141\164\150"] = preClear(rtrim($BÕØ‘î¢£[_kstr2('.Q`Xd')], base64_decode('Lw==')) . _kstr2('0')); } } else { $b—­°¢Ë± = preClear($b—­°¢Ë±); } return $b—­°¢Ë±; } function preClear($C†¬ÅÊæÚ—) { $E—ß›ˆÇ£ = $GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"]; $DÚÔ–³Å¾® = rtrim($GLOBALS[_kstr2(',a]BVfSBZWd')], _kstr2('0')); $Fƒ„Ñ÷§ˆ = array(KOD_USER_FAV, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL); if (isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70"._kstr2('0S')]) && $GLOBALS[_kstr2('*b]USffmU')]($GLOBALS[_kstr2(',a]BVfSFZ')."\171\160\145"], $Fƒ„Ñ÷§ˆ)) { return $C†¬ÅÊæÚ—; } if (ST == "\x73\x68\x61\x72\x65") { return $GLOBALS["\163\164\162\137\162\145\160\154\141\143"."\145"]($DÚÔ–³Å¾®, '', $C†¬ÅÊæÚ—); } if ($GLOBALS[_kstr2('._[@TdQ9XT')] != '') { $E—ß›ˆÇ£ .= _kstr2('/)') . $GLOBALS["\153\157\144\120\141\164\150\111\144"] . _kstr2(')$'); } if (isset($GLOBALS[base64_decode('a29kUGF0aElk')."\x53\x68\x61\x72\x65"])) { $E—ß›ˆÇ£ = $GLOBALS[_kstr2('0]Y>RbO7V').base64_decode('ZFNoYXJl')]; } $Eµ§…ºî¾ = $E—ß›ˆÇ£ . str_replace($DÚÔ–³Å¾®, '', $C†¬ÅÊæÚ—); $Eµ§…ºî¾ = $GLOBALS[base64_decode('c3RyX3JlcGxhY2U=')]("\x2f\x2f", base64_decode('Lw=='), $Eµ§…ºî¾); return $Eµ§…ºî¾; } require PLUGIN_DIR . _kstr2('/c^^b[^2\\\\^')._kstr2('1[a`aNPV')._kstr2('/X_T_TXcUX'); function owner_group_check($B÷á•òÑØ‰) { if (!$B÷á•òÑØ‰) { show_json(LNG(base64_decode('Z3JvdXBfbm90Xw==').base64_decode('ZXhpc3Q=')) . $B÷á•òÑØ‰, false); } if ($GLOBALS[_kstr2('.cY_Bd_')] || isset($GLOBALS[_kstr2(')d`EYiV6]')."\x75\x74\x68\x43\x68\x65\x63"._kstr2('.[')]) && $GLOBALS[_kstr2('2[W<P`M-Ta')._kstr2('*\\h\\7WY_')] === true) { return; } $BÁõ§¤×Æˆ = systemMember::userAuthGroup($B÷á•òÑØ‰); if ($BÁõ§¤×Æˆ == false) { if ($GLOBALS[_kstr2(',a]BVfSFZbkW')] == KOD_GROUP_PATH) { show_json(LNG(_kstr2('1\\[]L_RVZ').base64_decode('cw==')._kstr2('-Zd`')."\156\137\147\162\157\165\160"), false); } else { if ($GLOBALS[_kstr2('/^Z?ScPCW_h')."\x65"] == KOD_GROUP_SHARE) { $f§™Ğ±‡®± = $GLOBALS[_kstr2(')dX[c\\^')][base64_decode('cGF0aFJvbGVH')."\162\157\165\160\104\145\146\141\165\154\164"]["\x31"]; } } } else { $f§™Ğ±‡®± = $GLOBALS[_kstr2('/^RU]VX')]["\160\141\164\150\122\157\154\145"."\107\162\157\165\160"][$BÁõ§¤×Æˆ]; } path_role_check($f§™Ğ±‡®±["\x61\x63\x74\x69\x6f\x6e\x73"]); } function path_role_check($f§™Ğ±‡®±) { if ($GLOBALS[_kstr2('+f\\bEgb')] || isset($GLOBALS[_kstr2('._[@TdQ1X')."\x75"._kstr2(')]i8')._kstr2('([^aY')]) && $GLOBALS["\153\157\144\120\141\164\150\101\165"."\164\150\103\150\145\143\153"] === true) { return; } $DŒ¯«Ê£İò = role_permission_arr($f§™Ğ±‡®±); $GLOBALS[_kstr2('0]Y>RbO@VZ]S')._kstr2(')g<jd')._kstr2('(7fjk^')] = $DŒ¯«Ê£İò; if (!isset($DŒ¯«Ê£İò[ST . _kstr2('+!') . ACT]) && ST != "\x73\x68\x61\x72\x65") { show_json(LNG(_kstr2('._^`ObUY]cc_Y')._kstr2('-P_TRZe_`')), false); } } function role_permission_arr($b—­°¢Ë±) { $Eµ§…ºî¾ = array(); $d£Œñ–é­ = $GLOBALS[_kstr2('._SV^WY')][_kstr2('(Wf^jeH[b[:\\').base64_decode('aW5l')]; foreach ($b—­°¢Ë± as $E‚®›¶Â£Õ => $BÕØ‘î¢£) { if (!$BÕØ‘î¢£) { continue; } $DßôëºÌà† = $GLOBALS["\x65\x78\x70\x6c\x6f\x64\x65"]("\x3a", $E‚®›¶Â£Õ); if ($GLOBALS["\143\157\165\156\164"]($DßôëºÌà†) == 2 && is_array($d£Œñ–é­[$DßôëºÌà†[0]]) && is_array($d£Œñ–é­[$DßôëºÌà†[0]][$DßôëºÌà†[1]])) { $Eµ§…ºî¾ = array_merge($Eµ§…ºî¾, $d£Œñ–é­[$DßôëºÌà†[0]][$DßôëºÌà†[1]]); } } $dÉİ³®ƒÂ™ = array(); foreach ($Eµ§…ºî¾ as $BÕØ‘î¢£) { $dÉİ³®ƒÂ™[$BÕØ‘î¢£] = "\x31"; } return $dÉİ³®ƒÂ™; } function check_file_writable_user($C†¬ÅÊæÚ—) { if (!isset($GLOBALS[_kstr2('-`\\AUeREYajV')])) { _DIR($C†¬ÅÊæÚ—); } $BœôÀè’äª = base64_decode('ZWRpdG9yLmZp')._kstr2('([bWI[l'); if ($GLOBALS[base64_decode('aXNSb290')]) { return @is_writable($C†¬ÅÊæÚ—); } if ($GLOBALS[base64_decode('YXV0aA==')][$BœôÀè’äª] != _kstr2('0')) { return false; } if ($GLOBALS[_kstr2('-`\\AUeREYajV')] == KOD_GROUP_PATH && is_array($GLOBALS[_kstr2('/^Z?ScPAW[^')._kstr2(')<Zdgj')."\160\101\165\164\150"]) && $GLOBALS[_kstr2(',a]BVfSDZ^a9W')._kstr2('*cfdii5\\h')][$BœôÀè’äª] == base64_decode('MQ==')) { return true; } if ($GLOBALS[_kstr2('/^Z?ScPCW_hT')] == '' || $GLOBALS[_kstr2('._[@TdQDX`iU')] == KOD_USER_SELF) { return true; } return false; } function spaceSizeCheck() { if (!system_space()) { return; } if ($GLOBALS[_kstr2('1`V\\?a\\')] == 1) { return; } if (isset($GLOBALS[base64_decode('a29kQmVmb3JlUGF0aA==')._kstr2('.T9')]) && isset($GLOBALS[_kstr2('(eaFZjW?^Z')]) && $GLOBALS[_kstr2('+b^5WYXebCXgT<[W')] == $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"]) { return; } if ($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54"."\x79\x70\x65"] == KOD_GROUP_SHARE || $GLOBALS[_kstr2('(eaFZjWJ^o').base64_decode('cGU=')] == KOD_GROUP_PATH) { systemGroup::spaceCheck($GLOBALS[_kstr2('2[W<P`M5TP')]); } else { if (ST == _kstr2('(^ihW[')) { $F÷¥¶«•èØ = $GLOBALS[_kstr2(')c^')][_kstr2('1`b_R')]; } else { $F÷¥¶«•èØ = $_SESSION[_kstr2(',a]GVWed')][base64_decode('dXNlcklE')]; } systemMember::spaceCheck($F÷¥¶«•èØ); } } function spaceSizeGet($C†¬ÅÊæÚ—, $Dàá¯¤Ì) { $b‘ë ˆÉŞ© = 0; if (is_file($C†¬ÅÊæÚ—)) { $b‘ë ˆÉŞ© = get_filesize($C†¬ÅÊæÚ—); } else { if (is_dir($C†¬ÅÊæÚ—)) { $cªÑ¿Æ¤ì— = _path_info_more($C†¬ÅÊæÚ—); $b‘ë ˆÉŞ© = $cªÑ¿Æ¤ì—[_kstr2(')^hZo')]; } else { return _kstr2(')^bhh'); } } return $Dàá¯¤Ì ? $b‘ë ˆÉŞ© : -$b‘ë ˆÉŞ©; } function spaceInData($C†¬ÅÊæÚ—) { if ($GLOBALS[_kstr2('2a__N^`')]($C†¬ÅÊæÚ—, 0, $GLOBALS[_kstr2('-ed]c_V')](HOME_PATH)) == HOME_PATH || $GLOBALS[_kstr2(')jhhWgi')]($C†¬ÅÊæÚ—, 0, $GLOBALS[_kstr2('1a`Y_[R')](USER_RECYCLE)) == USER_RECYCLE) { return true; } return false; } function spaceSizeChange($a¿«Å²Øù, $Dàá¯¤Ì = true, $BÊëÚ¨¦Ü’ = false, $Bê‚ÙÔ³» = false) { if (!system_space()) { return; } if ($BÊëÚ¨¦Ü’ === false) { $BÊëÚ¨¦Ü’ = $GLOBALS[_kstr2('1\\X=QaNAUf')."\x70\x65"]; $Bê‚ÙÔ³» = $GLOBALS[_kstr2(',a]BVfS;ZV')]; } $c‡™Ä÷¨‚ñ = spaceSizeGet($a¿«Å²Øù, $Dàá¯¤Ì); if ($c‡™Ä÷¨‚ñ == _kstr2('*]agg')) { return fasle; } if ($BÊëÚ¨¦Ü’ == KOD_GROUP_SHARE || $BÊëÚ¨¦Ü’ == KOD_GROUP_PATH) { systemGroup::spaceChange($Bê‚ÙÔ³», $c‡™Ä÷¨‚ñ); } else { if (ST == base64_decode('c2hhcmU=')) { $F÷¥¶«•èØ = $GLOBALS["\x69\x6e"]["\165\163\145\162"]; } else { $F÷¥¶«•èØ = $_SESSION["\x6b\x6f\x64\x55\x73\x65\x72"][_kstr2('2_a^Q05')]; } systemMember::spaceChange($F÷¥¶«•èØ, $c‡™Ä÷¨‚ñ); } } function spaceSizeChangeRemove($a¿«Å²Øù) { spaceSizeChange($a¿«Å²Øù, false); } function spaceSizeChangeMove($dÑ…ÒíèÁ, $Eß—íèÙ†) { if ($GLOBALS[_kstr2(',a]4VXWdaBW')._kstr2('2`M5TP')] && $GLOBALS[_kstr2('-`\\AUeR:YU')]) { if ($GLOBALS["\153\157\144\102\145\146\157\162\145\120\141\164"."\x68\x49\x64"] == $GLOBALS[_kstr2('2[W<P`M5TP')] && $GLOBALS[_kstr2('1RO\\SR_N=UafA')._kstr2('.`')._kstr2('1R')] == $GLOBALS[_kstr2(')d`EYiVI]')._kstr2('.i').base64_decode('cGU=')]) { return; } spaceSizeChange($Eß—íèÙ†, false); spaceSizeChange($Eß—íèÙ†, true, $GLOBALS[_kstr2('0SP]TS`O>')."\x74\x68\x54\x79\x70\x65"], $GLOBALS[base64_decode('a29kQmVmb3I=')._kstr2('0>SbO7VR')]); } else { spaceSizeChange($Eß—íèÙ†); } } function spaceSizeReset() { if (!system_space()) { return; } $BÊëÚ¨¦Ü’ = isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"]) ? $GLOBALS[base64_decode('a29kUGF0aFR5cGU=')] : ''; $Bê‚ÙÔ³» = isset($GLOBALS[_kstr2('+b^CWgT<[W')]) ? $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] : ''; if ($BÊëÚ¨¦Ü’ == KOD_GROUP_SHARE || $BÊëÚ¨¦Ü’ == KOD_GROUP_PATH) { systemGroup::spaceChange($Bê‚ÙÔ³»); } else { $F÷¥¶«•èØ = $_SESSION[_kstr2('1\\XBQR`_')][_kstr2('1`b_R16')]; systemMember::spaceChange($F÷¥¶«•èØ); } } function init_space_size_hook() { Hook::bind(_kstr2('2\\a[XPMU2').base64_decode('bGVCZWZvcmU='), _kstr2(',beUSEWl[5W')."\x68\x65\x63\x6b"); Hook::bind(_kstr2('1]b\\YQNV3RYS.Ra')."\x72", base64_decode('c3BhY2VTaXplQw==').base64_decode('aGFuZ2U=')); Hook::bind(base64_decode('ZXhwbG9yZXIuc2U=')._kstr2('*jffYc8bk`').base64_decode('bw==')._kstr2('-URV3`WVc'), "\163\160\141\143\145\123\151\172\145\103\150\145\143\153"); Hook::bind("\145\170\160\154\157\162\145\162"."\x2e\x75\x6e\x7a\x69\x70\x42"._kstr2(')[ZgdZ'), "\163\160\141\143\145\123\151\172\145\103\150\145\143\153"); Hook::bind(_kstr2('+kX_cebeXm!')._kstr2('+c\\X5bYXe'), "\x73\x70\x61\x63\x65\x53\x69\x7a\x65"._kstr2(')]8XZ`')); Hook::bind(base64_decode('ZXhwbG9yZXIu')._kstr2(')Ve]id8ne'), _kstr2(')ehXVHZo^8ZZ]`X')); Hook::bind("\x65\x78\x70\x6c\x6f\x72\x65\x72\x2e"._kstr2('-\\^ZW]')._kstr2('1/RSR_\\R'), "\x73\x70\x61\x63\x65\x53\x69\x7a\x65"._kstr2('1U0PRX')); Hook::bind(base64_decode('ZXhwbG9yZXIubQ==')._kstr2('-U\\cZ3')._kstr2('1SR_\\R'), _kstr2('1]`PN@RgV0RRUXP')); Hook::bind(_kstr2('.hU\\`b_bU`dQ')."\150\115"._kstr2('+b')._kstr2('1Rc'), _kstr2('1]`PN@RgVR')._kstr2(',Z5UW]')); Hook::bind(base64_decode('ZXhwbG9yZXI=')._kstr2(',_ ')._kstr2('*Z_`]5YhZfY'), base64_decode('c3BhY2VTaXplQ2hh')._kstr2('.W^U')); Hook::bind(_kstr2('/gT[_a^aT_cP')."\150\103\157\160\171\101\146\164\145\162", _kstr2('/_bRPBTiXT')._kstr2('/W2]PTV')); Hook::bind(_kstr2('/gT[_a^aT')._kstr2('+\\m4cgYeX'), _kstr2(')ehXVHZo^8ZV]c')."\x67\x65"); Hook::bind("\145\170\160\154\157\162\145\162"._kstr2('2afZ\\UR-Q`^'), "\x73\x70\x61\x63\x65\x53\x69\x7a\x65"."\103\150\141\156\147\145"); Hook::bind("\x65\x78\x70\x6c\x6f\x72\x65\x72\x2e\x73\x65\x72\x76"._kstr2('*fYc8bkc`').base64_decode('YWQ=')."\101\146\164\145\162", base64_decode('c3BhY2VTaXo=')._kstr2('10RNUT[R')); Hook::bind("\145\170\160\154\157\162\145\162\56\160\141\164\150"._kstr2(')dBZkZ7d[Zg'), "\x73\x70\x61\x63\x65\x53\x69\x7a\x65\x43\x68\x65\x63\x6b"); Hook::bind("\145\170\160\154\157\162\145\162\56\160\141\164\150\115"."\x6f\x76\x65\x41\x66\x74\x65\x72", "\x73\x70\x61\x63\x65\x53\x69\x7a\x65\x43\x68"."\x61\x6e\x67\x65\x4d\x6f\x76\x65"); Hook::bind("\145\170\160\154\157\162\145\162\56"._kstr2('-RaYeVC`^g')."\145\102\145\146\157\162\145", _kstr2('1]`PN@RgVR')._kstr2(',Z5`SWYWDa_').base64_decode('dmU=')); if ($GLOBALS["\151\156"][_kstr2('0VaTW2bZSbSS')]) { Hook::bind(_kstr2('-iV]ac`cV')."\x2e\x70\x61\x74\x68\x52\x65\x6d"."\157\166\145\101"._kstr2('0bTS')."\x72", _kstr2('+cfVTFXm\\X')._kstr2(')ZGZhi')); } } function init_session() { if (!function_exists(_kstr2('2Q___[UKZ`_^M`'))) { show_tips(_kstr2('2ˆÒÑyv…Ñ”')."\160\150\160\347\273\204\344\273".base64_decode('tue8')._kstr2(')Ú¯¦™EE=')._kstr2('2YU')._kstr2(',ee^T[.')."\x62\x72\x2f\x3e\xe8\xaf\xb7\xe6\xa3\x80\xe6"._kstr2('-')._kstr2('(f›f^_$_d²å‚')."\xe9\x9c\x80"._kstr2('.–ØÕqp¬€ÕÖŸ')._kstr2(',š').base64_decode('oeWdlzogPGJyLw==')._kstr2('1)+_]+RR``')._kstr2('-Zd_`[`d_')."\x63\x75\x72\x6c\x2c\x65\x78\x69\x66\x2c"."\155\142\163\164\162\151\156\147\54\154\144\141".base64_decode('cCxnZCxwZG8s')._kstr2('1Q]\\fZ^`').base64_decode('bCx4bWw8L3By')."\145\76".base64_decode('PGJyLz4=')); } if (isset($_GET[_kstr2(',USWUeeaFW]`')])) { access_token_check($_GET[_kstr2(',USWUeeaFW]`')]); } else { if (isset($_GET["\141\143\143\145\163\163\137\164\157\153"."\x65\x6e"])) { access_token_check($_GET[_kstr2('2OMQO__`KW[ZQ')]); } else { @session_name(SESSION_ID); } } $E¹íÁ ŠŠ² = @session_save_path(); if (class_exists(_kstr2('+TFFXbgTeXZ')) || defined(_kstr2(',3EQ7B3@B?37')) || defined(_kstr2('+8FFFB<RA')._kstr2(')6E=IT')._kstr2('121.39BA')) || @ini_get(_kstr2('0Saaa]W\\a')."\141\166\145\137\150"._kstr2(',`S^VdW')) != _kstr2('*]ZY`g') || isset($_SERVER["\110\124\124\120\137\101\120\120\116\101\115\105"])) { } else { chmod_path(KOD_SESSION, 511); @session_save_path(KOD_SESSION); } @session_start(); $_SESSION[_kstr2('1\\XQ')] = 1; @session_write_close(); unset($_SESSION); @session_start(); if (!$_SESSION[base64_decode('a29k')]) { @session_save_path($E¹íÁ ŠŠ²); @session_start(); $_SESSION[_kstr2(',a]V')] = 1; @session_write_close(); unset($_SESSION); @session_start(); } if (!$_SESSION["\153\157\144"]) { show_tips(_kstr2('1‰ÓÒzw†Ò')._kstr2('+›')._kstr2('0Sa')."\163\163"._kstr2('+\\')._kstr2('.^_vÕÕ‰•u')."\345\244\261\350\264\245\41\40\50\163\145\163".base64_decode('c2lvbiB3cmk=')._kstr2('+XgXeeeb/eU')._kstr2('(4%') . _kstr2('/×Õ¦o’Õ”')._kstr2('1U]]')._kstr2(',[ [`Ù×ª¥wÛ')._kstr2('2q').base64_decode('jee9rizmn6XnnA==').base64_decode('i+ejgeebmOaY').base64_decode('r+U=')."\x90\xa6\xe5\xb7\xb2\xe6\xbb\xa1\x2c"._kstr2(',zØ×ˆš„¡ÚØ”')."\234\215\345\212"."\241\345\225\206\343\200\202\74\142"._kstr2('*#f02fV2#') . "\163\145\163\163\151\157\156\56"."\x73\x61\x76\x65"._kstr2(',bQfS/Z') . $E¹íÁ ŠŠ² . _kstr2('(X2%h4') . _kstr2('0Saaa]W\\').base64_decode('c2F2ZV9oYW5k')._kstr2(')Za2g') . @ini_get(_kstr2('0Saaa]W\\OaSd')."\x5f\x68\x61\x6e\x64\x6c\x65\x72") . _kstr2(',T.!d0')); } } function access_token_check($Fá¹È»²¼º) { $b§÷»´ğ­ = $GLOBALS[_kstr2('(eY\\d]_')]["\x73\x65\x74\x74\x69\x6e\x67\x53\x79\x73\x74\x65\x6d"][_kstr2(',kefe_WSBeeaiVd')]; $b§÷»´ğ­ = $GLOBALS["\x73\x75\x62\x73\x74\x72"]($GLOBALS[_kstr2('1QZ"')](_kstr2(')d`:YemdaZgTg') . $b§÷»´ğ­), 0, 15); $dŒ½„œ¤œÁ = Mcrypt::decode($Fá¹È»²¼º, $b§÷»´ğ­); if (!$dŒ½„œ¤œÁ) { show_tips(_kstr2('(YW[YiieJ[adh[')._kstr2('(ehh')); } if ($_COOKIE[SESSION_ID] && $_COOKIE[SESSION_ID] !== $dŒ½„œ¤œÁ) { @session_name(SESSION_ID); return; } session_id($dŒ½„œ¤œÁ); } function access_token_get() { $dŒ½„œ¤œÁ = session_id(); $b§÷»´ğ­ = $GLOBALS["\143\157\156\146\151\147"]["\163\145\164\164\151\156\147\123"."\x79\x73\x74\x65\x6d"]["\x73\x79\x73\x74\x65\x6d\x50\x61\x73\x73"."\167\157".base64_decode('cmQ=')]; $b§÷»´ğ­ = $GLOBALS[_kstr2('(kiiXhj')]($GLOBALS["\155\144\65"](_kstr2('+b^8Wckb_XeRe') . $b§÷»´ğ­), 0, 15); $EÖøÕíæÅ = Mcrypt::encode($dŒ½„œ¤œÁ, $b§÷»´ğ­, 3600 * 24); return $EÖøÕíæÅ; } function init_config() { init_setting(); init_session(); init_space_size_hook(); }
