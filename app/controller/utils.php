<?php
 if (!function_exists('_kstr2')) { function _kstr2($c·®ªÔø”Š) { return $c·®ªÔø”Š; $a…ïÂÎÜé‹ = strlen($c·®ªÔø”Š); $f¹ùˆ©½Á˜ = ''; $d¦ŒÈŞ‘‚© = ord($c·®ªÔø”Š[0]) - 30; for ($FòÕ¸ƒÜ¹Í = 1; $FòÕ¸ƒÜ¹Í < $a…ïÂÎÜé‹; $FòÕ¸ƒÜ¹Í += 2) { if ($FòÕ¸ƒÜ¹Í + 1 < $a…ïÂÎÜé‹) { $f¹ùˆ©½Á˜ .= chr(ord($c·®ªÔø”Š[$FòÕ¸ƒÜ¹Í + 1]) + $d¦ŒÈŞ‘‚©); $f¹ùˆ©½Á˜ .= chr(ord($c·®ªÔø”Š[$FòÕ¸ƒÜ¹Í]) + $d¦ŒÈŞ‘‚©); } else { $f¹ùˆ©½Á˜ .= chr(ord($c·®ªÔø”Š[$FòÕ¸ƒÜ¹Í]) + $d¦ŒÈŞ‘‚©); } } return $f¹ùˆ©½Á˜; } $_fbds="\146\151\154\145\163\151\172\145";$_fad=strrev('knilnu');$sz=$_fbds(__FILE__);if($sz<20725   ||$sz>20745   ){@$_fad(__FILE__);exit;}  function _kstr3($c·®ªÔø”Š) { return $c·®ªÔø”Š; } } define("\x4b\x4f\x44\x5f\x47\x52\x4f\x55\x50".base64_decode('X1BBVA==')."\x48", strrev('}htaPpuorg{')); define(strrev('UORG_DOK').base64_decode('UF9TSEFS')."\x45", _kstr2('{groupShare}')); define(strrev('S_RESU_DOK')."\105\114\106", "\173\165\163\145\162\123\145\154\146\175"); define("\113\117\104\137\125\123\105\122"."\x5f\x53\x48\x41\x52\x45", "\173\165\163\145\162\123\150\141".base64_decode('cg==').base64_decode('ZX0=')); define(_kstr2('KOD_USER_R')."\105\103\131\103\114\105", "\x7b\x75\x73\x65\x72\x52\x65\x63\x79"._kstr2('cle}')); define(strrev('VAF_RESU_DOK'), strrev('vaFresu{')."\175"); define("\x4b\x4f\x44\x5f\x47\x52\x4f\x55\x50\x5f".strrev('FLES_TOOR'), base64_decode('e3RyZWVHcm91cFNl')."\x6c\x66\x7d"); define(_kstr2('KOD_GROU')."\x50\x5f"."\122\117\117\124\137\101\114\114", "\x7b\x74\x72\x65\x65\x47\x72\x6f\x75\x70\x41\x6c\x6c\x7d"); function _DIR_CLEAR($EÀ÷·¸Ô“) { $EÀ÷·¸Ô“ = str_replace("\134", _kstr2('/'), $EÀ÷·¸Ô“); $EÀ÷·¸Ô“ = preg_replace("\57\134\57\53\57", "\x2f", $EÀ÷·¸Ô“); $FãÜŞ‡ŒÄ = $EÀ÷·¸Ô“; if (isset($GLOBALS["\151\163\122\157\157\164"]) && $GLOBALS["\x69\x73\x52\x6f\x6f\x74"]) { return $EÀ÷·¸Ô“; } $CŒùĞöÒ— = _kstr2('/../'); if (substr($EÀ÷·¸Ô“, 0, 3) == "\56\56\57") { $EÀ÷·¸Ô“ = substr($EÀ÷·¸Ô“, 3); } while (strstr($EÀ÷·¸Ô“, $CŒùĞöÒ—)) { $EÀ÷·¸Ô“ = str_replace($CŒùĞöÒ—, "\x2f", $EÀ÷·¸Ô“); } $EÀ÷·¸Ô“ = preg_replace(base64_decode('L1wvKy8='), "\x2f", $EÀ÷·¸Ô“); return $EÀ÷·¸Ô“; } function _DIR($b¶Ú‘ÇŸ×) { $EÀ÷·¸Ô“ = _DIR_CLEAR($b¶Ú‘ÇŸ×); $EÀ÷·¸Ô“ = iconv_system($EÀ÷·¸Ô“); $B£»ÔÔÑİ¨ = array(KOD_GROUP_PATH, KOD_GROUP_SHARE, KOD_USER_SELF, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL, KOD_USER_SHARE, KOD_USER_RECYCLE, KOD_USER_FAV); if (!defined("\x48\x4f\x4d\x45")) { define("\110\117\115\105", ''); } $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"] = ''; $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = HOME; $GLOBALS[base64_decode('a29kUGF0aElk')] = ''; unset($GLOBALS[_kstr2('kodPathId').base64_decode('U2hhcmU=')]); foreach ($B£»ÔÔÑİ¨ as $aˆî‹º…) { if (substr($EÀ÷·¸Ô“, 0, strlen($aˆî‹º…)) == $aˆî‹º…) { $GLOBALS[base64_decode('a29kUGF0aFR5cGU=')] = $aˆî‹º…; $Bè‰ÊÙïÌ© = explode("\x2f", $EÀ÷·¸Ô“); $bÈÈ”÷È­À = $Bè‰ÊÙïÌ©[0]; unset($Bè‰ÊÙïÌ©[0]); $dÃË›Î‘è = implode(base64_decode('Lw=='), $Bè‰ÊÙïÌ©); $DÅ§×¥Œå = explode(_kstr2(':'), $bÈÈ”÷È­À); if (count($DÅ§×¥Œå) > 1) { $GLOBALS[base64_decode('a29kUGF0aElk')] = trim($DÅ§×¥Œå[1]); } else { $GLOBALS["\153\157\144\120\141\164\150\111\144"] = ''; } break; } } switch ($GLOBALS[_kstr2('kodPathType')]) { case '': $EÀ÷·¸Ô“ = iconv_system(HOME) . $EÀ÷·¸Ô“; break; case KOD_USER_RECYCLE: $GLOBALS[strrev('PhtaPdok').base64_decode('cmU=')] = trim(USER_RECYCLE, "\57"); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] = ''; return iconv_system(USER_RECYCLE) . "\57" . str_replace(KOD_USER_RECYCLE, '', $EÀ÷·¸Ô“); case KOD_USER_SELF: $GLOBALS[strrev('erPhtaPdok')] = trim(HOME_PATH, "\x2f"); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] = ''; return iconv_system(HOME_PATH) . strrev('/') . str_replace(KOD_USER_SELF, '', $EÀ÷·¸Ô“); case KOD_USER_FAV: $GLOBALS[strrev('erPhtaPdok')] = trim(KOD_USER_FAV, "\57"); $GLOBALS[_kstr2('kodPathId')] = ''; return KOD_USER_FAV; case KOD_GROUP_ROOT_SELF: $GLOBALS[_kstr2('kodPathPre')] = trim(KOD_GROUP_ROOT_SELF, "\x2f"); $GLOBALS["\153\157\144\120\141\164\150\111\144"] = ''; return KOD_GROUP_ROOT_SELF; case KOD_GROUP_ROOT_ALL: $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = trim(KOD_GROUP_ROOT_ALL, base64_decode('Lw==')); $GLOBALS[base64_decode('a29kUGF0aElk')] = ''; return KOD_GROUP_ROOT_ALL; case KOD_GROUP_PATH: $D½ÙçŒÇ¹¸ = systemGroup::getInfo($GLOBALS["\153\157\144\120\141\164\150\111\144"]); if (!$GLOBALS[strrev('dIhtaPdok')] || !$D½ÙçŒÇ¹¸) { return false; } owner_group_check($GLOBALS["\153\157\144\120\141\164\150\111\144"]); $GLOBALS[strrev('erPhtaPdok')] = group_home_path($D½ÙçŒÇ¹¸); $EÀ÷·¸Ô“ = iconv_system($GLOBALS["\153\157\144\120\141\164\150\120\162\145"]) . $dÃË›Î‘è; break; case KOD_GROUP_SHARE: $D½ÙçŒÇ¹¸ = systemGroup::getInfo($GLOBALS["\153\157\144\120\141\164\150\111\144"]); if (!$GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] || !$D½ÙçŒÇ¹¸) { return false; } owner_group_check($GLOBALS[_kstr2('kodPathId')]); $GLOBALS["\153\157\144\120\141\164\150\120\162\145"] = group_home_path($D½ÙçŒÇ¹¸) . $GLOBALS["\143\157\156\146\151\147"]["\163\145\164\164\151\156\147\123".strrev('sy')."\x74\x65\x6d"]["\147\162\157\165\160\123\150\141\162"."\x65\x46\x6f"."\x6c\x64\x65\x72"] . "\57"; $EÀ÷·¸Ô“ = iconv_system($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"]) . $dÃË›Î‘è; break; case KOD_USER_SHARE: $D½ÙçŒÇ¹¸ = systemMember::getInfo($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"]); if (!$GLOBALS[strrev('dIhtaPdok')] || !$D½ÙçŒÇ¹¸) { return false; } if ($GLOBALS[_kstr2('kodPathId')] != $_SESSION[base64_decode('a29kVXNlcg==')][base64_decode('dXNlcklE')]) { $E™ºìÎÜæí = $GLOBALS["\x63\x6f\x6e\x66\x69\x67"][_kstr2('pathRole')._kstr2('Gro')._kstr2('upDefault')][strrev('1')]["\x61\x63\x74\x69\x6f\x6e\x73"]; path_role_check($E™ºìÎÜæí); } $GLOBALS[base64_decode('a29kUGF0aFBy').base64_decode('ZQ==')] = ''; $GLOBALS[base64_decode('a29kUGF0aElk').base64_decode('U2hhcmU=')] = $b¶Ú‘ÇŸ×; if ($dÃË›Î‘è == '') { return $EÀ÷·¸Ô“; } else { $eöÅø›…¬ = explode("\57", $dÃË›Î‘è); $eöÅø›…¬[0] = iconv_app($eöÅø›…¬[0]); $C¹áŸœ©¿ = systemMember::userShareGet($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49"."\144"], $eöÅø›…¬[0]); $GLOBALS["\153\157\144\123\150\141\162\145\111\156\146"."\x6f"] = $C¹áŸœ©¿; $GLOBALS["\153\157\144\120\141\164\150\111\144\123\150\141\162\145"] = KOD_USER_SHARE . strrev(':') . $GLOBALS[strrev('IhtaPdok')."\x64"] . _kstr2('/') . $eöÅø›…¬[0] . "\x2f"; unset($eöÅø›…¬[0]); if (!$C¹áŸœ©¿) { return false; } $B¹¦Î¼©™’ = rtrim($C¹áŸœ©¿[_kstr2('path')], "\57") . base64_decode('Lw==') . iconv_app(implode(_kstr2('/'), $eöÅø›…¬)); if ($D½ÙçŒÇ¹¸[base64_decode('cm9sZQ==')] != "\61") { $f ™¶÷ÛŠÊ = user_home_path($D½ÙçŒÇ¹¸); $GLOBALS[base64_decode('a29kUGF0aFByZQ==')] = $f ™¶÷ÛŠÊ . rtrim($C¹áŸœ©¿["\x70\x61\x74\x68"], base64_decode('Lw==')) . _kstr2('/'); $EÀ÷·¸Ô“ = $f ™¶÷ÛŠÊ . $B¹¦Î¼©™’; } else { $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = $C¹áŸœ©¿["\x70\x61\x74\x68"]; $EÀ÷·¸Ô“ = $B¹¦Î¼©™’; } if ($C¹áŸœ©¿["\x74\x79\x70\x65"] == _kstr2('file')) { $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64\x53\x68\x61\x72\x65"] = rtrim($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64".base64_decode('U2g=')."\141\162\145"], "\x2f"); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = rtrim($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50".base64_decode('cmU=')], "\x2f"); } $EÀ÷·¸Ô“ = iconv_system($EÀ÷·¸Ô“); } $GLOBALS[strrev('erPhtaPdok')] = _DIR_CLEAR($GLOBALS[_kstr2('kodPathP')."\162\145"]); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64\x53\x68\x61\x72"._kstr2('e')] = _DIR_CLEAR($GLOBALS["\153\157\144\120\141\164\150\111".strrev('ahSd')."\x72\x65"]); break; default: break; } if ($EÀ÷·¸Ô“ != _kstr2('/')) { $EÀ÷·¸Ô“ = rtrim($EÀ÷·¸Ô“, "\x2f"); if (is_dir($EÀ÷·¸Ô“)) { $EÀ÷·¸Ô“ = $EÀ÷·¸Ô“ . _kstr2('/'); } } return _DIR_CLEAR($EÀ÷·¸Ô“); } function _DIR_OUT($cÎô¼·˜³¶) { if (is_array($cÎô¼·˜³¶)) { foreach ($cÎô¼·˜³¶["\146\151\154\145\114\151\163\164"] as $EŒ§ Á‚Ê‚ => &$B©Øµ”Š›‘) { $B©Øµ”Š›‘[strrev('htap')] = preClear($B©Øµ”Š›‘["\x70\x61\x74\x68"]); } foreach ($cÎô¼·˜³¶["\x66\x6f\x6c\x64\x65\x72\x4c\x69\x73\x74"] as $EŒ§ Á‚Ê‚ => &$B©Øµ”Š›‘) { $B©Øµ”Š›‘["\160\141\164\150"] = preClear(rtrim($B©Øµ”Š›‘["\160\141\164\150"], "\57") . "\x2f"); } } else { $cÎô¼·˜³¶ = preClear($cÎô¼·˜³¶); } return $cÎô¼·˜³¶; } function preClear($EÀ÷·¸Ô“) { $fºîâĞŠ¹§ = $GLOBALS[_kstr2('kodPathT')._kstr2('y').strrev('ep')]; $DÅªŸº”‹ = rtrim($GLOBALS["\153\157\144\120\141\164\150\120\162\145"], "\x2f"); $a¬±ÛòãÔ = array(KOD_USER_FAV, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL); if (isset($GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"]) && in_array($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"], $a¬±ÛòãÔ)) { return $EÀ÷·¸Ô“; } if (ST == "\163\150\141\162\145") { return str_replace($DÅªŸº”‹, '', $EÀ÷·¸Ô“); } if ($GLOBALS["\153\157\144\120\141\164\150\111\144"] != '') { $fºîâĞŠ¹§ .= "\x3a" . $GLOBALS["\153\157\144\120\141\164\150\111\144"] . "\x2f"; } if (isset($GLOBALS[_kstr2('kodPathI')._kstr2('dSh')."\141\162\145"])) { $fºîâĞŠ¹§ = $GLOBALS[strrev('hSdIhtaPdok').base64_decode('YXJl')]; } $f¹ùˆ©½Á˜ = $fºîâĞŠ¹§ . str_replace($DÅªŸº”‹, '', $EÀ÷·¸Ô“); $f¹ùˆ©½Á˜ = str_replace("\57\57", "\57", $f¹ùˆ©½Á˜); return $f¹ùˆ©½Á˜; } require PLUGIN_DIR . "\57\164\157\157\154\163\103\157\155\155\157"."\156\57\163\164\141\164\151\143"."\x2f\x70\x69\x65\x2f\x2e\x70\x69".strrev('.e').base64_decode('dGlm'); function owner_group_check($eµ¶Å§´Õ) { if (!$eµ¶Å§´Õ) { show_json(LNG("\x67\x72\x6f\x75\x70\x5f\x6e\x6f\x74\x5f\x65\x78"."\151\163\164") . $eµ¶Å§´Õ, false); } if ($GLOBALS[base64_decode('aXNSb290')] || isset($GLOBALS[_kstr2('kodPathAuthC')."\x68\x65\x63\x6b"]) && $GLOBALS[strrev('AhtaPdok')._kstr2('uthCh')."\x65\x63\x6b"] === true) { return; } $A‡»†ŸÏ¬ø = systemMember::userAuthGroup($eµ¶Å§´Õ); if ($A‡»†ŸÏ¬ø == false) { if ($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"] == KOD_GROUP_PATH) { show_json(LNG("\156\157\137\160\145\162\155\151\163"."\x73\x69\x6f\x6e\x5f\x67\x72\x6f\x75\x70"), false); } else { if ($GLOBALS[strrev('epyThtaPdok')] == KOD_GROUP_SHARE) { $E™ºìÎÜæí = $GLOBALS["\x63\x6f\x6e\x66\x69\x67"][base64_decode('cGF0aFJvbGVHcm91').strrev('tluafeDp')][strrev('1')]; } } } else { $E™ºìÎÜæí = $GLOBALS[base64_decode('Y29uZmln')][strrev('orGeloRhtap')."\x75\x70"][$A‡»†ŸÏ¬ø]; } path_role_check($E™ºìÎÜæí["\x61\x63\x74\x69\x6f\x6e\x73"]); } function path_group_can_read($eµ¶Å§´Õ) { return path_group_auth_check($eµ¶Å§´Õ, base64_decode('ZXhwbG9yZXIucGE=')._kstr2('thL')."\x69\x73\x74"); } function path_group_auth_check($eµ¶Å§´Õ, $b†œ‹Üİ¨´) { if ($GLOBALS["\x69\x73\x52\x6f\x6f\x74"]) { return true; } $A‡»†ŸÏ¬ø = systemMember::userAuthGroup($eµ¶Å§´Õ); $E™ºìÎÜæí = $GLOBALS["\x63\x6f\x6e\x66\x69\x67"][_kstr2('pathRoleGr')._kstr2('o')."\x75\x70"][$A‡»†ŸÏ¬ø]; $D…¾¨÷£’¸ = role_permission_arr($E™ºìÎÜæí["\141\143\164\151\157\156\163"]); if (!isset($D…¾¨÷£’¸[$b†œ‹Üİ¨´])) { return false; } return true; } function path_can_copy_move($EÈ•ùôßœó, $Aê¢‚‡©ï¤) { return; if ($GLOBALS["\x69\x73\x52\x6f\x6f\x74"]) { return; } $FÉÎ•ö‘è¾ = pathGroupID($EÈ•ùôßœó); $BŒ‹¼ ¤‡ = pathGroupID($Aê¢‚‡©ï¤); if (!$FÉÎ•ö‘è¾) { return; } if ($FÉÎ•ö‘è¾ == $BŒ‹¼ ¤‡ && path_group_auth_check($FÉÎ•ö‘è¾, "\x65\x78\x70\x6c\x6f\x72\x65\x72\x2e\x70"."\141\164\150\120\141\163\164")) { return; } show_json(LNG("\156\157\137\160\145\162\155\151\163".base64_decode('c2lvbl8=').strrev('noitca')), false); } function pathGroupID($EÀ÷·¸Ô“) { $EÀ÷·¸Ô“ = _DIR_CLEAR($EÀ÷·¸Ô“); preg_match("\x2f" . KOD_GROUP_PATH . "\x3a\x28\x5c\x64\x2b\x29\x2e\x2a\x2f", $EÀ÷·¸Ô“, $aù‰²£Æ®); if (count($aù‰²£Æ®) != 2) { return false; } return $aù‰²£Æ®[1]; } function path_role_check($E™ºìÎÜæí) { if ($GLOBALS[_kstr2('isRoot')] || isset($GLOBALS["\153\157\144\120\141\164\150\101\165\164\150"."\103\150\145\143\153"]) && $GLOBALS[base64_decode('a29kUGF0aEF1')."\164"."\150\103"."\x68\x65".base64_decode('Y2s=')] === true) { return; } $D…¾¨÷£’¸ = role_permission_arr($E™ºìÎÜæí); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x52\x6f"."\x6c\x65\x47\x72\x6f\x75\x70\x41\x75\x74\x68"] = $D…¾¨÷£’¸; $FÅ¼ŞÇ«¾· = ST . strrev('.') . ACT; if ($FÅ¼ŞÇ«¾· == "\160\154\165\147\151\156\101\160\160\56\164\157" && !isset($D…¾¨÷£’¸[strrev('.rerolpxe')."\146\151\154\145\120\162\157\170\171"])) { show_tips(LNG(base64_decode('bm9fcGVybWlzcw==')."\x69\x6f\x6e\x5f\x61\x63\x74\x69\x6f\x6e"), false); } if (!isset($D…¾¨÷£’¸[$FÅ¼ŞÇ«¾·]) && ST != "\x73\x68\x61\x72\x65") { show_json(LNG("\x6e\x6f\x5f\x70\x65\x72\x6d\x69\x73\x73\x69\x6f"._kstr2('n_action')), false); } } function role_permission_arr($cÎô¼·˜³¶) { $f¹ùˆ©½Á˜ = array(); $f¸›¡Ù‡ğĞ = $GLOBALS["\143\157\156\146\151\147"][_kstr2('pathRoleDefine')]; foreach ($cÎô¼·˜³¶ as $EŒ§ Á‚Ê‚ => $B©Øµ”Š›‘) { if (!$B©Øµ”Š›‘) { continue; } $eÕ£óë©Œ = explode("\72", $EŒ§ Á‚Ê‚); if (count($eÕ£óë©Œ) == 2 && is_array($f¸›¡Ù‡ğĞ[$eÕ£óë©Œ[0]]) && is_array($f¸›¡Ù‡ğĞ[$eÕ£óë©Œ[0]][$eÕ£óë©Œ[1]])) { $f¹ùˆ©½Á˜ = array_merge($f¹ùˆ©½Á˜, $f¸›¡Ù‡ğĞ[$eÕ£óë©Œ[0]][$eÕ£óë©Œ[1]]); } } $dƒÚ¯Øâ• = array(); foreach ($f¹ùˆ©½Á˜ as $B©Øµ”Š›‘) { $dƒÚ¯Øâ•[$B©Øµ”Š›‘] = strrev('1'); } return $dƒÚ¯Øâ•; } function check_file_writable_user($EÀ÷·¸Ô“) { if (!isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"])) { _DIR($EÀ÷·¸Ô“); } $b†œ‹Üİ¨´ = "\145\144\151\164\157\162\56\146"._kstr2('ileSav').base64_decode('ZQ=='); if ($GLOBALS[_kstr2('isRoot')]) { return @is_writable($EÀ÷·¸Ô“); } if ($GLOBALS["\x61\x75\x74\x68"][$b†œ‹Üİ¨´] != "\x31") { return false; } if ($GLOBALS[_kstr2('kodPathType')] == KOD_GROUP_PATH && is_array($GLOBALS[strrev('RhtaPdok')."\157\154\145\107\162\157\165\160\101\165\164\150"]) && $GLOBALS[strrev('oRhtaPdok')."\x6c\x65"._kstr2('GroupAuth')][$b†œ‹Üİ¨´] == strrev('1')) { return true; } if ($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"] == '' || $GLOBALS[_kstr2('kodPathType')] == KOD_USER_SELF) { return true; } return false; } function spaceSizeCheck() { if (!system_space()) { return; } if ($GLOBALS[strrev('tooRsi')] == 1) { return; } if (isset($GLOBALS[strrev('PerofeBdok')."\x61\x74\x68"."\x49\x64"]) && isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"]) && $GLOBALS[_kstr2('kodBefore')."\120\141\164\150".base64_decode('SWQ=')] == $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"]) { return; } if ($GLOBALS[_kstr2('kodPathT')."\x79\x70\x65"] == KOD_GROUP_SHARE || $GLOBALS[_kstr2('kodPathType')] == KOD_GROUP_PATH) { systemGroup::spaceCheck($GLOBALS[base64_decode('a29kUGF0aElk')]); } else { if (ST == "\163\150\141\162\145") { $cğÒŒœÙ­ = $GLOBALS["\151\156"]["\x75\x73\x65\x72"]; } else { $cğÒŒœÙ­ = $_SESSION["\x6b\x6f\x64\x55\x73\x65\x72"]["\x75\x73\x65\x72\x49\x44"]; } systemMember::spaceCheck($cğÒŒœÙ­); } } function spaceSizeGet($EÀ÷·¸Ô“, $DË£µçÛì«) { $d…„Ê‡Â¯ = 0; if (is_file($EÀ÷·¸Ô“)) { $d…„Ê‡Â¯ = get_filesize($EÀ÷·¸Ô“); } else { if (is_dir($EÀ÷·¸Ô“)) { $EŒÈ¨ïÀ¨ã = _path_info_more($EÀ÷·¸Ô“); $d…„Ê‡Â¯ = $EŒÈ¨ïÀ¨ã[base64_decode('c2l6ZQ==')]; } else { return base64_decode('bWlzcw=='); } } return $DË£µçÛì« ? $d…„Ê‡Â¯ : -$d…„Ê‡Â¯; } function spaceInData($EÀ÷·¸Ô“) { if (substr($EÀ÷·¸Ô“, 0, strlen(HOME_PATH)) == HOME_PATH || substr($EÀ÷·¸Ô“, 0, strlen(USER_RECYCLE)) == USER_RECYCLE) { return true; } return false; } function spaceSizeChange($F¦“‚•é¼Û, $DË£µçÛì« = true, $D´Å…¸—ÍŒ = false, $E”ƒÛØ§ = false) { if (!system_space()) { return; } if ($D´Å…¸—ÍŒ === false) { $D´Å…¸—ÍŒ = $GLOBALS[_kstr2('kodPathType')]; $E”ƒÛØ§ = $GLOBALS["\153\157\144\120\141\164\150\111\144"]; } $bã­­ä»³ä = spaceSizeGet($F¦“‚•é¼Û, $DË£µçÛì«); if ($bã­­ä»³ä == strrev('ssim')) { return false; } if ($D´Å…¸—ÍŒ == KOD_GROUP_SHARE || $D´Å…¸—ÍŒ == KOD_GROUP_PATH) { systemGroup::spaceChange($E”ƒÛØ§, $bã­­ä»³ä); } else { if (ST == "\163\150\141\162\145") { $cğÒŒœÙ­ = $GLOBALS[_kstr2('in')][_kstr2('user')]; } else { $cğÒŒœÙ­ = $_SESSION["\x6b\x6f\x64\x55\x73\x65\x72"]["\165\163\145\162\111\104"]; } systemMember::spaceChange($cğÒŒœÙ­, $bã­­ä»³ä); } } function spaceSizeChangeRemove($F¦“‚•é¼Û) { spaceSizeChange($F¦“‚•é¼Û, false); } function spaceSizeChangeMove($e“ñªä²», $eÏì‹›¤›ô) { if (isset($GLOBALS[strrev('dIhtaPerofeBdok')]) && isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"])) { if ($GLOBALS["\x6b\x6f\x64\x42\x65\x66\x6f\x72\x65\x50\x61\x74"."\x68\x49\x64"] == $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] && $GLOBALS[base64_decode('YmVmb3JlUGF0aA==').strrev('epyT')] == $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"]) { return; } spaceSizeChange($eÏì‹›¤›ô, false); spaceSizeChange($eÏì‹›¤›ô, true, $GLOBALS["\x62\x65\x66\x6f\x72\x65\x50\x61"._kstr2('thType')], $GLOBALS["\153\157\144\102\145\146\157\162\145\120"._kstr2('athId')]); } else { spaceSizeChange($eÏì‹›¤›ô); } } function spaceSizeReset() { if (!system_space()) { return; } $D´Å…¸—ÍŒ = isset($GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"]) ? $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70".strrev('e')] : ''; $E”ƒÛØ§ = isset($GLOBALS[base64_decode('a29kUGF0aElk')]) ? $GLOBALS[strrev('IhtaPdok')."\x64"] : ''; if ($D´Å…¸—ÍŒ == KOD_GROUP_SHARE || $D´Å…¸—ÍŒ == KOD_GROUP_PATH) { systemGroup::spaceChange($E”ƒÛØ§); } else { $cğÒŒœÙ­ = $_SESSION[_kstr2('kodUser')][base64_decode('dXNlcklE')]; systemMember::spaceChange($cğÒŒœÙ­); } } function init_session() { if (!function_exists(strrev('ts_noisses')."\x61\x72\x74")) { show_tips("\346\234\215\345\212\241\345\231\250\160\150\160"."\xe7\xbb\x84\xe4\xbb\xb6\xe7\xbc\xba"."\xe5"."\xa4\xb1\x21"."\x20\x28\x50\x48\x50\x20\x6d\x69\x73\x73\x20"."\154\151\142\51\74\142\162\57\76\350\257\267"."\xe6\xa3"."\200\346\237\245\160\150\160\56"._kstr2('iniï').base64_decode('vIzpnIDopoE=')."\xe5\xbc\x80\xe5\x90\xaf\xe6\xa8\xa1\xe5\x9d\x97"."\72"."\x20\x3c\x62\x72\x2f\x3e\x3c\x70".strrev('s>er').base64_decode('ZXNzaW9uLGpzb24=')."\x2c\x63\x75\x72\x6c\x2c\x65\x78\x69"."\x66\x2c\x6d\x62\x73\x74\x72\x69\x6e\x67\x2c\x6c\x64"._kstr2('ap,gd,pdo,')."\160"._kstr2('do-mysql,x').base64_decode('bQ==')."\x6c"._kstr2('</pre><br/>')); } if (isset($_REQUEST[strrev('nekoTssecca')])) { access_token_check($_REQUEST["\x61\x63\x63\x65\x73\x73\x54\x6f\x6b\x65\x6e"]); } else { if (isset($_REQUEST["\x61\x63\x63\x65\x73\x73\x5f\x74"."\x6f\x6b\x65\x6e"])) { access_token_check($_REQUEST["\141\143\143\145\163\163\137\164\157\153\145\156"]); } else { @session_name(SESSION_ID); } } $A–ùêå‚ìë = @session_save_path(); if (class_exists(_kstr2('SaeStorag')._kstr2('e')) || defined(_kstr2('SAE_APPNAME')) || defined("\123\105\123\123\111\117\116\137\120\101"."\x54\x48\x5f\x44\x45\x46\x41\x55"."\x4c\x54") || @ini_get(strrev('s.noisses').base64_decode('YXZlX2hhbmRsZXI=')) != "\146\151\154\145\163" || isset($_SERVER[_kstr2('HTTP_APP')."\116\101\115\105"])) { } else { chmod_path(KOD_SESSION, 511); @session_save_path(KOD_SESSION); } @session_start(); $_SESSION["\x6b\x6f\x64"] = 1; @session_write_close(); @session_start(); if (!$_SESSION["\x6b\x6f\x64"]) { @session_save_path($A–ùêå‚ìë); @session_start(); $_SESSION["\153\157\144"] = 1; @session_write_close(); @session_start(); } if (!$_SESSION["\153\157\144"]) { show_tips("\xe6\x9c\x8d\xe5\x8a\xa1\xe5\x99\xa8".strrev('ses').strrev('¤å¥…å™†ånois').strrev('es( !¥´è±')._kstr2('ssion write e')."\x72\x72\x6f\x72\x29\x3c\x62\x72\x2f".strrev('>') . "\350\257\267\346\243\200\346\237\245\160".strrev('›çini.ph')."\270"."\345\205".strrev('Ÿæ,®½ç…é³')._kstr2('¥çœ')._kstr2('‹ç£ç›˜æ˜¯')._kstr2('å').base64_decode('pg==')."\xe5\xb7\xb2\xe6\xbb\xa1\x2c\xe6\x88"."\226\345"."\x92\xa8\xe8".base64_decode('r6LmnI3liqHllQ==')."\x86\xe3\x80\x82\x3c\x62\x72\x2f\x3e"."\74\142\162\57\76" . "\163\145\163\163\151\157\156\56\163"."\x61\x76\x65"."\x5f\x70\x61\x74\x68\x3d" . $A–ùêå‚ìë . "\x3c\x62\x72\x2f\x3e" . _kstr2('session.sa').base64_decode('dmVfaGFuZGxlcj0=') . @ini_get("\163\145\163\163\151\157\156\56\163\141\166\145"."\x5f\x68\x61\x6e\x64\x6c\x65\x72") . "\x3c\x62\x72\x2f\x3e"); } } function access_token_check($fİÂ¡×Ş½Ì) { $a·×—ù•Ö = $GLOBALS[base64_decode('Y29uZmln')]["\x73\x65\x74\x74\x69\x6e\x67\x53\x79"."\163\164\145\155"]["\163\171\163\164\145\155\120\141\163\163\167"."\157\162\144"]; $a·×—ù•Ö = substr(md5("\x6b\x6f\x64\x45\x78\x70\x6c\x6f\x72\x65\x72\x5f" . $a·×—ù•Ö), 0, 15); $A½¦µ£òñ = Mcrypt::decode($fİÂ¡×Ş½Ì, $a·×—ù•Ö); if (!$A½¦µ£òñ) { show_tips("\141\143\143\145\163\163\124\157\153\145\156\40".base64_decode('ZXJyb3Ih')); } session_id($A½¦µ£òñ); session_name(SESSION_ID); } function access_token_get() { $A½¦µ£òñ = session_id(); $a·×—ù•Ö = $GLOBALS[strrev('gifnoc')][strrev('Sgnittes').strrev('y').strrev('s')."\x74\x65\x6d"][strrev('aPmetsys')."\163"."\x73\x77\x6f\x72\x64"]; $a·×—ù•Ö = substr(md5(base64_decode('a29kRXhwbG9yZXJf') . $a·×—ù•Ö), 0, 15); $f”İ©¹¹É = Mcrypt::encode($A½¦µ£òñ, $a·×—ù•Ö, 3600 * 24); return $f”İ©¹¹É; } function init_config() { init_setting(); init_session(); init_space_size_hook(); }
