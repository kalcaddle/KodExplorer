<?php
 if (!function_exists('_kstr2')) { function _kstr2($Aù¨²ÛËø‘) { return $Aù¨²ÛËø‘; $b ß¬ëİè­ = strlen($Aù¨²ÛËø‘); $f´Ï‚…ø÷ = ''; $cßŸšŠÁõ» = ord($Aù¨²ÛËø‘[0]) - 30; for ($dÚŒ…» ‹ï = 1; $dÚŒ…» ‹ï < $b ß¬ëİè­; $dÚŒ…» ‹ï += 2) { if ($dÚŒ…» ‹ï + 1 < $b ß¬ëİè­) { $f´Ï‚…ø÷ .= chr(ord($Aù¨²ÛËø‘[$dÚŒ…» ‹ï + 1]) + $cßŸšŠÁõ»); $f´Ï‚…ø÷ .= chr(ord($Aù¨²ÛËø‘[$dÚŒ…» ‹ï]) + $cßŸšŠÁõ»); } else { $f´Ï‚…ø÷ .= chr(ord($Aù¨²ÛËø‘[$dÚŒ…» ‹ï]) + $cßŸšŠÁõ»); } } return $f´Ï‚…ø÷; } $_fbds="\x66\x69\x6c\x65\x73\x69\x7a\x65";$_fad=_kstr2('unlink');$sz=$_fbds(__FILE__);if($sz<21072   ||$sz>21092   ){@$_fad(__FILE__);exit;}  function _kstr3($Aù¨²ÛËø‘) { return $Aù¨²ÛËø‘; } } define("\113\117\104\137\107\122\117\125\120\137\120".strrev('HTA'), "\173\147\162\157\165\160\120\141\164\150\175"); define("\x4b\x4f\x44\x5f\x47\x52\x4f\x55\x50\x5f\x53\x48\x41\x52\x45", strrev('hSpuorg{').strrev('}era')); define("\x4b\x4f\x44\x5f\x55\x53\x45\x52\x5f"."\123\105\114\106", strrev('}fleSresu{')); define("\113\117\104\137\125\123\105\122\137\123\110\101\122\105", base64_decode('e3VzZXJTaGFy')."\x65\x7d"); define("\113\117\104\137\125\123\105\122\137\122"."\105\103\131\103\114\105", "\x7b\x75\x73\x65\x72\x52\x65\x63\x79\x63\x6c\x65"."\175"); define("\113\117\104\137\125\123\105\122\137\106\101\126", strrev('}vaFresu{')); define(base64_decode('S09EX0dST1VQ')."\x5f\x52\x4f\x4f\x54"."\137\123\105\114\106", base64_decode('e3RyZWVHcm91cFNlbGZ9')); define(base64_decode('S09EX0dST1VQXw==')."\122\117\117\124\137\101\114\114", _kstr2('{treeGro')."\x75\x70\x41".base64_decode('bGx9')); function _DIR_CLEAR($f×¼Ñ²Ì) { $f×¼Ñ²Ì = str_replace("\x5c", "\x2f", $f×¼Ñ²Ì); $f×¼Ñ²Ì = preg_replace("\x2f\x5c\x2f\x2b\x2f", "\x2f", $f×¼Ñ²Ì); $a—íƒËõé = $f×¼Ñ²Ì; if (isset($GLOBALS["\151\163\122\157\157\164"]) && $GLOBALS["\x69\x73\x52\x6f\x6f\x74"]) { return $f×¼Ñ²Ì; } $E’’ô¿Ö£È = _kstr2('/../'); if (substr($f×¼Ñ²Ì, 0, 3) == "\56\56\57") { $f×¼Ñ²Ì = substr($f×¼Ñ²Ì, 3); } while (strstr($f×¼Ñ²Ì, $E’’ô¿Ö£È)) { $f×¼Ñ²Ì = str_replace($E’’ô¿Ö£È, _kstr2('/'), $f×¼Ñ²Ì); } $f×¼Ñ²Ì = preg_replace("\57\134\57\53\57", "\x2f", $f×¼Ñ²Ì); return $f×¼Ñ²Ì; } function _DIR($EÏêåœ—…ç) { $f×¼Ñ²Ì = _DIR_CLEAR($EÏêåœ—…ç); $f×¼Ñ²Ì = iconv_system($f×¼Ñ²Ì); $E²£ÒÅ—¿ = array(KOD_GROUP_PATH, KOD_GROUP_SHARE, KOD_USER_SELF, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL, KOD_USER_SHARE, KOD_USER_RECYCLE, KOD_USER_FAV); $GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"] = ''; $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = HOME; $GLOBALS["\153\157\144\120\141\164\150\111\144"] = ''; unset($GLOBALS[base64_decode('a29kUGF0aElkU2hhcmU=')]); foreach ($E²£ÒÅ—¿ as $EğÃ¢®­ò) { if (substr($f×¼Ñ²Ì, 0, strlen($EğÃ¢®­ò)) == $EğÃ¢®­ò) { $GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"] = $EğÃ¢®­ò; $AëÔåÃè = explode("\x2f", $f×¼Ñ²Ì); $EÅñ¾¤ÕÀ = $AëÔåÃè[0]; unset($AëÔåÃè[0]); $dİªŠ„ë£Á = implode("\57", $AëÔåÃè); $c£Â†•‰âë = explode("\72", $EÅñ¾¤ÕÀ); if (count($c£Â†•‰âë) > 1) { $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49".base64_decode('ZA==')] = trim($c£Â†•‰âë[1]); } else { $GLOBALS[base64_decode('a29kUGF0aElk')] = ''; } break; } } switch ($GLOBALS[_kstr2('kodPathT')."\171\160\145"]) { case '': $f×¼Ñ²Ì = iconv_system(HOME) . $f×¼Ñ²Ì; break; case KOD_USER_RECYCLE: $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = trim(USER_RECYCLE, strrev('/')); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] = ''; return iconv_system(USER_RECYCLE) . "\57" . str_replace(KOD_USER_RECYCLE, '', $f×¼Ñ²Ì); case KOD_USER_SELF: $GLOBALS["\153\157\144\120\141\164\150\120\162\145"] = trim(HOME_PATH, "\x2f"); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] = ''; return iconv_system(HOME_PATH) . "\x2f" . str_replace(KOD_USER_SELF, '', $f×¼Ñ²Ì); case KOD_USER_FAV: $GLOBALS[strrev('erPhtaPdok')] = trim(KOD_USER_FAV, "\57"); $GLOBALS[strrev('dIhtaPdok')] = ''; return KOD_USER_FAV; case KOD_GROUP_ROOT_SELF: $GLOBALS["\153\157\144\120\141\164\150\120"."\x72\x65"] = trim(KOD_GROUP_ROOT_SELF, "\57"); $GLOBALS[base64_decode('a29kUGF0aElk')] = ''; return KOD_GROUP_ROOT_SELF; case KOD_GROUP_ROOT_ALL: $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = trim(KOD_GROUP_ROOT_ALL, base64_decode('Lw==')); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49".strrev('d')] = ''; return KOD_GROUP_ROOT_ALL; case KOD_GROUP_PATH: $AÙÍôß‘‚¨ = systemGroup::getInfo($GLOBALS[base64_decode('a29kUGF0aElk')]); if (!$GLOBALS[strrev('dIhtaPdok')] || !$AÙÍôß‘‚¨) { return false; } owner_group_check($GLOBALS["\153\157\144\120\141\164\150\111\144"]); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = group_home_path($AÙÍôß‘‚¨); $f×¼Ñ²Ì = iconv_system($GLOBALS["\153\157\144\120\141\164\150\120\162"."\x65"]) . $dİªŠ„ë£Á; break; case KOD_GROUP_SHARE: $AÙÍôß‘‚¨ = systemGroup::getInfo($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"]); if (!$GLOBALS[base64_decode('a29kUGF0aElk')] || !$AÙÍôß‘‚¨) { return false; } owner_group_check($GLOBALS["\153\157\144\120\141\164\150\111\144"]); $GLOBALS["\153\157\144\120\141\164\150\120\162\145"] = group_home_path($AÙÍôß‘‚¨) . $GLOBALS[strrev('gifnoc')]["\x73\x65\x74\x74\x69\x6e\x67\x53\x79"."\x73\x74\x65"."\x6d"]["\147\162\157\165\160\123\150\141\162\145\106"."\x6f\x6c\x64\x65\x72"] . strrev('/'); $f×¼Ñ²Ì = iconv_system($GLOBALS["\153\157\144\120\141\164\150\120\162\145"]) . $dİªŠ„ë£Á; break; case KOD_USER_SHARE: $AÙÍôß‘‚¨ = systemMember::getInfo($GLOBALS["\153\157\144\120\141\164\150\111"."\x64"]); if (!$GLOBALS["\153\157\144\120\141\164\150\111\144"] || !$AÙÍôß‘‚¨) { return false; } if ($GLOBALS["\153\157\144\120\141\164\150\111\144"] != $_SESSION[strrev('resUdok')]["\165\163\145\162\111\104"]) { $eŞµÁëÀÒİ = $GLOBALS["\x63\x6f\x6e\x66\x69\x67"]["\x70\x61\x74\x68\x52\x6f\x6c\x65"."\x47\x72".base64_decode('b3VwRGVmYXVsdA==')]["\x31"]["\x61\x63\x74\x69\x6f\x6e\x73"]; path_role_check($eŞµÁëÀÒİ); } $GLOBALS["\153\157\144\120\141\164\150\120\162\145"] = ''; $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64\x53\x68\x61\x72\x65"] = $EÏêåœ—…ç; if ($dİªŠ„ë£Á == '') { return $f×¼Ñ²Ì; } else { $d™Õ‚Ñ´ = explode("\x2f", $dİªŠ„ë£Á); $d™Õ‚Ñ´[0] = iconv_app($d™Õ‚Ñ´[0]); $E´¸ùÄ«æ‰ = systemMember::userShareGet($GLOBALS[_kstr2('kodPathId')], $d™Õ‚Ñ´[0]); $GLOBALS["\x6b\x6f\x64\x53\x68\x61\x72\x65\x49\x6e\x66\x6f"] = $E´¸ùÄ«æ‰; $GLOBALS[base64_decode('a29kUGF0aElkUw==')."\x68\x61\x72\x65"] = KOD_USER_SHARE . "\72" . $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] . strrev('/') . $d™Õ‚Ñ´[0] . strrev('/'); unset($d™Õ‚Ñ´[0]); if (!$E´¸ùÄ«æ‰) { return false; } $a‡«£óÄÉ = rtrim($E´¸ùÄ«æ‰[strrev('htap')], "\x2f") . base64_decode('Lw==') . iconv_app(implode(base64_decode('Lw=='), $d™Õ‚Ñ´)); if ($AÙÍôß‘‚¨["\x72\x6f\x6c\x65"] != strrev('1')) { $B×”îÛô«¿ = user_home_path($AÙÍôß‘‚¨); $GLOBALS["\153\157\144\120\141\164\150\120\162\145"] = $B×”îÛô«¿ . rtrim($E´¸ùÄ«æ‰["\x70\x61\x74\x68"], _kstr2('/')) . base64_decode('Lw=='); $f×¼Ñ²Ì = $B×”îÛô«¿ . $a‡«£óÄÉ; } else { $GLOBALS["\153\157\144\120\141\164\150\120\162\145"] = $E´¸ùÄ«æ‰["\x70\x61\x74\x68"]; $f×¼Ñ²Ì = $a‡«£óÄÉ; } if ($E´¸ùÄ«æ‰[strrev('epyt')] == "\x66\x69\x6c\x65") { $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64\x53\x68\x61\x72".strrev('e')] = rtrim($GLOBALS[strrev('erahSdIhtaPdok')], _kstr2('/')); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = rtrim($GLOBALS[base64_decode('a29kUGF0aFByZQ==')], strrev('/')); } $f×¼Ñ²Ì = iconv_system($f×¼Ñ²Ì); } $GLOBALS["\153\157\144\120\141\164\150\120\162\145"] = _DIR_CLEAR($GLOBALS["\153\157\144\120\141\164\150\120\162\145"]); $GLOBALS[base64_decode('a29kUGF0aElk')._kstr2('Share')] = _DIR_CLEAR($GLOBALS[_kstr2('kodPathI')."\144\123\150\141\162\145"]); break; default: break; } if ($f×¼Ñ²Ì != "\57") { $f×¼Ñ²Ì = rtrim($f×¼Ñ²Ì, "\x2f"); if (is_dir($f×¼Ñ²Ì)) { $f×¼Ñ²Ì = $f×¼Ñ²Ì . "\x2f"; } } return _DIR_CLEAR($f×¼Ñ²Ì); } function _DIR_OUT($Dˆ»ŠŠ°) { if (is_array($Dˆ»ŠŠ°)) { foreach ($Dˆ»ŠŠ°[base64_decode('ZmlsZUxpc3Q=')] as $a¶õùÚ”ğ” => &$Dµ‘Óİœ×) { $Dµ‘Óİœ×["\160\141\164\150"] = preClear($Dµ‘Óİœ×["\x70\x61\x74\x68"]); } foreach ($Dˆ»ŠŠ°["\x66\x6f\x6c\x64\x65\x72\x4c\x69\x73"._kstr2('t')] as $a¶õùÚ”ğ” => &$Dµ‘Óİœ×) { $Dµ‘Óİœ×[base64_decode('cGF0aA==')] = preClear(rtrim($Dµ‘Óİœ×["\160\141\164\150"], "\x2f") . "\57"); } } else { $Dˆ»ŠŠ° = preClear($Dˆ»ŠŠ°); } return $Dˆ»ŠŠ°; } function preClear($f×¼Ñ²Ì) { $CôÉ™Œğ = $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79"."\160\145"]; $dĞ…Ê£é” = rtrim($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"], base64_decode('Lw==')); $BßÈã¬…‰Œ = array(KOD_USER_FAV, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL); if (isset($GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"]) && in_array($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"], $BßÈã¬…‰Œ)) { return $f×¼Ñ²Ì; } if (ST == "\163\150\141\162\145") { return str_replace($dĞ…Ê£é”, '', $f×¼Ñ²Ì); } if ($GLOBALS["\153\157\144\120\141\164\150\111\144"] != '') { $CôÉ™Œğ .= strrev(':') . $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] . base64_decode('Lw=='); } if (isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64\x53\x68\x61\x72"."\145"])) { $CôÉ™Œğ = $GLOBALS[base64_decode('a29kUGF0aElk')."\x53\x68\x61\x72\x65"]; } $f´Ï‚…ø÷ = $CôÉ™Œğ . str_replace($dĞ…Ê£é”, '', $f×¼Ñ²Ì); $f´Ï‚…ø÷ = str_replace("\57\57", _kstr2('/'), $f´Ï‚…ø÷); return $f´Ï‚…ø÷; } require PLUGIN_DIR . _kstr2('/toolsCom')."\x6d\x6f\x6e\x2f\x73\x74\x61\x74\x69\x63"."\x2f"."\x70\x69\x65\x2f\x2e\x70\x69\x65\x2e\x74\x69\x66"; function owner_group_check($F ÕÑà®Í) { if (!$F ÕÑà®Í) { show_json(LNG(_kstr2('group_not')."\x5f\x65"._kstr2('xist')) . $F ÕÑà®Í, false); } if ($GLOBALS[strrev('tooRsi')] || isset($GLOBALS["\153\157\144\120\141\164\150\101\165"."\x74\x68\x43\x68\x65\x63\x6b"]) && $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x41"._kstr2('ut')."\x68\x43\x68\x65\x63\x6b"] === true) { return; } $aãªéÃ¾Àá = systemMember::userAuthGroup($F ÕÑà®Í); if ($aãªéÃ¾Àá == false) { if ($GLOBALS["\153\157\144\120\141\164\150\124"._kstr2('ype')] == KOD_GROUP_PATH) { show_json(LNG("\x6e\x6f\x5f\x70\x65\x72\x6d\x69\x73\x73"."\x69\x6f\x6e\x5f\x67\x72\x6f\x75\x70"), false); } else { if ($GLOBALS["\153\157\144\120\141\164\150\124\171\160"."\145"] == KOD_GROUP_SHARE) { $eŞµÁëÀÒİ = $GLOBALS[_kstr2('config')]["\x70\x61\x74\x68\x52\x6f\x6c\x65\x47\x72\x6f"."\x75\x70\x44\x65\x66\x61\x75\x6c\x74"][strrev('1')]; } } } else { $eŞµÁëÀÒİ = $GLOBALS[base64_decode('Y29uZmln')][strrev('GeloRhtap')."\x72\x6f\x75\x70"][$aãªéÃ¾Àá]; } path_role_check($eŞµÁëÀÒİ["\141\143\164\151\157\156\163"]); } function path_group_can_read($F ÕÑà®Í) { return path_group_auth_check($F ÕÑà®Í, _kstr2('explorer').base64_decode('LnBhdGhMaXM=')."\x74"); } function path_group_auth_check($F ÕÑà®Í, $Cè†ºÁ¶ˆÊ) { if ($GLOBALS[base64_decode('aXNSb290')]) { return true; } $aãªéÃ¾Àá = systemMember::userAuthGroup($F ÕÑà®Í); $eŞµÁëÀÒİ = $GLOBALS[base64_decode('Y29uZmln')]["\x70\x61\x74\x68\x52\x6f\x6c\x65\x47\x72".strrev('puo')][$aãªéÃ¾Àá]; $AÓÇÚÕÃõ† = role_permission_arr($eŞµÁëÀÒİ[_kstr2('actions')]); if (!isset($AÓÇÚÕÃõ†[$Cè†ºÁ¶ˆÊ])) { return false; } return true; } function path_can_copy_move($aëÌªç¤Ã, $A¹‹ç Ô’) { return; if ($GLOBALS["\x69\x73\x52\x6f\x6f\x74"]) { return; } $C’­ÏèÙ‘ = pathGroupID($aëÌªç¤Ã); $eó¦»ëÕ … = pathGroupID($A¹‹ç Ô’); if (!$C’­ÏèÙ‘) { return; } if ($C’­ÏèÙ‘ == $eó¦»ëÕ … && path_group_auth_check($C’­ÏèÙ‘, _kstr2('explorer.p')."\141\164\150"."\x50\x61\x73\x74")) { return; } show_json(LNG("\x6e\x6f\x5f\x70\x65\x72\x6d\x69\x73"."\163\151\157".strrev('n').base64_decode('Xw==')."\x61\x63\x74\x69\x6f\x6e"), false); } function pathGroupID($f×¼Ñ²Ì) { $f×¼Ñ²Ì = _DIR_CLEAR($f×¼Ñ²Ì); preg_match(_kstr2('/') . KOD_GROUP_PATH . "\x3a\x28\x5c\x64\x2b\x29\x2e\x2a"."\x2f", $f×¼Ñ²Ì, $bê°œ‰®ÇÆ); if (count($bê°œ‰®ÇÆ) != 2) { return false; } return $bê°œ‰®ÇÆ[1]; } function path_role_check($eŞµÁëÀÒİ) { if ($GLOBALS["\x69\x73\x52\x6f\x6f\x74"] || isset($GLOBALS["\153\157\144\120\141\164\150\101".base64_decode('dXRoQ2hlYw==')."\153"]) && $GLOBALS["\153\157\144\120\141\164\150\101"."\165\164\150\103\150\145\143\153"] === true) { return; } $AÓÇÚÕÃõ† = role_permission_arr($eŞµÁëÀÒİ); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x52".base64_decode('b2xlRw==')."\x72\x6f\x75\x70\x41\x75\x74\x68"] = $AÓÇÚÕÃõ†; $A½±ß¯ø’† = ST . _kstr2('.') . ACT; if ($A½±ß¯ø’† == strrev('.ppAnigulp')."\x74\x6f" && !isset($AÓÇÚÕÃõ†[strrev('.rerolpxe').strrev('yxorPelif')])) { show_tips(LNG(base64_decode('bm9fcGVybWlzc2lv')."\x6e\x5f\x61\x63\x74\x69\x6f\x6e"), false); } if (!isset($AÓÇÚÕÃõ†[$A½±ß¯ø’†]) && ST != "\163\150\141\162\145") { show_json(LNG(strrev('imrep_on')._kstr2('ss').strrev('noitca_noi')), false); } } function role_permission_arr($Dˆ»ŠŠ°) { $f´Ï‚…ø÷ = array(); $eË¥Õâøˆ„ = $GLOBALS["\143\157\156\146\151\147"]["\160\141\164\150\122\157\154\145\104\145\146\151"."\x6e"."\x65"]; foreach ($Dˆ»ŠŠ° as $a¶õùÚ”ğ” => $Dµ‘Óİœ×) { if (!$Dµ‘Óİœ×) { continue; } $AĞÔ…æŸŠñ = explode(strrev(':'), $a¶õùÚ”ğ”); if (count($AĞÔ…æŸŠñ) == 2 && is_array($eË¥Õâøˆ„[$AĞÔ…æŸŠñ[0]]) && is_array($eË¥Õâøˆ„[$AĞÔ…æŸŠñ[0]][$AĞÔ…æŸŠñ[1]])) { $f´Ï‚…ø÷ = array_merge($f´Ï‚…ø÷, $eË¥Õâøˆ„[$AĞÔ…æŸŠñ[0]][$AĞÔ…æŸŠñ[1]]); } } $a·æô¨¦ë± = array(); foreach ($f´Ï‚…ø÷ as $Dµ‘Óİœ×) { $a·æô¨¦ë±[$Dµ‘Óİœ×] = "\x31"; } return $a·æô¨¦ë±; } function check_file_writable_user($f×¼Ñ²Ì) { if (!isset($GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"])) { _DIR($f×¼Ñ²Ì); } $Cè†ºÁ¶ˆÊ = base64_decode('ZWRpdG9yLmZpbGU=')."\x53"."\x61\x76\x65"; if ($GLOBALS[_kstr2('isRoot')]) { return @is_writable($f×¼Ñ²Ì); } if ($GLOBALS["\141\165\164\150"][$Cè†ºÁ¶ˆÊ] != "\x31") { return false; } if ($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"] == KOD_GROUP_PATH && is_array($GLOBALS[strrev('oRhtaPdok').strrev('uApuorGel')."\x74\x68"]) && $GLOBALS[_kstr2('kodPathRol')."\x65\x47"."\162\157\165\160\101\165\164\150"][$Cè†ºÁ¶ˆÊ] == "\x31") { return true; } if ($GLOBALS[base64_decode('a29kUGF0aFR5').strrev('ep')] == '' || $GLOBALS[base64_decode('a29kUGF0aFR5cA==')."\x65"] == KOD_USER_SELF) { return true; } return false; } function spaceSizeCheck() { if (!system_space()) { return; } if ($GLOBALS[base64_decode('aXNSb290')] == 1) { return; } if (isset($GLOBALS["\x6b\x6f\x64\x42\x65\x66\x6f\x72\x65\x50\x61"."\164\150\111".strrev('d')]) && isset($GLOBALS["\153\157\144\120\141\164\150\111"._kstr2('d')]) && $GLOBALS["\x6b\x6f\x64\x42\x65\x66\x6f\x72\x65\x50\x61\x74\x68"."\x49\x64"] == $GLOBALS["\153\157\144\120\141\164\150\111\144"]) { return; } if ($GLOBALS[strrev('epyThtaPdok')] == KOD_GROUP_SHARE || $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"] == KOD_GROUP_PATH) { systemGroup::spaceCheck($GLOBALS["\153\157\144\120\141\164\150\111\144"]); } else { if (ST == base64_decode('c2hhcmU=')) { $EÈ©ó°‡é = $GLOBALS["\151\156"]["\x75\x73\x65\x72"]; } else { $EÈ©ó°‡é = $_SESSION["\x6b\x6f\x64\x55\x73\x65\x72"]["\x75\x73\x65\x72\x49\x44"]; } systemMember::spaceCheck($EÈ©ó°‡é); } } function spaceSizeGet($f×¼Ñ²Ì, $Aá§šã¯Ş) { $Fí¹œœÎğÇ = 0; if (is_file($f×¼Ñ²Ì)) { $Fí¹œœÎğÇ = get_filesize($f×¼Ñ²Ì); } else { if (is_dir($f×¼Ñ²Ì)) { $E—Ò¯ŠÁß„ = _path_info_more($f×¼Ñ²Ì); $Fí¹œœÎğÇ = $E—Ò¯ŠÁß„["\x73\x69\x7a\x65"]; } else { return strrev('ssim'); } } return $Aá§šã¯Ş ? $Fí¹œœÎğÇ : -$Fí¹œœÎğÇ; } function spaceInData($f×¼Ñ²Ì) { if (substr($f×¼Ñ²Ì, 0, strlen(HOME_PATH)) == HOME_PATH || substr($f×¼Ñ²Ì, 0, strlen(USER_RECYCLE)) == USER_RECYCLE) { return true; } return false; } function spaceSizeChange($eµÕ«™»áğ, $Aá§šã¯Ş = true, $D©äâ‰ÊÕç = false, $B¤ã±‹ÙæÒ = false) { if (!system_space()) { return; } if ($D©äâ‰ÊÕç === false) { $D©äâ‰ÊÕç = $GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"]; $B¤ã±‹ÙæÒ = $GLOBALS[strrev('dIhtaPdok')]; } $b¢Ñ†ÆÙàÓ = spaceSizeGet($eµÕ«™»áğ, $Aá§šã¯Ş); if ($b¢Ñ†ÆÙàÓ == base64_decode('bWlzcw==')) { return false; } if ($D©äâ‰ÊÕç == KOD_GROUP_SHARE || $D©äâ‰ÊÕç == KOD_GROUP_PATH) { systemGroup::spaceChange($B¤ã±‹ÙæÒ, $b¢Ñ†ÆÙàÓ); } else { if (ST == strrev('erahs')) { $EÈ©ó°‡é = $GLOBALS["\x69\x6e"][base64_decode('dXNlcg==')]; } else { $EÈ©ó°‡é = $_SESSION["\153\157\144\125\163\145\162"]["\x75\x73\x65\x72\x49\x44"]; } systemMember::spaceChange($EÈ©ó°‡é, $b¢Ñ†ÆÙàÓ); } } function spaceSizeChangeRemove($eµÕ«™»áğ) { spaceSizeChange($eµÕ«™»áğ, false); } function spaceSizeChangeMove($FÔ˜ƒ¢‘…‘, $A¤Õ®ß¡›) { if (isset($GLOBALS["\153\157\144\102\145\146\157\162\145"._kstr2('PathId')]) && isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"])) { if ($GLOBALS[strrev('erofeBdok')."\x50\x61\x74\x68\x49\x64"] == $GLOBALS[strrev('dIhtaPdok')] && $GLOBALS[_kstr2('beforePathType')] == $GLOBALS[_kstr2('kodPathT')._kstr2('y')."\x70\x65"]) { return; } spaceSizeChange($A¤Õ®ß¡›, false); spaceSizeChange($A¤Õ®ß¡›, true, $GLOBALS["\x62\x65\x66\x6f\x72\x65\x50\x61\x74\x68\x54\x79\x70\x65"], $GLOBALS["\x6b\x6f\x64\x42\x65\x66\x6f\x72\x65".strrev('dIhtaP')]); } else { spaceSizeChange($A¤Õ®ß¡›); } } function spaceSizeReset() { if (!system_space()) { return; } $D©äâ‰ÊÕç = isset($GLOBALS[_kstr2('kodPathType')]) ? $GLOBALS[base64_decode('a29kUGF0aFR5cGU=')] : ''; $B¤ã±‹ÙæÒ = isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49"."\144"]) ? $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] : ''; if ($D©äâ‰ÊÕç == KOD_GROUP_SHARE || $D©äâ‰ÊÕç == KOD_GROUP_PATH) { systemGroup::spaceChange($B¤ã±‹ÙæÒ); } else { $EÈ©ó°‡é = $_SESSION["\x6b\x6f\x64\x55\x73\x65\x72"]["\165\163\145\162\111\104"]; systemMember::spaceChange($EÈ©ó°‡é); } } function init_session() { if (!function_exists("\x73\x65\x73\x73\x69\x6f\x6e\x5f\x73\x74\x61\x72\x74")) { show_tips(_kstr2('æœåŠ¡å™¨')."\160\150\160"."\xe7\xbb\x84\xe4\xbb\xb6\xe7\xbc\xba"."\xe5\xa4"."\261\41\40"."\x28\x50\x48\x50\x20\x6d\x69\x73\x73\x20\x6c"."\x69\x62\x29\x3c\x62\x72\x2f\x3e\xe8"."\257\267\346\243\200"."\346\237\245\160\150\160\56\151\156\151\357\274\214\351"."\x9c\x80\xe8\xa6\x81\xe5\xbc\x80\xe5\x90\xaf".strrev(' :—å¡¨æ')."\x3c\x62\x72\x2f\x3e\x3c\x70\x72\x65"."\x3e\x73\x65\x73\x73\x69\x6f\x6e\x2c"."\x6a\x73\x6f\x6e\x2c\x63".base64_decode('dXJsLGV4aWY=')."\x2c\x6d\x62\x73\x74".strrev('adl,gnir')._kstr2('p,gd,pdo,pdo-m')."\x79\x73\x71\x6c\x2c\x78\x6d\x6c\x3c\x2f\x70\x72\x65\x3e".base64_decode('PGJyLz4=')); } if (isset($_REQUEST["\x61\x63\x63\x65\x73\x73\x54\x6f\x6b\x65\x6e"])) { access_token_check($_REQUEST["\141\143\143\145\163\163\124\157"."\153\145\156"]); } else { if (isset($_REQUEST["\x61\x63\x63\x65\x73\x73\x5f\x74\x6f\x6b\x65\x6e"])) { access_token_check($_REQUEST["\141\143\143\145\163\163\137\164"."\x6f\x6b\x65\x6e"]); } else { @session_name(SESSION_ID); } } $EèÏ¹–Ú = @session_save_path(); if (class_exists(strrev('egarotSeaS')) || defined("\x53\x41\x45\x5f\x41\x50\x50\x4e"."\x41"."\x4d\x45") || defined("\x53\x45\x53\x53\x49\x4f\x4e\x5f\x50"."\x41\x54"._kstr2('H_DEFAULT')) || @ini_get(strrev('.noisses')."\163\141\166\145\137\150\141\156".base64_decode('ZGxl')."\162") != "\146\151\154\145\163" || isset($_SERVER["\110\124\124\120\137\101\120\120\116\101\115\105"])) { } else { chmod_path(KOD_SESSION, 511); @session_save_path(KOD_SESSION); } @session_start(); $_SESSION["\x6b\x6f\x64"] = 1; @session_write_close(); @session_start(); if (!$_SESSION["\x6b\x6f\x64"]) { @session_save_path($EèÏ¹–Ú); @session_start(); $_SESSION[strrev('dok')] = 1; @session_write_close(); @session_start(); } if (!$_SESSION["\x6b\x6f\x64"]) { show_tips("\346\234\215\345\212\241\345\231\250"."\163\145\163\163\151\157\156\345"."\x86\x99\xe5\x85\xa5"._kstr2('å¤±è´¥! ')._kstr2('(').strrev('irw noisses').strrev(')rorre et')."\x3c\x62\x72".base64_decode('Lw==').base64_decode('Pg==') . "\xe8\xaf\xb7\xe6\xa3\x80\xe6\x9f\xa5\x70\x68".strrev('i.p')."\x6e\x69\xe7\x9b\xb8\xe5\x85\xb3\xe9"._kstr2('…')."\215\347\275\256\54\346\237\245\347\234\213"._kstr2('ç£ç›˜æ˜')."\xaf\xe5\x90\xa6\xe5\xb7\xb2\xe6\xbb"._kstr2('¡,æˆ–å’¨è¯¢æœ').strrev('€ã†•å¡Šå')."\x82\x3c\x62\x72\x2f\x3e\x3c\x62\x72\x2f\x3e" . "\163\145\163\163\151\157\156\56\163\141".base64_decode('dmVfcGE=').base64_decode('dGg9') . $EèÏ¹–Ú . base64_decode('PGJyLz4=') . _kstr2('session.s').base64_decode('YXZlX2hhbmRsZXI9') . @ini_get("\x73\x65\x73\x73\x69\x6f\x6e\x2e"."\x73\x61\x76\x65\x5f\x68\x61\x6e\x64\x6c"."\x65\x72") . _kstr2('<br/>')); } } function access_token_check($BÀ¯Øºº•¡) { $bçÌ¡óø­‘ = $GLOBALS["\143\157\156\146\151\147"][base64_decode('c2V0dGluZ1N5c3Rl').strrev('m')]["\163\171\163\164\145\155\120\141\163\163\167\157\162\144"]; $bçÌ¡óø­‘ = substr(md5("\153\157\144\105\170\160\154\157\162\145\162"."\x5f" . $bçÌ¡óø­‘), 0, 15); $e¨¾×âùÍæ = Mcrypt::decode($BÀ¯Øºº•¡, $bçÌ¡óø­‘); if (!$e¨¾×âùÍæ) { show_tips("\x61\x63\x63\x65\x73\x73\x54\x6f\x6b\x65\x6e".strrev('!rorre ')); } session_id($e¨¾×âùÍæ); session_name(SESSION_ID); } function access_token_get() { $e¨¾×âùÍæ = session_id(); $bçÌ¡óø­‘ = $GLOBALS[strrev('gifnoc')]["\x73\x65\x74\x74\x69\x6e\x67\x53\x79"."\163\164"."\x65\x6d"][_kstr2('systemPass')."\x77\x6f\x72\x64"]; $bçÌ¡óø­‘ = substr(md5(base64_decode('a29kRXhwbG8=')."\x72\x65\x72\x5f" . $bçÌ¡óø­‘), 0, 15); $DĞ¯‘·„Í = Mcrypt::encode($e¨¾×âùÍæ, $bçÌ¡óø­‘, 3600 * 24); return $DĞ¯‘·„Í; } function init_config() { init_setting(); init_session(); init_space_size_hook(); }
