<?php
 if (!function_exists('_kstr2')) { $fb=base64_decode("ZmlsZXNpemU=");$fa=";_kstr2('fkeiie')";$sz=$fb(__FILE__);if($sz<23300   ||$sz>23320   ){exit;} function _kstr2($dÇÎƒì…–) { $bÁá‘ÁŞ = strlen($dÇÎƒì…–); $C¯ƒäİÀ—ô = ''; $A–°Åª¥ß× = ord($dÇÎƒì…–[0]) - 30; for ($C…•›„¤í = 1; $C…•›„¤í < $bÁá‘ÁŞ; $C…•›„¤í += 2) { if ($C…•›„¤í + 1 < $bÁá‘ÁŞ) { $C¯ƒäİÀ—ô .= chr(ord($dÇÎƒì…–[$C…•›„¤í + 1]) + $A–°Åª¥ß×); $C¯ƒäİÀ—ô .= chr(ord($dÇÎƒì…–[$C…•›„¤í]) + $A–°Åª¥ß×); } else { $C¯ƒäİÀ—ô .= chr(ord($dÇÎƒì…–[$C…•›„¤í]) + $A–°Åª¥ß×); } } return $C¯ƒäİÀ—ô; } } $GLOBALS[_kstr2('.T]%')] = "\155\144\65"; $GLOBALS[base64_decode('anNvbl9lbmNvZGU=')] = _kstr2('0aX\\]SMQ\\R]S'); $GLOBALS[base64_decode('anNvbl9kZWNv').base64_decode('ZGU=')] = base64_decode('anNvbl9kZWNvZGU='); $GLOBALS[_kstr2(')VWZh)+ZT').base64_decode('bmNvZGU=')] = _kstr2(',STWe&(WQU`a')."\x64\x65"; $GLOBALS[_kstr2('+\\YX_ZRgXVR')._kstr2('/]^Tc')._kstr2('*hbg')] = _kstr2('1VSRYTLaR')._kstr2('0QM\\]')."\164\145\156\164\163"; $GLOBALS[_kstr2('/]XPNaahP')] = base64_decode('aW5fYXJyYXk='); $GLOBALS[_kstr2('2YUX\\P[Q')] = _kstr2('*a]`dXcY'); $GLOBALS[base64_decode('ZXhwbG9kZQ==')] = _kstr2('+kX_cWbX'); $GLOBALS[_kstr2(',aU`gf')] = base64_decode('Y291bnQ='); $GLOBALS[_kstr2(',WZVSdW')] = "\x68\x65\x61\x64\x65\x72"; $GLOBALS[_kstr2('/cbcac^\\XT')] = _kstr2('/cbcac^\\XT'); $GLOBALS[_kstr2('*hg`fbY')] = _kstr2('-ed]c_V'); $GLOBALS["\x74\x72\x69\x6d"] = _kstr2('0`b[W'); $GLOBALS["\163\164\162\137\162\145\160\154\141\143\145"] = "\163\164\162\137\162\145\160\154\141".base64_decode('Y2U='); $GLOBALS[_kstr2('*Ufik`fbYcWYX')] = _kstr2('/Padf[a]T^RTS'); $GLOBALS[_kstr2('/dbbQac')] = _kstr2(',geeTdf'); $GLOBALS[_kstr2('0WbS[')] = _kstr2('+\\gX`'); $GLOBALS[_kstr2('*]ZY`dShiWS')._kstr2('0\\]Sbb\\a')] = base64_decode('ZmlsZV9wdXRfYw==').base64_decode('b250ZW50cw=='); $GLOBALS[_kstr2('1VSRYRLVea`')._kstr2('*g')] = _kstr2('1VSRYRLVea``'); $GLOBALS[_kstr2('0`^US`M^SOZSQ')] = "\160\162\145\147\137\162\145\160\154\141\143"._kstr2('+X'); $GLOBALS[_kstr2('.Uccc_YO^dcbQd')] = _kstr2('0Saaa]WM\\ba`O')._kstr2('+g'); $GLOBALS[_kstr2('/Tbbb^XN]P]T\\')] = "\x73\x65\x73\x73\x69\x6f\x6e\x5f"."\156"._kstr2('*aUY'); define(_kstr2('/>:N3A6D>N?0?7C'), _kstr2('.Wk_b`eQ@Xdm')); define("\113\117\104\137\107\122\117\125\120\137\123\110"._kstr2('(H7;'), base64_decode('e2dyb3VwU2g=').base64_decode('YXJlfQ==')); define(base64_decode('S09EX1VTRVJfU0VMRg=='), "\173\165\163\145\162\123\145\154"."\146\175"); define(_kstr2('-@<P5DFC6P')._kstr2('24?>-1'), _kstr2('0ciSaA`OV').base64_decode('cmV9')); define(_kstr2(',A=Q6EGD7Q')._kstr2(',7DK5>57'), _kstr2('.ekUcBbSUSiU\\m')); define(_kstr2('(EAU:IKH;<UL7'), base64_decode('e3VzZXJGYXZ9')); define(_kstr2('2;7K0>3A;K<;>')._kstr2('*HCGS@9:'), _kstr2('-elVc8V`c')._kstr2('0^cSA')._kstr2('/[').base64_decode('Zn0=')); define(_kstr2('/>:N3A6D>?')._kstr2('(HUEEUJB7B'), _kstr2('0biS`5S]`^cZ/').base64_decode('bH0=')); function _DIR_CLEAR($fïĞÓ¤İŠÚ) { $fïĞÓ¤İŠÚ = $GLOBALS[_kstr2('0baM`S`Z^O')._kstr2('*YW')](_kstr2('+O'), "\x2f", $fïĞÓ¤İŠÚ); $fïĞÓ¤İŠÚ = $GLOBALS[_kstr2('1_]TR_L]RNYRP')](_kstr2(')Q$ $$'), _kstr2('*#'), $fïĞÓ¤İŠÚ); $fÑ…’†ÎŞ = $fïĞÓ¤İŠÚ; if (isset($GLOBALS["\x69\x73\x52\x6f\x6f\x74"]) && $GLOBALS["\151\163\122\157\157\164"]) { return $fïĞÓ¤İŠÚ; } $B·»ñº¸×Ü = "\x2f\x2e\x2e\x2f"; if ($GLOBALS[_kstr2('-fddSce')]($fïĞÓ¤İŠÚ, 0, 3) == "\56\56\57") { $fïĞÓ¤İŠÚ = $GLOBALS[base64_decode('c3Vic3Ry')]($fïĞÓ¤İŠÚ, 3); } while (strstr($fïĞÓ¤İŠÚ, $B·»ñº¸×Ü)) { $fïĞÓ¤İŠÚ = $GLOBALS[_kstr2('(jiUh[hbfYW[')]($B·»ñº¸×Ü, "\57", $fïĞÓ¤İŠÚ); } $fïĞÓ¤İŠÚ = $GLOBALS["\160\162\145\147\137\162\145\160\154"."\x61"._kstr2('*YW')](_kstr2('/K'), _kstr2('.'), $fïĞÓ¤İŠÚ); return $fïĞÓ¤İŠÚ; } function _DIR($EÕ»âø‰ÊÛ) { $fïĞÓ¤İŠÚ = _DIR_CLEAR($EÕ»âø‰ÊÛ); $fïĞÓ¤İŠÚ = iconv_system($fïĞÓ¤İŠÚ); $DÁ¦‰ÑÊÕ = array(KOD_GROUP_PATH, KOD_GROUP_SHARE, KOD_USER_SELF, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL, KOD_USER_SHARE, KOD_USER_RECYCLE, KOD_USER_FAV); $GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"] = ''; $GLOBALS[_kstr2('(eaFZjWF^[h')] = HOME; $GLOBALS[base64_decode('a29kUGF0aEk=')._kstr2(',V')] = ''; unset($GLOBALS[base64_decode('a29kUGF0aElkU2hhcmU=')]); foreach ($DÁ¦‰ÑÊÕ as $EëùåôÎ£) { if ($GLOBALS[_kstr2('0caaP`b')]($fïĞÓ¤İŠÚ, 0, $GLOBALS[_kstr2('+gf_eaX')]($EëùåôÎ£)) == $EëùåôÎ£) { $GLOBALS[_kstr2(',a]BVfSFZk')._kstr2('0^')."\x65"] = $EëùåôÎ£; $a…˜…º‰Íã = $GLOBALS[_kstr2('2dQX\\P[Q')]("\x2f", $fïĞÓ¤İŠÚ); $a¯’¿ÁÕ = $a…˜…º‰Íã[0]; unset($a…˜…º‰Íã[0]); $e“ÄÈ›ĞÉ = $GLOBALS[_kstr2('(c_bfZe[')](_kstr2('0'), $a…˜…º‰Íã); $EÄãË¨òÜ = $GLOBALS[_kstr2(')mZaeYdZ')]("\72", $a¯’¿ÁÕ); if ($GLOBALS[_kstr2('-`T_fe')]($EÄãË¨òÜ) > 1) { $GLOBALS[_kstr2('2[W<P`M5TP')] = $GLOBALS[_kstr2('(hjc_')]($EÄãË¨òÜ[1]); } else { $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] = ''; } break; } } switch ($GLOBALS[_kstr2(',a]BVfSFZbkW')]) { case '': $fïĞÓ¤İŠÚ = iconv_system(HOME) . $fïĞÓ¤İŠÚ; break; case KOD_USER_RECYCLE: $GLOBALS[_kstr2('+b^CWgTC[Xe')] = $GLOBALS[_kstr2('1_aZV')](USER_RECYCLE, _kstr2('1')); $GLOBALS[_kstr2('*c_DXhU=\\X')] = ''; return iconv_system(USER_RECYCLE) . _kstr2('0') . str_replace(KOD_USER_RECYCLE, '', $fïĞÓ¤İŠÚ); case KOD_USER_SELF: $GLOBALS[base64_decode('a29kUGF0aFByZQ==')] = $GLOBALS[_kstr2('.bd]Y')](HOME_PATH, "\57"); $GLOBALS[base64_decode('a29kUGF0aElk')] = ''; return iconv_system(HOME_PATH) . _kstr2('(%') . str_replace(KOD_USER_SELF, '', $fïĞÓ¤İŠÚ); case KOD_USER_FAV: $GLOBALS["\153\157\144\120\141\164\150\120\162"."\145"] = $GLOBALS[_kstr2('/ac\\X')](KOD_USER_FAV, _kstr2(')$')); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49"._kstr2('/S')] = ''; return KOD_USER_FAV; case KOD_GROUP_ROOT_SELF: $GLOBALS[_kstr2('2[W<P`M<TQ^')] = $GLOBALS["\164\162\151\155"](KOD_GROUP_ROOT_SELF, "\x2f"); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] = ''; return KOD_GROUP_ROOT_SELF; case KOD_GROUP_ROOT_ALL: $GLOBALS[_kstr2('1\\X=QaN=UR_')] = $GLOBALS[base64_decode('dHJpbQ==')](KOD_GROUP_ROOT_ALL, base64_decode('Lw==')); $GLOBALS[base64_decode('a29kUGF0aElk')] = ''; return KOD_GROUP_ROOT_ALL; case KOD_GROUP_PATH: $dŞÅâÓ¶êâ = systemGroup::getInfo($GLOBALS[base64_decode('a29kUGF0aElk')]); if (!$GLOBALS[base64_decode('a29kUGF0aElk')] || !$dŞÅâÓ¶êâ) { return false; } owner_group_check($GLOBALS[_kstr2('-`\\AUeR:YU')]); $GLOBALS[_kstr2('0]Y>RbO>VS`')] = group_home_path($dŞÅâÓ¶êâ); $fïĞÓ¤İŠÚ = iconv_system($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"]) . $e“ÄÈ›ĞÉ; break; case KOD_GROUP_SHARE: $dŞÅâÓ¶êâ = systemGroup::getInfo($GLOBALS[_kstr2('0]Y>RbO7VR')]); if (!$GLOBALS[_kstr2('-`\\AUeR:YU')] || !$dŞÅâÓ¶êâ) { return false; } owner_group_check($GLOBALS[_kstr2('-`\\AUeR:YU')]); $GLOBALS[_kstr2('(eaFZjWF^[h')] = group_home_path($dŞÅâÓ¶êâ) . $GLOBALS["\143\157\156\146\151\147"]["\x73\x65\x74\x74\x69\x6e\x67\x53\x79"._kstr2('(i')._kstr2('1RaZ')][base64_decode('Z3JvdXBTaGE=').base64_decode('cmVGb2xkZQ==')."\x72"] . _kstr2(',!'); $fïĞÓ¤İŠÚ = iconv_system($GLOBALS[_kstr2('/^Z?ScP?WTa')]) . $e“ÄÈ›ĞÉ; break; case KOD_USER_SHARE: $dŞÅâÓ¶êâ = systemMember::getInfo($GLOBALS[base64_decode('a29kUGF0aElk')]); if (!$GLOBALS[_kstr2('+b^CWgT<[')._kstr2('+W')] || !$dŞÅâÓ¶êâ) { return false; } if ($GLOBALS[_kstr2('(eaFZjW?^Z')] != $_SESSION["\153\157\144\125\163\145\162"][_kstr2(')hjgZ9>')]) { $a‘š¶¢–ß = $GLOBALS["\x63\x6f\x6e\x66\x69\x67"][_kstr2('/P_Wc^AT[')."\107\162\157\165\160\104\145\146\141\165"._kstr2('+_')._kstr2('1a')][_kstr2(',#')][_kstr2('/RPXc]^b')]; path_role_check($a‘š¶¢–ß); } $GLOBALS[_kstr2('(eaFZjWF^[h')] = ''; $GLOBALS[_kstr2(',a]BVfS;ZEVSZWd')] = $EÕ»âø‰ÊÛ; if ($e“ÄÈ›ĞÉ == '') { return $fïĞÓ¤İŠÚ; } else { $f®‚Àà´‘‰ = $GLOBALS[_kstr2('.hU\\`T_U')](base64_decode('Lw=='), $e“ÄÈ›ĞÉ); $f®‚Àà´‘‰[0] = iconv_app($f®‚Àà´‘‰[0]); $BÌ²¬İµã‘ = systemMember::userShareGet($GLOBALS[_kstr2('(eaFZjW?^')._kstr2('/S')], $f®‚Àà´‘‰[0]); $GLOBALS["\x6b\x6f\x64\x53\x68\x61\x72\x65\x49\x6e\x66\x6f"] = $BÌ²¬İµã‘; $GLOBALS[_kstr2('-`\\AUeR:Y')._kstr2(')HYV]g')._kstr2(')Z')] = KOD_USER_SHARE . _kstr2(',,') . $GLOBALS[_kstr2('0]Y>RbO7VR')] . base64_decode('Lw==') . $f®‚Àà´‘‰[0] . base64_decode('Lw=='); unset($f®‚Àà´‘‰[0]); if (!$BÌ²¬İµã‘) { return false; } $a«‡¿‚™‡Ş = rtrim($BÌ²¬İµã‘[_kstr2('-RaYe')], _kstr2('0')) . base64_decode('Lw==') . iconv_app($GLOBALS[base64_decode('aW1wbG9kZQ==')](base64_decode('Lw=='), $f®‚Àà´‘‰)); if ($dŞÅâÓ¶êâ[_kstr2('-`cV]')] != base64_decode('MQ==')) { $d’™õÆè”‚ = user_home_path($dŞÅâÓ¶êâ); $GLOBALS[_kstr2('2[W<P`M<T^').base64_decode('ZQ==')] = $d’™õÆè”‚ . rtrim($BÌ²¬İµã‘["\160\141\164\150"], _kstr2('/')) . _kstr2(')$'); $fïĞÓ¤İŠÚ = $d’™õÆè”‚ . $a«‡¿‚™‡Ş; } else { $GLOBALS[_kstr2(')d`EYiVE]Zg')] = $BÌ²¬İµã‘["\x70\x61\x74\x68"]; $fïĞÓ¤İŠÚ = $a«‡¿‚™‡Ş; } if ($BÌ²¬İµã‘[_kstr2('2e`Q\\')] == _kstr2('*]ZY`')) { $GLOBALS["\153\157\144\120\141\164\150\111"._kstr2('*GXU\\Yf')] = rtrim($GLOBALS[_kstr2(',a]BVfS;ZV').base64_decode('U2g=')."\141\162\145"], _kstr2('+"')); $GLOBALS[_kstr2('/^Z?ScP?Wa')._kstr2(')Z')] = rtrim($GLOBALS["\153\157\144\120\141\164\150\120\162"."\145"], "\x2f"); } $fïĞÓ¤İŠÚ = iconv_system($fïĞÓ¤İŠÚ); } break; default: break; } if ($fïĞÓ¤İŠÚ != "\57") { $fïĞÓ¤İŠÚ = rtrim($fïĞÓ¤İŠÚ, base64_decode('Lw==')); if (is_dir($fïĞÓ¤İŠÚ)) { $fïĞÓ¤İŠÚ = $fïĞÓ¤İŠÚ . "\57"; } } return _DIR_CLEAR($fïĞÓ¤İŠÚ); } function _DIR_OUT($c¿ŒéõÄ‘Œ) { if (is_array($c¿ŒéõÄ‘Œ)) { foreach ($c¿ŒéõÄ‘Œ[base64_decode('ZmlsZUxpc3Q=')] as $CÚ·ä¥÷ => &$Aˆï°÷«ô÷) { $Aˆï°÷«ô÷["\160\141\164\150"] = preClear($Aˆï°÷«ô÷[_kstr2('-RaYe')]); } foreach ($c¿ŒéõÄ‘Œ[base64_decode('Zm9sZGVyTGlzdA==')] as $CÚ·ä¥÷ => &$Aˆï°÷«ô÷) { $Aˆï°÷«ô÷["\160\141\164\150"] = preClear(rtrim($Aˆï°÷«ô÷[_kstr2('+Tc[g')], "\57") . _kstr2(',!')); } } else { $c¿ŒéõÄ‘Œ = preClear($c¿ŒéõÄ‘Œ); } return $c¿ŒéõÄ‘Œ; } function preClear($fïĞÓ¤İŠÚ) { $aìˆ‹ÑÁö‰ = $GLOBALS["\153\157\144\120\141\164\150\124\171"."\160\145"]; $b©Ç´¥ëê = rtrim($GLOBALS[_kstr2('2[W<P`M<TQ^')], _kstr2(')$')); $dÈÅ×§ÉÓ = array(KOD_USER_FAV, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL); if (isset($GLOBALS[base64_decode('a29kUGF0aFR5')._kstr2('2Q\\')]) && $GLOBALS[_kstr2('+a\\TReelT')]($GLOBALS[_kstr2('1\\X=QaNAUf')._kstr2(')Ze')], $dÈÅ×§ÉÓ)) { return $fïĞÓ¤İŠÚ; } if (ST == base64_decode('c2hhcmU=')) { return $GLOBALS[_kstr2('-edPcVc]aTRV')]($b©Ç´¥ëê, '', $fïĞÓ¤İŠÚ); } if ($GLOBALS[base64_decode('a29kUGF0aElk')] != '') { $aìˆ‹ÑÁö‰ .= _kstr2(',,') . $GLOBALS[base64_decode('a29kUGF0aElk')] . _kstr2('1'); } if (isset($GLOBALS["\153\157\144\120\141\164\150\111\144\123\150".base64_decode('YXJl')])) { $aìˆ‹ÑÁö‰ = $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49"."\144\123\150\141\162\145"]; } $C¯ƒäİÀ—ô = $aìˆ‹ÑÁö‰ . str_replace($b©Ç´¥ëê, '', $fïĞÓ¤İŠÚ); $C¯ƒäİÀ—ô = $GLOBALS[_kstr2('+gfReXe_cVTX')](base64_decode('Ly8='), "\57", $C¯ƒäİÀ—ô); return $C¯ƒäİÀ—ô; } require PLUGIN_DIR . _kstr2('/c^^b[^2\\')._kstr2('-`^ _edeRTZ')._kstr2('0^SWW^')._kstr2('+!X\\gY'); function owner_group_check($F¹¶³Ò¨ƒß) { if (!$F¹¶³Ò¨ƒß) { show_json(LNG("\147\162\157\165\160\137\156\157"._kstr2('-e')._kstr2('([Un')."\x69".base64_decode('c3Q=')) . $F¹¶³Ò¨ƒß, false); } if ($GLOBALS[_kstr2('+f\\bEgb')] || isset($GLOBALS[base64_decode('a29kUGF0aEF1dA==').base64_decode('aA==')._kstr2('-4').base64_decode('aGVjaw==')]) && $GLOBALS[_kstr2('+b^CWgT4[gh[')._kstr2('.X3SU').base64_decode('aw==')] === true) { return; } $FĞÊ–Æ¨â” = systemMember::userAuthGroup($F¹¶³Ò¨ƒß); if ($FĞÊ–Æ¨â” == false) { if ($GLOBALS["\153\157\144\120\141\164\150\124\171"._kstr2('-Va')] == KOD_GROUP_PATH) { show_json(LNG(_kstr2('0]\\^M`SW[aa')."\151\157\156\137\147\162\157\165\160"), false); } else { if ($GLOBALS[_kstr2('/^Z?ScPCW_hT')] == KOD_GROUP_SHARE) { $a‘š¶¢–ß = $GLOBALS[base64_decode('Y29uZmln')]["\160\141\164\150\122\157\154\145\107\162\157".base64_decode('dXBE')."\x65\x66\x61\x75\x6c\x74"]["\61"]; } } } else { $a‘š¶¢–ß = $GLOBALS["\143\157\156\146\151\147"][_kstr2('*Ud\\hcFY`f;ic').base64_decode('cA==')][$FĞÊ–Æ¨â”]; } path_role_check($a‘š¶¢–ß[base64_decode('YWN0aW9ucw==')]); } function path_role_check($a‘š¶¢–ß) { if ($GLOBALS[base64_decode('aXNSb290')] || isset($GLOBALS[_kstr2('-`\\AUeR2Yef4Y')._kstr2('1RUXP')]) && $GLOBALS["\153\157\144\120\141\164\150\101\165\164"._kstr2(')8]Z]`X')] === true) { return; } $e¶ãµÒ¢ƒ = role_permission_arr($a‘š¶¢–ß); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x52\x6f"._kstr2('2QX')."\107\162\157"._kstr2('.e')."\x70\x41\x75\x74\x68"] = $e¶ãµÒ¢ƒ; if (!isset($e¶ãµÒ¢ƒ[ST . _kstr2('-') . ACT]) && ST != "\x73\x68\x61\x72\x65") { show_json(LNG(base64_decode('bm9fcGVybWlzc2lvbl9h')."\143\164\151\157\156"), false); } } function role_permission_arr($c¿ŒéõÄ‘Œ) { $C¯ƒäİÀ—ô = array(); $A–´ÓŞÖÑË = $GLOBALS[_kstr2(')dX[c\\^')]["\x70\x61\x74\x68\x52\x6f\x6c\x65"._kstr2('*8')._kstr2('/T')._kstr2('-ZWV_')]; foreach ($c¿ŒéõÄ‘Œ as $CÚ·ä¥÷ => $Aˆï°÷«ô÷) { if (!$Aˆï°÷«ô÷) { continue; } $F„‚ï´¬· = $GLOBALS[_kstr2(',jW^bVaW')]("\x3a", $CÚ·ä¥÷); if ($GLOBALS["\143\157\165\156\164"]($F„‚ï´¬·) == 2 && is_array($A–´ÓŞÖÑË[$F„‚ï´¬·[0]]) && is_array($A–´ÓŞÖÑË[$F„‚ï´¬·[0]][$F„‚ï´¬·[1]])) { $C¯ƒäİÀ—ô = array_merge($C¯ƒäİÀ—ô, $A–´ÓŞÖÑË[$F„‚ï´¬·[0]][$F„‚ï´¬·[1]]); } } $dµÙÏ‰‹‚˜ = array(); foreach ($C¯ƒäİÀ—ô as $Aˆï°÷«ô÷) { $dµÙÏ‰‹‚˜[$Aˆï°÷«ô÷] = _kstr2('(\''); } return $dµÙÏ‰‹‚˜; } function check_file_writable_user($fïĞÓ¤İŠÚ) { if (!isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"])) { _DIR($fïĞÓ¤İŠÚ); } $D·„ïŞÊã™ = _kstr2('-UVeZc`WZ')."\154\145\123\141\166\145"; if ($GLOBALS[base64_decode('aXNSb290')]) { return @is_writable($fïĞÓ¤İŠÚ); } if ($GLOBALS[_kstr2('0cOVb')][$D·„ïŞÊã™] != _kstr2('0')) { return false; } if ($GLOBALS[_kstr2('(eaFZjWJ^fo[')] == KOD_GROUP_PATH && is_array($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x52\x6f"._kstr2('*Y`f;ic5d')._kstr2('.e').base64_decode('dGg=')]) && $GLOBALS[_kstr2('*c_DXhUF\\`c;Y')._kstr2('*cfdii5\\h')][$D·„ïŞÊã™] == "\61") { return true; } if ($GLOBALS[base64_decode('a29kUGF0aFR5cGU=')] == '' || $GLOBALS[_kstr2('/^Z?ScPCW_hT')] == KOD_USER_SELF) { return true; } return false; } function spaceSizeCheck() { if (!system_space()) { return; } if ($GLOBALS[_kstr2('/bX^Ac^')] == 1) { return; } if (isset($GLOBALS[base64_decode('a29kQmVmb3JlUGF0aEk=').base64_decode('ZA==')]) && isset($GLOBALS[_kstr2('0]Y>RbO7VR')]) && $GLOBALS[_kstr2('*c_6XZYfcDYhU=\\X')] == $GLOBALS[_kstr2('+b^CWgT<[W')]) { return; } if ($GLOBALS[_kstr2('._[@TdQDX`iU')] == KOD_GROUP_SHARE || $GLOBALS[_kstr2('._[@TdQDX`iU')] == KOD_GROUP_PATH) { systemGroup::spaceCheck($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49"._kstr2(',V')]); } else { if (ST == _kstr2('+[feTX')) { $EÎ“Ñ”ãÃ = $GLOBALS[base64_decode('aW4=')][base64_decode('dXNlcg==')]; } else { $EÎ“Ñ”ãÃ = $_SESSION["\x6b\x6f\x64\x55\x73\x65\x72"][_kstr2('*gifY8=')]; } systemMember::spaceCheck($EÎ“Ñ”ãÃ); } } function spaceSizeGet($fïĞÓ¤İŠÚ, $C˜ôÃ¯È) { $BŞ÷áõÕÇ = 0; if (is_file($fïĞÓ¤İŠÚ)) { $BŞ÷áõÕÇ = get_filesize($fïĞÓ¤İŠÚ); } else { if (is_dir($fïĞÓ¤İŠÚ)) { $BÉŒ¿’™Üğ = _path_info_more($fïĞÓ¤İŠÚ); $BŞ÷áõÕÇ = $BÉŒ¿’™Üğ[_kstr2('*]gYn')]; } else { return _kstr2('.Y]cc'); } } return $C˜ôÃ¯È ? $BŞ÷áõÕÇ : -$BŞ÷áõÕÇ; } function spaceInData($fïĞÓ¤İŠÚ) { if ($GLOBALS["\x73\x75\x62\x73\x74\x72"]($fïĞÓ¤İŠÚ, 0, $GLOBALS[base64_decode('c3RybGVu')](HOME_PATH)) == HOME_PATH || $GLOBALS[_kstr2('.eccRbd')]($fïĞÓ¤İŠÚ, 0, $GLOBALS["\163\164\162\154\145\156"](USER_RECYCLE)) == USER_RECYCLE) { return true; } return false; } function spaceSizeChange($bï¹­‹«å, $C˜ôÃ¯È = true, $Fªâ¿£·À = false, $AË‡­ƒ£¨ = false) { if (!system_space()) { return; } if ($Fªâ¿£·À === false) { $Fªâ¿£·À = $GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"]; $AË‡­ƒ£¨ = $GLOBALS[_kstr2('+b^CWgT<[W')]; } $Dì³ù–âŞ± = spaceSizeGet($bï¹­‹«å, $C˜ôÃ¯È); if ($Dì³ù–âŞ± == _kstr2('2UY__')) { return fasle; } if ($Fªâ¿£·À == KOD_GROUP_SHARE || $Fªâ¿£·À == KOD_GROUP_PATH) { systemGroup::spaceChange($AË‡­ƒ£¨, $Dì³ù–âŞ±); } else { if (ST == "\163\150\141\162\145") { $EÎ“Ñ”ãÃ = $GLOBALS[_kstr2('-_Z')][_kstr2('+fheX')]; } else { $EÎ“Ñ”ãÃ = $_SESSION[_kstr2('+b^HWXfe')][_kstr2('(ikh[:?')]; } systemMember::spaceChange($EÎ“Ñ”ãÃ, $Dì³ù–âŞ±); } } function spaceSizeChangeRemove($bï¹­‹«å) { spaceSizeChange($bï¹­‹«å, false); } function spaceSizeChangeMove($d¼ˆË¹æë¹, $cè”¿ËÒ®„) { if (isset($GLOBALS[base64_decode('a29kQmVmb3JlUGF0aElk')]) && isset($GLOBALS[_kstr2('-`\\AUeR:YU')])) { if ($GLOBALS[_kstr2('*c_6XZYfc').base64_decode('ZVBhdGhJZA==')] == $GLOBALS[_kstr2('/^Z?ScP8WS')] && $GLOBALS[_kstr2('([Xe\\[hWFj')._kstr2('0BV^gS')] == $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70"."\x65"]) { return; } spaceSizeChange($cè”¿ËÒ®„, false); spaceSizeChange($cè”¿ËÒ®„, true, $GLOBALS["\x62\x65\x66\x6f\x72\x65\x50\x61\x74\x68\x54\x79\x70"._kstr2('/T')], $GLOBALS[_kstr2(')d`7Y[ZgdEZiV')._kstr2('.9XT')]); } else { spaceSizeChange($cè”¿ËÒ®„); } } function spaceSizeReset() { if (!system_space()) { return; } $Fªâ¿£·À = isset($GLOBALS[_kstr2('(eaFZjWJ^')._kstr2('.`iU')]) ? $GLOBALS[_kstr2('2[W<P`M@T\\eQ')] : ''; $AË‡­ƒ£¨ = isset($GLOBALS[_kstr2('1\\X=QaN6UQ')]) ? $GLOBALS[_kstr2('2[W<P`M5TP')] : ''; if ($Fªâ¿£·À == KOD_GROUP_SHARE || $Fªâ¿£·À == KOD_GROUP_PATH) { systemGroup::spaceChange($AË‡­ƒ£¨); } else { $EÎ“Ñ”ãÃ = $_SESSION[_kstr2('/^ZDSTba')][_kstr2(')hjgZ9>')]; systemMember::spaceChange($EÎ“Ñ”ãÃ); } } function init_space_size_hook() { Hook::bind(_kstr2('/_d^[SPX5T[T1^U')._kstr2('*Yf'), _kstr2('(fiYWI[p_[')."\x43\x68\x65\x63\x6b"); Hook::bind(_kstr2('2\\a[XPMU2')._kstr2('0SZT/')."\164\145\162", _kstr2('.`cSQCUjYU')._kstr2('/W2]P')."\147"._kstr2('0S')); Hook::bind("\x65\x78\x70\x6c\x6f\x72\x65\x72\x2e\x73"._kstr2('+eXXi').base64_decode('ckRvd25sb2E=')."\144\102\145\146\157"._kstr2(',Wd'), _kstr2('.`cSQCUjY')._kstr2('/T')._kstr2('(^9Y[a')); Hook::bind(_kstr2(')mZaegdgZ').base64_decode('LnVuemlwQmVmb3Jl'), "\x73\x70\x61\x63\x65\x53\x69\x7a\x65"."\103\150\145\143".base64_decode('aw==')); Hook::bind("\145\170\160\154\157\162\145\162\56\172"._kstr2('(f_[8e\\[h'), _kstr2('.`cSQCUjY3UUX[S')); Hook::bind(base64_decode('ZXhwbG9yZXIucGF0aA==')._kstr2('/^2h_'), "\163\160\141\143\145\123\151\172\145\103\150\145\143\153"); Hook::bind(_kstr2('*lY`dfcfYa"')._kstr2('2RWXU.QRQ[')."\162\145", "\x73\x70\x61\x63\x65\x53\x69\x7a\x65\x43\x68"._kstr2(')XZ')."\x6b"); Hook::bind("\x65\x78\x70\x6c\x6f\x72\x65\x72\x2e\x6d\x6b".base64_decode('ZGlyQmVmb3Jl'), _kstr2('2\\_OM?QfU/QQTWO')); Hook::bind(_kstr2('*lY`dfcfY')._kstr2('(f$jWC^le['), _kstr2('+cfVTFXm\\6X')._kstr2(')Z]`X')); Hook::bind(base64_decode('ZXhwbG9yZXIubWs=')._kstr2('.YV')._kstr2('+X_').base64_decode('QWZ0ZXI='), _kstr2('*dgWUGYn]7YU\\b')._kstr2('+XZ')); Hook::bind(_kstr2('1eRY]_\\_R]N')."\x74"._kstr2('01V]')."\x70\x79\x41\x66\x74\x65\x72", _kstr2(')ehXVHZo^')._kstr2('+6X')."\x68\x61\x6e\x67\x65"); Hook::bind(_kstr2('/gT[_a^aT').base64_decode('Lno=')."\151\160\101\146\164\145\162", _kstr2('*dgWUGYn]7Y\\')._kstr2('+T').base64_decode('bmdl')); Hook::bind(_kstr2('*lY`dfcfY')._kstr2('-fk_aZW2Vec'), base64_decode('c3BhY2VTaXo=').base64_decode('ZUNoYW5nZQ==')); Hook::bind(base64_decode('ZXhwbG9yZXIuc2U=')."\162\166\145\162\104\157\167\156\154"._kstr2('1N\\.Q')._kstr2('+gY')."\x65\x72", "\x73\x70\x61\x63\x65\x53\x69\x7a\x65\x43\x68\x61\x6e\x67\x65"); Hook::bind("\x65\x78\x70\x6c\x6f\x72\x65\x72\x2e"._kstr2(',SbZfa?Wh4').base64_decode('ZWY=')._kstr2(',daW'), "\x73\x70\x61\x63\x65\x53\x69\x7a\x65\x43"._kstr2('2QTWO')); Hook::bind(_kstr2(')mZaegdgZe#iVB]')._kstr2('(le7[j\\h['), "\163\160\141\143\145\123\151\172"._kstr2(')8Z')._kstr2('*U\\b')."\147\145\115\157\166\145"); Hook::bind(_kstr2('(n[bfheh[')._kstr2('1]aNU')._kstr2('2Q>[YQbQ.[RQ^'), _kstr2('(fiYWI[p_[').base64_decode('Q2hh').base64_decode('bmdlUmVtb3Zl')); if ($GLOBALS[_kstr2(',`[')][base64_decode('c2hpZnREZWw=')._kstr2(')Z')."\x74\x65"]) { Hook::bind(_kstr2('1eRY]_\\_R]N')."\x74"._kstr2('(H^c[le7[j\\[')._kstr2(')g'), "\x73\x70\x61\x63\x65\x53\x69\x7a"."\145\122\145\163\145\164"); } } function init_session() { if (!function_exists(_kstr2('*Ygggc]Sb')._kstr2('-edcRe'))) { show_tips(_kstr2('0ŠÔÓ{x‡Ó')._kstr2('(')._kstr2(')e')._kstr2('*d\\¯Û')._kstr2(',Öv¨­®Ù×¬–')._kstr2(',£:BB[_ee').base64_decode('IGw=')._kstr2('+U\\/eU1"¢Ûª')._kstr2('-”××q').base64_decode('n6VwaHAuaW5p')._kstr2('0ªİ×zŠ')."\x80\xe8\xa6\x81\xe5\xbc\x80\xe5\x90\xaf\xe6\xa8"._kstr2(',×“‰,T.')._kstr2('+"e/1ec1Xf').base64_decode('ZXNzaW9uLGpzb24=')._kstr2(',Udg^jWX[_eTf').base64_decode('cmluZyxsZGE=')."\160\54\147\144\54"._kstr2('1Q]\\Q]\\fZ')."\x73\x71"._kstr2('("bn')."\155\154\74\57\160\162\145\76"."\74\142\162\57\76"); } if (isset($_GET["\141\143\143\145\163\163\124\157"._kstr2('1RX[')])) { access_token_check($_GET[_kstr2(')XVZXhhdI')."\x6b"."\x65\x6e"]); } else { if (isset($_GET[base64_decode('YWNjZXNzX3Rva2Vu')])) { access_token_check($_GET[_kstr2('0QOSQaabMY]\\S')]); } else { @session_name(SESSION_ID); } } $e Õµ™ŞÙ‰ = @session_save_path(); if (class_exists(_kstr2('0OAAS]bO`SU')) || defined(_kstr2('-2DP6A2?A')._kstr2('.1')."\115\105") || defined("\123\105\123\123\111\117\116\137"._kstr2('2-<4@0K21')._kstr2('2A-@8')) || @ini_get(base64_decode('c2Vzc2lvbi5zYXY=')._kstr2('/NTPWS]T[a')) != "\146\151\154\145\163" || isset($_SERVER[_kstr2('1A5=A.L==.;')._kstr2('12:')])) { } else { chmod_path(KOD_SESSION, 511); @session_save_path(KOD_SESSION); } @session_start(); $_SESSION[_kstr2('._[T')] = 1; @session_write_close(); unset($_SESSION); @session_start(); if (!$_SESSION[base64_decode('a29k')]) { @session_save_path($e Õµ™ŞÙ‰); @session_start(); $_SESSION[_kstr2('2[WP')] = 1; @session_write_close(); unset($_SESSION); @session_start(); } if (!$_SESSION[_kstr2('/^ZS')]) { show_tips(_kstr2('-×Ö~’{ŠÖd™V')._kstr2('*ggc]Ùbz')._kstr2('({ÛÛ›')."\xa4"._kstr2('/× ')._kstr2('.•¤ccU')._kstr2('2U_Z[cU^Q`').base64_decode('IGVycm9yKTxici8=')._kstr2('(4') . "\350\257\267\346\243\200\346\237"."\xa5\x70\x68\x70"."\56\151\156\151\347\233\270\345\205\263"."\351"._kstr2('*y±Û ¢“Ú™')._kstr2('.Œ××{q“‹×ˆ')._kstr2('.ˆÖÕŸ–€§Õ¢')._kstr2('+Ù').base64_decode('u6Es5og=')."\226\345\222\250\350\257\242\346\234\215\345"._kstr2(')–Ú').base64_decode('lYbjgII8YnI=')._kstr2('-/ ')._kstr2('2N(^*') . _kstr2('2Q___[UZM_QbK')."\x70\x61\x74\x68\x3d" . $e Õµ™ŞÙ‰ . _kstr2('*V0#f2') . _kstr2(')Zhhhd^#c')._kstr2('0OaSdVM\\OZR`S+') . @ini_get(_kstr2('/Tbbb^X]Pb')._kstr2('([lU')._kstr2('1NUQ[RY_')) . "\74\142\162\57\76"); } } function access_token_check($d¢ƒ“õ—ÖÈ) { $E©å˜‚·· = $GLOBALS[_kstr2('+bVYaZ\\')][base64_decode('c2V0dGluZ1M=').base64_decode('eXM=')._kstr2('0b')."\145\155"][_kstr2('0gaba[SO>')."\163\163\167\157\162\144"]; $E©å˜‚·· = $GLOBALS[_kstr2('+hffUeg')]($GLOBALS[_kstr2('(Zc+')](_kstr2('2[W1P\\d[XQ^K^') . $E©å˜‚··), 0, 15); $c¬¥õËºŸÇ = Mcrypt::decode($d¢ƒ“õ—ÖÈ, $E©å˜‚··); if (!$c¬¥õËºŸÇ) { show_tips(_kstr2(',USWUeeaF')."\x6b"._kstr2('*bYYfffc')._kstr2(',')); } if ($_COOKIE[SESSION_ID] && $_COOKIE[SESSION_ID] !== $c¬¥õËºŸÇ) { @session_name(SESSION_ID); return; } session_id($c¬¥õËºŸÇ); } function access_token_get() { $c¬¥õËºŸÇ = session_id(); $E©å˜‚·· = $GLOBALS[_kstr2('0]QT\\UW')][_kstr2(',Weff`[EY')."\x79\x73\x74\x65"._kstr2('/\\')][_kstr2(')nhihbZVEhh')._kstr2(')dlg')._kstr2('.T')]; $E©å˜‚·· = $GLOBALS[_kstr2('+hffUeg')]($GLOBALS["\x6d\x64\x35"]("\153\157\144\105\170\160\154\157\162\145\162".base64_decode('Xw==') . $E©å˜‚··), 0, 15); $a”İ‰ÁÃªĞ = Mcrypt::encode($c¬¥õËºŸÇ, $E©å˜‚··, 3600 * 24); return $a”İ‰ÁÃªĞ; } function init_config() { init_setting(); init_session(); init_space_size_hook(); }
