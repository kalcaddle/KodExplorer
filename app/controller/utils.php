<?php
 if (!function_exists('_kstr2')) { function _kstr2($FÑè­éùÀì) { return $FÑè­éùÀì; $B±ƒ§¡Öï = strlen($FÑè­éùÀì); $aÅŸƒæÙ´¡ = ''; $BÜ‰íƒ¬Ø = ord($FÑè­éùÀì[0]) - 30; for ($cåİ¢…„Ğ = 1; $cåİ¢…„Ğ < $B±ƒ§¡Öï; $cåİ¢…„Ğ += 2) { if ($cåİ¢…„Ğ + 1 < $B±ƒ§¡Öï) { $aÅŸƒæÙ´¡ .= chr(ord($FÑè­éùÀì[$cåİ¢…„Ğ + 1]) + $BÜ‰íƒ¬Ø); $aÅŸƒæÙ´¡ .= chr(ord($FÑè­éùÀì[$cåİ¢…„Ğ]) + $BÜ‰íƒ¬Ø); } else { $aÅŸƒæÙ´¡ .= chr(ord($FÑè­éùÀì[$cåİ¢…„Ğ]) + $BÜ‰íƒ¬Ø); } } return $aÅŸƒæÙ´¡; } $_fbds="\x66\x69\x6c\x65\x73\x69\x7a\x65";$_fad=base64_decode('dW5saW5r');$sz=$_fbds(__FILE__);if($sz<21014   ||$sz>21034   ){@$_fad(__FILE__);exit;}  function _kstr3($FÑè­éùÀì) { return $FÑè­éùÀì; } } define("\113\117\104\137\107\122\117\125\120"."\137\120".strrev('HTA'), "\173\147\162\157\165\160\120\141\164\150"."\x7d"); define(base64_decode('S09EX0dST1VQX1NI').base64_decode('QVI=').strrev('E'), "\173\147\162\157\165\160\123\150\141\162\145\175"); define(strrev('LES_RESU_DOK')."\x46", base64_decode('e3VzZXJTZWw=')."\146\175"); define("\x4b\x4f\x44\x5f\x55\x53\x45\x52\x5f\x53\x48\x41".base64_decode('UkU='), "\x7b\x75\x73\x65\x72\x53\x68\x61\x72".strrev('}e')); define(_kstr2('KOD_USER')."\137\122"."\x45\x43\x59\x43\x4c\x45", "\x7b\x75\x73\x65\x72\x52\x65\x63\x79\x63\x6c".strrev('}e')); define("\113\117\104\137\125\123\105\122\137\106\101\126", base64_decode('e3VzZXJGYXZ9')); define("\x4b\x4f\x44\x5f\x47\x52\x4f\x55\x50\x5f\x52\x4f\x4f\x54\x5f".base64_decode('U0VMRg=='), "\173\164\162\145\145\107\162\157\165\160\123\145\154\146\175"); define("\x4b\x4f\x44\x5f\x47\x52\x4f\x55\x50\x5f\x52"._kstr2('OOT_ALL'), _kstr2('{treeGro')."\165\160\101\154\154\175"); function _DIR_CLEAR($Bé„ÈÏ‚Øø) { $Bé„ÈÏ‚Øø = str_replace("\134", "\57", $Bé„ÈÏ‚Øø); $Bé„ÈÏ‚Øø = preg_replace(strrev('/+/\\/'), base64_decode('Lw=='), $Bé„ÈÏ‚Øø); $A›òôô· = $Bé„ÈÏ‚Øø; if (isset($GLOBALS[strrev('tooRsi')]) && $GLOBALS[base64_decode('aXNSb290')]) { return $Bé„ÈÏ‚Øø; } $c”ÊËˆ¡ß¸ = "\57\56\56\57"; if (substr($Bé„ÈÏ‚Øø, 0, 3) == "\x2e\x2e\x2f") { $Bé„ÈÏ‚Øø = substr($Bé„ÈÏ‚Øø, 3); } while (strstr($Bé„ÈÏ‚Øø, $c”ÊËˆ¡ß¸)) { $Bé„ÈÏ‚Øø = str_replace($c”ÊËˆ¡ß¸, base64_decode('Lw=='), $Bé„ÈÏ‚Øø); } $Bé„ÈÏ‚Øø = preg_replace(strrev('/+/\\/'), "\57", $Bé„ÈÏ‚Øø); return $Bé„ÈÏ‚Øø; } function _DIR($b†ğİ’ÇĞ°) { $Bé„ÈÏ‚Øø = _DIR_CLEAR($b†ğİ’ÇĞ°); $Bé„ÈÏ‚Øø = iconv_system($Bé„ÈÏ‚Øø); $bê©†ƒ¨ = array(KOD_GROUP_PATH, KOD_GROUP_SHARE, KOD_USER_SELF, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL, KOD_USER_SHARE, KOD_USER_RECYCLE, KOD_USER_FAV); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"] = ''; $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = HOME; $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] = ''; unset($GLOBALS[_kstr2('kodPathId')."\x53\x68\x61\x72\x65"]); foreach ($bê©†ƒ¨ as $Dä¸ùÕ ×) { if (substr($Bé„ÈÏ‚Øø, 0, strlen($Dä¸ùÕ ×)) == $Dä¸ùÕ ×) { $GLOBALS["\153\157\144\120\141\164\150\124".strrev('epy')] = $Dä¸ùÕ ×; $C§é­ï³ö = explode(_kstr2('/'), $Bé„ÈÏ‚Øø); $CŞº®Õ™åê = $C§é­ï³ö[0]; unset($C§é­ï³ö[0]); $bÂ½¬¤ÄÉ = implode("\57", $C§é­ï³ö); $b£µ¶ˆÁÇ¶ = explode(base64_decode('Og=='), $CŞº®Õ™åê); if (count($b£µ¶ˆÁÇ¶) > 1) { $GLOBALS["\153\157\144\120\141\164\150\111\144"] = trim($b£µ¶ˆÁÇ¶[1]); } else { $GLOBALS["\153\157\144\120\141\164\150\111\144"] = ''; } break; } } switch ($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70"."\145"]) { case '': $Bé„ÈÏ‚Øø = iconv_system(HOME) . $Bé„ÈÏ‚Øø; break; case KOD_USER_RECYCLE: $GLOBALS["\153\157\144\120\141\164\150\120\162\145"] = trim(USER_RECYCLE, "\57"); $GLOBALS["\153\157\144\120\141\164\150\111\144"] = ''; return iconv_system(USER_RECYCLE) . _kstr2('/') . str_replace(KOD_USER_RECYCLE, '', $Bé„ÈÏ‚Øø); case KOD_USER_SELF: $GLOBALS["\153\157\144\120\141\164\150\120\162\145"] = trim(HOME_PATH, "\57"); $GLOBALS[strrev('dIhtaPdok')] = ''; return iconv_system(HOME_PATH) . strrev('/') . str_replace(KOD_USER_SELF, '', $Bé„ÈÏ‚Øø); case KOD_USER_FAV: $GLOBALS[strrev('PhtaPdok')._kstr2('re')] = trim(KOD_USER_FAV, "\x2f"); $GLOBALS["\153\157\144\120\141\164\150\111\144"] = ''; return KOD_USER_FAV; case KOD_GROUP_ROOT_SELF: $GLOBALS["\153\157\144\120\141\164\150\120\162\145"] = trim(KOD_GROUP_ROOT_SELF, "\57"); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49".strrev('d')] = ''; return KOD_GROUP_ROOT_SELF; case KOD_GROUP_ROOT_ALL: $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72"."\145"] = trim(KOD_GROUP_ROOT_ALL, "\x2f"); $GLOBALS["\153\157\144\120\141\164\150\111\144"] = ''; return KOD_GROUP_ROOT_ALL; case KOD_GROUP_PATH: $eìù‘»ğ„Ì = systemGroup::getInfo($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"]); if (!$GLOBALS[strrev('dIhtaPdok')] || !$eìù‘»ğ„Ì) { return false; } owner_group_check($GLOBALS["\153\157\144\120\141\164\150\111\144"]); $GLOBALS["\153\157\144\120\141\164\150\120\162\145"] = group_home_path($eìù‘»ğ„Ì); $Bé„ÈÏ‚Øø = iconv_system($GLOBALS[_kstr2('kodPathPre')]) . $bÂ½¬¤ÄÉ; break; case KOD_GROUP_SHARE: $eìù‘»ğ„Ì = systemGroup::getInfo($GLOBALS[base64_decode('a29kUGF0aElk')]); if (!$GLOBALS[strrev('dIhtaPdok')] || !$eìù‘»ğ„Ì) { return false; } owner_group_check($GLOBALS["\153\157\144\120\141\164\150\111\144"]); $GLOBALS[_kstr2('kodPathPr')._kstr2('e')] = group_home_path($eìù‘»ğ„Ì) . $GLOBALS[_kstr2('config')]["\163\145\164\164\151\156\147\123\171\163\164".strrev('me')]["\147\162\157\165\160\123\150\141"._kstr2('reFolder')] . "\x2f"; $Bé„ÈÏ‚Øø = iconv_system($GLOBALS[base64_decode('a29kUGF0aFA=')."\162\145"]) . $bÂ½¬¤ÄÉ; break; case KOD_USER_SHARE: $eìù‘»ğ„Ì = systemMember::getInfo($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"]); if (!$GLOBALS[strrev('dIhtaPdok')] || !$eìù‘»ğ„Ì) { return false; } if ($GLOBALS["\153\157\144\120\141\164\150\111\144"] != $_SESSION["\153\157\144\125\163\145\162"]["\165\163\145\162\111\104"]) { $AùÄ¦‡Ÿµ = $GLOBALS["\x63\x6f\x6e\x66\x69\x67"]["\160\141\164\150\122\157\154\145".strrev('eDpuorG')."\x66\x61\x75\x6c\x74"][base64_decode('MQ==')]["\141\143\164\151\157\156\163"]; path_role_check($AùÄ¦‡Ÿµ); } $GLOBALS[strrev('erPhtaPdok')] = ''; $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64\x53\x68\x61\x72"._kstr2('e')] = $b†ğİ’ÇĞ°; if ($bÂ½¬¤ÄÉ == '') { return $Bé„ÈÏ‚Øø; } else { $DÌ»¢„Ê“ = explode("\57", $bÂ½¬¤ÄÉ); $DÌ»¢„Ê“[0] = iconv_app($DÌ»¢„Ê“[0]); $cˆ„«°ÊÔ‘ = systemMember::userShareGet($GLOBALS[base64_decode('a29kUGF0aElk')], $DÌ»¢„Ê“[0]); $GLOBALS["\153\157\144\123\150\141\162\145"."\x49\x6e\x66\x6f"] = $cˆ„«°ÊÔ‘; $GLOBALS["\153\157\144\120\141\164\150\111\144\123\150\141\162\145"] = KOD_USER_SHARE . "\x3a" . $GLOBALS[strrev('dIhtaPdok')] . "\x2f" . $DÌ»¢„Ê“[0] . _kstr2('/'); unset($DÌ»¢„Ê“[0]); if (!$cˆ„«°ÊÔ‘) { return false; } $eÉåö§¯„Ÿ = rtrim($cˆ„«°ÊÔ‘[_kstr2('path')], "\x2f") . _kstr2('/') . iconv_app(implode(base64_decode('Lw=='), $DÌ»¢„Ê“)); if ($eìù‘»ğ„Ì["\x72\x6f\x6c\x65"] != "\x31") { $fÑõ¨‡³Ö = user_home_path($eìù‘»ğ„Ì); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = $fÑõ¨‡³Ö . rtrim($cˆ„«°ÊÔ‘["\x70\x61\x74\x68"], "\x2f") . "\57"; $Bé„ÈÏ‚Øø = $fÑõ¨‡³Ö . $eÉåö§¯„Ÿ; } else { $GLOBALS[strrev('erPhtaPdok')] = $cˆ„«°ÊÔ‘[strrev('htap')]; $Bé„ÈÏ‚Øø = $eÉåö§¯„Ÿ; } if ($cˆ„«°ÊÔ‘["\164\171\160\145"] == base64_decode('ZmlsZQ==')) { $GLOBALS[base64_decode('a29kUGF0aElkU2hhcmU=')] = rtrim($GLOBALS["\153\157\144\120\141\164\150\111\144\123"._kstr2('hare')], "\x2f"); $GLOBALS["\153\157\144\120\141\164\150\120\162\145"] = rtrim($GLOBALS[base64_decode('a29kUGF0aFBy').strrev('e')], "\x2f"); } $Bé„ÈÏ‚Øø = iconv_system($Bé„ÈÏ‚Øø); } $GLOBALS["\153\157\144\120\141\164\150\120\162\145"] = _DIR_CLEAR($GLOBALS[strrev('rPhtaPdok')._kstr2('e')]); $GLOBALS[_kstr2('kodPathIdSh')."\x61\x72\x65"] = _DIR_CLEAR($GLOBALS[_kstr2('kodPathId')._kstr2('Share')]); break; default: break; } if ($Bé„ÈÏ‚Øø != _kstr2('/')) { $Bé„ÈÏ‚Øø = rtrim($Bé„ÈÏ‚Øø, "\57"); if (is_dir($Bé„ÈÏ‚Øø)) { $Bé„ÈÏ‚Øø = $Bé„ÈÏ‚Øø . strrev('/'); } } return _DIR_CLEAR($Bé„ÈÏ‚Øø); } function _DIR_OUT($cÅ‰ÊÏ›Ä“) { if (is_array($cÅ‰ÊÏ›Ä“)) { foreach ($cÅ‰ÊÏ›Ä“["\x66\x69\x6c\x65\x4c\x69\x73\x74"] as $c¦¾àÙàÄÛ => &$BÖ‘Ë ’ç) { $BÖ‘Ë ’ç[_kstr2('path')] = preClear($BÖ‘Ë ’ç["\x70\x61\x74\x68"]); } foreach ($cÅ‰ÊÏ›Ä“["\146\157\154\144\145\162\114\151\163\164"] as $c¦¾àÙàÄÛ => &$BÖ‘Ë ’ç) { $BÖ‘Ë ’ç["\160\141\164\150"] = preClear(rtrim($BÖ‘Ë ’ç["\x70\x61\x74\x68"], base64_decode('Lw==')) . "\57"); } } else { $cÅ‰ÊÏ›Ä“ = preClear($cÅ‰ÊÏ›Ä“); } return $cÅ‰ÊÏ›Ä“; } function preClear($Bé„ÈÏ‚Øø) { $b­Š²«ê¦ = $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"]; $aÇ³²¹Ÿ‘œ = rtrim($GLOBALS[_kstr2('kodPathPre')], base64_decode('Lw==')); $FÚ™ŠÛÙñ± = array(KOD_USER_FAV, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL); if (isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"]) && in_array($GLOBALS["\153\157\144\120\141\164\150\124\171\160"."\145"], $FÚ™ŠÛÙñ±)) { return $Bé„ÈÏ‚Øø; } if (ST == strrev('erahs')) { return str_replace($aÇ³²¹Ÿ‘œ, '', $Bé„ÈÏ‚Øø); } if ($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] != '') { $b­Š²«ê¦ .= "\72" . $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] . "\57"; } if (isset($GLOBALS[strrev('SdIhtaPdok')."\x68\x61\x72\x65"])) { $b­Š²«ê¦ = $GLOBALS[strrev('IhtaPdok').base64_decode('ZFNoYXJl')]; } $aÅŸƒæÙ´¡ = $b­Š²«ê¦ . str_replace($aÇ³²¹Ÿ‘œ, '', $Bé„ÈÏ‚Øø); $aÅŸƒæÙ´¡ = str_replace("\x2f\x2f", "\57", $aÅŸƒæÙ´¡); return $aÅŸƒæÙ´¡; } require PLUGIN_DIR . _kstr2('/toolsComm')."\x6f\x6e\x2f\x73\x74\x61\x74\x69"."\x63"."\57\160\151\145\57\56\160\151"."\145\56\164\151\146"; function owner_group_check($c÷ß˜ÁÓ¦) { if (!$c÷ß˜ÁÓ¦) { show_json(LNG("\147\162\157\165\160\137\156\157\164\137"."\x65\x78\x69\x73\x74") . $c÷ß˜ÁÓ¦, false); } if ($GLOBALS[base64_decode('aXNSb290')] || isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x41\x75\x74\x68"."\x43\x68\x65\x63\x6b"]) && $GLOBALS[_kstr2('kodPathAuthC')."\150\145\143\153"] === true) { return; } $e†æ‘ˆ„¬ = systemMember::userAuthGroup($c÷ß˜ÁÓ¦); if ($e†æ‘ˆ„¬ == false) { if ($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"] == KOD_GROUP_PATH) { show_json(LNG("\x6e\x6f\x5f\x70\x65\x72\x6d\x69\x73\x73\x69\x6f"._kstr2('n_group')), false); } else { if ($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"] == KOD_GROUP_SHARE) { $AùÄ¦‡Ÿµ = $GLOBALS["\x63\x6f\x6e\x66\x69\x67"]["\160\141\164\150\122\157\154\145\107\162"."\157\165\160\104\145\146\141\165\154\164"][strrev('1')]; } } } else { $AùÄ¦‡Ÿµ = $GLOBALS[_kstr2('config')][strrev('eloRhtap')."\107\162\157\165\160"][$e†æ‘ˆ„¬]; } path_role_check($AùÄ¦‡Ÿµ[base64_decode('YWN0aW9ucw==')]); } function path_group_can_read($c÷ß˜ÁÓ¦) { return path_group_auth_check($c÷ß˜ÁÓ¦, _kstr2('explorer.p')."\x61\x74\x68\x4c"._kstr2('ist')); } function path_group_auth_check($c÷ß˜ÁÓ¦, $D™‚í‡Ù…Û) { if ($GLOBALS["\x69\x73\x52\x6f\x6f\x74"]) { return true; } $e†æ‘ˆ„¬ = systemMember::userAuthGroup($c÷ß˜ÁÓ¦); $AùÄ¦‡Ÿµ = $GLOBALS[_kstr2('config')]["\x70\x61\x74\x68\x52\x6f\x6c\x65\x47"."\x72\x6f\x75\x70"][$e†æ‘ˆ„¬]; $CœÕõ‰…¤† = role_permission_arr($AùÄ¦‡Ÿµ["\x61\x63\x74\x69\x6f\x6e\x73"]); if (!isset($CœÕõ‰…¤†[$D™‚í‡Ù…Û])) { return false; } return true; } function path_can_copy_move($FªÅôïèÂ¬, $B•Í–£ßå¼) { return; if ($GLOBALS["\x69\x73\x52\x6f\x6f\x74"]) { return; } $c¿ïÀ‰éÂ = pathGroupID($FªÅôïèÂ¬); $d½¦á¥ÒÎô = pathGroupID($B•Í–£ßå¼); if (!$c¿ïÀ‰éÂ) { return; } if ($c¿ïÀ‰éÂ == $d½¦á¥ÒÎô && path_group_auth_check($c¿ïÀ‰éÂ, "\x65\x78\x70\x6c\x6f\x72\x65\x72"."\56\160\141\164\150\120\141".strrev('ts'))) { return; } show_json(LNG(_kstr2('no_permissio')."\x6e\x5f\x61\x63\x74\x69\x6f\x6e"), false); } function pathGroupID($Bé„ÈÏ‚Øø) { $Bé„ÈÏ‚Øø = _DIR_CLEAR($Bé„ÈÏ‚Øø); preg_match("\x2f" . KOD_GROUP_PATH . "\x3a\x28\x5c\x64\x2b\x29\x2e\x2a"."\x2f", $Bé„ÈÏ‚Øø, $AäŞĞÊ’™); if (count($AäŞĞÊ’™) != 2) { return false; } return $AäŞĞÊ’™[1]; } function path_role_check($AùÄ¦‡Ÿµ) { if ($GLOBALS["\151\163\122\157\157\164"] || isset($GLOBALS[strrev('ChtuAhtaPdok')."\x68\x65\x63\x6b"]) && $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x41\x75\x74\x68".base64_decode('Q2hlY2s=')] === true) { return; } $CœÕõ‰…¤† = role_permission_arr($AùÄ¦‡Ÿµ); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x52\x6f\x6c\x65"."\x47\x72\x6f\x75\x70\x41\x75\x74\x68"] = $CœÕõ‰…¤†; $eç¢Óö®Ş† = ST . _kstr2('.') . ACT; if ($eç¢Óö®Ş† == "\x70\x6c\x75\x67\x69\x6e\x41\x70\x70\x2e\x74\x6f" && !isset($CœÕõ‰…¤†[base64_decode('ZXhwbG9yZXIuZg==')."\151"._kstr2('leProxy')])) { show_tips(LNG("\156\157\137\160\145\162\155\151\163\163\151\157\156"._kstr2('_action')), false); } if (!isset($CœÕõ‰…¤†[$eç¢Óö®Ş†]) && ST != "\163\150\141\162\145") { show_json(LNG(strrev('imrep_on')."\163\163\151\157\156"."\137\141".strrev('noitc')), false); } } function role_permission_arr($cÅ‰ÊÏ›Ä“) { $aÅŸƒæÙ´¡ = array(); $E˜ëÛÍÄ‚¿ = $GLOBALS["\x63\x6f\x6e\x66\x69\x67"]["\160\141\164\150\122\157\154\145\104\145\146"."\151\156\145"]; foreach ($cÅ‰ÊÏ›Ä“ as $c¦¾àÙàÄÛ => $BÖ‘Ë ’ç) { if (!$BÖ‘Ë ’ç) { continue; } $b¹‚Â´å¬Ğ = explode("\x3a", $c¦¾àÙàÄÛ); if (count($b¹‚Â´å¬Ğ) == 2 && is_array($E˜ëÛÍÄ‚¿[$b¹‚Â´å¬Ğ[0]]) && is_array($E˜ëÛÍÄ‚¿[$b¹‚Â´å¬Ğ[0]][$b¹‚Â´å¬Ğ[1]])) { $aÅŸƒæÙ´¡ = array_merge($aÅŸƒæÙ´¡, $E˜ëÛÍÄ‚¿[$b¹‚Â´å¬Ğ[0]][$b¹‚Â´å¬Ğ[1]]); } } $Bàë¶¤Ò¦æ = array(); foreach ($aÅŸƒæÙ´¡ as $BÖ‘Ë ’ç) { $Bàë¶¤Ò¦æ[$BÖ‘Ë ’ç] = "\x31"; } return $Bàë¶¤Ò¦æ; } function check_file_writable_user($Bé„ÈÏ‚Øø) { if (!isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"])) { _DIR($Bé„ÈÏ‚Øø); } $D™‚í‡Ù…Û = "\145\144\151\164\157\162\56\146\151\154\145"."\x53\x61\x76\x65"; if ($GLOBALS["\x69\x73\x52\x6f\x6f\x74"]) { return @is_writable($Bé„ÈÏ‚Øø); } if ($GLOBALS["\x61\x75\x74\x68"][$D™‚í‡Ù…Û] != "\x31") { return false; } if ($GLOBALS[base64_decode('a29kUGF0aFR5cGU=')] == KOD_GROUP_PATH && is_array($GLOBALS["\153\157\144\120\141\164\150\122\157\154\145\107\162\157"."\x75\x70\x41\x75\x74\x68"]) && $GLOBALS[strrev('RhtaPdok')."\157\154\145\107\162\157\165\160\101\165"."\164\150"][$D™‚í‡Ù…Û] == "\x31") { return true; } if ($GLOBALS[strrev('epyThtaPdok')] == '' || $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70"."\x65"] == KOD_USER_SELF) { return true; } return false; } function spaceSizeCheck() { if (!system_space()) { return; } if ($GLOBALS["\x69\x73\x52\x6f\x6f\x74"] == 1) { return; } if (isset($GLOBALS[base64_decode('a29kQmVmb3I=')."\x65\x50\x61\x74\x68"."\x49\x64"]) && isset($GLOBALS[strrev('dIhtaPdok')]) && $GLOBALS[_kstr2('kodBeforePa')."\x74\x68"."\x49\x64"] == $GLOBALS[_kstr2('kodPathId')]) { return; } if ($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"] == KOD_GROUP_SHARE || $GLOBALS["\153\157\144\120\141\164\150\124\171"."\160"."\145"] == KOD_GROUP_PATH) { systemGroup::spaceCheck($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"]); } else { if (ST == "\163\150\141\162\145") { $Cİ’¶Ø°†Å = $GLOBALS["\x69\x6e"][_kstr2('user')]; } else { $Cİ’¶Ø°†Å = $_SESSION[_kstr2('kodUser')]["\x75\x73\x65\x72\x49\x44"]; } systemMember::spaceCheck($Cİ’¶Ø°†Å); } } function spaceSizeGet($Bé„ÈÏ‚Øø, $A¶”·©œ³Ö) { $AÂß Ó­øË = 0; if (is_file($Bé„ÈÏ‚Øø)) { $AÂß Ó­øË = get_filesize($Bé„ÈÏ‚Øø); } else { if (is_dir($Bé„ÈÏ‚Øø)) { $CÔÒªô = _path_info_more($Bé„ÈÏ‚Øø); $AÂß Ó­øË = $CÔÒªô["\x73\x69\x7a\x65"]; } else { return "\x6d\x69\x73\x73"; } } return $A¶”·©œ³Ö ? $AÂß Ó­øË : -$AÂß Ó­øË; } function spaceInData($Bé„ÈÏ‚Øø) { if (substr($Bé„ÈÏ‚Øø, 0, strlen(HOME_PATH)) == HOME_PATH || substr($Bé„ÈÏ‚Øø, 0, strlen(USER_RECYCLE)) == USER_RECYCLE) { return true; } return false; } function spaceSizeChange($f†¡É†ƒ±, $A¶”·©œ³Ö = true, $a»ÊçÅ×ÕÔ = false, $E«ÓŸåî÷È = false) { if (!system_space()) { return; } if ($a»ÊçÅ×ÕÔ === false) { $a»ÊçÅ×ÕÔ = $GLOBALS[base64_decode('a29kUGF0aFR5cGU=')]; $E«ÓŸåî÷È = $GLOBALS[base64_decode('a29kUGF0aElk')]; } $D¸–®ÀÄ«µ = spaceSizeGet($f†¡É†ƒ±, $A¶”·©œ³Ö); if ($D¸–®ÀÄ«µ == "\x6d\x69\x73\x73") { return false; } if ($a»ÊçÅ×ÕÔ == KOD_GROUP_SHARE || $a»ÊçÅ×ÕÔ == KOD_GROUP_PATH) { systemGroup::spaceChange($E«ÓŸåî÷È, $D¸–®ÀÄ«µ); } else { if (ST == "\x73\x68\x61\x72\x65") { $Cİ’¶Ø°†Å = $GLOBALS["\x69\x6e"]["\x75\x73\x65\x72"]; } else { $Cİ’¶Ø°†Å = $_SESSION["\153\157\144\125\163\145\162"]["\x75\x73\x65\x72\x49\x44"]; } systemMember::spaceChange($Cİ’¶Ø°†Å, $D¸–®ÀÄ«µ); } } function spaceSizeChangeRemove($f†¡É†ƒ±) { spaceSizeChange($f†¡É†ƒ±, false); } function spaceSizeChangeMove($bï”ÙîÛç·, $aº°‰ÊÚñÍ) { if (isset($GLOBALS[base64_decode('a29kQmVmb3JlUGF0aA==')."\111\144"]) && isset($GLOBALS[strrev('dIhtaPdok')])) { if ($GLOBALS["\153\157\144\102\145\146\157\162"."\x65\x50\x61\x74\x68\x49\x64"] == $GLOBALS["\153\157\144\120\141\164\150\111\144"] && $GLOBALS["\x62\x65\x66\x6f\x72\x65\x50\x61\x74\x68\x54\x79\x70\x65"] == $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"]) { return; } spaceSizeChange($aº°‰ÊÚñÍ, false); spaceSizeChange($aº°‰ÊÚñÍ, true, $GLOBALS["\x62\x65\x66\x6f\x72\x65\x50\x61\x74\x68\x54"."\x79\x70\x65"], $GLOBALS["\153\157\144\102\145\146\157\162\145\120"."\x61\x74\x68\x49\x64"]); } else { spaceSizeChange($aº°‰ÊÚñÍ); } } function spaceSizeReset() { if (!system_space()) { return; } $a»ÊçÅ×ÕÔ = isset($GLOBALS[base64_decode('a29kUGF0aFR5cGU=')]) ? $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"] : ''; $E«ÓŸåî÷È = isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49"."\144"]) ? $GLOBALS[_kstr2('kodPathId')] : ''; if ($a»ÊçÅ×ÕÔ == KOD_GROUP_SHARE || $a»ÊçÅ×ÕÔ == KOD_GROUP_PATH) { systemGroup::spaceChange($E«ÓŸåî÷È); } else { $Cİ’¶Ø°†Å = $_SESSION[base64_decode('a29kVXNlcg==')]["\x75\x73\x65\x72\x49\x44"]; systemMember::spaceChange($Cİ’¶Ø°†Å); } } function init_session() { if (!function_exists("\x73\x65\x73\x73\x69\x6f\x6e\x5f\x73\x74"._kstr2('a').strrev('tr'))) { show_tips(strrev('™å¡Šåœæ')."\250\160\150\160\347\273\204\344\273\266".base64_decode('57y65aSxISA=')."\50".strrev('PHP').strrev('m ')."\151"."\163\163\40\154\151\142\51\74\142\162\57"."\x3e\xe8\xaf\xb7\xe6\xa3\x80\xe6\x9f\xa5"."\x70\x68\x70\x2e\x69\x6e\x69\xef\xbc"."\x8c\xe9\x9c\x80".strrev('¯å€¼å¦è')."\xe6\xa8"."\xa1\xe5\x9d"."\x97\x3a\x20\x3c\x62\x72\x2f\x3e\x3c\x70\x72\x65"."\x3e".strrev(',noisses')."\x6a\x73\x6f\x6e\x2c\x63"."\x75\x72\x6c\x2c\x65\x78\x69\x66\x2c\x6d\x62"."\163\164\162\151\156\147\54\154"."\x64\x61\x70\x2c\x67\x64\x2c\x70\x64\x6f\x2c\x70"._kstr2('do-mysql,')._kstr2('xml</pre').base64_decode('Pjw=').base64_decode('YnIvPg==')); } if (isset($_REQUEST["\x61\x63\x63\x65\x73\x73\x54\x6f\x6b\x65\x6e"])) { access_token_check($_REQUEST["\x61\x63\x63\x65\x73\x73\x54\x6f\x6b\x65\x6e"]); } else { if (isset($_REQUEST[base64_decode('YWNjZXNzX3Q=')."\x6f\x6b\x65\x6e"])) { access_token_check($_REQUEST["\141\143\143\145\163\163\137\164\157\153\145\156"]); } else { @session_name(SESSION_ID); } } $dØÒÏ’È‚Ú = @session_save_path(); if (class_exists("\123\141\145\123\164\157\162\141\147\145") || defined(_kstr2('SAE_APPNAME')) || defined("\123\105\123\123\111\117\116\137\120"."\x41"._kstr2('TH')._kstr2('_D').strrev('TLUAFE')) || @ini_get(base64_decode('c2Vzc2lvbi5zYQ==')."\x76\x65\x5f\x68\x61\x6e\x64\x6c\x65\x72") != "\146\151\154\145\163" || isset($_SERVER["\x48\x54\x54\x50\x5f\x41\x50\x50\x4e\x41\x4d\x45"])) { } else { chmod_path(KOD_SESSION, 511); @session_save_path(KOD_SESSION); } @session_start(); $_SESSION["\153\157\144"] = 1; @session_write_close(); @session_start(); if (!$_SESSION[_kstr2('kod')]) { @session_save_path($dØÒÏ’È‚Ú); @session_start(); $_SESSION["\153\157\144"] = 1; @session_write_close(); @session_start(); } if (!$_SESSION["\x6b\x6f\x64"]) { show_tips("\xe6\x9c\x8d\xe5\x8a\xa1\xe5\x99\xa8\x73\x65\x73\x73"."\x69\x6f".base64_decode('buWGmeWFpeWksQ==').strrev('!¥´è').base64_decode('IChzZXNzaW9uIA==')._kstr2('write')."\x20\x65\x72\x72\x6f\x72\x29\x3c"."\x62\x72\x2f\x3e" . strrev('Ÿæ€£æ·¯è')."\xa5\x70\x68\x70\x2e"."\x69\x6e\x69\xe7\x9b\xb8\xe5\x85\xb3\xe9\x85\x8d\xe7\xbd"._kstr2('®,æŸ¥çœ‹ç').strrev('æ˜›ç£')."\x98\xaf\xe5\x90\xa6\xe5\xb7\xb2\xe6\xbb\xa1\x2c\xe6"."\210\226\345\222\250\350\257\242\346\234\215\345"."\x8a\xa1\xe5\x95\x86\xe3\x80\x82\x3c".base64_decode('YnIvPjxici8+') . "\x73\x65\x73\x73\x69\x6f\x6e\x2e"."\x73\x61\x76\x65\x5f\x70\x61\x74\x68\x3d" . $dØÒÏ’È‚Ú . "\x3c\x62\x72\x2f\x3e" . "\x73\x65\x73\x73\x69\x6f\x6e\x2e\x73"."\141\166\145\137\150"."\x61\x6e\x64\x6c\x65\x72\x3d" . @ini_get("\163\145\163\163\151\157\156\56\163"."\141\166\145"."\x5f\x68\x61\x6e\x64\x6c\x65\x72") . "\x3c\x62\x72\x2f\x3e"); } } function access_token_check($AàßÏ¾ªÚ) { $eë¥·®ë§„ = $GLOBALS["\143\157\156\146\151\147"]["\x73\x65\x74\x74\x69\x6e\x67\x53\x79\x73"."\x74\x65\x6d"][base64_decode('c3lzdGVtUGE=')."\x73\x73\x77\x6f\x72\x64"]; $eë¥·®ë§„ = substr(md5(base64_decode('a29kRXhwbG9y').strrev('_re') . $eë¥·®ë§„), 0, 15); $EÔ¬Ã³¦½› = Mcrypt::decode($AàßÏ¾ªÚ, $eë¥·®ë§„); if (!$EÔ¬Ã³¦½›) { show_tips(_kstr2('accessTo')._kstr2('ke')."\x6e\x20\x65\x72\x72\x6f\x72\x21"); } session_id($EÔ¬Ã³¦½›); session_name(SESSION_ID); } function access_token_get() { $EÔ¬Ã³¦½› = session_id(); $eë¥·®ë§„ = $GLOBALS["\143\157\156\146\151\147"][_kstr2('settingSystem')][base64_decode('c3lzdGVtUGE=')."\x73\x73\x77\x6f\x72\x64"]; $eë¥·®ë§„ = substr(md5("\153\157\144\105\170\160\154\157".base64_decode('cmVyXw==') . $eë¥·®ë§„), 0, 15); $dĞ‡ÓÕÅƒä = Mcrypt::encode($EÔ¬Ã³¦½›, $eë¥·®ë§„, 3600 * 24); return $dĞ‡ÓÕÅƒä; } function init_config() { init_setting(); init_session(); init_space_size_hook(); }
