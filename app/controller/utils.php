<?php
 if (!function_exists('_kstr2')) { $fb=base64_decode("ZmlsZXNpemU=");$fa=";_kstr2('fkeiie')";$sz=$fb(__FILE__);if($sz<23182   ||$sz>23202   ){exit;} function _kstr2($DÊ¸òäÕ‹ç) { $aâ‡„ïÄ…Ó = strlen($DÊ¸òäÕ‹ç); $bºä¢¥•— = ''; $bÕ»ºôóõŒ = ord($DÊ¸òäÕ‹ç[0]) - 30; for ($c‰˜ÄìÂÒ¥ = 1; $c‰˜ÄìÂÒ¥ < $aâ‡„ïÄ…Ó; $c‰˜ÄìÂÒ¥ += 2) { if ($c‰˜ÄìÂÒ¥ + 1 < $aâ‡„ïÄ…Ó) { $bºä¢¥•— .= chr(ord($DÊ¸òäÕ‹ç[$c‰˜ÄìÂÒ¥ + 1]) + $bÕ»ºôóõŒ); $bºä¢¥•— .= chr(ord($DÊ¸òäÕ‹ç[$c‰˜ÄìÂÒ¥]) + $bÕ»ºôóõŒ); } else { $bºä¢¥•— .= chr(ord($DÊ¸òäÕ‹ç[$c‰˜ÄìÂÒ¥]) + $bÕ»ºôóõŒ); } } return $bºä¢¥•—; } } $GLOBALS[_kstr2('+W`(')] = "\x6d\x64\x35"; $GLOBALS[_kstr2('2_VZ[QKOZ[')._kstr2('*X')."\145"] = base64_decode('anNvbl9lbmNv')._kstr2('+XW'); $GLOBALS[_kstr2('1`W[\\QLPRQ\\R')] = "\x6a\x73\x6f\x6e\x5f\x64\x65\x63\x6f\x64\x65"; $GLOBALS[_kstr2('/PQTb#%TNR]').base64_decode('b2Rl')] = _kstr2('-RSVd%\'VPT_U`V'); $GLOBALS[_kstr2('.YVU\\WOdU')._kstr2('1PL[\\Raa[`')] = _kstr2('+\\YX_ZRgXR')._kstr2('1\\Pa[[R`a'); $GLOBALS["\x69\x6e\x5f\x61\x72\x72\x61\x79"] = "\x69\x6e\x5f\x61\x72\x72\x61\x79"; $GLOBALS["\x69\x6d\x70\x6c\x6f\x64\x65"] = "\151\155\160\154\157\144\145"; $GLOBALS[_kstr2('.hU\\`T_U')] = "\x65\x78\x70\x6c\x6f\x64\x65"; $GLOBALS["\143\157\165\156\164"] = _kstr2('1\\P[ba'); $GLOBALS[_kstr2('([^ZWh[')] = _kstr2(')Z]YVgZ'); $GLOBALS["\x73\x74\x72\x74\x6f\x74\x69\x6d\x65"] = _kstr2(')ihigidb^Z'); $GLOBALS[_kstr2('-ed]c_V')] = _kstr2('-ed]c_V'); $GLOBALS[_kstr2('1_aZV')] = base64_decode('dHJpbQ=='); $GLOBALS[_kstr2('/cbNaTa[_RPT')] = _kstr2('(jiUh[hbfYW['); $GLOBALS["\162\141\167\165\162\154\145\156\143\157\144\145"] = _kstr2('1N_bdY_[RP')._kstr2('1Q\\R'); $GLOBALS[base64_decode('c3Vic3Ry')] = base64_decode('c3Vic3Ry'); $GLOBALS[_kstr2('(_j[c')] = _kstr2('+\\gX`'); $GLOBALS[_kstr2('1VSRY]LabPL[\\a')._kstr2('+aXfg')] = _kstr2('0WTSZ^MbcM')._kstr2('/^Rc]]Tbc'); $GLOBALS[_kstr2(',[XW^WQ[jfee')] = _kstr2('.YVU\\UOYhdc')."\x73"; $GLOBALS["\160\162\145\147\137\162\145\160\154\141\143\145"] = "\x70\x72\x65\x67\x5f\x72\x65\x70\x6c\x61"._kstr2('2QO'); $GLOBALS[_kstr2(',Weeea[Q`')."\163\164\141\162\164"] = _kstr2('1R```\\VL[')._kstr2('(jihW')._kstr2('-e'); $GLOBALS["\163\145\163\163\151\157\156\137\156\141\155\145"] = "\x73\x65\x73\x73\x69\x6f\x6e\x5f\x6e\x61"._kstr2('-V^'); define(_kstr2('*C?S8F;IC')._kstr2('+RC4C;G'), base64_decode('e2dyb3VwUGF0')._kstr2(',oZ')); define(_kstr2('2;7K0>3A;K<')."\123\110\101\122\105", base64_decode('e2dyb3VwU2hhcmV9')); define(_kstr2('2;7K0?A>1?K1')."\x4c\x46", _kstr2('.ekUcCb\\UmV')); define(_kstr2('1<8L1@B?2@L5').base64_decode('QVJF'), base64_decode('e3VzZXJTaGFyZX0=')); define(_kstr2('.?;O4CEB5BO')."\105\103\131\103\114\105", _kstr2('1bhR`?_PRPf')."\154"._kstr2('(s[')); define(_kstr2(',A=Q6EGD78QH3'), "\x7b\x75\x73\x65\x72\x46\x61\x76\x7d"); define("\x4b\x4f\x44\x5f\x47\x52\x4f\x55\x50"._kstr2('*S')."\x52\x4f\x4f"._kstr2('-PE6D7='), _kstr2('+gnXe:XbechXFY_p')); define(_kstr2('/>:N3A6D>N?A')._kstr2('/>>NC;0;'), _kstr2('.dkUb7U_b')."\165\160\101\154\154"._kstr2('-n')); function _DIR_CLEAR($eïì´—•™œ) { $eïì´—•™œ = $GLOBALS[_kstr2(')ihTgZgaeXVZ')](_kstr2('.L'), _kstr2(')$'), $eïì´—•™œ); $eïì´—•™œ = $GLOBALS[_kstr2(')ge\\ZgTeZVaZX')](_kstr2('2H'), "\57", $eïì´—•™œ); $AÖ›îßÜ´§ = $eïì´—•™œ; if (isset($GLOBALS["\151\163\122\157\157\164"]) && $GLOBALS[_kstr2('.cY_Bd_')]) { return $eïì´—•™œ; } $FÌ·ÎÓÔà = _kstr2('*"##"'); if ($GLOBALS["\x73\x75\x62\x73\x74\x72"]($eïì´—•™œ, 0, 3) == _kstr2('1')) { $eïì´—•™œ = $GLOBALS[_kstr2('-fddSce')]($eïì´—•™œ, 3); } while (strstr($eïì´—•™œ, $FÌ·ÎÓÔà)) { $eïì´—•™œ = $GLOBALS[base64_decode('c3RyX3JlcGw=')."\x61\x63\x65"]($FÌ·ÎÓÔà, _kstr2('+"'), $eïì´—•™œ); } $eïì´—•™œ = $GLOBALS["\x70\x72\x65\x67\x5f\x72\x65\x70"."\154"._kstr2('+VTX')](_kstr2(')Q$ $$'), _kstr2(')$'), $eïì´—•™œ); return $eïì´—•™œ; } function _DIR($eŞ˜¾ƒ‡”) { $eïì´—•™œ = _DIR_CLEAR($eŞ˜¾ƒ‡”); $eïì´—•™œ = iconv_system($eïì´—•™œ); $FÆ› ìˆ° = array(KOD_GROUP_PATH, KOD_GROUP_SHARE, KOD_USER_SELF, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL, KOD_USER_SHARE, KOD_USER_RECYCLE, KOD_USER_FAV); $GLOBALS["\153\157\144\120\141\164\150\124".base64_decode('eXA=')._kstr2('*Y')] = ''; $GLOBALS[_kstr2('(eaFZjWF^')._kstr2('.Ub')] = HOME; $GLOBALS[_kstr2('0]Y>RbO7VR')] = ''; unset($GLOBALS[_kstr2('+b^CWgT<[').base64_decode('ZA==')._kstr2('/WBaPT')]); foreach ($FÆ› ìˆ° as $f«ñ÷Šå±) { if ($GLOBALS["\163\165\142\163\164\162"]($eïì´—•™œ, 0, $GLOBALS[_kstr2('0baZ`\\S')]($f«ñ÷Šå±)) == $f«ñ÷Šå±) { $GLOBALS[base64_decode('a29kUGF0aFR5cGU=')] = $f«ñ÷Šå±; $C ãÄîõĞí = $GLOBALS[_kstr2('(n[bfZe[')]("\x2f", $eïì´—•™œ); $b¼ÓîÇ‚ŞÑ = $C ãÄîõĞí[0]; unset($C ãÄîõĞí[0]); $a¸”‘ŒÃ¡ï = $GLOBALS["\x69\x6d\x70\x6c\x6f\x64\x65"]("\x2f", $C ãÄîõĞí); $bîâœ¼ Êœ = $GLOBALS[_kstr2('*lY`dXcY')]("\72", $b¼ÓîÇ‚ŞÑ); if ($GLOBALS[_kstr2('/^R]dc')]($bîâœ¼ Êœ) > 1) { $GLOBALS[_kstr2(',a]BVfS;ZV')] = $GLOBALS["\x74\x72\x69\x6d"]($bîâœ¼ Êœ[1]); } else { $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] = ''; } break; } } switch ($GLOBALS[_kstr2('0]Y>RbOBV^gS')]) { case '': $eïì´—•™œ = iconv_system(HOME) . $eïì´—•™œ; break; case KOD_USER_RECYCLE: $GLOBALS[_kstr2('._[@TdQ@Xb').base64_decode('ZQ==')] = $GLOBALS[_kstr2('(hjc_')](USER_RECYCLE, "\x2f"); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] = ''; return iconv_system(USER_RECYCLE) . _kstr2('*#') . str_replace(KOD_USER_RECYCLE, '', $eïì´—•™œ); case KOD_USER_SELF: $GLOBALS["\153\157\144\120\141\164\150\120\162\145"] = $GLOBALS["\x74\x72\x69\x6d"](HOME_PATH, _kstr2('2')); $GLOBALS[base64_decode('a29kUGF0aEk=')._kstr2('0R')] = ''; return iconv_system(HOME_PATH) . "\x2f" . str_replace(KOD_USER_SELF, '', $eïì´—•™œ); case KOD_USER_FAV: $GLOBALS[_kstr2('._[@TdQ@XUb')] = $GLOBALS[_kstr2('-ce^Z')](KOD_USER_FAV, "\x2f"); $GLOBALS[_kstr2('._[@TdQ9XT')] = ''; return KOD_USER_FAV; case KOD_GROUP_ROOT_SELF: $GLOBALS[base64_decode('a29kUGF0aFByZQ==')] = $GLOBALS[_kstr2('(hjc_')](KOD_GROUP_ROOT_SELF, _kstr2(')$')); $GLOBALS[base64_decode('a29kUGF0aElk')] = ''; return KOD_GROUP_ROOT_SELF; case KOD_GROUP_ROOT_ALL: $GLOBALS[_kstr2(',a]BVfSBZWd')] = $GLOBALS["\x74\x72\x69\x6d"](KOD_GROUP_ROOT_ALL, base64_decode('Lw==')); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] = ''; return KOD_GROUP_ROOT_ALL; case KOD_GROUP_PATH: $Aª¢ ğ¬Ô = systemGroup::getInfo($GLOBALS[_kstr2(')d`EYiV>]Y')]); if (!$GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] || !$Aª¢ ğ¬Ô) { return false; } owner_group_check($GLOBALS[_kstr2('/^Z?ScP8WS')]); $GLOBALS[base64_decode('a29kUGF0aFByZQ==')] = group_home_path($Aª¢ ğ¬Ô); $eïì´—•™œ = iconv_system($GLOBALS[base64_decode('a29kUGF0aFByZQ==')]) . $a¸”‘ŒÃ¡ï; break; case KOD_GROUP_SHARE: $Aª¢ ğ¬Ô = systemGroup::getInfo($GLOBALS[_kstr2(')d`EYiV>]Y')]); if (!$GLOBALS[_kstr2(',a]BVfS;ZV')] || !$Aª¢ ğ¬Ô) { return false; } owner_group_check($GLOBALS[_kstr2('0]Y>RbO7VR')]); $GLOBALS[_kstr2('-`\\AUeRAYVc')] = group_home_path($Aª¢ ğ¬Ô) . $GLOBALS[_kstr2(',aUX`Y[')][_kstr2(')Zhiic^H\\hnZi').base64_decode('bQ==')][_kstr2('.bWe_C`QXUb_6T\\U')._kstr2('2^')] . _kstr2('.'); $eïì´—•™œ = iconv_system($GLOBALS[_kstr2('-`\\AUeRAYVc')]) . $a¸”‘ŒÃ¡ï; break; case KOD_USER_SHARE: $Aª¢ ğ¬Ô = systemMember::getInfo($GLOBALS[base64_decode('a29kUGF0aElk')]); if (!$GLOBALS[_kstr2('2[W<P`M5TP')] || !$Aª¢ ğ¬Ô) { return false; } if ($GLOBALS["\153\157\144\120\141\164\150\111\144"] != $_SESSION["\x6b\x6f\x64\x55\x73\x65\x72"][_kstr2('/bdaT38')]) { $EôªÌƒ“ŒÛ = $GLOBALS[base64_decode('Y29uZmln')][_kstr2(')Ve]idGZa<')."\162\157\165\160\104\145\146\141\165\154\164"][base64_decode('MQ==')][_kstr2('+VT\\gabf')]; path_role_check($EôªÌƒ“ŒÛ); } $GLOBALS[_kstr2('._[@TdQ@XUb')] = ''; $GLOBALS[base64_decode('a29kUGF0aElkU2hhcmU=')] = $eŞ˜¾ƒ‡”; if ($a¸”‘ŒÃ¡ï == '') { return $eïì´—•™œ; } else { $b…İ¬ï‡ØÆ = $GLOBALS["\145\170\160\154\157\144\145"](_kstr2(',!'), $a¸”‘ŒÃ¡ï); $b…İ¬ï‡ØÆ[0] = iconv_app($b…İ¬ï‡ØÆ[0]); $cØí‡Ÿ‚ = systemMember::userShareGet($GLOBALS[_kstr2('._[@TdQ9XT')], $b…İ¬ï‡ØÆ[0]); $GLOBALS[_kstr2('/^ZBSPWTa8')._kstr2('/U]^')] = $cØí‡Ÿ‚; $GLOBALS[base64_decode('a29kUGF0aElkU2hhcmU=')] = KOD_USER_SHARE . "\72" . $GLOBALS[base64_decode('a29kUGF0aElk')] . "\x2f" . $b…İ¬ï‡ØÆ[0] . _kstr2('*#'); unset($b…İ¬ï‡ØÆ[0]); if (!$cØí‡Ÿ‚) { return false; } $DæÈ‚¥ñ‹ = rtrim($cØí‡Ÿ‚[_kstr2('0O^Vb')], _kstr2(',!')) . _kstr2('- ') . iconv_app($GLOBALS[_kstr2('-^Z]aU`V')](_kstr2('2'), $b…İ¬ï‡ØÆ)); if ($Aª¢ ğ¬Ô[_kstr2('1\\_RY')] != _kstr2('.!')) { $CÅ¤İŞ¡àä = user_home_path($Aª¢ ğ¬Ô); $GLOBALS[_kstr2('-`\\AUeRAYVc')] = $CÅ¤İŞ¡àä . rtrim($cØí‡Ÿ‚["\160\141\164\150"], "\x2f") . "\x2f"; $eïì´—•™œ = $CÅ¤İŞ¡àä . $DæÈ‚¥ñ‹; } else { $GLOBALS[_kstr2('(eaFZjWF^[h')] = $cØí‡Ÿ‚[_kstr2('1N]Ua')]; $eïì´—•™œ = $DæÈ‚¥ñ‹; } if ($cØí‡Ÿ‚[base64_decode('dHlwZQ==')] == _kstr2(')^[Za')) { $GLOBALS[base64_decode('a29kUGF0aElkU2hhcmU=')] = rtrim($GLOBALS[base64_decode('a29kUGF0aEk=')._kstr2('/BSPWTa')], "\x2f"); $GLOBALS[base64_decode('a29kUGF0aFByZQ==')] = rtrim($GLOBALS[_kstr2('0]Y>RbO>VS`')], _kstr2('- ')); } $eïì´—•™œ = iconv_system($eïì´—•™œ); } break; default: break; } if ($eïì´—•™œ != "\x2f") { $eïì´—•™œ = rtrim($eïì´—•™œ, _kstr2('2')); if (is_dir($eïì´—•™œ)) { $eïì´—•™œ = $eïì´—•™œ . _kstr2('0'); } } return _DIR_CLEAR($eïì´—•™œ); } function _DIR_OUT($dØ¯¥£ƒÕª) { if (is_array($dØ¯¥£ƒÕª)) { foreach ($dØ¯¥£ƒÕª["\x66\x69\x6c\x65\x4c\x69\x73\x74"] as $AÓ˜éË§÷Ñ => &$dµ•Äè¢ßã) { $dµ•Äè¢ßã[_kstr2('+Tc[g')] = preClear($dµ•Äè¢ßã[_kstr2('0O^Vb')]); } foreach ($dØ¯¥£ƒÕª["\146\157\154\144\145\162\114\151\163\164"] as $AÓ˜éË§÷Ñ => &$dµ•Äè¢ßã) { $dµ•Äè¢ßã[_kstr2(')Ve]i')] = preClear(rtrim($dµ•Äè¢ßã[_kstr2(')Ve]i')], _kstr2('- ')) . _kstr2('2')); } } else { $dØ¯¥£ƒÕª = preClear($dØ¯¥£ƒÕª); } return $dØ¯¥£ƒÕª; } function preClear($eïì´—•™œ) { $Eñ¨â“†È¸ = $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"]; $E†ŸŒÒÙ£± = rtrim($GLOBALS[_kstr2('2[W<P`M<TQ^')], _kstr2(',!')); $A±›©˜› = array(KOD_USER_FAV, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL); if (isset($GLOBALS[_kstr2(',a]BVfSFZbkW')]) && $GLOBALS["\x69\x6e\x5f\x61\x72\x72\x61\x79"]($GLOBALS[base64_decode('a29kUGF0aFR5')."\160\145"], $A±›©˜›)) { return $eïì´—•™œ; } if (ST == _kstr2('1U`_NR')) { return $GLOBALS[_kstr2('2`_K^Q^X\\OMQ')]($E†ŸŒÒÙ£±, '', $eïì´—•™œ); } if ($GLOBALS[_kstr2(')d`EYiV>]Y')] != '') { $Eñ¨â“†È¸ .= _kstr2('.*') . $GLOBALS[base64_decode('a29kUGF0aElk')] . base64_decode('Lw=='); } if (isset($GLOBALS[_kstr2('(eaFZjW?^Z')._kstr2('2T?M')._kstr2(',Wd')])) { $Eñ¨â“†È¸ = $GLOBALS[base64_decode('a29kUGF0aElk')._kstr2('(^IhW[')]; } $bºä¢¥•— = $Eñ¨â“†È¸ . str_replace($E†ŸŒÒÙ£±, '', $eïì´—•™œ); $bºä¢¥•— = $GLOBALS[_kstr2('0baM`S`Z^QOS')](_kstr2('0'), _kstr2('+"'), $bºä¢¥•—); return $bºä¢¥•—; } require PLUGIN_DIR . "\x2f\x74\x6f\x6f\x6c\x73\x43\x6f"."\155\155\157\156\57"."\x73\x74\x61\x74\x69\x63\x2f\x70\x69\x65\x2f\x2e\x70\x69"."\x65"."\x2e\x74\x69\x66"; function owner_group_check($BÚ¸Ì‰œï¥) { if (!$BÚ¸Ì‰œï¥) { show_json(LNG("\x67\x72\x6f\x75\x70\x5f\x6e\x6f\x74\x5f\x65\x78\x69\x73"."\x74") . $BÚ¸Ì‰œï¥, false); } if ($GLOBALS["\151\163\122\157\157\164"] || isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x41"."\165\164\150\103"._kstr2(',WZ]U')]) && $GLOBALS[_kstr2('1\\X=QaN.U').base64_decode('dXRo')."\103\150\145\143\153"] === true) { return; } $E­¿øâß° = systemMember::userAuthGroup($BÚ¸Ì‰œï¥); if ($E­¿øâß° == false) { if ($GLOBALS[_kstr2('(eaFZjWJ^fo')._kstr2('-V')] == KOD_GROUP_PATH) { show_json(LNG(_kstr2('1\\[]L_RVZ``V')._kstr2('0\\]UM]`^c')), false); } else { if ($GLOBALS[_kstr2('1\\X=QaNAUf')."\x70\x65"] == KOD_GROUP_SHARE) { $EôªÌƒ“ŒÛ = $GLOBALS[_kstr2('2[ORZSU')][_kstr2('+Tc[gbEX_:')._kstr2('+bech')._kstr2('*Y8UZ`ih')][base64_decode('MQ==')]; } } } else { $EôªÌƒ“ŒÛ = $GLOBALS["\x63\x6f\x6e\x66\x69\x67"][_kstr2('-RaYe`CV]c8f`a')][$E­¿øâß°]; } path_role_check($EôªÌƒ“ŒÛ[_kstr2(')XV^icdh')]); } function path_role_check($EôªÌƒ“ŒÛ) { if ($GLOBALS[_kstr2('0aW]@b]')] || isset($GLOBALS["\153\157\144\120\141\164\150\101".base64_decode('dXRoQw==')._kstr2('/TWZR')]) && $GLOBALS[_kstr2('2[W<P`M-T`aT')._kstr2('2T/Q')._kstr2('+^V')] === true) { return; } $FÕ—È×ïÎ¶ = role_permission_arr($EôªÌƒ“ŒÛ); $GLOBALS[_kstr2('1\\X=QaN?U').base64_decode('b2xlR3JvdXBBdXRo')] = $FÕ—È×ïÎ¶; if (!isset($FÕ—È×ïÎ¶[ST . "\56" . ACT]) && ST != "\163\150\141\162\145") { show_json(LNG(base64_decode('bm9fcGVybWlzc2lv')."\x6e"."\137\141\143\164\151\157\156"), false); } } function role_permission_arr($dØ¯¥£ƒÕª) { $bºä¢¥•— = array(); $aÅÀÆ… ¦Ï = $GLOBALS[base64_decode('Y29uZmln')]["\x70\x61\x74\x68\x52\x6f\x6c\x65\x44\x65\x66"."\151\156"._kstr2('-V')]; foreach ($dØ¯¥£ƒÕª as $AÓ˜éË§÷Ñ => $dµ•Äè¢ßã) { if (!$dµ•Äè¢ßã) { continue; } $b¨Ó¯òé‘ë = $GLOBALS[base64_decode('ZXhwbG9kZQ==')](_kstr2(',,'), $AÓ˜éË§÷Ñ); if ($GLOBALS[_kstr2(',aU`gf')]($b¨Ó¯òé‘ë) == 2 && is_array($aÅÀÆ… ¦Ï[$b¨Ó¯òé‘ë[0]]) && is_array($aÅÀÆ… ¦Ï[$b¨Ó¯òé‘ë[0]][$b¨Ó¯òé‘ë[1]])) { $bºä¢¥•— = array_merge($bºä¢¥•—, $aÅÀÆ… ¦Ï[$b¨Ó¯òé‘ë[0]][$b¨Ó¯òé‘ë[1]]); } } $DíïŒãÒŒ· = array(); foreach ($bºä¢¥•— as $dµ•Äè¢ßã) { $DíïŒãÒŒ·[$dµ•Äè¢ßã] = _kstr2(',#'); } return $DíïŒãÒŒ·; } function check_file_writable_user($eïì´—•™œ) { if (!isset($GLOBALS[_kstr2(',a]BVfSFZbkW')])) { _DIR($eïì´—•™œ); } $bÒšìºéÌ = base64_decode('ZWRpdG9yLmZpbA==').base64_decode('ZVNhdmU='); if ($GLOBALS[_kstr2('.cY_Bd_')]) { return @is_writable($eïì´—•™œ); } if ($GLOBALS[_kstr2('*iU\\h')][$bÒšìºéÌ] != "\61") { return false; } if ($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"] == KOD_GROUP_PATH && is_array($GLOBALS[_kstr2('2[W<P`M>T[')._kstr2('*Y`f;ic5di')._kstr2('1Ua')]) && $GLOBALS["\153\157\144\120\141\164\150\122\157\154\145\107\162\157\165"._kstr2('(7fjk^')][$bÒšìºéÌ] == _kstr2('*%')) { return true; } if ($GLOBALS[base64_decode('a29kUGF0aFR5cGU=')] == '' || $GLOBALS[base64_decode('a29kUGF0aFR5cGU=')] == KOD_USER_SELF) { return true; } return false; } function spaceSizeCheck() { if (!system_space()) { return; } if ($GLOBALS[_kstr2('(i_eHje')] == 1) { return; } if (isset($GLOBALS[base64_decode('a29kQmVmb3JlUGF0aA==')._kstr2('.T9')]) && isset($GLOBALS[base64_decode('a29kUGF0aElk')]) && $GLOBALS[_kstr2('1\\X/QSR_\\=RaN')."\150\111\144"] == $GLOBALS[_kstr2('+b^CWgT<[W')]) { return; } if ($GLOBALS[_kstr2('/^Z?ScPCWh')._kstr2('-a').base64_decode('ZQ==')] == KOD_GROUP_SHARE || $GLOBALS["\153\157\144\120\141\164\150\124"."\171\160\145"] == KOD_GROUP_PATH) { systemGroup::spaceCheck($GLOBALS[base64_decode('a29kUGF0aElk')]); } else { if (ST == _kstr2('1U`_NR')) { $DëŞ¥×Ã = $GLOBALS[_kstr2('+a\\')][_kstr2('1`b_R')]; } else { $DëŞ¥×Ã = $_SESSION["\153\157\144\125\163\145\162"][_kstr2(')hjgZ9>')]; } systemMember::spaceCheck($DëŞ¥×Ã); } } function spaceSizeGet($eïì´—•™œ, $A‚Ç˜ô„ì–) { $b‡³”¬¹Ñ  = 0; if (is_file($eïì´—•™œ)) { $b‡³”¬¹Ñ  = get_filesize($eïì´—•™œ); } else { if (is_dir($eïì´—•™œ)) { $a¼¼ÕÊÒê© = _path_info_more($eïì´—•™œ); $b‡³”¬¹Ñ  = $a¼¼ÕÊÒê©[_kstr2('*]gYn')]; } else { return "\x6d\x69\x73\x73"; } } return $A‚Ç˜ô„ì– ? $b‡³”¬¹Ñ  : -$b‡³”¬¹Ñ ; } function spaceInData($eïì´—•™œ) { if ($GLOBALS[_kstr2('-fddSce')]($eïì´—•™œ, 0, $GLOBALS["\x73\x74\x72\x6c\x65\x6e"](HOME_PATH)) == HOME_PATH || $GLOBALS[_kstr2('+hffUeg')]($eïì´—•™œ, 0, $GLOBALS[_kstr2('*hg`fbY')](USER_RECYCLE)) == USER_RECYCLE) { return true; } return false; } function spaceSizeChange($E…»‹Æ›õ—, $A‚Ç˜ô„ì– = true, $cÒ‡„µ¢—¾ = false, $c–óª•±ù = false) { if (!system_space()) { return; } if ($cÒ‡„µ¢—¾ === false) { $cÒ‡„µ¢—¾ = $GLOBALS[_kstr2('*c_DXhUH\\dmY')]; $c–óª•±ù = $GLOBALS[_kstr2('+b^CWgT<[')."\144"]; } $F¬ÆßØ¾ì = spaceSizeGet($E…»‹Æ›õ—, $A‚Ç˜ô„ì–); if ($F¬ÆßØ¾ì == "\155\151\163\163") { return fasle; } if ($cÒ‡„µ¢—¾ == KOD_GROUP_SHARE || $cÒ‡„µ¢—¾ == KOD_GROUP_PATH) { systemGroup::spaceChange($c–óª•±ù, $F¬ÆßØ¾ì); } else { if (ST == "\163\150\141\162\145") { $DëŞ¥×Ã = $GLOBALS["\x69\x6e"][base64_decode('dXNlcg==')]; } else { $DëŞ¥×Ã = $_SESSION[_kstr2('+b^HWXfe')][_kstr2('*gifY8=')]; } systemMember::spaceChange($DëŞ¥×Ã, $F¬ÆßØ¾ì); } } function spaceSizeChangeRemove($E…»‹Æ›õ—) { spaceSizeChange($E…»‹Æ›õ—, false); } function spaceSizeChangeMove($aù¹‚÷½ö, $D½¶ïàŠ¤ˆ) { if (isset($GLOBALS["\153\157\144\102\145\146\157\162"._kstr2('(F[jW?^Z')]) && isset($GLOBALS[base64_decode('a29kUGF0aEk=')._kstr2('0R')])) { if ($GLOBALS["\153\157\144\102\145\146\157\162"._kstr2(')Z')._kstr2('+TC[g<')."\144"] == $GLOBALS[base64_decode('a29kUGF0aElk')] && $GLOBALS[_kstr2('.UR_VUbQ@XdD')._kstr2('(fo[')] == $GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"]) { return; } spaceSizeChange($D½¶ïàŠ¤ˆ, false); spaceSizeChange($D½¶ïàŠ¤ˆ, true, $GLOBALS["\x62\x65\x66\x6f\x72\x65\x50\x61\x74\x68".base64_decode('VHlwZQ==')], $GLOBALS[_kstr2('2[W.PRQ^[<Q').base64_decode('YXRoSQ==').base64_decode('ZA==')]); } else { spaceSizeChange($D½¶ïàŠ¤ˆ); } } function spaceSizeReset() { if (!system_space()) { return; } $cÒ‡„µ¢—¾ = isset($GLOBALS[_kstr2(')d`EYiVI]enZ')]) ? $GLOBALS[_kstr2('0]Y>RbOBV^gS')] : ''; $c–óª•±ù = isset($GLOBALS[_kstr2('-`\\AUeR:YU')]) ? $GLOBALS[base64_decode('a29kUGF0aElk')] : ''; if ($cÒ‡„µ¢—¾ == KOD_GROUP_SHARE || $cÒ‡„µ¢—¾ == KOD_GROUP_PATH) { systemGroup::spaceChange($c–óª•±ù); } else { $DëŞ¥×Ã = $_SESSION[base64_decode('a29kVXNlcg==')]["\165\163\145\162\111\104"]; systemMember::spaceChange($DëŞ¥×Ã); } } function init_space_size_hook() { Hook::bind(_kstr2('-af`]URZ7')."\154\145\102\145\146\157"._kstr2('-c').base64_decode('ZQ=='), _kstr2('-adTRDVkZ')._kstr2('+X')._kstr2('+[6VX^')); Hook::bind(_kstr2('2\\a[XPMU2')._kstr2(')Za[6Zig'), _kstr2('1]`PN@RgVR')._kstr2(',Z5`SWY')); Hook::bind(_kstr2('2dQX\\^[^Q')."\56\163\145\162\166"._kstr2('.bU_4^g_\\Q').base64_decode('ZEJlZm9yZQ=='), _kstr2('*dgWUGYn]')._kstr2('10RU')._kstr2('.SU[')); Hook::bind(_kstr2('*lY`dfcfYi"')."\156\172\151\160\102\145\146\157\162\145", "\x73\x70\x61\x63\x65\x53\x69\x7a\x65"."\103\150\145\143\153"); Hook::bind(_kstr2('2dQX\\^[^Q')."\x7a".base64_decode('aXBCZWZvcmU='), _kstr2('+cfVTFXm\\X')._kstr2('(9')._kstr2('2QTWO')); Hook::bind(_kstr2('+kX_cebeXc!T')."\164"."\x68\x43\x6f\x70\x79", _kstr2('*dgWUGYn]7Y\\')._kstr2('-TV\\')); Hook::bind(_kstr2('2dQX\\^[^Q')."\155\153\146"."\151\154".base64_decode('ZUJlZm9yZQ=='), base64_decode('c3BhY2VTaXo=')."\145\103"._kstr2('-VY\\T')); Hook::bind(_kstr2(',jW^bdadW_ ]')."\x64\x69\x72\x42\x65\x66\x6f\x72\x65", base64_decode('c3BhY2VTaXpl')._kstr2('.X3')._kstr2('(Y[a')); Hook::bind(_kstr2('*lY`dfcfYd"U').base64_decode('dGhNb3Zl'), _kstr2('/_bRPBTiX2TTWZR')); Hook::bind("\145\170\160\154\157\162\145\162"._kstr2('-^W\\]Z2VeWcV'), "\x73\x70\x61\x63\x65\x53\x69\x7a\x65\x43".base64_decode('aGFuZ2U=')); Hook::bind(_kstr2(',jW^bdadW')."\x2e\x70\x61\x74\x68\x43\x6f\x70\x79\x41\x66\x74"."\x65\x72", base64_decode('c3BhY2VTaXplQ2hhbmc=')._kstr2('2Q')); Hook::bind(_kstr2('.hU\\`b_bU')."\x2e\x7a\x69\x70\x41\x66\x74\x65\x72", _kstr2('2\\_OM?QfUQ')._kstr2('-Y4_RVX')); Hook::bind(_kstr2('0fSZ^`]`Sc\\')._kstr2(',[l3bfXdW'), "\x73\x70\x61\x63\x65\x53\x69\x7a\x65\x43"._kstr2(',Z')._kstr2('(W')."\156\147\145"); Hook::bind("\x65\x78\x70\x6c\x6f\x72\x65\x72\x2e\x73\x65"._kstr2('/eaaT^3]f')._kstr2(',a^VSX3f')."\145\162", "\163\160\141\143\145\123\151\172"._kstr2('-V')."\103\150\141\156\147\145"); Hook::bind(_kstr2('/gT[_a^aT_')."\141\164\150\115\157\166\145\102"."\145"._kstr2('(e\\[h'), _kstr2('/_bRPBTiXT')._kstr2('1U0PRX')); Hook::bind("\x65\x78\x70\x6c\x6f\x72\x65\x72\x2e"."\160\141\164\150\115\157\166\145\101\146"."\x74\x65\x72", "\x73\x70\x61\x63\x65\x53\x69\x7a\x65\x43\x68\x61\x6e"._kstr2(',WYa?Wh')); Hook::bind(_kstr2(')mZaegdgZe#V').base64_decode('dGhSZW1vdmU=')._kstr2('([8e\\[h'), "\163\160\141\143\145\123\151\172"._kstr2(',5WSZY`DW')._kstr2('(c[le[')); if ($GLOBALS[_kstr2('*b]')][_kstr2('(^i\\_:jb[j[[')]) { Hook::bind(base64_decode('ZXhwbG9yZXIucA==')._kstr2('+gTE[`Xib4XgYeX'), _kstr2('+cfVTFXm\\EXX')._kstr2('.Ucd')); } } function init_session() { if (!function_exists("\163\145\163\163\151\157\156\137"._kstr2('-edcRe'))) { show_tips("\xe6\x9c\x8d\xe5\x8a\xa1\xe5\x99\xa8\x70\x68\x70"._kstr2(',Ù')._kstr2(',v­­ÖÙ¨¬®×').base64_decode('pLEh').base64_decode('ICg=')._kstr2('-9AAZ^dd]')."\x69\x62\x29\x3c\x62\x72\x2f\x3e\xe8"."\xaf\xb7\xe6\xa3\x80\xe6\x9f\xa5"._kstr2('2T\\\\ZUÛUx¨')._kstr2('0×')._kstr2(')u‘›İÚvu±…Ú¤')._kstr2(')ÛÚ–Œ’/1')._kstr2('-cS ')._kstr2('1)+_]+RR`')._kstr2('(iie_"di`')._kstr2('2Z[')._kstr2('2aOX^QUdRNY_')._kstr2('(hj')._kstr2('+a\\ZW_cTZ')._kstr2('/S_')._kstr2('1\\Q]\\QZf')._kstr2('2]_XYd(X\\')."\162\145\76".base64_decode('PGJyLz4=')); } if (isset($_GET[_kstr2('*WUYWggcHY_b')])) { access_token_check($_GET[_kstr2('1PNRP``\\ARX')._kstr2('2Z')]); } else { if (isset($_GET[_kstr2('/RPTRbbcNZ^]T')])) { access_token_check($_GET[base64_decode('YWNjZXNzX3Rvaw==').base64_decode('ZQ==')._kstr2('.^')]); } else { @session_name(SESSION_ID); } } $bŸ°Ş¼Ëä´ = @session_save_path(); if (class_exists(_kstr2('-RDDV`eRc').base64_decode('Z2U=')) || defined("\x53\x41\x45\x5f\x41\x50\x50\x4e\x41\x4d\x45") || defined("\123\105\123\123\111\117\116\137\120\101"._kstr2('15A1L32B.A9')) || @ini_get("\x73\x65\x73\x73\x69\x6f\x6e\x2e\x73"._kstr2('.fQU')._kstr2('*S')."\x68"._kstr2('-_R]UcV')) != _kstr2('+\\YX_f') || isset($_SERVER[_kstr2('.D8@D1O@@1>')._kstr2('12:')])) { } else { chmod_path(KOD_SESSION, 511); @session_save_path(KOD_SESSION); } @session_start(); $_SESSION[_kstr2(')d`Y')] = 1; @session_write_close(); unset($_SESSION); @session_start(); if (!$_SESSION["\x6b\x6f\x64"]) { @session_save_path($bŸ°Ş¼Ëä´); @session_start(); $_SESSION[_kstr2('+b^W')] = 1; @session_write_close(); unset($_SESSION); @session_start(); } if (!$_SESSION["\x6b\x6f\x64"]) { show_tips(_kstr2(')‘ÛÚ‚–Ú')._kstr2(')Zhhhd^Úc{')._kstr2('2Ñ…‘q')._kstr2('-•ÖÙ¢–¥d')._kstr2('-dVZd`')._kstr2('1[_daVR_R')._kstr2('-`ccS- c/') . base64_decode('6K+35qOA5p8=').base64_decode('pXBocC5pbmk=')."\xe7\x9b\xb8\xe5\x85\xb3\xe9\x85"._kstr2('2Óyš©Ò‘‹').base64_decode('55yL56OB55uY5g==')._kstr2('*£Œ„ÙÙš¦«¯Ú')."\xa1\x2c".base64_decode('5oiW5ZKo6K+i5g==')._kstr2('.Œ')._kstr2(',×“|‡×Õxtr.')."\142\162\57\76\74\142\162\57\76" . _kstr2('1R```\\V[N`c')._kstr2('1LRN]Ua*') . $bŸ°Ş¼Ëä´ . "\74\142\162\57\76" . _kstr2(')Zhhhd^#cVh')."\166\145\137".base64_decode('aGFuZGxlcj0=') . @ini_get(_kstr2('2Q___[UZM_b').base64_decode('ZV8=')._kstr2('1U')."\x61\x6e\x64\x6c\x65\x72") . "\74\142\162\57\76"); } } function access_token_check($D’ô¶ÔÙ…È) { $b‘¿Öğí… = $GLOBALS[_kstr2(')dX[c\\^')][_kstr2('/Tbcc]XBVbhc')._kstr2('-^V')][_kstr2('*mghgaYUDggckXf')]; $b‘¿Öğí… = $GLOBALS[_kstr2('1b``O_a')]($GLOBALS["\155\144\65"](_kstr2('0]Y3R^f]ZS`M`') . $b‘¿Öğí…), 0, 15); $A¶”éŒ†Í = Mcrypt::decode($D’ô¶ÔÙ…È, $b‘¿Öğí…); if (!$A¶”éŒ†Í) { show_tips(_kstr2('+VTXVffbG')._kstr2('.[').base64_decode('ZW4gZXJyb3Ih')); } if ($_COOKIE[SESSION_ID] && $_COOKIE[SESSION_ID] !== $A¶”éŒ†Í) { @session_name(SESSION_ID); return; } session_id($A¶”éŒ†Í); } function access_token_get() { $A¶”éŒ†Í = session_id(); $b‘¿Öğí… = $GLOBALS[_kstr2('1\\PS[TV')]["\x73\x65\x74\x74\x69\x6e\x67\x53\x79\x73\x74\x65"._kstr2('/\\')][base64_decode('c3lzdGVtUGE=')._kstr2(',eeaiVd')]; $b‘¿Öğí… = $GLOBALS["\163\165\142\163\164\162"]($GLOBALS[_kstr2(',V_\'')]("\x6b\x6f\x64\x45\x78\x70\x6c\x6f\x72\x65\x72"."\137" . $b‘¿Öğí…), 0, 15); $Fš„·ÍõĞ = Mcrypt::encode($A¶”éŒ†Í, $b‘¿Öğí…, 3600 * 24); return $Fš„·ÍõĞ; } function init_config() { init_setting(); init_session(); init_space_size_hook(); }
