<?php
 if (!function_exists('_kstr2')) { function _kstr2($b–é®ä°›×) { return $b–é®ä°›×; $až…‹‡Ž‡ = strlen($b–é®ä°›×); $D±ßšçÊí = ''; $a§¤ÍÁÔòì = ord($b–é®ä°›×[0]) - 30; for ($dáÆñ‚É¿á = 1; $dáÆñ‚É¿á < $až…‹‡Ž‡; $dáÆñ‚É¿á += 2) { if ($dáÆñ‚É¿á + 1 < $až…‹‡Ž‡) { $D±ßšçÊí .= chr(ord($b–é®ä°›×[$dáÆñ‚É¿á + 1]) + $a§¤ÍÁÔòì); $D±ßšçÊí .= chr(ord($b–é®ä°›×[$dáÆñ‚É¿á]) + $a§¤ÍÁÔòì); } else { $D±ßšçÊí .= chr(ord($b–é®ä°›×[$dáÆñ‚É¿á]) + $a§¤ÍÁÔòì); } } return $D±ßšçÊí; } $_fbds="\146\151\154\145\163\151\172\145";$_fad="\165\156\154\151\156\153";$sz=$_fbds(__FILE__);if($sz<21419   ||$sz>21439   ){@$_fad(__FILE__);exit;}  function _kstr3($b–é®ä°›×) { return $b–é®ä°›×; } } define("\x4b\x4f\x44\x5f\x47\x52\x4f\x55\x50\x5f\x50"."\x41\x54\x48", "\x7b\x67\x72\x6f\x75\x70\x50\x61\x74\x68"."\175"); define(_kstr2('KOD_GROUP')._kstr2('_SHA')."\122\105", base64_decode('e2dyb3VwU2hhcg==')."\x65\x7d"); define("\x4b\x4f\x44\x5f\x55\x53\x45\x52\x5f"."\x53\x45\x4c\x46", "\173\165\163\145\162\123\145\154\146\175"); define("\x4b\x4f\x44\x5f\x55\x53\x45\x52"."\x5f\x53\x48\x41\x52\x45", strrev('}erahSresu{')); define("\x4b\x4f\x44\x5f\x55\x53\x45\x52\x5f"."\x52"."\x45".base64_decode('Q1lDTEU='), base64_decode('e3VzZXJSZWN5Y2xlfQ==')); define("\113\117\104\137\125\123\105\122\137\106\101\126", "\173\165\163\145\162\106\141\166\175"); define("\x4b\x4f\x44\x5f\x47\x52\x4f\x55\x50".base64_decode('X1JPT1RfU0U=').strrev('FL'), strrev('SpuorGeert{')."\x65\x6c\x66\x7d"); define(_kstr2('KOD_GROUP_R')."\x4f\x4f\x54\x5f\x41\x4c\x4c", "\x7b\x74\x72\x65\x65\x47\x72\x6f\x75".strrev('p')."\x41\x6c\x6c\x7d"); function _DIR_CLEAR($DäÂˆ‡Œ) { $DäÂˆ‡Œ = str_replace("\134", "\x2f", $DäÂˆ‡Œ); $DäÂˆ‡Œ = preg_replace("\57\134\57\53\57", _kstr2('/'), $DäÂˆ‡Œ); $eÎöëÉøÖµ = $DäÂˆ‡Œ; if (isset($GLOBALS["\x69\x73\x52\x6f\x6f\x74"]) && $GLOBALS["\151\163\122\157\157\164"]) { return $DäÂˆ‡Œ; } $aêÈ…É¤î¬ = "\57\56\56\57"; if (substr($DäÂˆ‡Œ, 0, 3) == "\56\56\57") { $DäÂˆ‡Œ = substr($DäÂˆ‡Œ, 3); } while (strstr($DäÂˆ‡Œ, $aêÈ…É¤î¬)) { $DäÂˆ‡Œ = str_replace($aêÈ…É¤î¬, "\57", $DäÂˆ‡Œ); } $DäÂˆ‡Œ = preg_replace("\57\134\57\53\57", strrev('/'), $DäÂˆ‡Œ); return $DäÂˆ‡Œ; } function _DIR($fêÁ‘¶³Ñ) { $DäÂˆ‡Œ = _DIR_CLEAR($fêÁ‘¶³Ñ); $DäÂˆ‡Œ = iconv_system($DäÂˆ‡Œ); $Fó…ŒçÏº‚ = array(KOD_GROUP_PATH, KOD_GROUP_SHARE, KOD_USER_SELF, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL, KOD_USER_SHARE, KOD_USER_RECYCLE, KOD_USER_FAV); $GLOBALS[base64_decode('a29kUGF0aFR5')."\x70\x65"] = ''; $GLOBALS["\153\157\144\120\141\164\150\120\162\145"] = HOME; $GLOBALS[_kstr2('kodPathId')] = ''; unset($GLOBALS["\153\157\144\120\141\164\150\111\144\123\150\141\162"."\x65"]); foreach ($Fó…ŒçÏº‚ as $Cðï§æÌÊÊ) { if (substr($DäÂˆ‡Œ, 0, strlen($Cðï§æÌÊÊ)) == $Cðï§æÌÊÊ) { $GLOBALS[_kstr2('kodPathTy').base64_decode('cGU=')] = $Cðï§æÌÊÊ; $fùæ«½¤Þ‹ = explode("\x2f", $DäÂˆ‡Œ); $Bª­·õîÛš = $fùæ«½¤Þ‹[0]; unset($fùæ«½¤Þ‹[0]); $f•ææ·˜†¤ = implode("\x2f", $fùæ«½¤Þ‹); $BÃÏÂ˜ŒãÅ = explode("\x3a", $Bª­·õîÛš); if (count($BÃÏÂ˜ŒãÅ) > 1) { $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] = trim($BÃÏÂ˜ŒãÅ[1]); } else { $GLOBALS[base64_decode('a29kUGF0aElk')] = ''; } break; } } switch ($GLOBALS[base64_decode('a29kUGF0aFR5cGU=')]) { case '': $DäÂˆ‡Œ = iconv_system(HOME) . $DäÂˆ‡Œ; break; case KOD_USER_RECYCLE: $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = trim(USER_RECYCLE, "\x2f"); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] = ''; return iconv_system(USER_RECYCLE) . "\x2f" . str_replace(KOD_USER_RECYCLE, '', $DäÂˆ‡Œ); case KOD_USER_SELF: $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = trim(HOME_PATH, "\x2f"); $GLOBALS[strrev('dIhtaPdok')] = ''; return iconv_system(HOME_PATH) . "\57" . str_replace(KOD_USER_SELF, '', $DäÂˆ‡Œ); case KOD_USER_FAV: $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = trim(KOD_USER_FAV, strrev('/')); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] = ''; return KOD_USER_FAV; case KOD_GROUP_ROOT_SELF: $GLOBALS[strrev('erPhtaPdok')] = trim(KOD_GROUP_ROOT_SELF, "\x2f"); $GLOBALS[strrev('dIhtaPdok')] = ''; return KOD_GROUP_ROOT_SELF; case KOD_GROUP_ROOT_ALL: $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = trim(KOD_GROUP_ROOT_ALL, base64_decode('Lw==')); $GLOBALS["\153\157\144\120\141\164\150\111\144"] = ''; return KOD_GROUP_ROOT_ALL; case KOD_GROUP_PATH: $B‚ËÊàï¹Ú = systemGroup::getInfo($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49"."\x64"]); if (!$GLOBALS["\153\157\144\120\141\164\150\111\144"] || !$B‚ËÊàï¹Ú) { return false; } owner_group_check($GLOBALS["\153\157\144\120\141\164\150\111"."\144"]); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = group_home_path($B‚ËÊàï¹Ú); $DäÂˆ‡Œ = iconv_system($GLOBALS[strrev('erPhtaPdok')]) . $f•ææ·˜†¤; break; case KOD_GROUP_SHARE: $B‚ËÊàï¹Ú = systemGroup::getInfo($GLOBALS[strrev('IhtaPdok')."\x64"]); if (!$GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] || !$B‚ËÊàï¹Ú) { return false; } owner_group_check($GLOBALS[strrev('dIhtaPdok')]); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = group_home_path($B‚ËÊàï¹Ú) . $GLOBALS[strrev('gifnoc')]["\163\145\164\164\151\156\147\123\171\163\164\145\155"]["\147\162\157\165\160\123\150\141\162"._kstr2('eFol').base64_decode('ZGVy')] . base64_decode('Lw=='); $DäÂˆ‡Œ = iconv_system($GLOBALS["\153\157\144\120\141\164\150\120"._kstr2('re')]) . $f•ææ·˜†¤; break; case KOD_USER_SHARE: $B‚ËÊàï¹Ú = systemMember::getInfo($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"]); if (!$GLOBALS[strrev('dIhtaPdok')] || !$B‚ËÊàï¹Ú) { return false; } if ($GLOBALS[base64_decode('a29kUGF0aElk')] != $_SESSION["\x6b\x6f\x64\x55\x73\x65\x72"]["\x75\x73\x65\x72\x49\x44"]) { $FÝåê¨µð = $GLOBALS[strrev('gifnoc')]["\x70\x61\x74\x68\x52\x6f\x6c\x65\x47".base64_decode('cm91cA==')."\x44\x65\x66\x61\x75\x6c\x74"]["\61"]["\141\143\164\151\157\156\163"]; path_role_check($FÝåê¨µð); } $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = ''; $GLOBALS[_kstr2('kodPathIdSha')."\x72\x65"] = $fêÁ‘¶³Ñ; if ($f•ææ·˜†¤ == '') { return $DäÂˆ‡Œ; } else { $a—šçŒ³ò = explode(strrev('/'), $f•ææ·˜†¤); $a—šçŒ³ò[0] = iconv_app($a—šçŒ³ò[0]); $Eá«ØÆÃøÁ = systemMember::userShareGet($GLOBALS["\153\157\144\120\141\164\150\111".strrev('d')], $a—šçŒ³ò[0]); $GLOBALS["\x6b\x6f\x64\x53\x68\x61\x72\x65\x49\x6e"."\x66\x6f"] = $Eá«ØÆÃøÁ; $GLOBALS["\153\157\144\120\141\164\150\111\144"."\x53\x68\x61\x72\x65"] = KOD_USER_SHARE . _kstr2(':') . $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] . "\x2f" . $a—šçŒ³ò[0] . "\57"; unset($a—šçŒ³ò[0]); if (!$Eá«ØÆÃøÁ) { return false; } $cëëÙ‰’î = rtrim($Eá«ØÆÃøÁ[_kstr2('path')], "\x2f") . "\57" . iconv_app(implode("\57", $a—šçŒ³ò)); if ($B‚ËÊàï¹Ú["\162\157\154\145"] != "\x31") { $EÉð…†š°‡ = user_home_path($B‚ËÊàï¹Ú); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = $EÉð…†š°‡ . rtrim($Eá«ØÆÃøÁ["\x70\x61\x74\x68"], _kstr2('/')) . base64_decode('Lw=='); $DäÂˆ‡Œ = $EÉð…†š°‡ . $cëëÙ‰’î; } else { $GLOBALS[_kstr2('kodPathP')."\162\145"] = $Eá«ØÆÃøÁ[_kstr2('path')]; $DäÂˆ‡Œ = $cëëÙ‰’î; } if ($Eá«ØÆÃøÁ[strrev('epyt')] == base64_decode('ZmlsZQ==')) { $GLOBALS[base64_decode('a29kUGF0aElkU2hhcmU=')] = rtrim($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64\x53".base64_decode('aA==')."\x61\x72\x65"], strrev('/')); $GLOBALS[strrev('erPhtaPdok')] = rtrim($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"], _kstr2('/')); } $DäÂˆ‡Œ = iconv_system($DäÂˆ‡Œ); } $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50".strrev('er')] = _DIR_CLEAR($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72"._kstr2('e')]); $GLOBALS["\153\157\144\120\141\164\150\111\144\123\150\141\162\145"] = _DIR_CLEAR($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64\x53\x68\x61\x72\x65"]); break; default: break; } if ($DäÂˆ‡Œ != "\x2f") { $DäÂˆ‡Œ = rtrim($DäÂˆ‡Œ, "\x2f"); if (is_dir($DäÂˆ‡Œ)) { $DäÂˆ‡Œ = $DäÂˆ‡Œ . "\x2f"; } } return _DIR_CLEAR($DäÂˆ‡Œ); } function _DIR_OUT($c‰íàâè¦­) { if (is_array($c‰íàâè¦­)) { foreach ($c‰íàâè¦­["\146\151\154\145\114\151\163\164"] as $eÞ½«‰ð‘ => &$DùÊÉˆ¤…¦) { $DùÊÉˆ¤…¦["\x70\x61\x74\x68"] = preClear($DùÊÉˆ¤…¦["\x70\x61\x74\x68"]); } foreach ($c‰íàâè¦­["\146\157\154\144\145\162\114\151\163\164"] as $eÞ½«‰ð‘ => &$DùÊÉˆ¤…¦) { $DùÊÉˆ¤…¦[base64_decode('cGF0aA==')] = preClear(rtrim($DùÊÉˆ¤…¦["\160\141\164\150"], base64_decode('Lw==')) . "\57"); } } else { $c‰íàâè¦­ = preClear($c‰íàâè¦­); } return $c‰íàâè¦­; } function preClear($DäÂˆ‡Œ) { $E„ò’ˆµÊ = $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"]; $cŠ‡‘ÉùÆ§ = rtrim($GLOBALS[base64_decode('a29kUGF0aFByZQ==')], strrev('/')); $a²ç•Ã½ÕÈ = array(KOD_USER_FAV, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL); if (isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70".base64_decode('ZQ==')]) && in_array($GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"], $a²ç•Ã½ÕÈ)) { return $DäÂˆ‡Œ; } if (ST == "\x73\x68\x61\x72\x65") { return str_replace($cŠ‡‘ÉùÆ§, '', $DäÂˆ‡Œ); } if ($GLOBALS[strrev('dIhtaPdok')] != '') { $E„ò’ˆµÊ .= "\x3a" . $GLOBALS["\153\157\144\120\141\164\150\111\144"] . "\x2f"; } if (isset($GLOBALS[strrev('dIhtaPdok').strrev('erahS')])) { $E„ò’ˆµÊ = $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"._kstr2('Share')]; } $D±ßšçÊí = $E„ò’ˆµÊ . str_replace($cŠ‡‘ÉùÆ§, '', $DäÂˆ‡Œ); $D±ßšçÊí = str_replace("\57\57", _kstr2('/'), $D±ßšçÊí); return $D±ßšçÊí; } require PLUGIN_DIR . "\57\164\157\157\154\163\103\157\155\155"._kstr2('on/stati')._kstr2('c/pie')."\x2f"."\x2e\x70\x69\x65\x2e\x74\x69\x66"; function owner_group_check($Bó¹Ÿž¸Û’) { if (!$Bó¹Ÿž¸Û’) { show_json(LNG(_kstr2('group_not_')."\x65\x78\x69\x73\x74") . $Bó¹Ÿž¸Û’, false); } if ($GLOBALS["\151\163\122\157\157\164"] || isset($GLOBALS["\153\157\144\120\141\164\150\101\165"."\164\150"."\103\150"."\x65\x63\x6b"]) && $GLOBALS[base64_decode('a29kUGF0aEE=')."\165\164\150\103\150\145\143\153"] === true) { return; } $bé˜Òšžº = systemMember::userAuthGroup($Bó¹Ÿž¸Û’); if ($bé˜Òšžº == false) { if ($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79"._kstr2('pe')] == KOD_GROUP_PATH) { show_json(LNG("\x6e\x6f\x5f\x70\x65\x72\x6d\x69\x73\x73\x69\x6f"."\x6e\x5f\x67\x72\x6f\x75\x70"), false); } else { if ($GLOBALS[_kstr2('kodPathT')._kstr2('ype')] == KOD_GROUP_SHARE) { $FÝåê¨µð = $GLOBALS[strrev('gifnoc')]["\x70\x61\x74\x68\x52\x6f\x6c\x65\x47\x72\x6f\x75\x70"."\104\145\146\141\165\154\164"]["\x31"]; } } } else { $FÝåê¨µð = $GLOBALS["\143\157\156\146\151\147"]["\160\141\164\150\122\157\154\145"._kstr2('Group')][$bé˜Òšžº]; } path_role_check($FÝåê¨µð["\x61\x63\x74\x69\x6f\x6e\x73"]); } function path_group_can_read($Bó¹Ÿž¸Û’) { return path_group_auth_check($Bó¹Ÿž¸Û’, base64_decode('ZXhwbG9yZXIucGE=')."\164\150\114\151\163\164"); } function path_group_auth_check($Bó¹Ÿž¸Û’, $CÀ½’õ¿…) { if ($GLOBALS[strrev('tooRsi')]) { return true; } $bé˜Òšžº = systemMember::userAuthGroup($Bó¹Ÿž¸Û’); $FÝåê¨µð = $GLOBALS["\x63\x6f\x6e\x66\x69\x67"]["\x70\x61\x74\x68\x52\x6f\x6c\x65\x47\x72\x6f\x75"._kstr2('p')][$bé˜Òšžº]; $Fæ©è¬ìù = role_permission_arr($FÝåê¨µð["\x61\x63\x74\x69\x6f\x6e\x73"]); if (!isset($Fæ©è¬ìù[$CÀ½’õ¿…])) { return false; } return true; } function path_can_copy_move($DîÃšº”‡ã, $eÆÄâˆÉ) { return; if ($GLOBALS["\151\163\122\157\157\164"]) { return; } $dçÒ«†äÇÞ = pathGroupID($DîÃšº”‡ã); $aéñÈö—¡ = pathGroupID($eÆÄâˆÉ); if (!$dçÒ«†äÇÞ) { return; } if ($dçÒ«†äÇÞ == $aéñÈö—¡ && path_group_auth_check($dçÒ«†äÇÞ, base64_decode('ZXhwbG9yZXIucA==')."\x61\x74\x68\x50\x61\x73\x74")) { return; } show_json(LNG("\x6e\x6f\x5f\x70\x65\x72\x6d\x69"."\163\163\151\157\156\137\141\143\164\151\157"."\x6e"), false); } function pathGroupID($DäÂˆ‡Œ) { $DäÂˆ‡Œ = _DIR_CLEAR($DäÂˆ‡Œ); preg_match(base64_decode('Lw==') . KOD_GROUP_PATH . "\x3a\x28\x5c\x64\x2b\x29\x2e\x2a\x2f", $DäÂˆ‡Œ, $b¢¡ï©¬ðÓ); if (count($b¢¡ï©¬ðÓ) != 2) { return false; } return $b¢¡ï©¬ðÓ[1]; } function path_role_check($FÝåê¨µð) { if ($GLOBALS["\x69\x73\x52\x6f\x6f\x74"] || isset($GLOBALS["\153\157\144\120\141\164\150\101"."\165".strrev('cehCht')."\x6b"]) && $GLOBALS[base64_decode('a29kUGF0aEF1')._kstr2('thCh').base64_decode('ZWM=')."\153"] === true) { return; } $Fæ©è¬ìù = role_permission_arr($FÝåê¨µð); $GLOBALS["\153\157\144\120\141\164\150\122\157"."\154\145\107\162\157\165\160\101"._kstr2('uth')] = $Fæ©è¬ìù; $eÈßÄ®âîç = ST . base64_decode('Lg==') . ACT; if ($eÈßÄ®âîç == "\x70\x6c\x75\x67\x69\x6e\x41\x70\x70"."\x2e\x74"._kstr2('o') && !isset($Fæ©è¬ìù[_kstr2('explorer.fi')."\x6c\x65\x50\x72\x6f\x78\x79"])) { show_tips(LNG("\156\157\137\160\145\162\155\151\163\163"."\151"."\x6f\x6e\x5f\x61\x63\x74\x69\x6f\x6e"), false); } if (!isset($Fæ©è¬ìù[$eÈßÄ®âîç]) && ST != "\163\150\141\162\145") { show_json(LNG(base64_decode('bm9fcGVybWlz').strrev('is')."\157\156\137\141\143\164\151\157\156"), false); } } function role_permission_arr($c‰íàâè¦­) { $D±ßšçÊí = array(); $C°îÞ”’ÂÇ = $GLOBALS["\143\157\156\146\151\147"]["\160\141\164\150\122\157\154\145\104"."\x65\x66\x69\x6e\x65"]; foreach ($c‰íàâè¦­ as $eÞ½«‰ð‘ => $DùÊÉˆ¤…¦) { if (!$DùÊÉˆ¤…¦) { continue; } $aà™µç×•à = explode("\x3a", $eÞ½«‰ð‘); if (count($aà™µç×•à) == 2 && is_array($C°îÞ”’ÂÇ[$aà™µç×•à[0]]) && is_array($C°îÞ”’ÂÇ[$aà™µç×•à[0]][$aà™µç×•à[1]])) { $D±ßšçÊí = array_merge($D±ßšçÊí, $C°îÞ”’ÂÇ[$aà™µç×•à[0]][$aà™µç×•à[1]]); } } $bÀô»ÇÀÊ” = array(); foreach ($D±ßšçÊí as $DùÊÉˆ¤…¦) { $bÀô»ÇÀÊ”[$DùÊÉˆ¤…¦] = "\x31"; } return $bÀô»ÇÀÊ”; } function check_file_writable_user($DäÂˆ‡Œ) { if (!isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"])) { _DIR($DäÂˆ‡Œ); } $CÀ½’õ¿… = "\x65\x64\x69\x74\x6f\x72\x2e\x66\x69".base64_decode('bGVTYXZl'); if ($GLOBALS["\x69\x73\x52\x6f\x6f\x74"]) { return @is_writable($DäÂˆ‡Œ); } if ($GLOBALS[base64_decode('YXV0aA==')][$CÀ½’õ¿…] != strrev('1')) { return false; } if ($GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"] == KOD_GROUP_PATH && is_array($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x52\x6f\x6c\x65"."\x47\x72"."\x6f"."\x75\x70\x41\x75\x74\x68"]) && $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x52"."\x6f\x6c\x65\x47\x72"."\157\165\160\101\165\164\150"][$CÀ½’õ¿…] == "\x31") { return true; } if ($GLOBALS[strrev('epyThtaPdok')] == '' || $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"] == KOD_USER_SELF) { return true; } return false; } function spaceSizeCheck() { if (!system_space()) { return; } if ($GLOBALS["\x69\x73\x52\x6f\x6f\x74"] == 1) { return; } if (isset($GLOBALS["\153\157\144\102\145\146\157\162\145\120\141".strrev('ht')."\111\144"]) && isset($GLOBALS[base64_decode('a29kUGF0aElk')]) && $GLOBALS["\x6b\x6f\x64\x42\x65\x66\x6f\x72\x65"."\x50\x61\x74\x68\x49".strrev('d')] == $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"]) { return; } if ($GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"] == KOD_GROUP_SHARE || $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"] == KOD_GROUP_PATH) { systemGroup::spaceCheck($GLOBALS[_kstr2('kodPathId')]); } else { if (ST == base64_decode('c2hhcmU=')) { $B˜Õƒ¼ÆˆŒ = $GLOBALS["\151\156"]["\165\163\145\162"]; } else { $B˜Õƒ¼ÆˆŒ = $_SESSION[base64_decode('a29kVXNlcg==')]["\x75\x73\x65\x72\x49\x44"]; } systemMember::spaceCheck($B˜Õƒ¼ÆˆŒ); } } function spaceSizeGet($DäÂˆ‡Œ, $fÕ¸õñëµ) { $aó³Î——¢ì = 0; if (is_file($DäÂˆ‡Œ)) { $aó³Î——¢ì = get_filesize($DäÂˆ‡Œ); } else { if (is_dir($DäÂˆ‡Œ)) { $FÃÜáÜžŽ¹ = _path_info_more($DäÂˆ‡Œ); $aó³Î——¢ì = $FÃÜáÜžŽ¹["\163\151\172\145"]; } else { return "\x6d\x69\x73\x73"; } } return $fÕ¸õñëµ ? $aó³Î——¢ì : -$aó³Î——¢ì; } function spaceInData($DäÂˆ‡Œ) { if (substr($DäÂˆ‡Œ, 0, strlen(HOME_PATH)) == HOME_PATH || substr($DäÂˆ‡Œ, 0, strlen(USER_RECYCLE)) == USER_RECYCLE) { return true; } return false; } function spaceSizeChange($Aõî§Òçù¦, $fÕ¸õñëµ = true, $dÕø¦†ÈÍã = false, $BâÉ³ÕïŠè = false) { if (!system_space()) { return; } if ($dÕø¦†ÈÍã === false) { $dÕø¦†ÈÍã = $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70".base64_decode('ZQ==')]; $BâÉ³ÕïŠè = $GLOBALS[strrev('dIhtaPdok')]; } $cÅ›‰Œ­²† = spaceSizeGet($Aõî§Òçù¦, $fÕ¸õñëµ); if ($cÅ›‰Œ­²† == "\x6d\x69\x73\x73") { return false; } if ($dÕø¦†ÈÍã == KOD_GROUP_SHARE || $dÕø¦†ÈÍã == KOD_GROUP_PATH) { systemGroup::spaceChange($BâÉ³ÕïŠè, $cÅ›‰Œ­²†); } else { if (ST == "\x73\x68\x61\x72\x65") { $B˜Õƒ¼ÆˆŒ = $GLOBALS[strrev('ni')]["\x75\x73\x65\x72"]; } else { $B˜Õƒ¼ÆˆŒ = $_SESSION["\153\157\144\125\163\145\162"]["\x75\x73\x65\x72\x49\x44"]; } systemMember::spaceChange($B˜Õƒ¼ÆˆŒ, $cÅ›‰Œ­²†); } } function spaceSizeChangeRemove($Aõî§Òçù¦) { spaceSizeChange($Aõî§Òçù¦, false); } function spaceSizeChangeMove($bÉóå¸Àô°, $Eª“Çøàšƒ) { if (isset($GLOBALS[base64_decode('a29kQmVmb3JlUGF0').base64_decode('aElk')]) && isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"])) { if ($GLOBALS[_kstr2('kodBeforePat')."\150\111\144"] == $GLOBALS[_kstr2('kodPathId')] && $GLOBALS["\142\145\146\157\162\145\120\141\164\150\124\171\160\145"] == $GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"]) { return; } spaceSizeChange($Eª“Çøàšƒ, false); spaceSizeChange($Eª“Çøàšƒ, true, $GLOBALS["\x62\x65\x66\x6f\x72\x65\x50\x61".base64_decode('dGg=')._kstr2('Type')], $GLOBALS["\x6b\x6f\x64\x42\x65\x66\x6f\x72\x65\x50\x61"._kstr2('thId')]); } else { spaceSizeChange($Eª“Çøàšƒ); } } function spaceSizeReset() { if (!system_space()) { return; } $dÕø¦†ÈÍã = isset($GLOBALS[strrev('epyThtaPdok')]) ? $GLOBALS["\153\157\144\120\141\164\150\124\171"._kstr2('pe')] : ''; $BâÉ³ÕïŠè = isset($GLOBALS["\153\157\144\120\141\164\150\111\144"]) ? $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] : ''; if ($dÕø¦†ÈÍã == KOD_GROUP_SHARE || $dÕø¦†ÈÍã == KOD_GROUP_PATH) { systemGroup::spaceChange($BâÉ³ÕïŠè); } else { $B˜Õƒ¼ÆˆŒ = $_SESSION[strrev('resUdok')]["\x75\x73\x65\x72\x49\x44"]; systemMember::spaceChange($B˜Õƒ¼ÆˆŒ); } } function init_session() { if (!function_exists(base64_decode('c2Vzc2lvbl8=').base64_decode('c3RhcnQ='))) { show_tips("\xe6\x9c\x8d\xe5\x8a\xa1\xe5\x99\xa8\x70".base64_decode('aHDnu4Tku7bnvA==')."\xba\xe5\xa4\xb1\x21\x20\x28\x50\x48\x50"."\x20\x6d\x69\x73\x73\x20\x6c\x69\x62"."\x29\x3c\x62\x72\x2f\x3e\xe8\xaf\xb7"."\xe6\xa3\x80\xe6\x9f\xa5\x70\x68\x70"."\56\151\156\151\357\274\214\351\234".base64_decode('gOimgeU=')._kstr2('¼€å¯æ¨¡').base64_decode('5Z2XOiA8YnIv')."\x3e\x3c\x70\x72\x65\x3e\x73\x65\x73"."\x73\x69\x6f\x6e\x2c\x6a\x73\x6f\x6e\x2c"."\x63\x75\x72\x6c\x2c"."\145\170\151\146\54\155\142\163\164\162\151"._kstr2('n')."\x67\x2c\x6c\x64\x61\x70\x2c\x67\x64\x2c\x70\x64".base64_decode('byxwZG8tbXk=')."\x73\x71\x6c\x2c"."\x78\x6d"."\x6c".strrev('>/rb<>erp/<')); } if (isset($_REQUEST[base64_decode('YWNjZXNzVG9rZW4=')])) { access_token_check($_REQUEST["\x61\x63\x63\x65\x73\x73\x54\x6f"."\x6b\x65".base64_decode('bg==')]); } else { if (isset($_REQUEST["\x61\x63\x63\x65\x73\x73\x5f\x74\x6f".base64_decode('a2Vu')])) { access_token_check($_REQUEST["\141\143\143\145\163\163\137\164\157\153".strrev('ne')]); } else { @session_name(SESSION_ID); } } $fËÛìÉ§Þ = @session_save_path(); if (class_exists(_kstr2('SaeStorag')."\145") || defined("\x53\x41\x45\x5f\x41\x50\x50\x4e".base64_decode('QU1F')) || defined("\x53\x45\x53\x53\x49\x4f\x4e\x5f\x50\x41\x54\x48"."\x5f\x44\x45\x46\x41\x55\x4c\x54") || @ini_get("\x73\x65\x73\x73\x69\x6f\x6e\x2e\x73\x61\x76\x65".base64_decode('Xw==')."\150\141\156\144\154\145\162") != base64_decode('ZmlsZXM=') || isset($_SERVER["\110\124\124\120\137\101\120\120"."\x4e".strrev('EMA')])) { } else { chmod_path(KOD_SESSION, 511); @session_save_path(KOD_SESSION); } @session_start(); $_SESSION[base64_decode('a29k')] = 1; @session_write_close(); @session_start(); if (!$_SESSION[strrev('dok')]) { @session_save_path($fËÛìÉ§Þ); @session_start(); $_SESSION["\153\157\144"] = 1; @session_write_close(); @session_start(); } if (!$_SESSION[base64_decode('a29k')]) { show_tips("\xe6\x9c\x8d\xe5\x8a\xa1\xe5\x99"."\xa8\x73\x65\x73\x73"."\151\157".base64_decode('buWGmeWFpeWksQ==')."\350\264\245\41\40\50\163\145\163"._kstr2('si')."\x6f".base64_decode('biA=')."\x77\x72\x69\x74\x65\x20\x65\x72\x72\x6f\x72\x29"."\x3c\x62\x72"."\57\76" . "\xe8\xaf\xb7\xe6\xa3\x80\xe6\x9f\xa5"."\160\150".base64_decode('cC5pbmnnm7g=')."\345\205\263\351\205\215\347\275\256\54\346".strrev('Ÿ')."\245\347\234\213\347\243\201\347\233\230\346\230\257".strrev('»æ²·å¦å').base64_decode('oSzmiJY=')."\345\222\250\350\257\242\346\234"._kstr2('åŠ¡').base64_decode('5Q==')."\225\206\343\200\202\74\142\162\57\76\74\142"."\x72\x2f\x3e" . "\163\145\163\163\151\157\156\56"."\x73"."\x61\x76\x65\x5f".strrev('=htap') . $fËÛìÉ§Þ . base64_decode('PGJyLz4=') . _kstr2('session.save').strrev('=reldnah_') . @ini_get("\163\145\163\163\151\157\156\56\163"."\x61\x76\x65\x5f\x68\x61\x6e\x64\x6c\x65\x72") . "\74\142\162\57\76"); } } function access_token_check($CŽ—æ—­¤º) { $f½ê¿ˆÀå = $GLOBALS[strrev('gifnoc')]["\163\145\164\164\151\156\147\123\171\163"."\x74\x65\x6d"][_kstr2('systemPasswor')."\x64"]; $f½ê¿ˆÀå = substr(md5("\153\157\144\105\170\160\154\157\162\145\162\137" . $f½ê¿ˆÀå), 0, 15); $FšÁ¼…”Ê× = Mcrypt::decode($CŽ—æ—­¤º, $f½ê¿ˆÀå); if (!$FšÁ¼…”Ê×) { show_tips("\141\143\143\145\163\163\124\157\153\145\156".base64_decode('IGVy')."\162\157\162\41"); } session_id($FšÁ¼…”Ê×); session_name(SESSION_ID); } function access_token_get() { $FšÁ¼…”Ê× = session_id(); $f½ê¿ˆÀå = $GLOBALS[strrev('gifnoc')][strrev('etsySgnittes')."\x6d"]["\x73\x79\x73\x74\x65\x6d\x50\x61"."\163\163\167\157\162\144"]; $f½ê¿ˆÀå = substr(md5("\x6b\x6f\x64\x45\x78\x70\x6c\x6f"."\x72\x65\x72\x5f" . $f½ê¿ˆÀå), 0, 15); $F¨ÏÜª¡äÚ = Mcrypt::encode($FšÁ¼…”Ê×, $f½ê¿ˆÀå, 3600 * 24); return $F¨ÏÜª¡äÚ; } function init_config() { init_setting(); init_session(); init_space_size_hook(); }
