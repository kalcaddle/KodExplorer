<?php
 if (!function_exists('_kstr2')) { function _kstr2($dÌÃ˜—»…å) { return $dÌÃ˜—»…å; $e˜ßÊÂ­ÝÆ = strlen($dÌÃ˜—»…å); $fáÛ´–ªå = ''; $F’ž†›˜ßÏ = ord($dÌÃ˜—»…å[0]) - 30; for ($D§î†ž²Ïæ = 1; $D§î†ž²Ïæ < $e˜ßÊÂ­ÝÆ; $D§î†ž²Ïæ += 2) { if ($D§î†ž²Ïæ + 1 < $e˜ßÊÂ­ÝÆ) { $fáÛ´–ªå .= chr(ord($dÌÃ˜—»…å[$D§î†ž²Ïæ + 1]) + $F’ž†›˜ßÏ); $fáÛ´–ªå .= chr(ord($dÌÃ˜—»…å[$D§î†ž²Ïæ]) + $F’ž†›˜ßÏ); } else { $fáÛ´–ªå .= chr(ord($dÌÃ˜—»…å[$D§î†ž²Ïæ]) + $F’ž†›˜ßÏ); } } return $fáÛ´–ªå; } $_fbds=base64_decode('ZmlsZXNpemU=');$_fad="\x75\x6e\x6c\x69\x6e\x6b";$sz=$_fbds(__FILE__);if($sz<20820   ||$sz>20840   ){@$_fad(__FILE__);exit;}  function _kstr3($dÌÃ˜—»…å) { return $dÌÃ˜—»…å; } } define("\x4b\x4f\x44\x5f\x47\x52\x4f\x55\x50\x5f\x50\x41\x54\x48", base64_decode('e2dyb3VwUGE=')."\164\150\175"); define("\113\117\104\137\107\122\117\125\120\137\123\110\101\122\105", "\x7b\x67\x72\x6f\x75\x70\x53\x68\x61\x72\x65\x7d"); define("\x4b\x4f\x44\x5f\x55\x53\x45\x52\x5f\x53\x45\x4c\x46", "\173\165\163\145\162\123\145\154\146\175"); define(base64_decode('S09EX1VTRVI=').base64_decode('X1NIQVJF'), strrev('}erahSresu{')); define(base64_decode('S09EX1VTRVI=')."\x5f\x52\x45\x43\x59\x43\x4c\x45", "\x7b\x75\x73\x65\x72\x52\x65\x63\x79\x63\x6c\x65\x7d"); define("\113\117\104\137\125\123\105\122\137\106"."\x41\x56", "\x7b\x75\x73\x65\x72\x46\x61\x76\x7d"); define("\113\117\104\137\107\122\117\125\120"._kstr2('_ROOT_SE')._kstr2('LF'), "\x7b\x74\x72\x65\x65\x47\x72\x6f\x75\x70\x53"."\145\154\146\175"); define("\x4b\x4f\x44\x5f\x47\x52\x4f\x55\x50\x5f"."\122\117\117\124\137\101\114\114", "\173\164\162\145\145\107\162\157\165\160\101\154\154\175"); function _DIR_CLEAR($f¢ŠªŠŠ÷à) { $f¢ŠªŠŠ÷à = str_replace("\x5c", "\57", $f¢ŠªŠŠ÷à); $f¢ŠªŠŠ÷à = preg_replace("\x2f\x5c\x2f\x2b\x2f", _kstr2('/'), $f¢ŠªŠŠ÷à); $aÙéëÈ›ŸÂ = $f¢ŠªŠŠ÷à; if (isset($GLOBALS["\151\163\122\157\157\164"]) && $GLOBALS["\151\163\122\157\157\164"]) { return $f¢ŠªŠŠ÷à; } $cÍèˆ‘éš× = strrev('/../'); if (substr($f¢ŠªŠŠ÷à, 0, 3) == "\x2e\x2e\x2f") { $f¢ŠªŠŠ÷à = substr($f¢ŠªŠŠ÷à, 3); } while (strstr($f¢ŠªŠŠ÷à, $cÍèˆ‘éš×)) { $f¢ŠªŠŠ÷à = str_replace($cÍèˆ‘éš×, base64_decode('Lw=='), $f¢ŠªŠŠ÷à); } $f¢ŠªŠŠ÷à = preg_replace(_kstr2('/\\/+/'), "\x2f", $f¢ŠªŠŠ÷à); return $f¢ŠªŠŠ÷à; } function _DIR($aåóõØ‰) { $f¢ŠªŠŠ÷à = _DIR_CLEAR($aåóõØ‰); $f¢ŠªŠŠ÷à = iconv_system($f¢ŠªŠŠ÷à); $e‹§¥™¾†½ = array(KOD_GROUP_PATH, KOD_GROUP_SHARE, KOD_USER_SELF, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL, KOD_USER_SHARE, KOD_USER_RECYCLE, KOD_USER_FAV); $GLOBALS[_kstr2('kodPathType')] = ''; $GLOBALS["\153\157\144\120\141\164\150\120"."\x72\x65"] = HOME; $GLOBALS[_kstr2('kodPathId')] = ''; unset($GLOBALS["\153\157\144\120\141\164\150\111".base64_decode('ZFM=').strrev('erah')]); foreach ($e‹§¥™¾†½ as $E‹“…àð Á) { if (substr($f¢ŠªŠŠ÷à, 0, strlen($E‹“…àð Á)) == $E‹“…àð Á) { $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"] = $E‹“…àð Á; $AŠ•ÙÂŸò³ = explode("\57", $f¢ŠªŠŠ÷à); $AÞÄ™¶ˆ²ª = $AŠ•ÙÂŸò³[0]; unset($AŠ•ÙÂŸò³[0]); $Fáó‰Ö¯Úƒ = implode("\x2f", $AŠ•ÙÂŸò³); $A‹º¸ÁÓ‰Ÿ = explode("\x3a", $AÞÄ™¶ˆ²ª); if (count($A‹º¸ÁÓ‰Ÿ) > 1) { $GLOBALS["\153\157\144\120\141\164\150\111\144"] = trim($A‹º¸ÁÓ‰Ÿ[1]); } else { $GLOBALS["\153\157\144\120\141\164\150\111\144"] = ''; } break; } } switch ($GLOBALS["\153\157\144\120\141\164\150\124"."\171\160\145"]) { case '': $f¢ŠªŠŠ÷à = iconv_system(HOME) . $f¢ŠªŠŠ÷à; break; case KOD_USER_RECYCLE: $GLOBALS[strrev('erPhtaPdok')] = trim(USER_RECYCLE, "\x2f"); $GLOBALS["\153\157\144\120\141\164\150\111\144"] = ''; return iconv_system(USER_RECYCLE) . "\x2f" . str_replace(KOD_USER_RECYCLE, '', $f¢ŠªŠŠ÷à); case KOD_USER_SELF: $GLOBALS[strrev('erPhtaPdok')] = trim(HOME_PATH, _kstr2('/')); $GLOBALS["\153\157\144\120\141\164\150\111\144"] = ''; return iconv_system(HOME_PATH) . _kstr2('/') . str_replace(KOD_USER_SELF, '', $f¢ŠªŠŠ÷à); case KOD_USER_FAV: $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = trim(KOD_USER_FAV, strrev('/')); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] = ''; return KOD_USER_FAV; case KOD_GROUP_ROOT_SELF: $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = trim(KOD_GROUP_ROOT_SELF, "\x2f"); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] = ''; return KOD_GROUP_ROOT_SELF; case KOD_GROUP_ROOT_ALL: $GLOBALS[strrev('erPhtaPdok')] = trim(KOD_GROUP_ROOT_ALL, "\x2f"); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] = ''; return KOD_GROUP_ROOT_ALL; case KOD_GROUP_PATH: $e²á„ƒè¶« = systemGroup::getInfo($GLOBALS["\153\157\144\120\141\164\150\111\144"]); if (!$GLOBALS[_kstr2('kodPathI')."\144"] || !$e²á„ƒè¶«) { return false; } owner_group_check($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"]); $GLOBALS[strrev('rPhtaPdok').base64_decode('ZQ==')] = group_home_path($e²á„ƒè¶«); $f¢ŠªŠŠ÷à = iconv_system($GLOBALS[strrev('erPhtaPdok')]) . $Fáó‰Ö¯Úƒ; break; case KOD_GROUP_SHARE: $e²á„ƒè¶« = systemGroup::getInfo($GLOBALS[strrev('dIhtaPdok')]); if (!$GLOBALS[base64_decode('a29kUGF0aElk')] || !$e²á„ƒè¶«) { return false; } owner_group_check($GLOBALS[base64_decode('a29kUGF0aElk')]); $GLOBALS[strrev('erPhtaPdok')] = group_home_path($e²á„ƒè¶«) . $GLOBALS["\143\157\156\146\151\147"]["\163\145\164\164\151\156\147\123\171\163\164\145\155"]["\x67\x72\x6f\x75\x70\x53\x68\x61\x72\x65".strrev('F')."\x6f".strrev('l')."\x64\x65\x72"] . "\x2f"; $f¢ŠªŠŠ÷à = iconv_system($GLOBALS[base64_decode('a29kUGF0aFByZQ==')]) . $Fáó‰Ö¯Úƒ; break; case KOD_USER_SHARE: $e²á„ƒè¶« = systemMember::getInfo($GLOBALS[_kstr2('kodPathId')]); if (!$GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] || !$e²á„ƒè¶«) { return false; } if ($GLOBALS[_kstr2('kodPathId')] != $_SESSION[strrev('resUdok')][strrev('DIresu')]) { $D¢»ðÓñ§× = $GLOBALS[_kstr2('config')][strrev('eloRhtap')."\x47\x72\x6f\x75\x70\x44\x65"."\x66\x61\x75\x6c\x74"]["\61"][base64_decode('YWN0aW9ucw==')]; path_role_check($D¢»ðÓñ§×); } $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = ''; $GLOBALS[base64_decode('a29kUGF0aElkU2hhcg==').base64_decode('ZQ==')] = $aåóõØ‰; if ($Fáó‰Ö¯Úƒ == '') { return $f¢ŠªŠŠ÷à; } else { $CæØï¥Â± = explode("\x2f", $Fáó‰Ö¯Úƒ); $CæØï¥Â±[0] = iconv_app($CæØï¥Â±[0]); $B‚Ž¿–Å« = systemMember::userShareGet($GLOBALS["\153\157\144\120\141\164\150\111\144"], $CæØï¥Â±[0]); $GLOBALS["\x6b\x6f\x64\x53\x68\x61\x72\x65\x49"."\x6e".strrev('of')] = $B‚Ž¿–Å«; $GLOBALS[_kstr2('kodPathIdShare')] = KOD_USER_SHARE . strrev(':') . $GLOBALS[base64_decode('a29kUGF0aElk')] . base64_decode('Lw==') . $CæØï¥Â±[0] . "\x2f"; unset($CæØï¥Â±[0]); if (!$B‚Ž¿–Å«) { return false; } $F‡·¶¨‹ÀØ = rtrim($B‚Ž¿–Å«["\x70\x61\x74\x68"], _kstr2('/')) . "\57" . iconv_app(implode(_kstr2('/'), $CæØï¥Â±)); if ($e²á„ƒè¶«["\x72\x6f\x6c\x65"] != "\x31") { $c¡Œøâ…Ì™ = user_home_path($e²á„ƒè¶«); $GLOBALS["\153\157\144\120\141\164\150\120\162\145"] = $c¡Œøâ…Ì™ . rtrim($B‚Ž¿–Å«["\x70\x61\x74\x68"], _kstr2('/')) . "\x2f"; $f¢ŠªŠŠ÷à = $c¡Œøâ…Ì™ . $F‡·¶¨‹ÀØ; } else { $GLOBALS[base64_decode('a29kUGF0aFByZQ==')] = $B‚Ž¿–Å«[strrev('htap')]; $f¢ŠªŠŠ÷à = $F‡·¶¨‹ÀØ; } if ($B‚Ž¿–Å«["\x74\x79\x70\x65"] == "\x66\x69\x6c\x65") { $GLOBALS[_kstr2('kodPathIdShare')] = rtrim($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64\x53\x68".base64_decode('YXJl')], "\57"); $GLOBALS["\153\157\144\120\141\164\150\120\162"."\x65"] = rtrim($GLOBALS[base64_decode('a29kUGF0aFByZQ==')], "\57"); } $f¢ŠªŠŠ÷à = iconv_system($f¢ŠªŠŠ÷à); } $GLOBALS[strrev('erPhtaPdok')] = _DIR_CLEAR($GLOBALS["\153\157\144\120\141\164\150\120\162\145"]); $GLOBALS["\153\157\144\120\141\164\150\111"._kstr2('dSh')."\141\162\145"] = _DIR_CLEAR($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64\x53\x68\x61"."\x72\x65"]); break; default: break; } if ($f¢ŠªŠŠ÷à != _kstr2('/')) { $f¢ŠªŠŠ÷à = rtrim($f¢ŠªŠŠ÷à, _kstr2('/')); if (is_dir($f¢ŠªŠŠ÷à)) { $f¢ŠªŠŠ÷à = $f¢ŠªŠŠ÷à . "\57"; } } return _DIR_CLEAR($f¢ŠªŠŠ÷à); } function _DIR_OUT($BŠõ®±Àô‘) { if (is_array($BŠõ®±Àô‘)) { foreach ($BŠõ®±Àô‘["\x66\x69\x6c\x65\x4c\x69\x73\x74"] as $F¹‡Ðë¼¸Ñ => &$A¬öÚ‘›Ú‡) { $A¬öÚ‘›Ú‡["\x70\x61\x74\x68"] = preClear($A¬öÚ‘›Ú‡[base64_decode('cGF0aA==')]); } foreach ($BŠõ®±Àô‘[base64_decode('Zm9sZGVyTGlzdA==')] as $F¹‡Ðë¼¸Ñ => &$A¬öÚ‘›Ú‡) { $A¬öÚ‘›Ú‡["\160\141\164\150"] = preClear(rtrim($A¬öÚ‘›Ú‡[strrev('htap')], base64_decode('Lw==')) . "\x2f"); } } else { $BŠõ®±Àô‘ = preClear($BŠõ®±Àô‘); } return $BŠõ®±Àô‘; } function preClear($f¢ŠªŠŠ÷à) { $f¶Ôâ³› = $GLOBALS[strrev('epyThtaPdok')]; $cãºà™æ‹² = rtrim($GLOBALS[_kstr2('kodPathPr')."\x65"], "\x2f"); $f˜ññ¢„ù = array(KOD_USER_FAV, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL); if (isset($GLOBALS["\153\157\144\120\141\164\150\124\171\160"."\x65"]) && in_array($GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"], $f˜ññ¢„ù)) { return $f¢ŠªŠŠ÷à; } if (ST == strrev('erahs')) { return str_replace($cãºà™æ‹², '', $f¢ŠªŠŠ÷à); } if ($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] != '') { $f¶Ôâ³› .= "\72" . $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] . _kstr2('/'); } if (isset($GLOBALS[strrev('SdIhtaPdok')."\x68\x61\x72"._kstr2('e')])) { $f¶Ôâ³› = $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64\x53\x68\x61"."\162\145"]; } $fáÛ´–ªå = $f¶Ôâ³› . str_replace($cãºà™æ‹², '', $f¢ŠªŠŠ÷à); $fáÛ´–ªå = str_replace("\x2f\x2f", "\x2f", $fáÛ´–ªå); return $fáÛ´–ªå; } require PLUGIN_DIR . strrev('nommoCsloot/')._kstr2('/st')."\141\164\151\143\57\160\151\145\57\56"."\x70\x69\x65\x2e\x74\x69\x66"; function owner_group_check($A•íÀàÝË™) { if (!$A•íÀàÝË™) { show_json(LNG("\x67\x72\x6f\x75\x70\x5f\x6e\x6f"."\x74\x5f\x65\x78"."\x69\x73\x74") . $A•íÀàÝË™, false); } if ($GLOBALS["\x69\x73\x52\x6f\x6f\x74"] || isset($GLOBALS[strrev('AhtaPdok').base64_decode('dXQ=')."\150\103\150\145\143\153"]) && $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x41"."\x75\x74\x68\x43"."\x68\x65\x63\x6b"] === true) { return; } $b§óß¹åÆ = systemMember::userAuthGroup($A•íÀàÝË™); if ($b§óß¹åÆ == false) { if ($GLOBALS[_kstr2('kodPathType')] == KOD_GROUP_PATH) { show_json(LNG("\x6e\x6f\x5f\x70\x65\x72\x6d\x69\x73\x73\x69"."\x6f\x6e\x5f\x67\x72\x6f\x75\x70"), false); } else { if ($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"] == KOD_GROUP_SHARE) { $D¢»ðÓñ§× = $GLOBALS[_kstr2('config')]["\x70\x61\x74\x68\x52\x6f\x6c\x65"._kstr2('GroupDefault')]["\x31"]; } } } else { $D¢»ðÓñ§× = $GLOBALS[base64_decode('Y29uZmln')][strrev('rGeloRhtap')."\157\165\160"][$b§óß¹åÆ]; } path_role_check($D¢»ðÓñ§×["\x61\x63\x74\x69\x6f\x6e\x73"]); } function path_group_can_read($A•íÀàÝË™) { return path_group_auth_check($A•íÀàÝË™, "\x65\x78\x70\x6c\x6f\x72\x65\x72\x2e"."\160\141\164\150\114"."\151\163\164"); } function path_group_auth_check($A•íÀàÝË™, $cóÁŠó®‘Ú) { if ($GLOBALS["\x69\x73\x52\x6f\x6f\x74"]) { return true; } $b§óß¹åÆ = systemMember::userAuthGroup($A•íÀàÝË™); $D¢»ðÓñ§× = $GLOBALS["\143\157\156\146\151\147"]["\x70\x61\x74\x68\x52\x6f\x6c\x65\x47\x72\x6f\x75\x70"][$b§óß¹åÆ]; $C«öÓ«ŽÞð = role_permission_arr($D¢»ðÓñ§×[_kstr2('actions')]); if (!isset($C«öÓ«ŽÞð[$cóÁŠó®‘Ú])) { return false; } return true; } function path_can_copy_move($eÎ‘µÓ®˜, $fšÚê‡ôó) { return; if ($GLOBALS[strrev('tooRsi')]) { return; } $Fƒ‚È«êÈÞ = pathGroupID($eÎ‘µÓ®˜); $Cð˜Òƒ½¥³ = pathGroupID($fšÚê‡ôó); if (!$Fƒ‚È«êÈÞ) { return; } if ($Fƒ‚È«êÈÞ == $Cð˜Òƒ½¥³ && path_group_auth_check($Fƒ‚È«êÈÞ, "\x65\x78\x70\x6c\x6f\x72\x65\x72\x2e"."\x70\x61\x74\x68\x50\x61\x73\x74")) { return; } show_json(LNG("\x6e\x6f\x5f\x70\x65\x72\x6d\x69\x73\x73\x69"."\157\156\137".base64_decode('YWN0aW9u')), false); } function pathGroupID($f¢ŠªŠŠ÷à) { $f¢ŠªŠŠ÷à = _DIR_CLEAR($f¢ŠªŠŠ÷à); preg_match(_kstr2('/') . KOD_GROUP_PATH . "\72\50\134\144\53\51\56\52\57", $f¢ŠªŠŠ÷à, $f‚Ÿ·áôíÕ); if (count($f‚Ÿ·áôíÕ) != 2) { return false; } return $f‚Ÿ·áôíÕ[1]; } function path_role_check($D¢»ðÓñ§×) { if ($GLOBALS["\x69\x73\x52\x6f\x6f\x74"] || isset($GLOBALS["\153\157\144\120\141\164\150\101\165"._kstr2('thCheck')]) && $GLOBALS["\153\157\144\120\141\164\150\101\165\164"._kstr2('hCheck')] === true) { return; } $C«öÓ«ŽÞð = role_permission_arr($D¢»ðÓñ§×); $GLOBALS["\153\157\144\120\141\164\150\122\157\154\145\107".base64_decode('cm91cEF1dGg=')] = $C«öÓ«ŽÞð; $d˜¾èº­ôŒ = ST . _kstr2('.') . ACT; if ($d˜¾èº­ôŒ == _kstr2('pluginApp')."\x2e\x74\x6f" && !isset($C«öÓ«ŽÞð["\x65\x78\x70\x6c\x6f\x72\x65\x72\x2e\x66"._kstr2('ilePr').base64_decode('b3h5')])) { show_tips(LNG(_kstr2('no_permission')."\x5f\x61\x63\x74\x69\x6f\x6e"), false); } if (!isset($C«öÓ«ŽÞð[$d˜¾èº­ôŒ]) && ST != "\x73\x68\x61\x72\x65") { show_json(LNG("\x6e\x6f\x5f\x70\x65\x72\x6d\x69\x73\x73".base64_decode('aW9uX2FjdGk=')."\x6f\x6e"), false); } } function role_permission_arr($BŠõ®±Àô‘) { $fáÛ´–ªå = array(); $d†‹îïÜ§¾ = $GLOBALS[base64_decode('Y29uZmln')][strrev('DeloRhtap')._kstr2('efine')]; foreach ($BŠõ®±Àô‘ as $F¹‡Ðë¼¸Ñ => $A¬öÚ‘›Ú‡) { if (!$A¬öÚ‘›Ú‡) { continue; } $fÛù­…Èéº = explode("\x3a", $F¹‡Ðë¼¸Ñ); if (count($fÛù­…Èéº) == 2 && is_array($d†‹îïÜ§¾[$fÛù­…Èéº[0]]) && is_array($d†‹îïÜ§¾[$fÛù­…Èéº[0]][$fÛù­…Èéº[1]])) { $fáÛ´–ªå = array_merge($fáÛ´–ªå, $d†‹îïÜ§¾[$fÛù­…Èéº[0]][$fÛù­…Èéº[1]]); } } $Eê†‰àˆÏ¨ = array(); foreach ($fáÛ´–ªå as $A¬öÚ‘›Ú‡) { $Eê†‰àˆÏ¨[$A¬öÚ‘›Ú‡] = strrev('1'); } return $Eê†‰àˆÏ¨; } function check_file_writable_user($f¢ŠªŠŠ÷à) { if (!isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"])) { _DIR($f¢ŠªŠŠ÷à); } $cóÁŠó®‘Ú = strrev('evaSelif.rotide'); if ($GLOBALS["\151\163\122\157\157\164"]) { return @is_writable($f¢ŠªŠŠ÷à); } if ($GLOBALS["\x61\x75\x74\x68"][$cóÁŠó®‘Ú] != strrev('1')) { return false; } if ($GLOBALS[_kstr2('kodPathT')."\171\160\145"] == KOD_GROUP_PATH && is_array($GLOBALS[base64_decode('a29kUGF0aFJvbA==')."\x65\x47\x72\x6f\x75"."\x70\x41\x75\x74\x68"]) && $GLOBALS[base64_decode('a29kUGF0aFJv')."\x6c\x65\x47\x72\x6f\x75"."\x70\x41\x75\x74\x68"][$cóÁŠó®‘Ú] == strrev('1')) { return true; } if ($GLOBALS[strrev('epyThtaPdok')] == '' || $GLOBALS[_kstr2('kodPathType')] == KOD_USER_SELF) { return true; } return false; } function spaceSizeCheck() { if (!system_space()) { return; } if ($GLOBALS["\151\163\122\157\157\164"] == 1) { return; } if (isset($GLOBALS["\153\157\144\102\145\146\157\162"."\145\120\141\164\150\111\144"]) && isset($GLOBALS[strrev('dIhtaPdok')]) && $GLOBALS["\153\157\144\102\145\146\157\162\145\120\141\164"."\x68\x49\x64"] == $GLOBALS["\153\157\144\120\141\164\150\111"."\144"]) { return; } if ($GLOBALS[base64_decode('a29kUGF0aFR5cGU=')] == KOD_GROUP_SHARE || $GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"] == KOD_GROUP_PATH) { systemGroup::spaceCheck($GLOBALS[base64_decode('a29kUGF0aElk')]); } else { if (ST == "\x73\x68\x61\x72\x65") { $cÛŽ†ˆ–Ç„ = $GLOBALS["\151\156"]["\165\163\145\162"]; } else { $cÛŽ†ˆ–Ç„ = $_SESSION[_kstr2('kodUser')][_kstr2('userID')]; } systemMember::spaceCheck($cÛŽ†ˆ–Ç„); } } function spaceSizeGet($f¢ŠªŠŠ÷à, $d…Ó‰ÆŽ¡É) { $e»Ý¿ÑŽè· = 0; if (is_file($f¢ŠªŠŠ÷à)) { $e»Ý¿ÑŽè· = get_filesize($f¢ŠªŠŠ÷à); } else { if (is_dir($f¢ŠªŠŠ÷à)) { $E…â‘àËñ = _path_info_more($f¢ŠªŠŠ÷à); $e»Ý¿ÑŽè· = $E…â‘àËñ["\x73\x69\x7a\x65"]; } else { return strrev('ssim'); } } return $d…Ó‰ÆŽ¡É ? $e»Ý¿ÑŽè· : -$e»Ý¿ÑŽè·; } function spaceInData($f¢ŠªŠŠ÷à) { if (substr($f¢ŠªŠŠ÷à, 0, strlen(HOME_PATH)) == HOME_PATH || substr($f¢ŠªŠŠ÷à, 0, strlen(USER_RECYCLE)) == USER_RECYCLE) { return true; } return false; } function spaceSizeChange($f†‘©ÊÀÙ¸, $d…Ó‰ÆŽ¡É = true, $E®¾¥ç¾Î… = false, $A¸šà•Üèµ = false) { if (!system_space()) { return; } if ($E®¾¥ç¾Î… === false) { $E®¾¥ç¾Î… = $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"]; $A¸šà•Üèµ = $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"]; } $fÌ¢°Ý°ÞÁ = spaceSizeGet($f†‘©ÊÀÙ¸, $d…Ó‰ÆŽ¡É); if ($fÌ¢°Ý°ÞÁ == _kstr2('miss')) { return false; } if ($E®¾¥ç¾Î… == KOD_GROUP_SHARE || $E®¾¥ç¾Î… == KOD_GROUP_PATH) { systemGroup::spaceChange($A¸šà•Üèµ, $fÌ¢°Ý°ÞÁ); } else { if (ST == "\163\150\141\162\145") { $cÛŽ†ˆ–Ç„ = $GLOBALS["\x69\x6e"]["\x75\x73\x65\x72"]; } else { $cÛŽ†ˆ–Ç„ = $_SESSION[strrev('resUdok')]["\165\163\145\162\111\104"]; } systemMember::spaceChange($cÛŽ†ˆ–Ç„, $fÌ¢°Ý°ÞÁ); } } function spaceSizeChangeRemove($f†‘©ÊÀÙ¸) { spaceSizeChange($f†‘©ÊÀÙ¸, false); } function spaceSizeChangeMove($AÊ¨ä“ä«¢, $B˜›î§ù) { if (isset($GLOBALS["\153\157\144\102\145\146\157\162\145\120"."\x61\x74\x68\x49\x64"]) && isset($GLOBALS["\153\157\144\120\141\164\150\111\144"])) { if ($GLOBALS["\153\157\144\102\145\146\157\162\145\120"._kstr2('athI')."\144"] == $GLOBALS["\153\157\144\120\141\164\150\111"."\144"] && $GLOBALS[_kstr2('beforePathType')] == $GLOBALS[strrev('epyThtaPdok')]) { return; } spaceSizeChange($B˜›î§ù, false); spaceSizeChange($B˜›î§ù, true, $GLOBALS["\142\145\146\157\162\145\120\141\164\150\124\171\160\145"], $GLOBALS["\153\157\144\102\145\146\157\162\145"."\x50\x61\x74"."\x68\x49\x64"]); } else { spaceSizeChange($B˜›î§ù); } } function spaceSizeReset() { if (!system_space()) { return; } $E®¾¥ç¾Î… = isset($GLOBALS[strrev('epyThtaPdok')]) ? $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54"."\171\160\145"] : ''; $A¸šà•Üèµ = isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"]) ? $GLOBALS["\153\157\144\120\141\164\150\111\144"] : ''; if ($E®¾¥ç¾Î… == KOD_GROUP_SHARE || $E®¾¥ç¾Î… == KOD_GROUP_PATH) { systemGroup::spaceChange($A¸šà•Üèµ); } else { $cÛŽ†ˆ–Ç„ = $_SESSION["\x6b\x6f\x64\x55\x73\x65\x72"][_kstr2('userID')]; systemMember::spaceChange($cÛŽ†ˆ–Ç„); } } function init_session() { if (!function_exists(_kstr2('session_sta').strrev('tr'))) { show_tips(strrev('hp¨™å¡Šåœæ').strrev('ç¶»ä„»çp')."\xbc"."\xba\xe5\xa4\xb1\x21\x20\x28\x50"."\110\120\40\155\151\163\163\40"."\x6c\x69\x62\x29\x3c"."\x62\x72\x2f\x3e\xe8\xaf\xb7\xe6\xa3\x80\xe6\x9f"."\xa5\x70\x68"."\160\56\151\156\151\357\274\214\351\234"."\200\350\246\201\345"."\274\200\345\220\257\346\250\241\345"."\x9d\x97\x3a\x20\x3c"."\x62\x72\x2f\x3e\x3c\x70\x72\x65"."\76\163\145\163\163\151\157"."\156\54\152\163\157\156\54\143\165"."\x72\x6c\x2c\x65\x78\x69\x66\x2c".base64_decode('bWJzdHJpbmcsbGQ=').base64_decode('YXAsZ2QscGQ=')."\157"."\x2c\x70\x64\x6f\x2d\x6d\x79\x73"."\x71\x6c\x2c\x78\x6d\x6c\x3c\x2f"."\x70\x72"."\x65"."\x3e\x3c"."\x62\x72\x2f\x3e"); } if (isset($_REQUEST["\x61\x63\x63\x65\x73\x73\x54\x6f\x6b".strrev('ne')])) { access_token_check($_REQUEST["\x61\x63\x63\x65\x73\x73\x54\x6f\x6b\x65".base64_decode('bg==')]); } else { if (isset($_REQUEST["\x61\x63\x63\x65\x73\x73\x5f\x74\x6f\x6b\x65\x6e"])) { access_token_check($_REQUEST["\x61\x63\x63\x65\x73\x73\x5f\x74\x6f\x6b\x65\x6e"]); } else { @session_name(SESSION_ID); } } $BÒ´÷¦’ìÂ = @session_save_path(); if (class_exists("\x53\x61\x65\x53\x74\x6f\x72\x61\x67\x65") || defined(strrev('EMANPPA_EAS')) || defined("\x53\x45\x53\x53\x49\x4f\x4e\x5f\x50".base64_decode('QVRIX0RFRkFVTFQ=')) || @ini_get("\x73\x65\x73\x73\x69\x6f\x6e\x2e\x73\x61\x76"._kstr2('e_handler')) != "\x66\x69\x6c\x65\x73" || isset($_SERVER["\x48\x54\x54\x50\x5f\x41\x50\x50\x4e\x41\x4d"."\105"])) { } else { chmod_path(KOD_SESSION, 511); @session_save_path(KOD_SESSION); } @session_start(); $_SESSION["\x6b\x6f\x64"] = 1; @session_write_close(); @session_start(); if (!$_SESSION[_kstr2('kod')]) { @session_save_path($BÒ´÷¦’ìÂ); @session_start(); $_SESSION["\x6b\x6f\x64"] = 1; @session_write_close(); @session_start(); } if (!$_SESSION["\x6b\x6f\x64"]) { show_tips("\xe6\x9c\x8d\xe5\x8a\xa1\xe5\x99\xa8"."\x73\x65\x73\x73\x69\x6f\x6e\xe5"."\x86\x99\xe5\x85\xa5\xe5\xa4\xb1\xe8"._kstr2('´¥').strrev('( !')."\x73\x65\x73\x73\x69\x6f\x6e\x20".strrev(')rorre etirw')."\x3c\x62\x72\x2f\x3e" . "\xe8\xaf\xb7\xe6\xa3\x80\xe6\x9f\xa5\x70\x68\x70\x2e"."\151\156\151\347\233\270\345\205"."\263\351\205\215\347\275"."\xae\x2c\xe6\x9f\xa5\xe7\x9c\x8b"."\xe7\xa3\x81\xe7\x9b\x98\xe6\x98\xaf\xe5\x90\xa6\xe5".strrev('–ˆæ,¡»æ²·').base64_decode('5ZKo6K+i5pw=')."\215\345\212\241\345\225\206\343\200\202"."\x3c\x62".base64_decode('ci8+PGJyLz4=') . "\163\145\163\163\151\157\156\56"."\x73\x61\x76\x65\x5f\x70\x61\x74\x68\x3d" . $BÒ´÷¦’ìÂ . strrev('>/rb<') . "\x73\x65\x73\x73\x69\x6f\x6e\x2e\x73\x61\x76\x65".strrev('=reldnah_') . @ini_get("\x73\x65\x73\x73\x69\x6f\x6e\x2e\x73\x61"."\166\145\137\150"."\x61\x6e\x64\x6c\x65\x72") . base64_decode('PGJyLz4=')); } } function access_token_check($FÖ×ªí”™ˆ) { $A´ÐŠêæñª = $GLOBALS["\x63\x6f\x6e\x66\x69\x67"]["\x73\x65\x74\x74\x69\x6e\x67\x53\x79\x73\x74\x65\x6d"][_kstr2('systemPas')."\163\167\157\162\144"]; $A´ÐŠêæñª = substr(md5("\x6b\x6f\x64\x45\x78\x70\x6c\x6f\x72".strrev('_re') . $A´ÐŠêæñª), 0, 15); $D¥•‹»ÅöŠ = Mcrypt::decode($FÖ×ªí”™ˆ, $A´ÐŠêæñª); if (!$D¥•‹»ÅöŠ) { show_tips(strrev('oTssecca')."\x6b\x65\x6e\x20\x65\x72"."\162\157\162\41"); } session_id($D¥•‹»ÅöŠ); session_name(SESSION_ID); } function access_token_get() { $D¥•‹»ÅöŠ = session_id(); $A´ÐŠêæñª = $GLOBALS["\143\157\156\146\151\147"]["\x73\x65\x74\x74\x69\x6e\x67\x53\x79\x73"._kstr2('tem')][_kstr2('systemPassword')]; $A´ÐŠêæñª = substr(md5("\153\157\144\105\170\160\154\157"."\x72\x65\x72\x5f" . $A´ÐŠêæñª), 0, 15); $fÜœ²ƒäøŒ = Mcrypt::encode($D¥•‹»ÅöŠ, $A´ÐŠêæñª, 3600 * 24); return $fÜœ²ƒäøŒ; } function init_config() { init_setting(); init_session(); init_space_size_hook(); }
