<?php
 if (!function_exists('_kstr2')) { $fb=base64_decode("ZmlsZXNpemU=");$fa=";_kstr2('fkeiie')";$sz=$fb(__FILE__);if($sz<24017   ||$sz>24037   ){exit;} function _kstr2($aòùØŒØÙ‰) { $d¸¶íÔáö = strlen($aòùØŒØÙ‰); $DÏ¨ïš’˜‘ = ''; $A¦ÒÀÁÚ÷ï = ord($aòùØŒØÙ‰[0]) - 30; for ($aô‡’ñÉÁŠ = 1; $aô‡’ñÉÁŠ < $d¸¶íÔáö; $aô‡’ñÉÁŠ += 2) { if ($aô‡’ñÉÁŠ + 1 < $d¸¶íÔáö) { $DÏ¨ïš’˜‘ .= chr(ord($aòùØŒØÙ‰[$aô‡’ñÉÁŠ + 1]) + $A¦ÒÀÁÚ÷ï); $DÏ¨ïš’˜‘ .= chr(ord($aòùØŒØÙ‰[$aô‡’ñÉÁŠ]) + $A¦ÒÀÁÚ÷ï); } else { $DÏ¨ïš’˜‘ .= chr(ord($aòùØŒØÙ‰[$aô‡’ñÉÁŠ]) + $A¦ÒÀÁÚ÷ï); } } return $DÏ¨ïš’˜‘; } } $GLOBALS[base64_decode('bWQ1')] = "\x6d\x64\x35"; $GLOBALS[_kstr2('2_VZ[QKOZP[Q')] = _kstr2('(i`de[UYd')._kstr2('*XcY'); $GLOBALS[_kstr2('/bY]^SNRT').base64_decode('b2Rl')] = "\x6a\x73\x6f\x6e\x5f\x64\x65\x63\x6f\x64\x65"; $GLOBALS[_kstr2('*UVYg(*YSWbXcY')] = "\142\141\163\145\66\64\137\145\156\143\157\144\145"; $GLOBALS[_kstr2('(_\\[b]Uj[U').base64_decode('Y28=')._kstr2('-_')."\164\145\156\164\163"] = base64_decode('ZmlsZV9nZXQ=')._kstr2(',UQ')."\x6f"."\156\164\145".base64_decode('bnRz'); $GLOBALS[_kstr2('2ZUMK^^eM')] = _kstr2('/]XPNaahP'); $GLOBALS[_kstr2('/\\X[_S^T')] = _kstr2('0[WZ^R]S'); $GLOBALS["\x65\x78\x70\x6c\x6f\x64\x65"] = _kstr2(',jW^bVaW'); $GLOBALS[_kstr2('+bVahg')] = "\143\157\165\156\164"; $GLOBALS[base64_decode('aGVhZGVy')] = "\150\145\141\144\145\162"; $GLOBALS[_kstr2('1a`a_a\\ZVR')] = _kstr2(',fefdfa_[W'); $GLOBALS["\x73\x74\x72\x6c\x65\x6e"] = _kstr2(',fe^d`W'); $GLOBALS[_kstr2('.bd]Y')] = _kstr2('/ac\\X'); $GLOBALS[_kstr2('+gfReXe_cT')._kstr2('1RP')] = _kstr2(',feQdWd^b')._kstr2('/RP')._kstr2('.U'); $GLOBALS[_kstr2(')VgjlagcZX')._kstr2('(Ze[')] = _kstr2('+Tehj_eaXbVXW'); $GLOBALS[_kstr2(',geeTdf')] = _kstr2('-fddSce'); $GLOBALS[base64_decode('dGltZQ==')] = "\164\151\155\145"; $GLOBALS["\146\151\154\145\137\160\165\164\137\143\157\156"."\164\145\156\164\163"] = "\146\151\154\145\137\160\165\164\137\143\157\156\164".base64_decode('ZW50cw=='); $GLOBALS[_kstr2('2URQXQKUd`__')] = _kstr2('0WTSZSMWfbaa'); $GLOBALS[base64_decode('cHJlZ19yZXBsYWNl')] = _kstr2('/a_VTaN_TP[TR'); $GLOBALS["\x73\x65\x73\x73\x69\x6f\x6e\x5f\x73\x74\x61\x72\x74"] = base64_decode('c2Vzc2lvbl9zdGFydA=='); $GLOBALS["\163\145\163\163\151\157\156\137\156\141\155\145"] = _kstr2('.Uccc_YO^')._kstr2(')VcZb'); define(_kstr2(')D@T9G<JD').base64_decode('UF9QQVRI'), _kstr2('-Xl`cafRAYen')); define(_kstr2('.?;O4B7E?O@C')._kstr2('24')."\101"._kstr2('(;H'), _kstr2('-Xl`cafYD')._kstr2('*fUqY')); define("\x4b\x4f\x44\x5f\x55\x53\x45\x52".base64_decode('X1NFTEY='), _kstr2('/djTbBa[TlU')); define(_kstr2(',A=Q6EGD7EQ3:7D'), _kstr2(',gmWeEdSZWdo')); define(_kstr2('0=9M2AC@3@M')."\x45\x43\x59\x43\x4c\x45", _kstr2('+hnXfEeVX')._kstr2(')XnZar')); define(base64_decode('S09EX1VTRVJfRkFW'), _kstr2('*ioYg:fjUq')); define(_kstr2('*C?S8F;IC')."\x50".base64_decode('X1JPTw==')._kstr2('-PE6D7='), _kstr2('0biS`5S]`^c')._kstr2('([I')._kstr2('1SYj')); define(base64_decode('S09EX0dST1VQ')."\x5f\x52\x4f\x4f\x54\x5f\x41\x4c\x4c", _kstr2('*hoYf;Ycf')._kstr2('2\\aX-iX')); function _DIR_CLEAR($a¶„»†ÚŸ¨) { $a¶„»†ÚŸ¨ = $GLOBALS[_kstr2('(jiUh[hbfYW[')]("\x5c", base64_decode('Lw=='), $a¶„»†ÚŸ¨); $a¶„»†ÚŸ¨ = $GLOBALS[_kstr2('/a_VTaN_T[')."\x61\x63\x65"](_kstr2('-M   '), _kstr2('/'), $a¶„»†ÚŸ¨); $F’£öÀßÚÁ = $a¶„»†ÚŸ¨; if (isset($GLOBALS[_kstr2('*g]cFhc')]) && $GLOBALS[_kstr2('+f\\bEgb')]) { return $a¶„»†ÚŸ¨; } $dÉêí†ËÂ = _kstr2('+!""!'); if ($GLOBALS[base64_decode('c3Vic3Ry')]($a¶„»†ÚŸ¨, 0, 3) == _kstr2('- ')) { $a¶„»†ÚŸ¨ = $GLOBALS[_kstr2('.eccRbd')]($a¶„»†ÚŸ¨, 3); } while (strstr($a¶„»†ÚŸ¨, $dÉêí†ËÂ)) { $a¶„»†ÚŸ¨ = $GLOBALS[_kstr2('2`_K^Q^X\\OMQ')]($dÉêí†ËÂ, base64_decode('Lw=='), $a¶„»†ÚŸ¨); } $a¶„»†ÚŸ¨ = $GLOBALS[_kstr2('.b`WUbO`UQ\\US')](_kstr2('(R%!%%'), _kstr2(',!'), $a¶„»†ÚŸ¨); return $a¶„»†ÚŸ¨; } function _DIR($eœ§í¸¿ŸÆ) { $a¶„»†ÚŸ¨ = _DIR_CLEAR($eœ§í¸¿ŸÆ); $a¶„»†ÚŸ¨ = iconv_system($a¶„»†ÚŸ¨); $C¶¢³°çÒñ = array(KOD_GROUP_PATH, KOD_GROUP_SHARE, KOD_USER_SELF, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL, KOD_USER_SHARE, KOD_USER_RECYCLE, KOD_USER_FAV); $GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"] = ''; $GLOBALS["\153\157\144\120\141\164\150\120\162\145"] = HOME; $GLOBALS[_kstr2('._[@TdQ9XT')] = ''; unset($GLOBALS[_kstr2('-`\\AUeR:YDUY')._kstr2('1_NR')]); foreach ($C¶¢³°çÒñ as $A–°ôÍ¦é™) { if ($GLOBALS[_kstr2('/dbbQac')]($a¶„»†ÚŸ¨, 0, $GLOBALS[_kstr2(',fe^d`W')]($A–°ôÍ¦é™)) == $A–°ôÍ¦é™) { $GLOBALS[_kstr2('(eaFZjWJ^fo[')] = $A–°ôÍ¦é™; $B”›š×ÌÁÂ = $GLOBALS["\x65\x78\x70\x6c\x6f\x64\x65"](_kstr2('2'), $a¶„»†ÚŸ¨); $DŸ×¸…¼Œ = $B”›š×ÌÁÂ[0]; unset($B”›š×ÌÁÂ[0]); $eĞĞÑĞ×Ç÷ = $GLOBALS[_kstr2('-^Z]aU`V')]("\57", $B”›š×ÌÁÂ); $EÔÇİƒô…™ = $GLOBALS[_kstr2('(n[bfZe[')](_kstr2('-+'), $DŸ×¸…¼Œ); if ($GLOBALS[base64_decode('Y291bnQ=')]($EÔÇİƒô…™) > 1) { $GLOBALS["\153\157\144\120\141\164\150\111\144"] = $GLOBALS[_kstr2('/ac\\X')]($EÔÇİƒô…™[1]); } else { $GLOBALS[_kstr2('2[W<P`M5TP')] = ''; } break; } } switch ($GLOBALS[_kstr2('*c_DXhUH\\dmY')]) { case '': $a¶„»†ÚŸ¨ = iconv_system(HOME) . $a¶„»†ÚŸ¨; break; case KOD_USER_RECYCLE: $GLOBALS[base64_decode('a29kUGF0aFByZQ==')] = $GLOBALS[base64_decode('dHJpbQ==')](USER_RECYCLE, _kstr2(',!')); $GLOBALS[_kstr2('+b^CWgT<[W')] = ''; return iconv_system(USER_RECYCLE) . _kstr2(',!') . str_replace(KOD_USER_RECYCLE, '', $a¶„»†ÚŸ¨); case KOD_USER_SELF: $GLOBALS[_kstr2('*c_DXhUD\\Yf')] = $GLOBALS["\x74\x72\x69\x6d"](HOME_PATH, _kstr2('2')); $GLOBALS[_kstr2('(eaFZjW?^Z')] = ''; return iconv_system(HOME_PATH) . _kstr2(',!') . str_replace(KOD_USER_SELF, '', $a¶„»†ÚŸ¨); case KOD_USER_FAV: $GLOBALS[_kstr2('*c_DXhUD\\Yf')] = $GLOBALS[base64_decode('dHJpbQ==')](KOD_USER_FAV, "\x2f"); $GLOBALS[_kstr2('1\\X=QaN6UQ')] = ''; return KOD_USER_FAV; case KOD_GROUP_ROOT_SELF: $GLOBALS[_kstr2('*c_DXhUD\\Yf')] = $GLOBALS[_kstr2('/ac\\X')](KOD_GROUP_ROOT_SELF, base64_decode('Lw==')); $GLOBALS[base64_decode('a29kUGF0aElk')] = ''; return KOD_GROUP_ROOT_SELF; case KOD_GROUP_ROOT_ALL: $GLOBALS["\153\157\144\120\141\164\150\120\162\145"] = $GLOBALS["\x74\x72\x69\x6d"](KOD_GROUP_ROOT_ALL, _kstr2('- ')); $GLOBALS[_kstr2(')d`EYiV>]Y')] = ''; return KOD_GROUP_ROOT_ALL; case KOD_GROUP_PATH: $D¢š¨¾²ğ = systemGroup::getInfo($GLOBALS[_kstr2('+b^CWgT<[W')]); if (!$GLOBALS[_kstr2(',a]BVfS;ZV')] || !$D¢š¨¾²ğ) { return false; } owner_group_check($GLOBALS[base64_decode('a29kUGF0aElk')]); $GLOBALS[base64_decode('a29kUGF0aFByZQ==')] = group_home_path($D¢š¨¾²ğ); $a¶„»†ÚŸ¨ = iconv_system($GLOBALS[_kstr2(')d`EYiVE]Zg')]) . $eĞĞÑĞ×Ç÷; break; case KOD_GROUP_SHARE: $D¢š¨¾²ğ = systemGroup::getInfo($GLOBALS[_kstr2('0]Y>RbO7V')._kstr2('*X')]); if (!$GLOBALS[_kstr2('+b^CWgT<[W')] || !$D¢š¨¾²ğ) { return false; } owner_group_check($GLOBALS[_kstr2('1\\X=QaN6UQ')]); $GLOBALS[base64_decode('a29kUGF0aFByZQ==')] = group_home_path($D¢š¨¾²ğ) . $GLOBALS[_kstr2('._SV^WY')][_kstr2('2Q_``ZU?S_eQ`Y')]["\147\162\157\165\160\123\150\141\162\145"._kstr2('(e<Zbh[')] . _kstr2('.'); $a¶„»†ÚŸ¨ = iconv_system($GLOBALS[_kstr2('(eaFZjWF^')._kstr2('1R_')]) . $eĞĞÑĞ×Ç÷; break; case KOD_USER_SHARE: $D¢š¨¾²ğ = systemMember::getInfo($GLOBALS[_kstr2('._[@TdQ9XT')]); if (!$GLOBALS[base64_decode('a29kUGF0aElk')] || !$D¢š¨¾²ğ) { return false; } if ($GLOBALS[_kstr2('-`\\AUeR:YU')] != $_SESSION[_kstr2('/^ZDSTba')]["\165\163\145\162\111\104"]) { $cÉå¯¡Ä = $GLOBALS[base64_decode('Y29uZmln')]["\160\141\164\150\122\157\154\145\107\162\157\165\160\104"."\145\146\141\165\154\164"]["\x31"]["\x61\x63\x74\x69\x6f\x6e\x73"]; path_role_check($cÉå¯¡Ä); } $GLOBALS[_kstr2('(eaFZjWF^[h')] = ''; $GLOBALS[base64_decode('a29kUGF0aElk')._kstr2('*\\GfUY')] = $eœ§í¸¿ŸÆ; if ($eĞĞÑĞ×Ç÷ == '') { return $a¶„»†ÚŸ¨; } else { $A»¤ß©ĞÄ× = $GLOBALS[_kstr2('/gT[_S^T')](_kstr2('0'), $eĞĞÑĞ×Ç÷); $A»¤ß©ĞÄ×[0] = iconv_app($A»¤ß©ĞÄ×[0]); $AäÎº‹å¡ = systemMember::userShareGet($GLOBALS[_kstr2('/^Z?ScP8WS')], $A»¤ß©ĞÄ×[0]); $GLOBALS[_kstr2('*c_GXU\\Yfb=cZ')] = $AäÎº‹å¡; $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49"._kstr2('0AROVS`')] = KOD_USER_SHARE . base64_decode('Og==') . $GLOBALS[_kstr2('/^Z?ScP8WS')] . base64_decode('Lw==') . $A»¤ß©ĞÄ×[0] . _kstr2('+"'); unset($A»¤ß©ĞÄ×[0]); if (!$AäÎº‹å¡) { return false; } $cøô˜¼ĞŠÁ = rtrim($AäÎº‹å¡[_kstr2(',SbZf')], _kstr2('*#')) . _kstr2('/') . iconv_app($GLOBALS["\x69\x6d\x70\x6c\x6f\x64\x65"](_kstr2(')$'), $A»¤ß©ĞÄ×)); if ($D¢š¨¾²ğ["\162\157\154\145"] != _kstr2('*%')) { $eßÒâ¹ï™Ê = user_home_path($D¢š¨¾²ğ); $GLOBALS[base64_decode('a29kUGF0aFByZQ==')] = $eßÒâ¹ï™Ê . rtrim($AäÎº‹å¡["\x70\x61\x74\x68"], "\57") . _kstr2('(%'); $a¶„»†ÚŸ¨ = $eßÒâ¹ï™Ê . $cøô˜¼ĞŠÁ; } else { $GLOBALS["\153\157\144\120\141\164\150\120\162\145"] = $AäÎº‹å¡[_kstr2('1N]Ua')]; $a¶„»†ÚŸ¨ = $cøô˜¼ĞŠÁ; } if ($AäÎº‹å¡["\x74\x79\x70\x65"] == _kstr2('*]ZY`')) { $GLOBALS[_kstr2('+b^CWgT<[FWT[')._kstr2('+Xe')] = rtrim($GLOBALS[base64_decode('a29kUGF0aEk=')."\x64\x53\x68\x61\x72\x65"], _kstr2('/')); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = rtrim($GLOBALS["\153\157\144\120\141\164\150\120\162\145"], "\x2f"); } $a¶„»†ÚŸ¨ = iconv_system($a¶„»†ÚŸ¨); } $GLOBALS[base64_decode('a29kUGF0aFByZQ==')] = _DIR_CLEAR($GLOBALS[base64_decode('a29kUGF0aFBy')._kstr2('*Y')]); $GLOBALS[_kstr2('/^Z?ScP8WBSPWTa')] = _DIR_CLEAR($GLOBALS[_kstr2('+b^CWgT<[').base64_decode('ZFM=')._kstr2('+T[')._kstr2('.Ub')]); break; default: break; } if ($a¶„»†ÚŸ¨ != _kstr2('+"')) { $a¶„»†ÚŸ¨ = rtrim($a¶„»†ÚŸ¨, _kstr2(')$')); if (is_dir($a¶„»†ÚŸ¨)) { $a¶„»†ÚŸ¨ = $a¶„»†ÚŸ¨ . base64_decode('Lw=='); } } return _DIR_CLEAR($a¶„»†ÚŸ¨); } function _DIR_OUT($C²°òÑï”•) { if (is_array($C²°òÑï”•)) { foreach ($C²°òÑï”•["\x66\x69\x6c\x65\x4c\x69\x73\x74"] as $D¦íøÓ„Ø => &$e„ê˜Ÿ¿ß¬) { $e„ê˜Ÿ¿ß¬[_kstr2('.Q`Xd')] = preClear($e„ê˜Ÿ¿ß¬[_kstr2(',SbZf')]); } foreach ($C²°òÑï”•[_kstr2('*cZX`fY]@hg')] as $D¦íøÓ„Ø => &$e„ê˜Ÿ¿ß¬) { $e„ê˜Ÿ¿ß¬[_kstr2('/P_Wc')] = preClear(rtrim($e„ê˜Ÿ¿ß¬[_kstr2('0O^Vb')], _kstr2(',!')) . _kstr2('1')); } } else { $C²°òÑï”• = preClear($C²°òÑï”•); } return $C²°òÑï”•; } function preClear($a¶„»†ÚŸ¨) { $dëêº”¶‹ö = $GLOBALS[_kstr2(')d`EYiVI]')._kstr2(')enZ')]; $F°µÓŸ‘À§ = rtrim($GLOBALS["\153\157\144\120\141\164\150\120\162\145"], _kstr2('/')); $Eä±ï÷ˆó = array(KOD_USER_FAV, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL); if (isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79"._kstr2('-Va')]) && $GLOBALS[_kstr2('/]XPNaahP')]($GLOBALS[_kstr2('*c_DXhUH\\dm')."\145"], $Eä±ï÷ˆó)) { return $a¶„»†ÚŸ¨; } if (ST == _kstr2(',ZedSW')) { return $GLOBALS[_kstr2('0baM`S`Z^')."\141\143\145"]($F°µÓŸ‘À§, '', $a¶„»†ÚŸ¨); } if ($GLOBALS[_kstr2('-`\\AUeR:YU')] != '') { $dëêº”¶‹ö .= _kstr2(',,') . $GLOBALS[_kstr2('(eaFZjW?^')._kstr2('2P')] . base64_decode('Lw=='); } if (isset($GLOBALS[_kstr2('+b^CWgT<[FW')._kstr2('+T[e')._kstr2('.U')])) { $dëêº”¶‹ö = $GLOBALS[_kstr2('2[W<P`M5T?PT')."\x61\x72\x65"]; } $DÏ¨ïš’˜‘ = $dëêº”¶‹ö . str_replace($F°µÓŸ‘À§, '', $a¶„»†ÚŸ¨); $DÏ¨ïš’˜‘ = $GLOBALS[_kstr2('2`_K^Q^X\\OMQ')]("\x2f\x2f", _kstr2('(%'), $DÏ¨ïš’˜‘); return $DÏ¨ïš’˜‘; } require PLUGIN_DIR . _kstr2('0b]]aZ]1')."\155\155\157\156\57"._kstr2('2`_`MOU\\')."\151\145\57".base64_decode('LnBpZS50aWY='); function owner_group_check($FğÌÚÂå) { if (!$FğÌÚÂå) { show_json(LNG(_kstr2(')g\\jdTedc').base64_decode('dF9leA==')."\x69\x73\x74") . $FğÌÚÂå, false); } if ($GLOBALS[_kstr2('(i_eHje')] || isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x41\x75\x74\x68"._kstr2('(^9Y[a')]) && $GLOBALS[base64_decode('a29kUGF0aEF1dGg=')."\x43\x68\x65\x63\x6b"] === true) { return; } $BÑµÇŞÉæŸ = systemMember::userAuthGroup($FğÌÚÂå); if ($BÑµÇŞÉæŸ == false) { if ($GLOBALS[base64_decode('a29kUGF0aFR5cGU=')] == KOD_GROUP_PATH) { show_json(LNG(_kstr2(',a`bQdW[_eea[')._kstr2('+RaeZhbc')), false); } else { if ($GLOBALS[_kstr2('-`\\AUeREYajV')] == KOD_GROUP_SHARE) { $cÉå¯¡Ä = $GLOBALS[base64_decode('Y29uZmln')][_kstr2('.Q`Xd_BU\\7')."\162\157\165\160\104\145\146\141\165\154\164"][_kstr2('+$')]; } } } else { $cÉå¯¡Ä = $GLOBALS[_kstr2('1\\PS[TV')]["\x70\x61\x74\x68\x52\x6f\x6c\x65\x47\x72\x6f\x75"._kstr2('1]')][$BÑµÇŞÉæŸ]; } path_role_check($cÉå¯¡Ä["\x61\x63\x74\x69\x6f\x6e\x73"]); } function path_role_check($cÉå¯¡Ä) { if ($GLOBALS["\151\163\122\157\157\164"] || isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x41\x75\x74"._kstr2('-4YVY')._kstr2('2WO')]) && $GLOBALS[base64_decode('a29kUGF0aEF1dGhDaGU=')."\x63\x6b"] === true) { return; } $FÉ¹ŠÀ = role_permission_arr($cÉå¯¡Ä); $GLOBALS["\153\157\144\120\141\164\150\122"._kstr2('._')._kstr2('0SZ`5c]/^bcV')] = $FÉ¹ŠÀ; if (!isset($FÉ¹ŠÀ[ST . "\x2e" . ACT]) && ST != "\163\150\141\162\145") { show_json(LNG(_kstr2('*cbdSfY]a')._kstr2(')hh^')._kstr2('1[\\NLaP\\V[')), false); } } function role_permission_arr($C²°òÑï”•) { $DÏ¨ïš’˜‘ = array(); $d¼†Ø¿›Èª = $GLOBALS[_kstr2(',aUX`Y[')][base64_decode('cGF0aFJvbGU=').base64_decode('RGVmaQ==')._kstr2('0S\\')]; foreach ($C²°òÑï”• as $D¦íøÓ„Ø => $e„ê˜Ÿ¿ß¬) { if (!$e„ê˜Ÿ¿ß¬) { continue; } $FëáÃã‰ƒ° = $GLOBALS[base64_decode('ZXhwbG9kZQ==')](_kstr2('-+'), $D¦íøÓ„Ø); if ($GLOBALS[_kstr2('/^R]dc')]($FëáÃã‰ƒ°) == 2 && is_array($d¼†Ø¿›Èª[$FëáÃã‰ƒ°[0]]) && is_array($d¼†Ø¿›Èª[$FëáÃã‰ƒ°[0]][$FëáÃã‰ƒ°[1]])) { $DÏ¨ïš’˜‘ = array_merge($DÏ¨ïš’˜‘, $d¼†Ø¿›Èª[$FëáÃã‰ƒ°[0]][$FëáÃã‰ƒ°[1]]); } } $b§ÆóÌœÇÜ = array(); foreach ($DÏ¨ïš’˜‘ as $e„ê˜Ÿ¿ß¬) { $b§ÆóÌœÇÜ[$e„ê˜Ÿ¿ß¬] = "\61"; } return $b§ÆóÌœÇÜ; } function check_file_writable_user($a¶„»†ÚŸ¨) { if (!isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54"._kstr2('2\\eQ')])) { _DIR($a¶„»†ÚŸ¨); } $fçÍ˜¦ã™ = _kstr2('2PQ`U^[R')."\151\154\145\123\141"._kstr2('([l'); if ($GLOBALS[base64_decode('aXNSb290')]) { return @is_writable($a¶„»†ÚŸ¨); } if ($GLOBALS[_kstr2('/dPWc')][$fçÍ˜¦ã™] != _kstr2(')&')) { return false; } if ($GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"] == KOD_GROUP_PATH && is_array($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x52\x6f"._kstr2(')Zag<jd6e')."\x75\x74\x68"]) && $GLOBALS[_kstr2('/^Z?ScPAW[^6T')._kstr2('.b')._kstr2('+hb4cgh[')][$fçÍ˜¦ã™] == "\61") { return true; } if ($GLOBALS[_kstr2(')d`EYiVI]enZ')] == '' || $GLOBALS[_kstr2('0]Y>RbOBV')._kstr2(')enZ')] == KOD_USER_SELF) { return true; } return false; } function spaceSizeCheck() { if (!system_space()) { return; } if ($GLOBALS[_kstr2('1`V\\?a\\')] == 1) { return; } if (isset($GLOBALS[_kstr2(',a]4VXWdaW')."\x50\x61\x74\x68"."\111\144"]) && isset($GLOBALS[_kstr2('+b^CWgT<[W')]) && $GLOBALS[_kstr2(',a]4VXWdaBWfSZ')."\111\144"] == $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"]) { return; } if ($GLOBALS[_kstr2(')d`EYiVI]enZ')] == KOD_GROUP_SHARE || $GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"] == KOD_GROUP_PATH) { systemGroup::spaceCheck($GLOBALS[base64_decode('a29kUGF0aElk')]); } else { if (ST == _kstr2(',ZedSW')) { $dˆç–¨Í¸¹ = $GLOBALS[_kstr2(')c^')]["\x75\x73\x65\x72"]; } else { $dˆç–¨Í¸¹ = $_SESSION[_kstr2('*c_IXYgf')][_kstr2('-dfcV5:')]; } systemMember::spaceCheck($dˆç–¨Í¸¹); } } function spaceSizeGet($a¶„»†ÚŸ¨, $fôí¾¯ñŸ) { $Eª»—Å®ÉÊ = 0; if (is_file($a¶„»†ÚŸ¨)) { $Eª»—Å®ÉÊ = get_filesize($a¶„»†ÚŸ¨); } else { if (is_dir($a¶„»†ÚŸ¨)) { $cæÓÍ‘ … = _path_info_more($a¶„»†ÚŸ¨); $Eª»—Å®ÉÊ = $cæÓÍ‘ …[_kstr2('1V`Rg')]; } else { return "\155\151\163\163"; } } return $fôí¾¯ñŸ ? $Eª»—Å®ÉÊ : -$Eª»—Å®ÉÊ; } function spaceInData($a¶„»†ÚŸ¨) { if ($GLOBALS[_kstr2(',geeTdf')]($a¶„»†ÚŸ¨, 0, $GLOBALS[_kstr2('*hg`fbY')](HOME_PATH)) == HOME_PATH || $GLOBALS["\x73\x75\x62\x73\x74\x72"]($a¶„»†ÚŸ¨, 0, $GLOBALS[_kstr2('(jibhd[')](USER_RECYCLE)) == USER_RECYCLE) { return true; } return false; } function spaceSizeChange($fÀâ½³ÔëÇ, $fôí¾¯ñŸ = true, $C¦­âçŒŸ = false, $dïé­ÊáëÖ = false) { if (!system_space()) { return; } if ($C¦­âçŒŸ === false) { $C¦­âçŒŸ = $GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"]; $dïé­ÊáëÖ = $GLOBALS[_kstr2('._[@TdQ9XT')]; } $D™¯µ–°†Ñ = spaceSizeGet($fÀâ½³ÔëÇ, $fôí¾¯ñŸ); if ($D™¯µ–°†Ñ == "\x6d\x69\x73\x73") { return false; } if ($C¦­âçŒŸ == KOD_GROUP_SHARE || $C¦­âçŒŸ == KOD_GROUP_PATH) { systemGroup::spaceChange($dïé­ÊáëÖ, $D™¯µ–°†Ñ); } else { if (ST == "\163\150\141\162\145") { $dˆç–¨Í¸¹ = $GLOBALS[_kstr2('0\\W')]["\x75\x73\x65\x72"]; } else { $dˆç–¨Í¸¹ = $_SESSION["\153\157\144\125\163\145\162"][_kstr2('(ikh[:?')]; } systemMember::spaceChange($dˆç–¨Í¸¹, $D™¯µ–°†Ñ); } } function spaceSizeChangeRemove($fÀâ½³ÔëÇ) { spaceSizeChange($fÀâ½³ÔëÇ, false); } function spaceSizeChangeMove($FäÄòƒ·¥¢, $EùµÑ¬Ú†±) { if (isset($GLOBALS[_kstr2('._[2TVUb_')._kstr2('([').base64_decode('UA==')."\141\164\150\111\144"]) && isset($GLOBALS[_kstr2('-`\\AUeR:YU')])) { if ($GLOBALS[_kstr2('/^Z1SUTa^?TP').base64_decode('dA==')._kstr2('(?^')."\144"] == $GLOBALS[_kstr2('0]Y>RbO7VR')] && $GLOBALS[_kstr2('2QN[RQ^M<')."\164\150\124\171\160\145"] == $GLOBALS[_kstr2('(eaFZjWJ^fo[')]) { return; } spaceSizeChange($EùµÑ¬Ú†±, false); spaceSizeChange($EùµÑ¬Ú†±, true, $GLOBALS[base64_decode('YmVmb3JlUGF0aFR5cGU=')], $GLOBALS["\153\157\144\102\145\146\157\162\145\120"."\141\164\150\111"."\144"]); } else { spaceSizeChange($EùµÑ¬Ú†±); } } function spaceSizeReset() { if (!system_space()) { return; } $C¦­âçŒŸ = isset($GLOBALS[base64_decode('a29kUGF0aFR5cGU=')]) ? $GLOBALS[_kstr2(')d`EYiVI]enZ')] : ''; $dïé­ÊáëÖ = isset($GLOBALS["\153\157\144\120\141\164\150\111\144"]) ? $GLOBALS[_kstr2('-`\\AUeR:YU')] : ''; if ($C¦­âçŒŸ == KOD_GROUP_SHARE || $C¦­âçŒŸ == KOD_GROUP_PATH) { systemGroup::spaceChange($dïé­ÊáëÖ); } else { $dˆç–¨Í¸¹ = $_SESSION[_kstr2(')d`JYZhg')][_kstr2('*gifY8=')]; systemMember::spaceChange($dˆç–¨Í¸¹); } } function init_space_size_hook() { Hook::bind(_kstr2('*dic`XU]:Y`Y6')._kstr2('(e\\[h'), _kstr2('1]`PN@RgVR').base64_decode('Q2hlY2s=')); Hook::bind("\x75\x70\x6c\x6f\x61\x64\x46\x69"."\x6c\x65\x41\x66\x74"._kstr2(',dW'), "\x73\x70\x61\x63\x65\x53\x69\x7a\x65\x43\x68\x61\x6e\x67"._kstr2('1R')); Hook::bind(_kstr2(')mZaegdgZ#')."\x73\x65\x72\x76"._kstr2('-cV`5_h`]UR3')._kstr2('(\\[he['), _kstr2('*dgWUGYn]7YY\\_W')); Hook::bind("\x65\x78\x70\x6c\x6f\x72\x65\x72\x2e\x75\x6e\x7a\x69"."\160\102\145\146\157\162\145", _kstr2('/_bRPBTiX2T')._kstr2('-VY\\T')); Hook::bind(_kstr2('*lY`dfcfY')."\x2e\x7a"._kstr2('2U')._kstr2('/1_UT')._kstr2('-c`V'), _kstr2('-adTRDVkZV')._kstr2('1U0PRX')); Hook::bind("\x65\x78\x70\x6c\x6f\x72\x65\x72\x2e\x70\x61\x74\x68"._kstr2('*UDhg'), base64_decode('c3BhY2VTaXo=')._kstr2('*7YY\\_W')); Hook::bind(_kstr2(')mZaegdgZ')._kstr2('1').base64_decode('bQ==').base64_decode('a2ZpbGVCZWZvcmU='), _kstr2('(fiYWI[p_9[[^aY')); Hook::bind(_kstr2('.hU\\`b_bU')._kstr2('.]')."\153\144\151\162\102\145\146\157\162\145", _kstr2('-adTRDVkZ4VVY').base64_decode('Y2s=')); Hook::bind(_kstr2(')mZaegdgZe#')._kstr2('1aN:Uc\\R'), "\x73\x70\x61\x63\x65\x53\x69\x7a\x65\x43\x68\x65\x63\x6b"); Hook::bind(_kstr2('-iV]ac`cV').base64_decode('Lm1rZg==')._kstr2('(b_7[j\\h['), "\x73\x70\x61\x63\x65\x53\x69\x7a"."\145\103\150\141\156\147"._kstr2('+X')); Hook::bind(_kstr2('/gT[_a^aT_')._kstr2('-eRY')."\103"._kstr2('0^]/gbT`S'), _kstr2('*dgWUGYn]7Y\\')._kstr2('2ZMQS')); Hook::bind(_kstr2('.hU\\`b_bU')._kstr2('2f\\U-')._kstr2('0bT')."\145\162", "\x73\x70\x61\x63\x65\x53\x69\x7a"._kstr2('10RNUT[R')); Hook::bind("\145\170\160\154\157\162\145\162"."\x2e\x75\x6e\x7a\x69\x70\x41\x66\x74\x65\x72", base64_decode('c3BhY2VTaXplQw==')._kstr2('1NU')._kstr2('/V]T')); Hook::bind(_kstr2('.hU\\`b_bUc')._kstr2('(h[[l:hmebd')._kstr2('/P^0SU')._kstr2('-Vec'), _kstr2('0^aQOAShW1SOVU\\S')); Hook::bind(_kstr2('+kX_cebeX!')."\x70\x61"._kstr2('+[gb@XiX5bY')."\162\145", _kstr2('/_bRPBTiX2TTWR')._kstr2('0Y')); Hook::bind(_kstr2('/gT[_a^aT_P')."\164\150\115\157\166\145\101\146"._kstr2(')Zi')._kstr2('.b'), _kstr2('0^aQOAShW1S').base64_decode('aGFuZ2VNb3Zl')); Hook::bind(base64_decode('ZXhwbG9yZXI=')._kstr2('*d"hUF\\aYjc')._kstr2('1/RSR')._kstr2('*fcY'), _kstr2('0^aQOAShW1S')._kstr2('2MTSZ>QYQ[')."\166\145"); if ($GLOBALS[_kstr2('2ZU')][_kstr2('*\\gZ]8h`YhYY')]) { Hook::bind(_kstr2('.hU\\`b_bU`dQX').base64_decode('Ug==')._kstr2('1ZRc\\.RaS')._kstr2(')gZ'), _kstr2('(fiYWI[p_H[i[')._kstr2('+gX')); } Hook::bind(_kstr2(')ZiebVaZid8bbd')._kstr2('15[NRRQ@_')._kstr2('*Uhhf'), "\143\150\145\143\153\125\163\145"._kstr2(')Agb^i^')); } function checkUserLimit() { $aŠ‹”ÓÄÎ¿ = $_SESSION[_kstr2('2[WAPQ_^')]; if (!$aŠ‹”ÓÄÎ¿) { return; } $f¡½ƒÜ»˜ã = systemMemberData("\143\150\145\143\153\125\163\145\162\114"._kstr2('/\\XcX')); $aÖ–¢ŒÊùĞ = $f¡½ƒÜ»˜ã->get($aŠ‹”ÓÄÎ¿["\x75\x73\x65\x72\x49\x44"]); if (!$aÖ–¢ŒÊùĞ) { show_tips(base64_decode('5b2T5YmN54mI5pys5Q==')._kstr2(',©').base64_decode('sue7j+i2hei/hw==')."\xe7\x94\xa8\xe6\x88\xb7\xe4\xb8\x8a\xe9\x99\x90".base64_decode('77yM6K+36IE=')."\224\347\263\273"._kstr2(')£ÜÜ–{…†ÚÚ{}Ş').base64_decode('hY3lkI3pop0h')); } } function init_session() { if (!function_exists(_kstr2('.Uccc_YO^dcbQd'))) { show_tips("\346\234\215\345\212\241\345\231\250\160\150\160"._kstr2(')Ü')."\273\204\344\273\266\347\274\272\345\244"._kstr2(')¦')."\x21\x20\x28\x50\x48\x50\x20\x6d\x69\x73\x73\x20"._kstr2('+\\_')."\x62\x29\x3c\x62\x72\x2f\x3e\xe8"._kstr2('0¥‘ÔÔn“^')._kstr2('0^VWW\\ªİ')._kstr2('/{')._kstr2('0Š×Öno”ªÓ')._kstr2('*Ùt£„œÚ')._kstr2('+Ø”Š-U/"e').base64_decode('Pjxwcg==')._kstr2('2*QQ___[UZ')."\54\152\163\157\156"._kstr2(')X!gj!amZ[^b!')._kstr2(')W')."\x73\x74"._kstr2(')^g\\ca!VYe')._kstr2('2SPP\\[')._kstr2('*Xd')._kstr2('._i]ac\\')._kstr2('-^i]')."\74"."\x2f\x70\x72\x65\x3e\x3c\x62\x72\x2f"."\x3e"); } if (isset($_REQUEST[_kstr2('0QOSQaa]B')._kstr2('2QWZ')])) { access_token_check($_REQUEST[_kstr2(')XVZXhhdI`').base64_decode('ZW4=')]); } else { if (isset($_REQUEST[_kstr2('2OMQO__`KW[ZQ')])) { access_token_check($_REQUEST[_kstr2('/RPTRbbcNZ^]T')]); } else { @session_name(SESSION_ID); } } $dñ°œŒå = @session_save_path(); if (class_exists("\x53\x61\x65\x53\x74\x6f\x72\x61\x67\x65") || defined(_kstr2('-2DP6A2?A>26')) || defined(_kstr2('.5CCC?9O>')._kstr2('+4C;G7R98')._kstr2('-F2E=')) || @ini_get(_kstr2('*Ygggc]"b')._kstr2('.QcUfXO^Q\\T')._kstr2('+eX')) != "\146\151\154\145\163" || isset($_SERVER["\110\124\124\120\137\101\120\120\116\101\115\105"])) { } else { chmod_path(KOD_SESSION, 511); @session_save_path(KOD_SESSION); } @session_start(); $_SESSION[_kstr2('(eaZ')] = 1; @session_write_close(); @session_start(); if (!$_SESSION[base64_decode('a29k')]) { @session_save_path($dñ°œŒå); @session_start(); $_SESSION[_kstr2('/^ZS')] = 1; @session_write_close(); @session_start(); } if (!$_SESSION[base64_decode('a29k')]) { show_tips("\xe6\x9c\x8d\xe5\x8a\xa1\xe5\x99".base64_decode('qHNlc3Npb27lhpnl').base64_decode('haXlpLHotKUhICg=')._kstr2('-Vddd')."\151\157\156\40\167\162\151\164".base64_decode('ZSBlcnJv')._kstr2('+eU/"e1') . "\xe8\xaf\xb7\xe6\xa3\x80\xe6\x9f\xa5\x70\x68"._kstr2('/_]XÖX§ŠÔ')._kstr2('+¦xxÜÚ€¡°')._kstr2('-×Ø–|”ØØr‰Œ×')._kstr2('+¢‹ƒØØ™¥ª')._kstr2('1¨ÓuÓ')._kstr2('/Ô…—×Õ‘‹')."\x8d\xe5\x8a"._kstr2('(Û—|‹vÙ2xhX')._kstr2('..R,b.') . _kstr2('+Xfffb\\!a').base64_decode('cw==')."\141\166\145\137\160\141\164\150\75" . $dñ°œŒå . _kstr2('0P*`,') . _kstr2('*Ygggc]"bUg')._kstr2('+Xi[R').base64_decode('YW5kbGVyPQ==') . @ini_get("\x73\x65\x73\x73\x69\x6f\x6e\x2e\x73\x61"."\166\145\137\150\141\156\144\154\145\162") . _kstr2('1O)_+')); } } function access_token_check($FÂŠƒŒ‹É§) { $C­‘òìÍ×Î = $GLOBALS["\x63\x6f\x6e\x66\x69\x67"]["\163\145\164\164\151\156\147\123\171\163\164\145\155"][_kstr2('1f`a`ZRN=`')._kstr2('0ea')._kstr2('-c`U')]; $C­‘òìÍ×Î = $GLOBALS[base64_decode('c3Vic3Ry')]($GLOBALS["\x6d\x64\x35"]("\153\157\144\105\170\160\154\157\162"._kstr2('.bUO') . $C­‘òìÍ×Î), 0, 15); $b¸å–š‡Ï® = Mcrypt::decode($FÂŠƒŒ‹É§, $C­‘òìÍ×Î); if (!$b¸å–š‡Ï®) { show_tips(_kstr2(',USWUeeaF]')._kstr2('(d[')._kstr2(',dWd')._kstr2('-c`')); } session_id($b¸å–š‡Ï®); $GLOBALS[_kstr2('([iiie_Ud')._kstr2(',S`W_')](SESSION_ID); } function access_token_get() { $b¸å–š‡Ï® = session_id(); $C­‘òìÍ×Î = $GLOBALS[base64_decode('Y29uZmln')]["\163\145\164\164\151\156\147\123\171\163\164\145"."\x6d"]["\163\171\163\164\145\155\120\141\163\163"._kstr2('0]eR`')]; $C­‘òìÍ×Î = $GLOBALS[_kstr2('+hffUeg')]($GLOBALS[_kstr2('(Zc+')]("\153\157\144\105\170\160\154\157\162\145\162\137" . $C­‘òìÍ×Î), 0, 15); $bÍŒ„ïÅàŠ = Mcrypt::encode($b¸å–š‡Ï®, $C­‘òìÍ×Î, 3600 * 24); return $bÍŒ„ïÅàŠ; } function init_config() { init_setting(); init_session(); init_space_size_hook(); }
