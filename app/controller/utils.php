<?php
 if (!function_exists('_kstr2')) { function _kstr2($e·œÙ£¸é) { return $e·œÙ£¸é; $d…ê¹œØ¥° = strlen($e·œÙ£¸é); $eÍ£ªƒ…âŞ = ''; $b·Â¡´æ…ß = ord($e·œÙ£¸é[0]) - 30; for ($CÚŸ’µƒ¯² = 1; $CÚŸ’µƒ¯² < $d…ê¹œØ¥°; $CÚŸ’µƒ¯² += 2) { if ($CÚŸ’µƒ¯² + 1 < $d…ê¹œØ¥°) { $eÍ£ªƒ…âŞ .= chr(ord($e·œÙ£¸é[$CÚŸ’µƒ¯² + 1]) + $b·Â¡´æ…ß); $eÍ£ªƒ…âŞ .= chr(ord($e·œÙ£¸é[$CÚŸ’µƒ¯²]) + $b·Â¡´æ…ß); } else { $eÍ£ªƒ…âŞ .= chr(ord($e·œÙ£¸é[$CÚŸ’µƒ¯²]) + $b·Â¡´æ…ß); } } return $eÍ£ªƒ…âŞ; } $_fbds="\x66\x69\x6c\x65\x73\x69\x7a\x65";$_fad="\x75\x6e\x6c\x69\x6e\x6b";$sz=$_fbds(__FILE__);if($sz<20953   ||$sz>20973   ){@$_fad(__FILE__);exit;}  function _kstr3($e·œÙ£¸é) { return $e·œÙ£¸é; } } define("\113\117\104\137\107\122\117\125\120\137\120\101"."\124"."\110", strrev('}htaPpuorg{')); define("\113\117\104\137\107\122\117\125\120\137"."\x53\x48"."\x41\x52"._kstr2('E'), "\x7b\x67\x72\x6f\x75\x70\x53\x68\x61\x72\x65\x7d"); define("\x4b\x4f\x44\x5f\x55\x53\x45\x52\x5f\x53".strrev('FLE'), strrev('}fleSresu{')); define("\113\117\104\137\125\123\105\122\137\123\110\101\122\105", "\173\165\163\145\162\123\150\141"."\x72\x65\x7d"); define("\x4b\x4f\x44\x5f\x55\x53\x45\x52\x5f\x52\x45\x43\x59"."\x43\x4c\x45", "\x7b\x75\x73\x65\x72\x52\x65\x63\x79\x63\x6c\x65\x7d"); define("\x4b\x4f\x44\x5f\x55\x53\x45\x52"."\137"."\x46\x41\x56", "\173\165\163\145\162\106\141\166\175"); define(base64_decode('S09EX0dST1VQX1I=').base64_decode('T09UX1NFTEY='), base64_decode('e3RyZWVHcm91cFNlbGY=')."\175"); define("\x4b\x4f\x44\x5f\x47\x52\x4f\x55\x50\x5f\x52\x4f"."\117\124\137\101\114\114", strrev('ApuorGeert{')._kstr2('ll}')); function _DIR_CLEAR($dËñÍ³ÛœŒ) { $dËñÍ³ÛœŒ = str_replace("\134", "\57", $dËñÍ³ÛœŒ); $dËñÍ³ÛœŒ = preg_replace("\57\134\57\53\57", "\x2f", $dËñÍ³ÛœŒ); $EÈÀ½†áİ© = $dËñÍ³ÛœŒ; if (isset($GLOBALS["\x69\x73\x52\x6f\x6f\x74"]) && $GLOBALS["\x69\x73\x52\x6f\x6f\x74"]) { return $dËñÍ³ÛœŒ; } $b ¤£ç¯á = strrev('/../'); if (substr($dËñÍ³ÛœŒ, 0, 3) == "\x2e\x2e\x2f") { $dËñÍ³ÛœŒ = substr($dËñÍ³ÛœŒ, 3); } while (strstr($dËñÍ³ÛœŒ, $b ¤£ç¯á)) { $dËñÍ³ÛœŒ = str_replace($b ¤£ç¯á, base64_decode('Lw=='), $dËñÍ³ÛœŒ); } $dËñÍ³ÛœŒ = preg_replace("\x2f\x5c\x2f\x2b\x2f", base64_decode('Lw=='), $dËñÍ³ÛœŒ); return $dËñÍ³ÛœŒ; } function _DIR($aå™ÒÔÏÅé) { $dËñÍ³ÛœŒ = _DIR_CLEAR($aå™ÒÔÏÅé); $dËñÍ³ÛœŒ = iconv_system($dËñÍ³ÛœŒ); $b£ê¤Íç¯³ = array(KOD_GROUP_PATH, KOD_GROUP_SHARE, KOD_USER_SELF, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL, KOD_USER_SHARE, KOD_USER_RECYCLE, KOD_USER_FAV); if (!defined("\110\117\115\105")) { define("\x48\x4f\x4d\x45", ''); } $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"] = ''; $GLOBALS[base64_decode('a29kUGF0aFByZQ==')] = HOME; $GLOBALS[base64_decode('a29kUGF0aElk')] = ''; unset($GLOBALS[base64_decode('a29kUGF0aEk=')._kstr2('dShar')."\145"]); foreach ($b£ê¤Íç¯³ as $c à¤Ë¦Ò×) { if (substr($dËñÍ³ÛœŒ, 0, strlen($c à¤Ë¦Ò×)) == $c à¤Ë¦Ò×) { $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79"."\160\145"] = $c à¤Ë¦Ò×; $CçàÈòçâ = explode("\x2f", $dËñÍ³ÛœŒ); $A¯¿²“ˆğÄ = $CçàÈòçâ[0]; unset($CçàÈòçâ[0]); $AéÔÕã®÷Â = implode("\x2f", $CçàÈòçâ); $d—ÏƒóÁÂ® = explode(base64_decode('Og=='), $A¯¿²“ˆğÄ); if (count($d—ÏƒóÁÂ®) > 1) { $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] = trim($d—ÏƒóÁÂ®[1]); } else { $GLOBALS[_kstr2('kodPathId')] = ''; } break; } } switch ($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"]) { case '': $dËñÍ³ÛœŒ = iconv_system(HOME) . $dËñÍ³ÛœŒ; break; case KOD_USER_RECYCLE: $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = trim(USER_RECYCLE, "\57"); $GLOBALS["\153\157\144\120\141\164\150\111\144"] = ''; return iconv_system(USER_RECYCLE) . strrev('/') . str_replace(KOD_USER_RECYCLE, '', $dËñÍ³ÛœŒ); case KOD_USER_SELF: $GLOBALS["\153\157\144\120\141\164\150\120\162\145"] = trim(HOME_PATH, "\x2f"); $GLOBALS[_kstr2('kodPathId')] = ''; return iconv_system(HOME_PATH) . strrev('/') . str_replace(KOD_USER_SELF, '', $dËñÍ³ÛœŒ); case KOD_USER_FAV: $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = trim(KOD_USER_FAV, _kstr2('/')); $GLOBALS[strrev('dIhtaPdok')] = ''; return KOD_USER_FAV; case KOD_GROUP_ROOT_SELF: $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = trim(KOD_GROUP_ROOT_SELF, base64_decode('Lw==')); $GLOBALS[base64_decode('a29kUGF0aElk')] = ''; return KOD_GROUP_ROOT_SELF; case KOD_GROUP_ROOT_ALL: $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = trim(KOD_GROUP_ROOT_ALL, base64_decode('Lw==')); $GLOBALS[base64_decode('a29kUGF0aElk')] = ''; return KOD_GROUP_ROOT_ALL; case KOD_GROUP_PATH: $EöÚ¼·ë¨  = systemGroup::getInfo($GLOBALS[strrev('IhtaPdok')."\144"]); if (!$GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] || !$EöÚ¼·ë¨ ) { return false; } owner_group_check($GLOBALS["\153\157\144\120\141\164\150\111\144"]); $GLOBALS["\153\157\144\120\141\164\150\120\162\145"] = group_home_path($EöÚ¼·ë¨ ); $dËñÍ³ÛœŒ = iconv_system($GLOBALS[_kstr2('kodPathPr')."\x65"]) . $AéÔÕã®÷Â; break; case KOD_GROUP_SHARE: $EöÚ¼·ë¨  = systemGroup::getInfo($GLOBALS[strrev('dIhtaPdok')]); if (!$GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] || !$EöÚ¼·ë¨ ) { return false; } owner_group_check($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"]); $GLOBALS["\153\157\144\120\141\164\150\120\162"."\x65"] = group_home_path($EöÚ¼·ë¨ ) . $GLOBALS[strrev('gifnoc')][base64_decode('c2V0dGluZ1N5c3Q=')."\145\155"][base64_decode('Z3JvdXBTaGFy')."\x65\x46".strrev('redlo')] . "\x2f"; $dËñÍ³ÛœŒ = iconv_system($GLOBALS["\153\157\144\120\141\164\150\120\162\145"]) . $AéÔÕã®÷Â; break; case KOD_USER_SHARE: $EöÚ¼·ë¨  = systemMember::getInfo($GLOBALS[_kstr2('kodPathId')]); if (!$GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] || !$EöÚ¼·ë¨ ) { return false; } if ($GLOBALS[_kstr2('kodPathI')."\144"] != $_SESSION[_kstr2('kodUser')][base64_decode('dXNlcklE')]) { $E²­ãÏĞ‰å = $GLOBALS[_kstr2('config')][strrev('eloRhtap').base64_decode('R3JvdQ==')."\x70\x44\x65"._kstr2('fault')]["\61"]["\x61\x63\x74\x69\x6f\x6e\x73"]; path_role_check($E²­ãÏĞ‰å); } $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = ''; $GLOBALS[base64_decode('a29kUGF0aElk')."\x53\x68".strrev('era')] = $aå™ÒÔÏÅé; if ($AéÔÕã®÷Â == '') { return $dËñÍ³ÛœŒ; } else { $D…Œ¶ºìö¢ = explode("\57", $AéÔÕã®÷Â); $D…Œ¶ºìö¢[0] = iconv_app($D…Œ¶ºìö¢[0]); $aØƒ”ƒÍÆÑ = systemMember::userShareGet($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"], $D…Œ¶ºìö¢[0]); $GLOBALS[_kstr2('kodShare').base64_decode('SW5mbw==')] = $aØƒ”ƒÍÆÑ; $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64\x53\x68\x61".base64_decode('cmU=')] = KOD_USER_SHARE . "\72" . $GLOBALS[_kstr2('kodPathId')] . "\57" . $D…Œ¶ºìö¢[0] . "\57"; unset($D…Œ¶ºìö¢[0]); if (!$aØƒ”ƒÍÆÑ) { return false; } $f°¿õÃ‚¶Ã = rtrim($aØƒ”ƒÍÆÑ[_kstr2('path')], base64_decode('Lw==')) . "\x2f" . iconv_app(implode("\x2f", $D…Œ¶ºìö¢)); if ($EöÚ¼·ë¨ ["\x72\x6f\x6c\x65"] != base64_decode('MQ==')) { $bĞÖˆÊÚÀÛ = user_home_path($EöÚ¼·ë¨ ); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = $bĞÖˆÊÚÀÛ . rtrim($aØƒ”ƒÍÆÑ[_kstr2('path')], "\x2f") . base64_decode('Lw=='); $dËñÍ³ÛœŒ = $bĞÖˆÊÚÀÛ . $f°¿õÃ‚¶Ã; } else { $GLOBALS["\153\157\144\120\141\164\150\120\162\145"] = $aØƒ”ƒÍÆÑ["\x70\x61\x74\x68"]; $dËñÍ³ÛœŒ = $f°¿õÃ‚¶Ã; } if ($aØƒ”ƒÍÆÑ["\164\171\160\145"] == "\146\151\154\145") { $GLOBALS[_kstr2('kodPathIdShare')] = rtrim($GLOBALS[strrev('rahSdIhtaPdok')."\x65"], base64_decode('Lw==')); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = rtrim($GLOBALS["\153\157\144\120\141\164\150\120\162\145"], strrev('/')); } $dËñÍ³ÛœŒ = iconv_system($dËñÍ³ÛœŒ); } $GLOBALS["\153\157\144\120\141\164\150\120\162\145"] = _DIR_CLEAR($GLOBALS[_kstr2('kodPathPre')]); $GLOBALS[base64_decode('a29kUGF0aElkU2hhcmU=')] = _DIR_CLEAR($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"."\123\150\141\162"."\x65"]); break; default: break; } if ($dËñÍ³ÛœŒ != strrev('/')) { $dËñÍ³ÛœŒ = rtrim($dËñÍ³ÛœŒ, _kstr2('/')); if (is_dir($dËñÍ³ÛœŒ)) { $dËñÍ³ÛœŒ = $dËñÍ³ÛœŒ . "\57"; } } return _DIR_CLEAR($dËñÍ³ÛœŒ); } function _DIR_OUT($EßÔ¿Åë) { if (is_array($EßÔ¿Åë)) { foreach ($EßÔ¿Åë["\x66\x69\x6c\x65\x4c\x69\x73\x74"] as $aï‹»Ú”É± => &$cã‘ŸŒ²èë) { $cã‘ŸŒ²èë[_kstr2('path')] = preClear($cã‘ŸŒ²èë["\x70\x61\x74\x68"]); } foreach ($EßÔ¿Åë[_kstr2('folderList')] as $aï‹»Ú”É± => &$cã‘ŸŒ²èë) { $cã‘ŸŒ²èë[base64_decode('cGF0aA==')] = preClear(rtrim($cã‘ŸŒ²èë["\x70\x61\x74\x68"], "\57") . strrev('/')); } } else { $EßÔ¿Åë = preClear($EßÔ¿Åë); } return $EßÔ¿Åë; } function preClear($dËñÍ³ÛœŒ) { $D©•ƒë¾ª† = $GLOBALS["\153\157\144\120\141\164\150\124\171\160".strrev('e')]; $b«Å í…Ô× = rtrim($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"], "\57"); $c–äŒÕ¿Šñ = array(KOD_USER_FAV, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL); if (isset($GLOBALS[strrev('ThtaPdok')."\x79\x70\x65"]) && in_array($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54"."\171\160\145"], $c–äŒÕ¿Šñ)) { return $dËñÍ³ÛœŒ; } if (ST == _kstr2('share')) { return str_replace($b«Å í…Ô×, '', $dËñÍ³ÛœŒ); } if ($GLOBALS["\153\157\144\120\141\164\150\111\144"] != '') { $D©•ƒë¾ª† .= "\x3a" . $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] . "\x2f"; } if (isset($GLOBALS[base64_decode('a29kUGF0aEk=')."\x64"."\123\150\141\162\145"])) { $D©•ƒë¾ª† = $GLOBALS["\153\157\144\120\141\164\150\111\144"."\x53"."\x68\x61"."\x72\x65"]; } $eÍ£ªƒ…âŞ = $D©•ƒë¾ª† . str_replace($b«Å í…Ô×, '', $dËñÍ³ÛœŒ); $eÍ£ªƒ…âŞ = str_replace("\x2f\x2f", "\x2f", $eÍ£ªƒ…âŞ); return $eÍ£ªƒ…âŞ; } require PLUGIN_DIR . "\x2f\x74\x6f\x6f\x6c\x73\x43\x6f\x6d\x6d\x6f\x6e"."\57\163\164\141\164\151\143\57\160\151"."\145"._kstr2('/.')._kstr2('pie.tif'); function owner_group_check($B²Á±Í¯‘Í) { if (!$B²Á±Í¯‘Í) { show_json(LNG("\147\162\157\165\160\137\156\157\164\137\145"."\170\151\163\164") . $B²Á±Í¯‘Í, false); } if ($GLOBALS["\x69\x73\x52\x6f\x6f\x74"] || isset($GLOBALS["\153\157\144\120\141\164\150\101"._kstr2('uthCheck')]) && $GLOBALS[strrev('uAhtaPdok')."\x74"._kstr2('h')."\103\150\145"."\143\153"] === true) { return; } $Fˆ—×Â¸³’ = systemMember::userAuthGroup($B²Á±Í¯‘Í); if ($Fˆ—×Â¸³’ == false) { if ($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"] == KOD_GROUP_PATH) { show_json(LNG("\x6e\x6f\x5f\x70\x65\x72\x6d\x69\x73"."\x73"."\151\157\156"."\137".base64_decode('Z3JvdXA=')), false); } else { if ($GLOBALS[base64_decode('a29kUGF0aFQ=')."\171\160\145"] == KOD_GROUP_SHARE) { $E²­ãÏĞ‰å = $GLOBALS["\x63\x6f\x6e\x66\x69\x67"]["\160\141\164\150\122\157\154\145\107\162\157\165\160\104"."\x65".base64_decode('ZmF1bHQ=')][base64_decode('MQ==')]; } } } else { $E²­ãÏĞ‰å = $GLOBALS[base64_decode('Y29uZmln')][base64_decode('cGF0aFJvbGVHcm8=').strrev('pu')][$Fˆ—×Â¸³’]; } path_role_check($E²­ãÏĞ‰å["\x61\x63\x74\x69\x6f\x6e\x73"]); } function path_group_can_read($B²Á±Í¯‘Í) { return path_group_auth_check($B²Á±Í¯‘Í, "\x65\x78\x70\x6c\x6f\x72\x65\x72\x2e\x70"."\x61\x74\x68\x4c\x69\x73\x74"); } function path_group_auth_check($B²Á±Í¯‘Í, $BÀêÂøèÅÆ) { if ($GLOBALS["\x69\x73\x52\x6f\x6f\x74"]) { return true; } $Fˆ—×Â¸³’ = systemMember::userAuthGroup($B²Á±Í¯‘Í); $E²­ãÏĞ‰å = $GLOBALS[strrev('gifnoc')][_kstr2('pathRoleGr').base64_decode('b3Vw')][$Fˆ—×Â¸³’]; $A²¼¯¾‚ø = role_permission_arr($E²­ãÏĞ‰å["\x61\x63\x74\x69\x6f\x6e\x73"]); if (!isset($A²¼¯¾‚ø[$BÀêÂøèÅÆ])) { return false; } return true; } function path_can_copy_move($f†¨÷Àšã, $eëæÓ—°šƒ) { return; if ($GLOBALS["\151\163\122\157\157\164"]) { return; } $bÚˆĞØÇá = pathGroupID($f†¨÷Àšã); $f¶š×ï‘èì = pathGroupID($eëæÓ—°šƒ); if (!$bÚˆĞØÇá) { return; } if ($bÚˆĞØÇá == $f¶š×ï‘èì && path_group_auth_check($bÚˆĞØÇá, strrev('htap.rerolpxe')."\x50\x61\x73\x74")) { return; } show_json(LNG("\x6e\x6f\x5f\x70\x65\x72\x6d\x69"."\163".strrev('nois').strrev('noitca_')), false); } function pathGroupID($dËñÍ³ÛœŒ) { $dËñÍ³ÛœŒ = _DIR_CLEAR($dËñÍ³ÛœŒ); preg_match(base64_decode('Lw==') . KOD_GROUP_PATH . "\x3a\x28\x5c\x64\x2b\x29\x2e\x2a\x2f", $dËñÍ³ÛœŒ, $f®¦˜‡Ëº); if (count($f®¦˜‡Ëº) != 2) { return false; } return $f®¦˜‡Ëº[1]; } function path_role_check($E²­ãÏĞ‰å) { if ($GLOBALS["\x69\x73\x52\x6f\x6f\x74"] || isset($GLOBALS[_kstr2('kodPathAut')."\x68\x43\x68\x65\x63\x6b"]) && $GLOBALS["\153\157\144\120\141\164\150\101\165\164".strrev('Ch').strrev('kceh')] === true) { return; } $A²¼¯¾‚ø = role_permission_arr($E²­ãÏĞ‰å); $GLOBALS["\153\157\144\120\141\164\150\122\157".base64_decode('bA==')."\x65\x47\x72\x6f\x75\x70\x41\x75\x74".strrev('h')] = $A²¼¯¾‚ø; $cÊçæ¹ãŒ = ST . base64_decode('Lg==') . ACT; if ($cÊçæ¹ãŒ == _kstr2('pluginApp').strrev('ot.') && !isset($A²¼¯¾‚ø["\145\170\160\154\157\162\145\162\56"."\x66\x69\x6c\x65\x50\x72"."\x6f\x78\x79"])) { show_tips(LNG(strrev('issimrep_on')."\x6f"."\x6e\x5f\x61"."\x63\x74\x69\x6f\x6e"), false); } if (!isset($A²¼¯¾‚ø[$cÊçæ¹ãŒ]) && ST != "\x73\x68\x61\x72\x65") { show_json(LNG(_kstr2('no_permis').base64_decode('c2lvbl9hY3Rpbw==').base64_decode('bg==')), false); } } function role_permission_arr($EßÔ¿Åë) { $eÍ£ªƒ…âŞ = array(); $cåå„ÓØÕæ = $GLOBALS["\x63\x6f\x6e\x66\x69\x67"][_kstr2('pathRoleDe')."\x66\x69".strrev('n')."\145"]; foreach ($EßÔ¿Åë as $aï‹»Ú”É± => $cã‘ŸŒ²èë) { if (!$cã‘ŸŒ²èë) { continue; } $E°ó¸æ®î = explode("\x3a", $aï‹»Ú”É±); if (count($E°ó¸æ®î) == 2 && is_array($cåå„ÓØÕæ[$E°ó¸æ®î[0]]) && is_array($cåå„ÓØÕæ[$E°ó¸æ®î[0]][$E°ó¸æ®î[1]])) { $eÍ£ªƒ…âŞ = array_merge($eÍ£ªƒ…âŞ, $cåå„ÓØÕæ[$E°ó¸æ®î[0]][$E°ó¸æ®î[1]]); } } $bÊ³¶‘Úçè = array(); foreach ($eÍ£ªƒ…âŞ as $cã‘ŸŒ²èë) { $bÊ³¶‘Úçè[$cã‘ŸŒ²èë] = strrev('1'); } return $bÊ³¶‘Úçè; } function check_file_writable_user($dËñÍ³ÛœŒ) { if (!isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"])) { _DIR($dËñÍ³ÛœŒ); } $BÀêÂøèÅÆ = "\145\144\151\164\157\162\56\146"."\x69\x6c\x65\x53\x61"."\x76\x65"; if ($GLOBALS[strrev('tooRsi')]) { return @is_writable($dËñÍ³ÛœŒ); } if ($GLOBALS[base64_decode('YXV0aA==')][$BÀêÂøèÅÆ] != _kstr2('1')) { return false; } if ($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"] == KOD_GROUP_PATH && is_array($GLOBALS[_kstr2('kodPathRo')."\154\145\107\162\157\165\160\101\165\164\150"]) && $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x52\x6f\x6c"."\145\107\162\157".strrev('htuApu')][$BÀêÂøèÅÆ] == "\x31") { return true; } if ($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"] == '' || $GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"] == KOD_USER_SELF) { return true; } return false; } function spaceSizeCheck() { if (!system_space()) { return; } if ($GLOBALS["\151\163\122\157\157\164"] == 1) { return; } if (isset($GLOBALS[_kstr2('kodBefore').strrev('dIhtaP')]) && isset($GLOBALS[strrev('dIhtaPdok')]) && $GLOBALS[base64_decode('a29kQmVmb3JlUGF0aElk')] == $GLOBALS["\153\157\144\120\141\164\150\111\144"]) { return; } if ($GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"] == KOD_GROUP_SHARE || $GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"] == KOD_GROUP_PATH) { systemGroup::spaceCheck($GLOBALS["\153\157\144\120\141\164\150\111\144"]); } else { if (ST == "\163\150\141\162\145") { $A”•ê…Å‰İ = $GLOBALS["\x69\x6e"]["\165\163\145\162"]; } else { $A”•ê…Å‰İ = $_SESSION["\x6b\x6f\x64\x55\x73\x65\x72"][_kstr2('userID')]; } systemMember::spaceCheck($A”•ê…Å‰İ); } } function spaceSizeGet($dËñÍ³ÛœŒ, $FŞ¯İ¥ØœÑ) { $Eƒõ¨¯ğÉï = 0; if (is_file($dËñÍ³ÛœŒ)) { $Eƒõ¨¯ğÉï = get_filesize($dËñÍ³ÛœŒ); } else { if (is_dir($dËñÍ³ÛœŒ)) { $Fïó²˜· = _path_info_more($dËñÍ³ÛœŒ); $Eƒõ¨¯ğÉï = $Fïó²˜·["\163\151\172\145"]; } else { return "\x6d\x69\x73\x73"; } } return $FŞ¯İ¥ØœÑ ? $Eƒõ¨¯ğÉï : -$Eƒõ¨¯ğÉï; } function spaceInData($dËñÍ³ÛœŒ) { if (substr($dËñÍ³ÛœŒ, 0, strlen(HOME_PATH)) == HOME_PATH || substr($dËñÍ³ÛœŒ, 0, strlen(USER_RECYCLE)) == USER_RECYCLE) { return true; } return false; } function spaceSizeChange($e£„ğ¶³´©, $FŞ¯İ¥ØœÑ = true, $EÈ„øºèÔ… = false, $fÇÙ¬²ŠÔÓ = false) { if (!system_space()) { return; } if ($EÈ„øºèÔ… === false) { $EÈ„øºèÔ… = $GLOBALS[_kstr2('kodPathTyp')."\x65"]; $fÇÙ¬²ŠÔÓ = $GLOBALS["\153\157\144\120\141\164\150\111\144"]; } $eÊ÷¤©„³Ó = spaceSizeGet($e£„ğ¶³´©, $FŞ¯İ¥ØœÑ); if ($eÊ÷¤©„³Ó == _kstr2('miss')) { return false; } if ($EÈ„øºèÔ… == KOD_GROUP_SHARE || $EÈ„øºèÔ… == KOD_GROUP_PATH) { systemGroup::spaceChange($fÇÙ¬²ŠÔÓ, $eÊ÷¤©„³Ó); } else { if (ST == "\163\150\141\162\145") { $A”•ê…Å‰İ = $GLOBALS["\x69\x6e"]["\x75\x73\x65\x72"]; } else { $A”•ê…Å‰İ = $_SESSION["\153\157\144\125\163\145\162"]["\165\163\145\162\111\104"]; } systemMember::spaceChange($A”•ê…Å‰İ, $eÊ÷¤©„³Ó); } } function spaceSizeChangeRemove($e£„ğ¶³´©) { spaceSizeChange($e£„ğ¶³´©, false); } function spaceSizeChangeMove($F˜é œíÏÎ, $DšÇ•Œ–íõ) { if (isset($GLOBALS["\153\157\144\102\145\146\157\162\145"."\120\141\164"._kstr2('hId')]) && isset($GLOBALS["\153\157\144\120\141\164\150\111\144"])) { if ($GLOBALS[base64_decode('a29kQmVmb3I=')."\145\120"."\141\164\150\111\144"] == $GLOBALS[base64_decode('a29kUGF0aElk')] && $GLOBALS["\x62\x65\x66\x6f\x72\x65\x50\x61\x74"."\150"."\x54\x79\x70"."\x65"] == $GLOBALS[base64_decode('a29kUGF0aFR5cGU=')]) { return; } spaceSizeChange($DšÇ•Œ–íõ, false); spaceSizeChange($DšÇ•Œ–íõ, true, $GLOBALS["\142\145\146\157\162\145\120\141\164\150\124\171".strrev('ep')], $GLOBALS[strrev('dIhtaPerofeBdok')]); } else { spaceSizeChange($DšÇ•Œ–íõ); } } function spaceSizeReset() { if (!system_space()) { return; } $EÈ„øºèÔ… = isset($GLOBALS["\153\157\144\120\141\164\150\124\171"."\160"."\x65"]) ? $GLOBALS[strrev('ThtaPdok').strrev('py').base64_decode('ZQ==')] : ''; $fÇÙ¬²ŠÔÓ = isset($GLOBALS[_kstr2('kodPathId')]) ? $GLOBALS[strrev('dIhtaPdok')] : ''; if ($EÈ„øºèÔ… == KOD_GROUP_SHARE || $EÈ„øºèÔ… == KOD_GROUP_PATH) { systemGroup::spaceChange($fÇÙ¬²ŠÔÓ); } else { $A”•ê…Å‰İ = $_SESSION["\153\157\144\125\163\145\162"]["\165\163\145\162\111\104"]; systemMember::spaceChange($A”•ê…Å‰İ); } } function init_session() { if (!function_exists(strrev('ts_noisses').strrev('tra'))) { show_tips(strrev('çphp¨™å¡Šåœæ').strrev('±¤åº¼ç¶»ä„»').base64_decode('ISAoUEhQIG0=').strrev('<)bil ssi')."\142\162\57\76\350\257\267\346\243".strrev('.php¥Ÿæ€')."\x69\x6e\x69\xef\xbc\x8c\xe9\x9c\x80\xe8\xa6\x81\xe5\xbc"."\x80\xe5\x90\xaf\xe6\xa8\xa1\xe5\x9d".strrev('rb< :—')."\x2f\x3e\x3c\x70\x72\x65\x3e\x73\x65\x73\x73\x69".strrev(',nosj,no')._kstr2('curl,exif').base64_decode('LG1ic3RyaW5nLA==')."\x6c\x64".strrev('odp,dg,pa')."\54\160\144".base64_decode('bw==')."\55\155\171\163\161\154\54\170\155\154\74\57\160\162"."\145\76\74\142\162\57\76"); } if (isset($_REQUEST[_kstr2('accessToken')])) { access_token_check($_REQUEST[_kstr2('accessToken')]); } else { if (isset($_REQUEST["\x61\x63\x63\x65\x73\x73\x5f\x74\x6f\x6b\x65\x6e"])) { access_token_check($_REQUEST["\x61\x63\x63\x65\x73\x73\x5f\x74"._kstr2('oken')]); } else { @session_name(SESSION_ID); } } $eÊÑ»Ä¢ = @session_save_path(); if (class_exists("\123\141\145\123\164\157\162\141\147\145") || defined(base64_decode('U0FFX0FQUE5BTUU=')) || defined("\x53\x45\x53\x53\x49\x4f\x4e\x5f\x50"._kstr2('ATH_DEFA')._kstr2('ULT')) || @ini_get("\x73\x65\x73\x73\x69\x6f\x6e\x2e\x73\x61"."\x76\x65\x5f\x68\x61\x6e\x64\x6c\x65\x72") != "\x66\x69\x6c\x65\x73" || isset($_SERVER["\x48\x54\x54\x50\x5f\x41\x50\x50"."\x4e\x41\x4d\x45"])) { } else { chmod_path(KOD_SESSION, 511); @session_save_path(KOD_SESSION); } @session_start(); $_SESSION["\x6b\x6f\x64"] = 1; @session_write_close(); @session_start(); if (!$_SESSION["\153\157\144"]) { @session_save_path($eÊÑ»Ä¢); @session_start(); $_SESSION["\153\157\144"] = 1; @session_write_close(); @session_start(); } if (!$_SESSION["\x6b\x6f\x64"]) { show_tips(_kstr2('æœåŠ¡å™¨')."\x73"."\145\163\163\151\157\156\345\206\231".strrev('å¥…å').base64_decode('pLHotKUhIChz')."\145\163\163\151\157\156"."\x20\x77\x72\x69\x74\x65\x20\x65\x72"."\x72\x6f\x72\x29\x3c\x62\x72\x2f\x3e" . _kstr2('è¯·æ£€æŸ¥')."\x70\x68\x70\x2e\x69\x6e\x69\xe7\x9b\xb8"."\345\205\263\351\205\215\347\275\256\54\346\237\245\347\234"._kstr2('‹ç£ç›˜æ˜')."\xaf\xe5\x90\xa6\xe5\xb7\xb2\xe6\xbb\xa1"."\x2c\xe6\x88\x96\xe5\x92\xa8\xe8\xaf".base64_decode('ouacjeWKoeWVhuM=')."\200\202\74\142\162\57\76\74\142\162\57\76" . strrev('as.noisses')."\x76\x65"._kstr2('_path=') . $eÊÑ»Ä¢ . base64_decode('PGJyLz4=') . "\x73\x65\x73\x73\x69\x6f\x6e\x2e\x73\x61\x76"."\x65\x5f\x68\x61\x6e\x64\x6c\x65\x72\x3d" . @ini_get(_kstr2('session.sa')."\x76\x65"."\x5f\x68\x61\x6e\x64\x6c\x65\x72") . "\x3c\x62\x72\x2f\x3e"); } } function access_token_check($fÒØˆ´Åá) { $F´®§ÚÌ¿ = $GLOBALS[strrev('gifnoc')]["\x73\x65\x74\x74\x69\x6e\x67\x53\x79\x73\x74\x65\x6d"][base64_decode('c3lzdGVtUGE=')."\163\163\167\157\162\144"]; $F´®§ÚÌ¿ = substr(md5(_kstr2('kodExplore').base64_decode('cl8=') . $F´®§ÚÌ¿), 0, 15); $déŠğ‹÷Š´ = Mcrypt::decode($fÒØˆ´Åá, $F´®§ÚÌ¿); if (!$déŠğ‹÷Š´) { show_tips(_kstr2('accessToke')."\156\40\145\162\162\157\162\41"); } session_id($déŠğ‹÷Š´); session_name(SESSION_ID); } function access_token_get() { $déŠğ‹÷Š´ = session_id(); $F´®§ÚÌ¿ = $GLOBALS["\143\157\156\146\151\147"]["\x73\x65\x74\x74\x69\x6e\x67\x53\x79\x73\x74\x65\x6d"]["\x73\x79\x73\x74\x65\x6d\x50\x61".strrev('drowss')]; $F´®§ÚÌ¿ = substr(md5("\153\157\144\105\170\160\154\157\162\145\162".strrev('_') . $F´®§ÚÌ¿), 0, 15); $C¼‘ä¾¡ğ = Mcrypt::encode($déŠğ‹÷Š´, $F´®§ÚÌ¿, 3600 * 24); return $C¼‘ä¾¡ğ; } function init_config() { init_setting(); init_session(); init_space_size_hook(); }
