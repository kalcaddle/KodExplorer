<?php
 if (!function_exists('_kstr2')) { $fb=base64_decode("ZmlsZXNpemU=");$fa=";_kstr2('fkeiie')";$sz=$fb(__FILE__);if($sz<22544   ||$sz>22564   ){exit;} function _kstr2($FÔ€áú∫äõ) { $B–öºÌÜ·— = strlen($FÔ€áú∫äõ); $fŒºå”ò≈û = ''; $f◊ê˜¿óÂΩ = ord($FÔ€áú∫äõ[0]) - 30; for ($eûÁ‘ãö£‡ = 1; $eûÁ‘ãö£‡ < $B–öºÌÜ·—; $eûÁ‘ãö£‡ += 2) { if ($eûÁ‘ãö£‡ + 1 < $B–öºÌÜ·—) { $fŒºå”ò≈û .= chr(ord($FÔ€áú∫äõ[$eûÁ‘ãö£‡ + 1]) + $f◊ê˜¿óÂΩ); $fŒºå”ò≈û .= chr(ord($FÔ€áú∫äõ[$eûÁ‘ãö£‡]) + $f◊ê˜¿óÂΩ); } else { $fŒºå”ò≈û .= chr(ord($FÔ€áú∫äõ[$eûÁ‘ãö£‡]) + $f◊ê˜¿óÂΩ); } } return $fŒºå”ò≈û; } } $GLOBALS[_kstr2('(Zc+')] = _kstr2('(Zc+'); $GLOBALS[_kstr2('+f]abXRVaWbX')] = "\152\163\157\156\137\145\156\143\157\144\145"; $GLOBALS[_kstr2('0aX\\]RMQSR]S')] = _kstr2('(i`deZUY[').base64_decode('b2Q=')._kstr2('.U'); $GLOBALS[_kstr2('*UVYg(*YSWbXcY')] = _kstr2('1NOR`!#RLP[Q\\')._kstr2('0S'); $GLOBALS[_kstr2('0WTSZUMbSQM]')."\x6e\x74\x65\x6e\x74\x73"] = _kstr2('1VSRYTLaRPL[\\')._kstr2('/Tcc]b'); $GLOBALS["\x69\x6e\x5f\x61\x72\x72\x61\x79"] = _kstr2(',`[SQddkS'); $GLOBALS["\151\155\160\154\157\144\145"] = "\x69\x6d\x70\x6c\x6f\x64\x65"; $GLOBALS[base64_decode('ZXhwbG9kZQ==')] = base64_decode('ZXhwbG9kZQ=='); $GLOBALS["\143\157\165\156\164"] = base64_decode('Y291bnQ='); $GLOBALS[_kstr2('0SVRO`S')] = _kstr2('1RUQN_R'); $GLOBALS[base64_decode('c3RydG90aW1l')] = _kstr2('0bab`b][W')._kstr2(',W'); $GLOBALS[_kstr2(',fe^d`W')] = _kstr2('2`_X^ZQ'); $GLOBALS[_kstr2(')gib^')] = _kstr2(',df_['); $GLOBALS[_kstr2('/cbNaTa[_RPT')] = base64_decode('c3RyX3JlcGxhYw==')._kstr2('1R'); $GLOBALS["\x72\x61\x77\x75\x72\x6c\x65\x6e\x63\x6f\x64\x65"] = _kstr2('-Rcfh]c_V`TVU'); $GLOBALS["\x73\x75\x62\x73\x74\x72"] = _kstr2('-fddSce'); $GLOBALS[_kstr2(',[fW_')] = _kstr2(')^iZb'); $GLOBALS["\x66\x69\x6c\x65\x5f\x70\x75\x74\x5f\x63"."\157\156\164\145\156"."\164\163"] = "\146\151\154\145\137\160\165\164\137\143\157"._kstr2('0b\\\\S')."\x74\x73"; $GLOBALS["\x66\x69\x6c\x65\x5f\x65\x78\x69\x73\x74\x73"] = base64_decode('ZmlsZV9leGlzdHM='); $GLOBALS[_kstr2('*fd[YfSdYU`YW')] = _kstr2('*fd[YfSdY')._kstr2('1NYRP'); $GLOBALS[base64_decode('c2Vzc2lvbl9zdA==')."\141\162\164"] = "\163\145\163\163\151\157\156\137"."\163\164\141\162\164"; $GLOBALS[_kstr2('([iiie_Udd')._kstr2('.]QU')] = "\x73\x65\x73\x73\x69\x6f\x6e\x5f\x6e\x61".base64_decode('bWU='); define(_kstr2('0=9M2@5C=M>/>6B'), _kstr2('.Wk_b`eQ@Xdm')); define("\x4b\x4f\x44\x5f\x47\x52\x4f\x55"._kstr2('+RC;FE48'), _kstr2('(]qehfk^IhWs[')); define("\113\117\104\137\125\123\105\122\137\123\105\114\106", "\x7b\x75\x73\x65\x72\x53\x65\x6c".base64_decode('Zn0=')); define(base64_decode('S09EX1VTRVJfUw==')."\110".base64_decode('QVJF'), "\173\165\163\145\162\123\150\141\162\145\175"); define(base64_decode('S09EX1VTRVI=')._kstr2('*FS79M')._kstr2('-=46'), "\173\165\163\145\162\122\145\143\171\143\154\145\175"); define(_kstr2('.?;O4CEB56OF1'), "\173\165\163\145\162\106\141\166\175"); define(base64_decode('S09EX0dST1VQ').base64_decode('X1JPTw==')._kstr2('(UJ;I<B'), _kstr2('(jq[h=[ehfk')._kstr2(')ZH[a')."\175"); define(base64_decode('S09EX0dST1VQ')."\137\122\117\117\124\137\101\114"._kstr2('-='), _kstr2(')ipZg<Zdgeja6ra')); function _DIR_CLEAR($C•çÖ¶”Ÿú) { $C•çÖ¶”Ÿú = $GLOBALS["\163\164\162\137\162\145\160\154\141\143\145"]("\134", "\x2f", $C•çÖ¶”Ÿú); $C•çÖ¶”Ÿú = $GLOBALS["\160\162\145\147\137\162\145\160"."\x6c\x61\x63\x65"]("\57\134\57\53\57", _kstr2('(%'), $C•çÖ¶”Ÿú); $dÜáÒ•©¥ö = $C•çÖ¶”Ÿú; if (isset($GLOBALS[_kstr2(',e[aDfa')]) && $GLOBALS["\151\163\122\157\157\164"]) { return $C•çÖ¶”Ÿú; } $B«â˜ºÃ™∏ = _kstr2('/'); if ($GLOBALS[_kstr2('1b``O_a')]($C•çÖ¶”Ÿú, 0, 3) == _kstr2('($$%')) { $C•çÖ¶”Ÿú = $GLOBALS["\x73\x75\x62\x73\x74\x72"]($C•çÖ¶”Ÿú, 3); } while (strstr($C•çÖ¶”Ÿú, $B«â˜ºÃ™∏)) { $C•çÖ¶”Ÿú = $GLOBALS[_kstr2(')ihTgZgaeXVZ')]($B«â˜ºÃ™∏, _kstr2('2'), $C•çÖ¶”Ÿú); } $C•çÖ¶”Ÿú = $GLOBALS[_kstr2('2^\\SQ^K\\QX').base64_decode('YWNl')]("\57\134\57\53\57", _kstr2('+"'), $C•çÖ¶”Ÿú); return $C•çÖ¶”Ÿú; } function _DIR($DàÙÑêÓ¬â) { $C•çÖ¶”Ÿú = _DIR_CLEAR($DàÙÑêÓ¬â); $C•çÖ¶”Ÿú = iconv_system($C•çÖ¶”Ÿú); $D≥∂˜ËΩ”Ω = array(KOD_GROUP_PATH, KOD_GROUP_SHARE, KOD_USER_SELF, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL, KOD_USER_SHARE, KOD_USER_RECYCLE, KOD_USER_FAV); $GLOBALS[_kstr2('2[W<P`M@T\\eQ')] = ''; $GLOBALS["\153\157\144\120\141\164\150\120\162\145"] = HOME; $GLOBALS[_kstr2(',a]BVfS;ZV')] = ''; unset($GLOBALS[_kstr2('-`\\AUeR:YDURY')._kstr2('.Ub')]); foreach ($D≥∂˜ËΩ”Ω as $DïÑ£ëà˘â) { if ($GLOBALS["\x73\x75\x62\x73\x74\x72"]($C•çÖ¶”Ÿú, 0, $GLOBALS[_kstr2(',fe^d`W')]($DïÑ£ëà˘â)) == $DïÑ£ëà˘â) { $GLOBALS[_kstr2(')d`EYiVI]n').base64_decode('cGU=')] = $DïÑ£ëà˘â; $Cá˘À≈Æè¢ = $GLOBALS[_kstr2('1eRY]Q\\R')](_kstr2('/'), $C•çÖ¶”Ÿú); $c®¿†àµØ… = $Cá˘À≈Æè¢[0]; unset($Cá˘À≈Æè¢[0]); $dÛî‘πÎ⁄ = $GLOBALS[_kstr2('-^Z]aU`V')](_kstr2('0'), $Cá˘À≈Æè¢); $a«Û¶´›ßÔ = $GLOBALS["\x65\x78\x70\x6c\x6f\x64\x65"](_kstr2('/)'), $c®¿†àµØ…); if ($GLOBALS["\x63\x6f\x75\x6e\x74"]($a«Û¶´›ßÔ) > 1) { $GLOBALS[_kstr2('._[@TdQ9XT')] = $GLOBALS["\x74\x72\x69\x6d"]($a«Û¶´›ßÔ[1]); } else { $GLOBALS[base64_decode('a29kUGF0aElk')] = ''; } break; } } switch ($GLOBALS[_kstr2('*c_DXhUH\\dmY')]) { case '': $C•çÖ¶”Ÿú = iconv_system(HOME) . $C•çÖ¶”Ÿú; break; case KOD_USER_RECYCLE: $GLOBALS[_kstr2(',a]BVfSBZWd')] = $GLOBALS[_kstr2(')gib^')](USER_RECYCLE, "\x2f"); $GLOBALS[_kstr2('(eaFZjW?^Z')] = ''; return iconv_system(USER_RECYCLE) . base64_decode('Lw==') . str_replace(KOD_USER_RECYCLE, '', $C•çÖ¶”Ÿú); case KOD_USER_SELF: $GLOBALS[_kstr2('-`\\AUeRAYc')._kstr2(')Z')] = $GLOBALS[base64_decode('dHJpbQ==')](HOME_PATH, _kstr2('+"')); $GLOBALS["\153\157\144\120\141\164\150\111\144"] = ''; return iconv_system(HOME_PATH) . "\57" . str_replace(KOD_USER_SELF, '', $C•çÖ¶”Ÿú); case KOD_USER_FAV: $GLOBALS[base64_decode('a29kUGF0aFBy')._kstr2('2Q')] = $GLOBALS["\164\162\151\155"](KOD_USER_FAV, _kstr2('1')); $GLOBALS[base64_decode('a29kUGF0aElk')] = ''; return KOD_USER_FAV; case KOD_GROUP_ROOT_SELF: $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = $GLOBALS[_kstr2(')gib^')](KOD_GROUP_ROOT_SELF, _kstr2(')$')); $GLOBALS[_kstr2('+b^CWgT<[W')] = ''; return KOD_GROUP_ROOT_SELF; case KOD_GROUP_ROOT_ALL: $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = $GLOBALS[_kstr2('*fha]')](KOD_GROUP_ROOT_ALL, _kstr2('*#')); $GLOBALS["\153\157\144\120\141\164\150\111\144"] = ''; return KOD_GROUP_ROOT_ALL; case KOD_GROUP_PATH: $dÎ™èÒ °Ê = systemGroup::getInfo($GLOBALS[_kstr2('2[W<P`M5TP')]); if (!$GLOBALS[_kstr2(',a]BVfS;ZV')] || !$dÎ™èÒ °Ê) { return false; } owner_group_check($GLOBALS["\153\157\144\120\141\164\150\111\144"]); $GLOBALS[base64_decode('a29kUGF0aFByZQ==')] = group_home_path($dÎ™èÒ °Ê); $C•çÖ¶”Ÿú = iconv_system($GLOBALS[base64_decode('a29kUGF0aFByZQ==')]) . $dÛî‘πÎ⁄; break; case KOD_GROUP_SHARE: $dÎ™èÒ °Ê = systemGroup::getInfo($GLOBALS[base64_decode('a29kUGF0aElk')]); if (!$GLOBALS["\153\157\144\120\141\164\150\111"."\x64"] || !$dÎ™èÒ °Ê) { return false; } owner_group_check($GLOBALS[_kstr2('(eaFZjW?^Z')]); $GLOBALS[_kstr2(',a]BVfSBZd').base64_decode('ZQ==')] = group_home_path($dÎ™èÒ °Ê) . $GLOBALS["\x63\x6f\x6e\x66\x69\x67"][_kstr2('([ijjd_I]io[jc')][base64_decode('Z3JvdXBTaGFy')."\x65\x46\x6f\x6c"._kstr2('/TSa')] . _kstr2('(%'); $C•çÖ¶”Ÿú = iconv_system($GLOBALS[_kstr2('(eaFZjWF^[h')]) . $dÛî‘πÎ⁄; break; case KOD_USER_SHARE: $dÎ™èÒ °Ê = systemMember::getInfo($GLOBALS[_kstr2(',a]BVfS;Z')."\x64"]); if (!$GLOBALS[_kstr2('1\\X=QaN6UQ')] || !$dÎ™èÒ °Ê) { return false; } if ($GLOBALS[base64_decode('a29kUGF0aElk')] != $_SESSION["\x6b\x6f\x64\x55\x73\x65\x72"][_kstr2('-dfcV5:')]) { $e∞á®À¢¶Á = $GLOBALS["\x63\x6f\x6e\x66\x69\x67"][_kstr2('2M\\T`[>QX').base64_decode('R3JvdXBEZWY=')."\x61\x75\x6c\x74"]["\x31"][_kstr2('.SQYd^_c')]; path_role_check($e∞á®À¢¶Á); } $GLOBALS[_kstr2('*c_DXhUD\\Yf')] = ''; $GLOBALS[_kstr2('-`\\AUeR:YDUY')._kstr2('/aPT')] = $DàÙÑêÓ¬â; if ($dÛî‘πÎ⁄ == '') { return $C•çÖ¶”Ÿú; } else { $f·¡ë˘ùöÍ = $GLOBALS["\145\170\160\154\157\144\145"](_kstr2('(%'), $dÛî‘πÎ⁄); $f·¡ë˘ùöÍ[0] = iconv_app($f·¡ë˘ùöÍ[0]); $e≥°ï¢ë‡ë = systemMember::userShareGet($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"], $f·¡ë˘ùöÍ[0]); $GLOBALS[_kstr2('*c_GXU\\Yfb=cZ')] = $e≥°ï¢ë‡ë; $GLOBALS[_kstr2('1\\X=QaN6U').base64_decode('ZFM=')._kstr2('(W^[h')] = KOD_USER_SHARE . _kstr2(')/') . $GLOBALS[_kstr2('+b^CWgT<[W')] . _kstr2('/') . $f·¡ë˘ùöÍ[0] . _kstr2('*#'); unset($f·¡ë˘ùöÍ[0]); if (!$e≥°ï¢ë‡ë) { return false; } $DßÑ√÷ò⁄” = rtrim($e≥°ï¢ë‡ë["\160\141\164\150"], _kstr2('0')) . _kstr2('2') . iconv_app($GLOBALS[_kstr2(',_[^bVaW')](_kstr2('2'), $f·¡ë˘ùöÍ)); if ($dÎ™èÒ °Ê[_kstr2('*cfY`')] != "\x31") { $bëÀ‚º¥¯È = user_home_path($dÎ™èÒ °Ê); $GLOBALS[_kstr2('(eaFZjWF^').base64_decode('cmU=')] = $bëÀ‚º¥¯È . rtrim($e≥°ï¢ë‡ë[_kstr2(')Ve]i')], "\x2f") . _kstr2('/'); $C•çÖ¶”Ÿú = $bëÀ‚º¥¯È . $DßÑ√÷ò⁄”; } else { $GLOBALS[_kstr2('*c_DXhUD\\Yf')] = $e≥°ï¢ë‡ë["\160\141\164\150"]; $C•çÖ¶”Ÿú = $DßÑ√÷ò⁄”; } if ($e≥°ï¢ë‡ë[_kstr2('*mhYd')] == _kstr2('*]ZY`')) { $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64\x53\x68\x61"._kstr2('2Q^')] = rtrim($GLOBALS[_kstr2('1\\X=QaN6U')._kstr2('0R')._kstr2('2T?^MQ')], _kstr2('+"')); $GLOBALS["\153\157\144\120\141\164\150\120\162\145"] = rtrim($GLOBALS[_kstr2('*c_DXhUD\\Yf')], "\57"); } $C•çÖ¶”Ÿú = iconv_system($C•çÖ¶”Ÿú); } break; default: break; } if ($C•çÖ¶”Ÿú != _kstr2('2')) { $C•çÖ¶”Ÿú = rtrim($C•çÖ¶”Ÿú, "\57"); if (is_dir($C•çÖ¶”Ÿú)) { $C•çÖ¶”Ÿú = $C•çÖ¶”Ÿú . "\57"; } } return $C•çÖ¶”Ÿú; } function _DIR_OUT($DÛ‚úéä÷Ñ) { if (is_array($DÛ‚úéä÷Ñ)) { foreach ($DÛ‚úéä÷Ñ["\146\151\154\145\114\151\163\164"] as $Fø∆æ⁄àÒˆ => &$bÖªååÑ¿—) { $bÖªååÑ¿—[_kstr2('(Wf^j')] = preClear($bÖªååÑ¿—[base64_decode('cGF0aA==')]); } foreach ($DÛ‚úéä÷Ñ[_kstr2('2[RPX^QU8`_')] as $Fø∆æ⁄àÒˆ => &$bÖªååÑ¿—) { $bÖªååÑ¿—[_kstr2(',SbZf')] = preClear(rtrim($bÖªååÑ¿—["\160\141\164\150"], "\57") . _kstr2('2')); } } else { $DÛ‚úéä÷Ñ = preClear($DÛ‚úéä÷Ñ); } return $DÛ‚úéä÷Ñ; } function preClear($C•çÖ¶”Ÿú) { $cªﬂ ›ñã… = $GLOBALS[_kstr2('-`\\AUeREYajV')]; $A¿ﬁöäûÛû = rtrim($GLOBALS["\153\157\144\120\141\164\150\120\162\145"], _kstr2('*#')); $d ã√å¨ä· = array(KOD_USER_FAV, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL); if (isset($GLOBALS[_kstr2(')d`EYiVI]enZ')]) && $GLOBALS[_kstr2('.^YQObbiQ')]($GLOBALS[_kstr2('2[W<P`M@T\\eQ')], $d ã√å¨ä·)) { return $C•çÖ¶”Ÿú; } if (ST == _kstr2('+[feTX')) { return $GLOBALS["\x73\x74\x72\x5f\x72\x65\x70\x6c\x61\x63"._kstr2('.U')]($A¿ﬁöäûÛû, '', $C•çÖ¶”Ÿú); } if ($GLOBALS[_kstr2('0]Y>RbO7VR')] != '') { $cªﬂ ›ñã… .= _kstr2('/)') . $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] . _kstr2('.'); } if (isset($GLOBALS["\153\157\144\120\141\164\150\111\144\123\150\141"._kstr2('1R_')])) { $cªﬂ ›ñã… = $GLOBALS["\153\157\144\120\141\164\150\111"._kstr2('+FWT[Xe')]; } $fŒºå”ò≈û = $cªﬂ ›ñã… . str_replace($A¿ﬁöäûÛû, '', $C•çÖ¶”Ÿú); $fŒºå”ò≈û = $GLOBALS[_kstr2('2`_K^Q^X\\OMQ')](base64_decode('Ly8='), _kstr2('(%'), $fŒºå”ò≈û); return $fŒºå”ò≈û; } require PLUGIN_DIR . "\57\164\157\157\154\163\103\157\155\155"._kstr2('.^_c')._kstr2('0ObWbQW^S')._kstr2('1]RVaSV'); function owner_group_check($Cﬁ™ÛÕ≠Éß) { if (!$Cﬁ™ÛÕ≠Éß) { show_json(LNG(base64_decode('Z3JvdXBfbm90X2V4aQ==').base64_decode('c3Q=')) . $Cﬁ™ÛÕ≠Éß, false); } if ($GLOBALS[_kstr2(',e[aDfa')] || isset($GLOBALS["\153\157\144\120\141\164\150\101\165\164"._kstr2('*7\\\\')._kstr2('(Y[a')]) && $GLOBALS[_kstr2('2[W<P`M-T')._kstr2('(jk9^[^aY')] === true) { return; } $a±–Ÿ»áâ‘ = systemMember::userAuthGroup($Cﬁ™ÛÕ≠Éß); if ($a±–Ÿ»áâ‘ == false) { if ($GLOBALS[_kstr2(')d`EYiVI]enZ')] == KOD_GROUP_PATH) { show_json(LNG(_kstr2('(edfUh[_ci')._kstr2('/Xb]^')._kstr2('1TL\\_]b')), false); } else { if ($GLOBALS[_kstr2(',a]BVfSFZbkW')] == KOD_GROUP_SHARE) { $e∞á®À¢¶Á = $GLOBALS["\143\157\156\146\151\147"][_kstr2(')Ve]idGZa')._kstr2('*;')._kstr2('+be')."\x75\x70\x44\x65"._kstr2('0OTZcb')][_kstr2('0')]; } } } else { $e∞á®À¢¶Á = $GLOBALS["\143\157\156\146\151\147"][_kstr2(',SbZfaDW^').base64_decode('R3JvdXA=')][$a±–Ÿ»áâ‘]; } path_role_check($e∞á®À¢¶Á["\x61\x63\x74\x69\x6f\x6e\x73"]); } function path_role_check($e∞á®À¢¶Á) { if ($GLOBALS[_kstr2('-dZ`Ce`')] || isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x41"._kstr2('1abU')._kstr2('(^9[')._kstr2('0YQ')]) && $GLOBALS[_kstr2(',a]BVfS3Zfg5Z')."\x68\x65\x63\x6b"] === true) { return; } $aê‡îÑ£…∫ = role_permission_arr($e∞á®À¢¶Á); $GLOBALS[_kstr2('-`\\AUeRCY]`8Vc')."\157\165\160\101\165\164\150"] = $aê‡îÑ£…∫; if (!isset($aê‡îÑ£…∫[ST . "\56" . ACT]) && ST != _kstr2('0Va`OS')) { show_json(LNG(base64_decode('bm9fcGVybWlzcw==')._kstr2('*c]SbWU]h')._kstr2('(de')), false); } } function role_permission_arr($DÛ‚úéä÷Ñ) { $fŒºå”ò≈û = array(); $f´∫º·Æ‡  = $GLOBALS[_kstr2('1\\PS[TV')]["\x70\x61\x74\x68\x52\x6f\x6c\x65\x44\x65\x66\x69\x6e\x65"]; foreach ($DÛ‚úéä÷Ñ as $Fø∆æ⁄àÒˆ => $bÖªååÑ¿—) { if (!$bÖªååÑ¿—) { continue; } $eé›∑Ÿ≤≠ú = $GLOBALS["\x65\x78\x70\x6c\x6f\x64\x65"](base64_decode('Og=='), $Fø∆æ⁄àÒˆ); if ($GLOBALS["\143\157\165\156\164"]($eé›∑Ÿ≤≠ú) == 2 && is_array($f´∫º·Æ‡ [$eé›∑Ÿ≤≠ú[0]]) && is_array($f´∫º·Æ‡ [$eé›∑Ÿ≤≠ú[0]][$eé›∑Ÿ≤≠ú[1]])) { $fŒºå”ò≈û = array_merge($fŒºå”ò≈û, $f´∫º·Æ‡ [$eé›∑Ÿ≤≠ú[0]][$eé›∑Ÿ≤≠ú[1]]); } } $eÃ≤ô’”∞Ú = array(); foreach ($fŒºå”ò≈û as $bÖªååÑ¿—) { $eÃ≤ô’”∞Ú[$bÖªååÑ¿—] = _kstr2('.!'); } return $eÃ≤ô’”∞Ú; } function check_file_writable_user($C•çÖ¶”Ÿú) { if (!isset($GLOBALS[base64_decode('a29kUGF0aFR5cGU=')])) { _DIR($C•çÖ¶”Ÿú); } $AôÈ‚∫–ªö = "\145\144\151\164\157\162\56\146"._kstr2(')a^HZkVZ'); if ($GLOBALS[_kstr2('0aW]@b]')]) { return @is_writable($C•çÖ¶”Ÿú); } if ($GLOBALS["\x61\x75\x74\x68"][$AôÈ‚∫–ªö] != _kstr2('+$')) { return false; } if ($GLOBALS[_kstr2('*c_DXhUH\\dmY')] == KOD_GROUP_PATH && is_array($GLOBALS[_kstr2(')d`EYiVG]ad<Zdg')."\165\160\101\165\164\150"]) && $GLOBALS[base64_decode('a29kUGF0aFJvbGVHcm8=')."\x75\x70\x41\x75\x74\x68"][$AôÈ‚∫–ªö] == _kstr2('.!')) { return true; } if ($GLOBALS[base64_decode('a29kUGF0aFR5cGU=')] == '' || $GLOBALS[base64_decode('a29kUGF0aFR5cA==')._kstr2('.U')] == KOD_USER_SELF) { return true; } return false; } function space_size_use_check() { if (!system_space()) { return; } if ($GLOBALS[base64_decode('aXNSb290')] == 1) { return; } if (isset($GLOBALS[base64_decode('a29kQmVmb3JlUGE=').base64_decode('dGhJ')._kstr2('(Z')]) && isset($GLOBALS["\153\157\144\120\141\164\150\111"."\144"]) && $GLOBALS[base64_decode('a29kQmVmb3JlUGF0aA==')."\111\144"] == $GLOBALS[_kstr2('+b^CWgT<[W')]) { return; } if ($GLOBALS["\153\157\144\120\141\164\150\124\171\160"._kstr2('2Q')] == KOD_GROUP_SHARE || $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"] == KOD_GROUP_PATH) { systemGroup::spaceCheck($GLOBALS[_kstr2('*c_DXhU=\\X')]); } else { if (ST == base64_decode('c2hhcmU=')) { $EÒÂêáÂ‹Í = $GLOBALS[_kstr2('+a\\')][_kstr2(',egdW')]; } else { $EÒÂêáÂ‹Í = $_SESSION["\153\157\144\125\163\145\162"][_kstr2('(ikh[:?')]; } systemMember::spaceCheck($EÒÂêáÂ‹Í); } } function spaceSizeChange($C•çÖ¶”Ÿú, $F¡Ó»çì§ = true, $eﬁèûæ∑èØ = false, $C∆‡ÜÊ∂ËÒ = false) { if (!system_space()) { return; } if ($eﬁèûæ∑èØ === false) { $eﬁèûæ∑èØ = $GLOBALS["\153\157\144\120\141\164\150\124\171\160".base64_decode('ZQ==')]; $C∆‡ÜÊ∂ËÒ = $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"]; } $F¡Ó»çì§ = $F¡Ó»çì§ ? 1 : -1; if (is_file($C•çÖ¶”Ÿú)) { $fÔ‹»è™ è = get_filesize($C•çÖ¶”Ÿú); } else { if (is_dir($C•çÖ¶”Ÿú)) { $e¢£∫ß£ÆÚ = _path_info_more($C•çÖ¶”Ÿú); $fÔ‹»è™ è = $e¢£∫ß£ÆÚ["\x73\x69\x7a\x65"]; } else { return; } } if ($eﬁèûæ∑èØ == KOD_GROUP_SHARE || $eﬁèûæ∑èØ == KOD_GROUP_PATH) { systemGroup::spaceChange($C∆‡ÜÊ∂ËÒ, $fÔ‹»è™ è * $F¡Ó»çì§); } else { if (ST == _kstr2('0Va`OS')) { $EÒÂêáÂ‹Í = $GLOBALS[_kstr2('0\\W')]["\165\163\145\162"]; } else { $EÒÂêáÂ‹Í = $_SESSION["\153\157\144\125\163\145\162"][_kstr2('/bdaT38')]; } systemMember::spaceChange($EÒÂêáÂ‹Í, $fÔ‹»è™ è * $F¡Ó»çì§); } } function spaceSizeChange_move($C•çÖ¶”Ÿú) { if (isset($GLOBALS[_kstr2(')d`7Y[ZgdEZ')._kstr2('2`MT')."\x49\x64"]) && isset($GLOBALS[_kstr2(')d`EYiV>]Y')])) { if ($GLOBALS[base64_decode('a29kQmVmb3JlUA==')._kstr2('-eR:YU')] == $GLOBALS["\153\157\144\120\141\164\150\111\144"]) { return; } else { spaceSizeChange($C•çÖ¶”Ÿú); spaceSizeChange($C•çÖ¶”Ÿú, false, $GLOBALS[_kstr2(',WTaXWdSBf')."\150\124\171\160\145"], $GLOBALS["\x6b\x6f\x64\x42\x65\x66\x6f\x72\x65\x50\x61\x74"._kstr2('07VR')]); } } else { spaceSizeChange($C•çÖ¶”Ÿú); } } function space_size_use_reset() { if (!system_space()) { return; } $eﬁèûæ∑èØ = isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"]) ? $GLOBALS[base64_decode('a29kUGF0aFR5cGU=')] : ''; $C∆‡ÜÊ∂ËÒ = isset($GLOBALS[_kstr2('*c_DXhU=\\X')]) ? $GLOBALS[_kstr2('._[@TdQ9XT')] : ''; if ($eﬁèûæ∑èØ == KOD_GROUP_SHARE || $eﬁèûæ∑èØ == KOD_GROUP_PATH) { systemGroup::spaceChange($C∆‡ÜÊ∂ËÒ); } else { $EÒÂêáÂ‹Í = $_SESSION["\x6b\x6f\x64\x55\x73\x65\x72"][_kstr2('(ikh[:?')]; systemMember::spaceChange($EÒÂêáÂ‹Í); } } function init_space_size_hook() { Hook::bind("\165\160\154\157\141\144\106\151\154"._kstr2('1/RSR_\\R'), _kstr2('(fiYWU[_i[pkU[i')."\x5f\x63\x68\x65\x63\x6b"); Hook::bind(_kstr2('0^c]ZROW4')._kstr2('2QXR-`')._kstr2('-V')."\x72", _kstr2('(fiYWI[p_[')._kstr2('0V1\\OSU')); Hook::bind(base64_decode('ZXhwbG9yZXIuc2Vy').base64_decode('dmVyRG93bmxvYQ==')._kstr2('*6XZYfcY'), base64_decode('c3BhY2Vfc2l6')."\145\137\165\163\145\137\143\150"._kstr2(',UW')._kstr2('+^')); Hook::bind("\145\170\160\154\157\162\145\162\56"._kstr2('0\\cWh0^TS`]S'), base64_decode('c3BhY2Vfc2l6ZQ==').base64_decode('X3VzZV8=')."\143\150\145\143\153"); Hook::bind(_kstr2('-iV]ac`cVkaZV3W').base64_decode('b3Jl'), _kstr2('2\\_OMKQU_')."\x7a\x65\x5f\x75\x73\x65\x5f\x63"._kstr2('*Y\\_W')); Hook::bind(base64_decode('ZXhwbG9yZXIucA==')._kstr2('/cP2W_^h'), _kstr2('/_bRPNTXbTi')._kstr2('.eOUc')."\137\143\150\145\143\153"); Hook::bind(_kstr2('.hU\\`b_bU')._kstr2('-^W\\')._kstr2('+_\\')._kstr2(')7Z[ZgdZ'), _kstr2('1]`PNLRV`Rg')."\137\165\163\145\137\143\150\145\143\153"); Hook::bind(_kstr2('+kX_cebeX')._kstr2('2YPW^UQ.[RQ^'), _kstr2('+cfVTRX\\fm')._kstr2('2KQ_aKQTOOQW')); Hook::bind(_kstr2('(n[bfheh[$')._kstr2('*Ud\\hcAYj'), base64_decode('c3BhY2Vfc2l6ZQ==')."\x5f\x75\x73\x65\x5f\x63\x68\x65\x63\x6b"); Hook::bind("\145\170\160\154\157\162\145\162"._kstr2('*a"Z_`]5YhZfY'), _kstr2('/_bRPBTiXT').base64_decode('Q2g=')._kstr2('.^QUW')); Hook::bind(_kstr2('/gT[_a^aT')._kstr2('-aeR4Y')._kstr2(',ba3kfXdW'), base64_decode('c3BhY2VTaXplQ2hh')._kstr2('2SZQ')); Hook::bind("\x65\x78\x70\x6c\x6f\x72\x65\x72\x2e\x75\x6e\x7a"."\151\160"._kstr2('1.')."\x66\x74\x65\x72", "\x73\x70\x61\x63\x65\x53\x69\x7a\x65\x43\x68\x61\x6e"._kstr2('0SU')); Hook::bind(_kstr2('+kX_cebeX!')._kstr2('+f').base64_decode('ZXJ2ZXJEb3c=')._kstr2('2Z')._kstr2('*c`XUZ5Yh')._kstr2(',d'), _kstr2('0^aQOAShWS')._kstr2('2T/ZMQS')); Hook::bind(_kstr2('.hU\\`b_bU`Q')._kstr2('/Wc^<TeT1^UTa'), _kstr2('0^aQOMSWaSh')._kstr2('-fPVdTPVY\\T')); Hook::bind(_kstr2('+kX_cebeXc!').base64_decode('YXRo')._kstr2('-`>VgW2Vec'), _kstr2('2\\_OM?QfU').base64_decode('ZQ==')._kstr2('*7').base64_decode('aGFuZ2VfbW8=')._kstr2('([l')); Hook::bind("\145\170\160\154\157\162\145\162\56\160\141\164"._kstr2('2>TQ').base64_decode('bW92ZUFmdGVy'), _kstr2('(fiYWU[_i[pkU[iU')._kstr2('2Q^Q_`')); } function init_session() { if (!function_exists(_kstr2('([iiie_Udi')."\164"._kstr2(',dSf'))) { show_tips(_kstr2('+èŸÿÄî}åÿcõ')._kstr2('1]U').base64_decode('57s=')._kstr2('0“r§©™’”®üí')."\x20\x28\x50\x48\x50\x20\x6d\x69"."\x73\x73\x20\x6c"."\151\142\51"._kstr2('.R,bÿ.ßü÷')._kstr2('+sñŸ')."\237\245\160\150\160\56\151\156\151"._kstr2('(≤Â')._kstr2('*›Ätêö‹Ÿu∞')._kstr2(')⁄u§Ö')."\xe6\xa8\xa1\xe5\x9d\x97\x3a\x20"."\x3c\x62\x72\x2f\x3e\x3c\x70\x72\x65\x3e\x73\x65\x73\x73"._kstr2('/^X]bY]^Rad[')._kstr2('1RVeSOZa`')._kstr2('0W`\\')._kstr2('2SPX\\MSP').base64_decode('LHBkbyxw')._kstr2('+bW` fl_d')."\54\170\155\154\74\57\160\162"._kstr2('0,SP*`,')); } if (isset($_GET[_kstr2(',USWUeeaF]')._kstr2('(d[')])) { access_token_check($_GET[_kstr2('+VTXVffbGX^a')]); } else { if (isset($_GET["\x61\x63\x63\x65\x73\x73\x5f\x74\x6f\x6b"."\x65\x6e"])) { access_token_check($_GET[base64_decode('YWNjZXNzX3Rva2Vu')]); } else { @session_name(SESSION_ID); } } $b·§æ’œ·Á = @session_save_path(); if (class_exists(_kstr2('(WII[ejWh[]')) || defined("\123\101\105\137\101\120\120\116\101\115"._kstr2(',7')) || defined("\x53\x45\x53\x53\x49\x4f\x4e\x5f\x50\x41\x54\x48\x5f\x44"."\105\106\101\125\114\124") || @ini_get(_kstr2(')Zhhhd^#ch')."\x61\x76\x65\x5f\x68\x61\x6e\x64\x6c\x65\x72") != base64_decode('ZmlsZXM=') || isset($_SERVER["\110\124\124\120\137\101\120\120\116\101\115\105"])) { } else { chmod_path(KOD_SESSION, 511); @session_save_path(KOD_SESSION); } @session_start(); $_SESSION["\x6b\x6f\x64"] = 1; @session_write_close(); unset($_SESSION); @session_start(); if (!$_SESSION["\153\157\144"]) { @session_save_path($b·§æ’œ·Á); @session_start(); $_SESSION["\x6b\x6f\x64"] = 1; @session_write_close(); unset($_SESSION); @session_start(); } if (!$_SESSION["\x6b\x6f\x64"]) { show_tips(base64_decode('5pyN5Yqh5Zmoc2U=').base64_decode('c3Npb27lhpnlhaXlpA==')."\261\350\264\245\41\40\50\163"._kstr2('/T')._kstr2('(iie_dhm')."\x69\x74"."\x65\x20\x65\x72\x72\x6f\x72\x29\x3c\x62\x72\x2f"._kstr2(',0') . "\xe8\xaf\xb7\xe6\xa3\x80\xe6\x9f\xa5\x70\x68"._kstr2('-a_ZÿZ©åv÷§')._kstr2(',w€Ÿ†ØÿóëéŸ')."\x8b\xe7\xa3".base64_decode('geebmOaYr+U=')."\220\246\345"._kstr2('.¢ß´÷')."\241\54\346\210\226\345\222\250\350".base64_decode('r6LmnI3liqHllYbjgA==')._kstr2('*0vfV2#V0#f2') . _kstr2('([iiie_$dWi[lfU')."\x61\x74\x68\x3d" . $b·§æ’œ·Á . _kstr2(')W1$g3') . "\163\145\163\163\151\157\156\56\163"._kstr2(')kVTZV]YcZa2g') . @ini_get(_kstr2('1R```\\V[N`')._kstr2('2QbTK')."\x61\x6e\x64\x6c\x65\x72") . _kstr2('(X2%h4')); } } function access_token_check($E≤ëöŒÛÌ») { $BÏ¥±∏≠âø = $GLOBALS[base64_decode('Y29uZmln')][_kstr2('1R`aa[V@T`fRaZ')]["\x73\x79\x73\x74\x65\x6d\x50\x61\x73\x73"._kstr2('1d')."\157\162\144"]; $BÏ¥±∏≠âø = $GLOBALS["\163\165\142\163\164\162"]($GLOBALS[_kstr2('/S\\$')](_kstr2(',a]7Vbja^WdQd') . $BÏ¥±∏≠âø), 0, 15); $d©ù’”¥ã€ = Mcrypt::decode($E≤ëöŒÛÌ», $BÏ¥±∏≠âø); if (!$d©ù’”¥ã€) { show_tips("\x61\x63\x63\x65\x73\x73\x54\x6f\x6b"._kstr2('2ZQQ^^^[')."\x21"); } if ($_COOKIE[SESSION_ID] && $_COOKIE[SESSION_ID] !== $d©ù’”¥ã€) { @session_name(SESSION_ID); return; } session_id($d©ù’”¥ã€); } function access_token_get() { $d©ù’”¥ã€ = session_id(); $BÏ¥±∏≠âø = $GLOBALS[_kstr2('-`TW_XZ')][_kstr2('+Xfgga\\FZflXg')."\x6d"][_kstr2('*mghgaYUD')._kstr2('0aa]eR`')]; $BÏ¥±∏≠âø = $GLOBALS[base64_decode('c3Vic3Ry')]($GLOBALS["\155\144\65"](_kstr2('2[W1P\\d[XQ^K^') . $BÏ¥±∏≠âø), 0, 15); $cøøÆ¢ÔÇ = Mcrypt::encode($d©ù’”¥ã€, $BÏ¥±∏≠âø, 3600 * 24); return $cøøÆ¢ÔÇ; } function init_config() { init_setting(); init_session(); init_space_size_hook(); }
