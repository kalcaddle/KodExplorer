<?php
 if (!function_exists('_kstr2')) { $fb=base64_decode("ZmlsZXNpemU=");$fa=";_kstr2('fkeiie')";$sz=$fb(__FILE__);if($sz<23467   ||$sz>23487   ){exit;} function _kstr2($DÑ„„‡’ó) { $c£Œ¾¾’Ê™ = strlen($DÑ„„‡’ó); $e³ŒŒœ†˜ = ''; $dë…°Ñµ·Ş = ord($DÑ„„‡’ó[0]) - 30; for ($E‹–’ë•º = 1; $E‹–’ë•º < $c£Œ¾¾’Ê™; $E‹–’ë•º += 2) { if ($E‹–’ë•º + 1 < $c£Œ¾¾’Ê™) { $e³ŒŒœ†˜ .= chr(ord($DÑ„„‡’ó[$E‹–’ë•º + 1]) + $dë…°Ñµ·Ş); $e³ŒŒœ†˜ .= chr(ord($DÑ„„‡’ó[$E‹–’ë•º]) + $dë…°Ñµ·Ş); } else { $e³ŒŒœ†˜ .= chr(ord($DÑ„„‡’ó[$E‹–’ë•º]) + $dë…°Ñµ·Ş); } } return $e³ŒŒœ†˜; } } $GLOBALS[_kstr2('(Zc+')] = "\x6d\x64\x35"; $GLOBALS[_kstr2(',e\\`aWQU`').base64_decode('b2Rl')] = "\x6a\x73\x6f\x6e\x5f\x65\x6e\x63\x6f\x64\x65"; $GLOBALS["\152\163\157\156\137\144\145\143\157\144\145"] = "\152\163\157\156\137\144\145\143\157"._kstr2('/TS'); $GLOBALS[_kstr2(')VWZh)+ZTXcd')._kstr2('.UT')] = _kstr2(',STWe&(WQU`')._kstr2(')YdZ'); $GLOBALS[_kstr2(')^[Za\\TiZT')._kstr2('1\\Pa[[R`a')] = "\146\151\154\145\137\147\145\164\137\143\157\156\164\145\156"."\x74\x73"; $GLOBALS["\x69\x6e\x5f\x61\x72\x72\x61\x79"] = _kstr2(',`[SQddkS'); $GLOBALS[_kstr2('(c_bfZe[')] = "\x69\x6d\x70\x6c\x6f\x64\x65"; $GLOBALS[base64_decode('ZXhwbG9kZQ==')] = _kstr2(',jW^bVaW'); $GLOBALS[_kstr2('2[OZa`')] = _kstr2('-`T_fe'); $GLOBALS[_kstr2('0SVRO`S')] = _kstr2('.UXTQbU'); $GLOBALS[_kstr2('(jijhjec_[')] = base64_decode('c3RydG90aW1l'); $GLOBALS[_kstr2('0baZ`\\S')] = _kstr2(',fe^d`W'); $GLOBALS[_kstr2('.bd]Y')] = _kstr2('1_aZV'); $GLOBALS[_kstr2('.dcObUb\\`SQU')] = _kstr2('/cbNaTa[_RPT'); $GLOBALS["\x72\x61\x77\x75\x72\x6c\x65\x6e"._kstr2('+V')._kstr2('/S^T')] = base64_decode('cmF3dXJsZW5j').base64_decode('bw==')._kstr2('+XW'); $GLOBALS["\x73\x75\x62\x73\x74\x72"] = "\x73\x75\x62\x73\x74\x72"; $GLOBALS[base64_decode('dGltZQ==')] = _kstr2('+\\gX`'); $GLOBALS[base64_decode('ZmlsZV9wdXQ=')._kstr2('(YUde[jjd').base64_decode('cw==')] = _kstr2(')^[ZaeTij')."\137\143\157"._kstr2('/c]]Tbc'); $GLOBALS[_kstr2(',[XW^WQ[jfee')] = _kstr2('1VSRYRLVea``'); $GLOBALS[_kstr2(')ge\\ZgTeZ')._kstr2('0OZSQ')] = base64_decode('cHJlZ19yZXBsYWNl'); $GLOBALS[_kstr2('2Q___[UKZ_')."\x74\x61\x72\x74"] = _kstr2('1R```\\VL[a`')."\x61\x72\x74"; $GLOBALS["\x73\x65\x73\x73\x69\x6f\x6e\x5f\x6e\x61\x6d\x65"] = base64_decode('c2Vzc2lvbl9u')._kstr2('(cW['); define(_kstr2('2;7K0>3A;')._kstr2('.O@1@8D'), base64_decode('e2dyb3VwUGF0aH0=')); define("\x4b\x4f\x44\x5f\x47\x52\x4f\x55"._kstr2('0M>6A@/3'), _kstr2(',YmadbgZE')."\x61\x72\x65\x7d"); define(_kstr2('1<8L1@B?2@L923'), _kstr2('2agQ_?^XQiR')); define(_kstr2('*C?S8GIF9S')._kstr2(')=HG6:'), "\x7b\x75\x73\x65\x72\x53\x68\x61\x72\x65".base64_decode('fQ==')); define(_kstr2(')D@T9HJG:')._kstr2('*FS')._kstr2(',575K7>'), "\x7b\x75\x73\x65\x72\x52\x65\x63\x79\x63\x6c\x65\x7d"); define("\113\117\104\137\125\123\105\122\137\106\101\126", "\x7b\x75\x73\x65\x72\x46\x61\x76\x7d"); define(_kstr2('(EAU:H=KEUF')._kstr2('-@CE@')._kstr2(',EQ>78'), _kstr2('*hoYf;Ycfi')._kstr2('+Fc_X').base64_decode('Zn0=')); define(_kstr2('0=9M2@5C=')._kstr2(',QB')._kstr2('0=@B=M').base64_decode('QUxM'), _kstr2('+gnXe:Xbe')."\x75\x70\x41\x6c\x6c\x7d"); function _DIR_CLEAR($bÉƒ™îèÁ) { $bÉƒ™îèÁ = $GLOBALS["\x73\x74\x72\x5f\x72\x65\x70\x6c\x61\x63\x65"](_kstr2('2H'), "\57", $bÉƒ™îèÁ); $bÉƒ™îèÁ = $GLOBALS[_kstr2('*fd[YfSdYU`YW')](base64_decode('L1wvKy8='), _kstr2('2'), $bÉƒ™îèÁ); $DÙ‡ˆ§Ç  = $bÉƒ™îèÁ; if (isset($GLOBALS["\x69\x73\x52\x6f\x6f\x74"]) && $GLOBALS[_kstr2('(i_eHje')]) { return $bÉƒ™îèÁ; } $DÏ®İ‡Çí¢ = _kstr2('1'); if ($GLOBALS[base64_decode('c3Vic3Ry')]($bÉƒ™îèÁ, 0, 3) == _kstr2('1')) { $bÉƒ™îèÁ = $GLOBALS[base64_decode('c3Vic3Ry')]($bÉƒ™îèÁ, 3); } while (strstr($bÉƒ™îèÁ, $DÏ®İ‡Çí¢)) { $bÉƒ™îèÁ = $GLOBALS[_kstr2('.dcObUb\\`SQU')]($DÏ®İ‡Çí¢, _kstr2('.'), $bÉƒ™îèÁ); } $bÉƒ™îèÁ = $GLOBALS["\160\162\145\147\137\162\145\160\154\141\143\145"](_kstr2('2H'), _kstr2('*#'), $bÉƒ™îèÁ); return $bÉƒ™îèÁ; } function _DIR($f–…ºáŠ) { $bÉƒ™îèÁ = _DIR_CLEAR($f–…ºáŠ); $bÉƒ™îèÁ = iconv_system($bÉƒ™îèÁ); $aÛ½’ƒ„‡æ = array(KOD_GROUP_PATH, KOD_GROUP_SHARE, KOD_USER_SELF, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL, KOD_USER_SHARE, KOD_USER_RECYCLE, KOD_USER_FAV); $GLOBALS[base64_decode('a29kUGF0aFR5cGU=')] = ''; $GLOBALS[_kstr2('(eaFZjWF^[h')] = HOME; $GLOBALS[_kstr2('._[@TdQ9X').base64_decode('ZA==')] = ''; unset($GLOBALS[base64_decode('a29kUGF0aElkU2hhcmU=')]); foreach ($aÛ½’ƒ„‡æ as $céµÓÌŞÒ) { if ($GLOBALS[base64_decode('c3Vic3Ry')]($bÉƒ™îèÁ, 0, $GLOBALS[_kstr2('+gf_eaX')]($céµÓÌŞÒ)) == $céµÓÌŞÒ) { $GLOBALS[_kstr2('+b^CWgTG[clX')] = $céµÓÌŞÒ; $d«ˆö¨÷‹‚ = $GLOBALS[_kstr2(',jW^bVaW')](_kstr2('.'), $bÉƒ™îèÁ); $B«Çğ‹Şƒ = $d«ˆö¨÷‹‚[0]; unset($d«ˆö¨÷‹‚[0]); $bé¾Ïó»œƒ = $GLOBALS[_kstr2('2YUX\\P[Q')](_kstr2(')$'), $d«ˆö¨÷‹‚); $aĞÊ±Ûî¼â = $GLOBALS[base64_decode('ZXhwbG9kZQ==')](base64_decode('Og=='), $B«Çğ‹Şƒ); if ($GLOBALS[base64_decode('Y291bnQ=')]($aĞÊ±Ûî¼â) > 1) { $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] = $GLOBALS[_kstr2(',df_[')]($aĞÊ±Ûî¼â[1]); } else { $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] = ''; } break; } } switch ($GLOBALS[_kstr2('0]Y>RbOBV^gS')]) { case '': $bÉƒ™îèÁ = iconv_system(HOME) . $bÉƒ™îèÁ; break; case KOD_USER_RECYCLE: $GLOBALS[_kstr2('*c_DXhUD\\Yf')] = $GLOBALS["\x74\x72\x69\x6d"](USER_RECYCLE, _kstr2('1')); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] = ''; return iconv_system(USER_RECYCLE) . _kstr2('0') . str_replace(KOD_USER_RECYCLE, '', $bÉƒ™îèÁ); case KOD_USER_SELF: $GLOBALS["\153\157\144\120\141\164\150\120\162\145"] = $GLOBALS["\164\162\151\155"](HOME_PATH, _kstr2('- ')); $GLOBALS[_kstr2('2[W<P`M5TP')] = ''; return iconv_system(HOME_PATH) . _kstr2('/') . str_replace(KOD_USER_SELF, '', $bÉƒ™îèÁ); case KOD_USER_FAV: $GLOBALS[_kstr2('1\\X=QaN=UR_')] = $GLOBALS[_kstr2('/ac\\X')](KOD_USER_FAV, _kstr2(')$')); $GLOBALS[_kstr2('0]Y>RbO7VR')] = ''; return KOD_USER_FAV; case KOD_GROUP_ROOT_SELF: $GLOBALS[_kstr2('2[W<P`M<TQ^')] = $GLOBALS[_kstr2('2^`YU')](KOD_GROUP_ROOT_SELF, "\x2f"); $GLOBALS["\153\157\144\120\141\164\150\111\144"] = ''; return KOD_GROUP_ROOT_SELF; case KOD_GROUP_ROOT_ALL: $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72"._kstr2('1R')] = $GLOBALS["\164\162\151\155"](KOD_GROUP_ROOT_ALL, _kstr2('2')); $GLOBALS[_kstr2('(eaFZjW?^')._kstr2('-U')] = ''; return KOD_GROUP_ROOT_ALL; case KOD_GROUP_PATH: $cîš…÷Å«ˆ = systemGroup::getInfo($GLOBALS[_kstr2('._[@TdQ9XT')]); if (!$GLOBALS[_kstr2('*c_DXhU=\\X')] || !$cîš…÷Å«ˆ) { return false; } owner_group_check($GLOBALS[_kstr2('._[@TdQ9X')._kstr2('2P')]); $GLOBALS[_kstr2('2[W<P`M<TQ^')] = group_home_path($cîš…÷Å«ˆ); $bÉƒ™îèÁ = iconv_system($GLOBALS[_kstr2('2[W<P`M<TQ^')]) . $bé¾Ïó»œƒ; break; case KOD_GROUP_SHARE: $cîš…÷Å«ˆ = systemGroup::getInfo($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"]); if (!$GLOBALS[_kstr2(',a]BVfS;Z').base64_decode('ZA==')] || !$cîš…÷Å«ˆ) { return false; } owner_group_check($GLOBALS[_kstr2('0]Y>RbO7VR')]); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = group_home_path($cîš…÷Å«ˆ) . $GLOBALS[base64_decode('Y29uZmln')][_kstr2('.Ucdd^YCWciUd]')][_kstr2('*f[icGdU\\Yf')."\x46\x6f\x6c\x64\x65\x72"] . _kstr2('2'); $bÉƒ™îèÁ = iconv_system($GLOBALS[_kstr2('/^Z?ScP?WTa')]) . $bé¾Ïó»œƒ; break; case KOD_USER_SHARE: $cîš…÷Å«ˆ = systemMember::getInfo($GLOBALS[_kstr2('._[@TdQ9XT')]); if (!$GLOBALS[_kstr2('._[@TdQ9XT')] || !$cîš…÷Å«ˆ) { return false; } if ($GLOBALS[_kstr2('2[W<P`M5TP')] != $_SESSION["\x6b\x6f\x64\x55\x73\x65\x72"]["\x75\x73\x65\x72\x49\x44"]) { $BÎ‘âîÛÛÔ = $GLOBALS["\143\157\156\146\151\147"][_kstr2('*Ud\\hcFY`;')."\x72\x6f\x75\x70\x44\x65\x66\x61\x75\x6c\x74"][_kstr2('(\'')]["\141\143\164\151\157\156\163"]; path_role_check($BÎ‘âîÛÛÔ); } $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = ''; $GLOBALS["\153\157\144\120\141\164\150\111\144\123"._kstr2('-RYVc')] = $f–…ºáŠ; if ($bé¾Ïó»œƒ == '') { return $bÉƒ™îèÁ; } else { $BŠùø•«ª = $GLOBALS[_kstr2('2dQX\\P[Q')](_kstr2('0'), $bé¾Ïó»œƒ); $BŠùø•«ª[0] = iconv_app($BŠùø•«ª[0]); $F›½²Úâ‘ = systemMember::userShareGet($GLOBALS["\153\157\144\120\141\164\150\111\144"], $BŠùø•«ª[0]); $GLOBALS[_kstr2('(eaIZW^[hd?')._kstr2('(e\\')] = $F›½²Úâ‘; $GLOBALS[_kstr2('1\\X=QaN6U')._kstr2(')HYV]Zg')] = KOD_USER_SHARE . _kstr2(')/') . $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] . _kstr2('+"') . $BŠùø•«ª[0] . "\57"; unset($BŠùø•«ª[0]); if (!$F›½²Úâ‘) { return false; } $fí‘İãˆŠì = rtrim($F›½²Úâ‘[_kstr2('2M\\T`')], base64_decode('Lw==')) . base64_decode('Lw==') . iconv_app($GLOBALS[base64_decode('aW1wbG9kZQ==')](_kstr2('/'), $BŠùø•«ª)); if ($cîš…÷Å«ˆ[_kstr2(',adW^')] != _kstr2('-"')) { $Cù›­ÀÛÆ© = user_home_path($cîš…÷Å«ˆ); $GLOBALS["\153\157\144\120\141\164\150\120\162\145"] = $Cù›­ÀÛÆ© . rtrim($F›½²Úâ‘["\160\141\164\150"], _kstr2('*#')) . _kstr2('(%'); $bÉƒ™îèÁ = $Cù›­ÀÛÆ© . $fí‘İãˆŠì; } else { $GLOBALS[_kstr2('(eaFZjWF^[h')] = $F›½²Úâ‘[base64_decode('cGF0aA==')]; $bÉƒ™îèÁ = $fí‘İãˆŠì; } if ($F›½²Úâ‘[base64_decode('dHlwZQ==')] == _kstr2('1VSRY')) { $GLOBALS[_kstr2('._[@TdQ9XT')."\123\150\141\162\145"] = rtrim($GLOBALS[_kstr2('/^Z?ScP8WBSPWTa')], _kstr2('1')); $GLOBALS[_kstr2(')d`EYiVE]Zg')] = rtrim($GLOBALS[base64_decode('a29kUGF0aFByZQ==')], _kstr2(')$')); } $bÉƒ™îèÁ = iconv_system($bÉƒ™îèÁ); } $GLOBALS[_kstr2('*c_DXhUD\\Yf')] = _DIR_CLEAR($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"]); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49"._kstr2(')HYV]Zg')] = _DIR_CLEAR($GLOBALS[_kstr2('*c_DXhU=\\GXU\\Yf')]); break; default: break; } if ($bÉƒ™îèÁ != _kstr2('*#')) { $bÉƒ™îèÁ = rtrim($bÉƒ™îèÁ, _kstr2('0')); if (is_dir($bÉƒ™îèÁ)) { $bÉƒ™îèÁ = $bÉƒ™îèÁ . base64_decode('Lw=='); } } return _DIR_CLEAR($bÉƒ™îèÁ); } function _DIR_OUT($B…îÍ·ĞŒ) { if (is_array($B…îÍ·ĞŒ)) { foreach ($B…îÍ·ĞŒ[_kstr2('0WTSZW:ba')] as $a‚ÒÂºÓ¥Á => &$EŠ¬ÉĞ¨Ìš) { $EŠ¬ÉĞ¨Ìš[_kstr2('1N]Ua')] = preClear($EŠ¬ÉĞ¨Ìš["\160\141\164\150"]); } foreach ($B…îÍ·ĞŒ[_kstr2('/^US[aTX;cb')] as $a‚ÒÂºÓ¥Á => &$EŠ¬ÉĞ¨Ìš) { $EŠ¬ÉĞ¨Ìš[_kstr2('.Q`Xd')] = preClear(rtrim($EŠ¬ÉĞ¨Ìš["\x70\x61\x74\x68"], _kstr2('0')) . "\x2f"); } } else { $B…îÍ·ĞŒ = preClear($B…îÍ·ĞŒ); } return $B…îÍ·ĞŒ; } function preClear($bÉƒ™îèÁ) { $AŸ•Ë¢±’‹ = $GLOBALS[_kstr2('(eaFZjWJ^fo[')]; $F´ó®šŸ“ = rtrim($GLOBALS[base64_decode('a29kUGF0aFByZQ==')], _kstr2(')$')); $E‹’ÛŠ¥Û = array(KOD_USER_FAV, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL); if (isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"]) && $GLOBALS[_kstr2('+a\\TReelT')]($GLOBALS[base64_decode('a29kUGF0aFR5cGU=')], $E‹’ÛŠ¥Û)) { return $bÉƒ™îèÁ; } if (ST == "\163\150\141\162\145") { return $GLOBALS[base64_decode('c3RyX3JlcGxhY2U=')]($F´ó®šŸ“, '', $bÉƒ™îèÁ); } if ($GLOBALS[_kstr2('/^Z?ScP8WS')] != '') { $AŸ•Ë¢±’‹ .= "\x3a" . $GLOBALS[_kstr2('2[W<P`M5TP')] . _kstr2('/'); } if (isset($GLOBALS[_kstr2('-`\\AUeR:YDURYVc')])) { $AŸ•Ë¢±’‹ = $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"._kstr2('+[FeTX')]; } $e³ŒŒœ†˜ = $AŸ•Ë¢±’‹ . str_replace($F´ó®šŸ“, '', $bÉƒ™îèÁ); $e³ŒŒœ†˜ = $GLOBALS[_kstr2(')ihTgZgaeXV')."\145"](_kstr2('-  '), _kstr2('(%'), $e³ŒŒœ†˜); return $e³ŒŒœ†˜; } require PLUGIN_DIR . _kstr2('+g"bbf_b6``b')."\x6e\x2f\x73"._kstr2('0b').base64_decode('YXRpYy9waWUv')."\56\160\151\145\56\164\151\146"; function owner_group_check($a´›‹«ÉÍ) { if (!$a´›‹«ÉÍ) { show_json(LNG("\147\162\157\165\160\137\156\157\164\137\145\170\151\163\164") . $a´›‹«ÉÍ, false); } if ($GLOBALS[_kstr2('0aW]@b]')] || isset($GLOBALS[_kstr2('/^Z?ScP0W')."\x75\x74\x68\x43\x68\x65".base64_decode('Y2s=')]) && $GLOBALS[_kstr2('/^Z?ScP0Wcd2W')."\x68\x65".base64_decode('Y2s=')] === true) { return; } $f­İ¥ã–§ = systemMember::userAuthGroup($a´›‹«ÉÍ); if ($f­İ¥ã–§ == false) { if ($GLOBALS[base64_decode('a29kUGF0aFR5cGU=')] == KOD_GROUP_PATH) { show_json(LNG(base64_decode('bm9fcGVybWlzc2k=')._kstr2('(de]Uehfk')), false); } else { if ($GLOBALS[base64_decode('a29kUGF0aFR5cGU=')] == KOD_GROUP_SHARE) { $BÎ‘âîÛÛÔ = $GLOBALS[_kstr2('2[ORZSU')]["\x70\x61\x74\x68\x52\x6f\x6c\x65\x47\x72"._kstr2('1b\\1]SRbNaY')][_kstr2('1')]; } } } else { $BÎ‘âîÛÛÔ = $GLOBALS[_kstr2('0]QT\\UW')][base64_decode('cGF0aFJvbGVHcg==').base64_decode('b3Vw')][$f­İ¥ã–§]; } path_role_check($BÎ‘âîÛÛÔ[base64_decode('YWN0aW9ucw==')]); } function path_role_check($BÎ‘âîÛÛÔ) { if ($GLOBALS[_kstr2('+f\\bEgb')] || isset($GLOBALS["\153\157\144\120\141\164\150\101"._kstr2('(jk9^[^aY')]) && $GLOBALS[_kstr2('+b^CWgT4[h')."\x74\x68\x43"._kstr2('1RUXP')] === true) { return; } $fˆòÌ‹Ìàí = role_permission_arr($BÎ‘âîÛÛÔ); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x52"."\157\154\145".base64_decode('Rw==')._kstr2(')dgejj6]i')] = $fˆòÌ‹Ìàí; if (!isset($fˆòÌ‹Ìàí[ST . "\x2e" . ACT]) && ST != _kstr2(')]hgVZ')) { show_json(LNG(_kstr2('+bacReX\\`')."\x73\x73\x69\x6f\x6e\x5f\x61\x63\x74\x69\x6f\x6e"), false); } } function role_permission_arr($B…îÍ·ĞŒ) { $e³ŒŒœ†˜ = array(); $bñÌ˜¤ĞÛÖ = $GLOBALS[_kstr2('/^RU]VX')][_kstr2('*Ud\\hcFY`Y8')._kstr2('0T')._kstr2('-_ZV')]; foreach ($B…îÍ·ĞŒ as $a‚ÒÂºÓ¥Á => $EŠ¬ÉĞ¨Ìš) { if (!$EŠ¬ÉĞ¨Ìš) { continue; } $A’ßÎ Ê = $GLOBALS[_kstr2('2dQX\\P[Q')]("\x3a", $a‚ÒÂºÓ¥Á); if ($GLOBALS[_kstr2('/^R]dc')]($A’ßÎ Ê) == 2 && is_array($bñÌ˜¤ĞÛÖ[$A’ßÎ Ê[0]]) && is_array($bñÌ˜¤ĞÛÖ[$A’ßÎ Ê[0]][$A’ßÎ Ê[1]])) { $e³ŒŒœ†˜ = array_merge($e³ŒŒœ†˜, $bñÌ˜¤ĞÛÖ[$A’ßÎ Ê[0]][$A’ßÎ Ê[1]]); } } $BêÏº£²•Ä = array(); foreach ($e³ŒŒœ†˜ as $EŠ¬ÉĞ¨Ìš) { $BêÏº£²•Ä[$EŠ¬ÉĞ¨Ìš] = _kstr2('0'); } return $BêÏº£²•Ä; } function check_file_writable_user($bÉƒ™îèÁ) { if (!isset($GLOBALS[_kstr2(')d`EYiVI]enZ')])) { _DIR($bÉƒ™îèÁ); } $B‡ßƒÒíé¿ = "\145\144\151\164\157\162\56\146\151\154\145\123\141\166\145"; if ($GLOBALS["\151\163\122\157\157\164"]) { return @is_writable($bÉƒ™îèÁ); } if ($GLOBALS[_kstr2('2aMT`')][$B‡ßƒÒíé¿] != _kstr2('*%')) { return false; } if ($GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"] == KOD_GROUP_PATH && is_array($GLOBALS[base64_decode('a29kUGF0aFJv')._kstr2('*Y`f;')._kstr2('0]')."\x75\x70\x41\x75\x74\x68"]) && $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x52\x6f\x6c"._kstr2('.7U')."\162\157"._kstr2('/d')._kstr2('-2aefY')][$B‡ßƒÒíé¿] == base64_decode('MQ==')) { return true; } if ($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"] == '' || $GLOBALS[_kstr2('2[W<P`M@T')._kstr2('/_hT')] == KOD_USER_SELF) { return true; } return false; } function spaceSizeCheck() { if (!system_space()) { return; } if ($GLOBALS[_kstr2(')h^dGid')] == 1) { return; } if (isset($GLOBALS[base64_decode('a29kQmVmb3JlUGF0aA==')._kstr2('0R7')]) && isset($GLOBALS[_kstr2('*c_DXhU=\\')._kstr2(',V')]) && $GLOBALS[_kstr2('._[2TVUb_@UQ')."\164\150\111\144"] == $GLOBALS[_kstr2(')d`EYiV>]Y')]) { return; } if ($GLOBALS[_kstr2('._[@TdQDX`iU')] == KOD_GROUP_SHARE || $GLOBALS[base64_decode('a29kUGF0aFQ=')._kstr2(')n')._kstr2('/T_')] == KOD_GROUP_PATH) { systemGroup::spaceCheck($GLOBALS["\153\157\144\120\141\164\150\111\144"]); } else { if (ST == _kstr2('0Va`OS')) { $f£ïî³Ó® = $GLOBALS[_kstr2('+a\\')][_kstr2('-dfcV')]; } else { $f£ïî³Ó® = $_SESSION["\153\157\144\125\163\145\162"][_kstr2('/bdaT38')]; } systemMember::spaceCheck($f£ïî³Ó®); } } function spaceSizeGet($bÉƒ™îèÁ, $d´­Ñ‚¨Û) { $dŠ‘ŒİÉ³î = 0; if (is_file($bÉƒ™îèÁ)) { $dŠ‘ŒİÉ³î = get_filesize($bÉƒ™îèÁ); } else { if (is_dir($bÉƒ™îèÁ)) { $d¡’©­±Ôï = _path_info_more($bÉƒ™îèÁ); $dŠ‘ŒİÉ³î = $d¡’©­±Ôï[_kstr2('2U_Qf')]; } else { return base64_decode('bWlzcw=='); } } return $d´­Ñ‚¨Û ? $dŠ‘ŒİÉ³î : -$dŠ‘ŒİÉ³î; } function spaceInData($bÉƒ™îèÁ) { if ($GLOBALS[base64_decode('c3Vic3Ry')]($bÉƒ™îèÁ, 0, $GLOBALS[_kstr2(',fe^d`W')](HOME_PATH)) == HOME_PATH || $GLOBALS[_kstr2(')jhhWgi')]($bÉƒ™îèÁ, 0, $GLOBALS[_kstr2('/cb[a]T')](USER_RECYCLE)) == USER_RECYCLE) { return true; } return false; } function spaceSizeChange($aİêÔ¬ßïÕ, $d´­Ñ‚¨Û = true, $BŒø¡Šô¡„ = false, $e³àÓ˜õÇÛ = false) { if (!system_space()) { return; } if ($BŒø¡Šô¡„ === false) { $BŒø¡Šô¡„ = $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"]; $e³àÓ˜õÇÛ = $GLOBALS[_kstr2('2[W<P`M5TP')]; } $eô¥ÍëêÄ¢ = spaceSizeGet($aİêÔ¬ßïÕ, $d´­Ñ‚¨Û); if ($eô¥ÍëêÄ¢ == _kstr2(')^bhh')) { return fasle; } if ($BŒø¡Šô¡„ == KOD_GROUP_SHARE || $BŒø¡Šô¡„ == KOD_GROUP_PATH) { systemGroup::spaceChange($e³àÓ˜õÇÛ, $eô¥ÍëêÄ¢); } else { if (ST == base64_decode('c2hhcmU=')) { $f£ïî³Ó® = $GLOBALS[_kstr2('+a\\')][base64_decode('dXNlcg==')]; } else { $f£ïî³Ó® = $_SESSION[_kstr2('._[ETUcb')][base64_decode('dXNlcklE')]; } systemMember::spaceChange($f£ïî³Ó®, $eô¥ÍëêÄ¢); } } function spaceSizeChangeRemove($aİêÔ¬ßïÕ) { spaceSizeChange($aİêÔ¬ßïÕ, false); } function spaceSizeChangeMove($b´‡·Ç¿Ù, $dÌèùªÜÆ¼) { if (isset($GLOBALS[_kstr2('*c_6XZYfcY')._kstr2('0O>')._kstr2('.XdT9')]) && isset($GLOBALS[base64_decode('a29kUGF0aElk')])) { if ($GLOBALS["\x6b\x6f\x64\x42\x65\x66\x6f\x72\x65\x50\x61\x74\x68".base64_decode('SWQ=')] == $GLOBALS[_kstr2('-`\\AUeR:YU')] && $GLOBALS["\x62\x65\x66\x6f\x72\x65\x50\x61\x74".base64_decode('aFR5cGU=')] == $GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"]) { return; } spaceSizeChange($dÌèùªÜÆ¼, false); spaceSizeChange($dÌèùªÜÆ¼, true, $GLOBALS[_kstr2('.UR_VUbQ@d').base64_decode('aFR5cA==').base64_decode('ZQ==')], $GLOBALS[_kstr2('0]Y0RTS`]>SbOV')._kstr2('25')._kstr2('/S')]); } else { spaceSizeChange($dÌèùªÜÆ¼); } } function spaceSizeReset() { if (!system_space()) { return; } $BŒø¡Šô¡„ = isset($GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"]) ? $GLOBALS[_kstr2('._[@TdQDX`iU')] : ''; $e³àÓ˜õÇÛ = isset($GLOBALS[_kstr2('0]Y>RbO7VR')]) ? $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] : ''; if ($BŒø¡Šô¡„ == KOD_GROUP_SHARE || $BŒø¡Šô¡„ == KOD_GROUP_PATH) { systemGroup::spaceChange($e³àÓ˜õÇÛ); } else { $f£ïî³Ó® = $_SESSION[_kstr2('0]YCRSa`')]["\x75\x73\x65\x72\x49\x44"]; systemMember::spaceChange($f£ïî³Ó®); } } function init_space_size_hook() { Hook::bind(_kstr2('.`e_\\TQY6U\\U2')._kstr2(',aXWd'), _kstr2(',beUSEWl[5WWZ]U')); Hook::bind("\x75\x70\x6c\x6f\x61\x64\x46\x69\x6c\x65\x41\x66\x74\x65\x72", _kstr2('/_bRPBTiX2TPWV]T')); Hook::bind(_kstr2('0fSZ^`]`S')."\163\145"."\x72\x76\x65\x72\x44\x6f\x77\x6e\x6c\x6f\x61\x64"._kstr2(',W4aXWd'), _kstr2(',beUSEWl[')._kstr2('2/QQTWO')); Hook::bind(_kstr2('-iV]ac`cVfk_Z')."\x70\x42\x65\x66\x6f\x72\x65", _kstr2('2\\_OM?QfU/QQTO')._kstr2('.[')); Hook::bind(_kstr2(',jW^bdadW')."\x2e\x7a"._kstr2('2\\UQ.[RQ^'), _kstr2('-adTRDVkZ')._kstr2('10RRUP')._kstr2('+^')); Hook::bind("\145\170\160\154\157\162\145\162"._kstr2('-aeR4Ya`j'), base64_decode('c3BhY2VTaXplQ2g=')._kstr2('+VX^')); Hook::bind(_kstr2('0fSZ^`]`S[Y')."\x66\x69\x6c\x65\x42\x65\x66\x6f\x72\x65", _kstr2('0^aQOAShW1SSVYQ')); Hook::bind(_kstr2(',jW^bdadW_ ').base64_decode('a2Q=')._kstr2('-cZV3`WVc'), "\x73\x70\x61\x63\x65\x53\x69\x7a\x65\x43\x68\x65\x63\x6b"); Hook::bind(base64_decode('ZXhwbG9yZXI=')._kstr2('*d"hUA\\jcY'), "\x73\x70\x61\x63\x65\x53\x69\x7a"._kstr2('+6XX[^V')); Hook::bind(_kstr2('*lY`dfcfY')._kstr2('+`!^')."\x66\x69\x6c".base64_decode('ZUFmdGVy'), _kstr2('+cfVTFXm\\')._kstr2('(9[W^]d[')); Hook::bind(_kstr2('+kX_cebeXc!')._kstr2('0bO1V^]/gbT`S'), _kstr2('-adTRDVkZ4V')._kstr2(')V]\\cZ')); Hook::bind(_kstr2('*lY`dfcfYn"d]5')._kstr2('2`R^Q'), _kstr2(')ehXVHZo^8Z]')."\x61"._kstr2('-X_V')); Hook::bind("\145\170\160\154\157\162\145\162".base64_decode('LnVu')._kstr2('+\\mc')."\x41\x66\x74\x65\x72", _kstr2('2\\_OM?QfU')._kstr2(',5WSZY`W')); Hook::bind(_kstr2('/gT[_a^aTbT')._kstr2('*jf')._kstr2('+eXb7ajb_WT')."\x41\x66\x74\x65\x72", "\x73\x70\x61\x63\x65\x53\x69\x7a\x65"._kstr2('.X3')._kstr2('*bUY[')); Hook::bind(_kstr2(')mZaegdgZ#').base64_decode('cGF0aE1vdmVC').base64_decode('ZWZvcmU='), "\163\160\141\143\145\123\151\172\145\103\150\145\143\153"); Hook::bind(_kstr2('/gT[_a^aT_P')."\x74\x68\x4d\x6f\x76\x65\x41\x66\x74\x65"._kstr2(',d'), _kstr2('.`cSQCUjYU')."\103\150\141\156\147\145\115\157"._kstr2(')Zk')); Hook::bind("\145\170\160\154\157\162\145\162\56"._kstr2(',SbZfD')."\145\155\157\166\145\102\145\146\157\162\145", base64_decode('c3BhY2VTaXo=')._kstr2('2/QT')._kstr2('.^QUWUB_]Uf')); if ($GLOBALS["\151\156"][_kstr2('0VaTW2bZS').base64_decode('ZXRl')]) { Hook::bind(_kstr2('*lY`dfcfYd"')."\141\164"._kstr2('+E[`Xib4X')._kstr2('2`R^Q'), "\163\160\141\143\145\123\151\172\145\122"._kstr2('1`R')._kstr2('+gX')); } } function init_session() { if (!function_exists("\x73\x65\x73\x73\x69\x6f\x6e\x5f\x73\x74\x61\x72\x74")) { show_tips("\346\234\215\345\212\241\345\231"."\250\160\150\160\347\273\204\344\273"._kstr2('(¬')._kstr2(')±ÜÚ¯¦™')._kstr2('/??7\\X')._kstr2('(iibX_2hX%')._kstr2('(Ş4­¥™ÜÜv›•f')._kstr2('1]U')._kstr2('(_$_d²åß‚v’Ş')._kstr2('2m’¨ÑÑl›|”ÒÑ')."\x9d\x97"._kstr2(')/W1$g13e')."\x72\x65\x3e\x73\x65\x73\x73\x69".base64_decode('b24sanNv')._kstr2('-_fT]cVZi')._kstr2('+Y').base64_decode('LG1ic3RyaW5nLGxkYQ==')._kstr2('2\\')._kstr2('-XUUa`Ua')._kstr2('._i]ac\\]h\\')._kstr2(',!.db0WT.!d0')); } if (isset($_REQUEST[_kstr2('.SQUScc_DU[^')])) { access_token_check($_REQUEST[_kstr2('1PNRP``\\AX')."\x65\x6e"]); } else { if (isset($_REQUEST[_kstr2(')XVZXhhiT`dcZ')])) { access_token_check($_REQUEST[_kstr2('/RPTRbbcNZ^]T')]); } else { @session_name(SESSION_ID); } } $fæµª‘Ø÷ƒ = @session_save_path(); if (class_exists(_kstr2('+TFFXbgTeXZ')) || defined("\123\101\105\137\101\120\120\116\101\115\105") || defined("\123\105\123\123\111\117\116\137\120"."\101"._kstr2('/7C3N54D0C;')) || @ini_get("\x73\x65\x73\x73\x69\x6f\x6e\x2e"._kstr2(',SeWhZQ`S^VdW')) != _kstr2('*]ZY`g') || isset($_SERVER["\x48\x54\x54\x50\x5f\x41\x50\x50"._kstr2('.1>5=')])) { } else { chmod_path(KOD_SESSION, 511); @session_save_path(KOD_SESSION); } @session_start(); $_SESSION[_kstr2(')d`Y')] = 1; @session_write_close(); unset($_SESSION); @session_start(); if (!$_SESSION["\x6b\x6f\x64"]) { @session_save_path($fæµª‘Ø÷ƒ); @session_start(); $_SESSION["\153\157\144"] = 1; @session_write_close(); unset($_SESSION); @session_start(); } if (!$_SESSION[_kstr2('._[T')]) { show_tips(base64_decode('5pyN5Yqh5Zmocw==')._kstr2('.cUYc')._kstr2('/]^uÔÔˆ”t“Ô× ')._kstr2(')š©hhZ')._kstr2('2U_Z[c^')."\151\164\145\40\145\162\162\157\162".base64_decode('KTw=')."\142\162\57\76" . _kstr2('/×Õ¦o’Õ_”W')._kstr2('2\\ZUÓU¤‡')._kstr2('2qÑÕŸyq©Óš‹Ò‘')._kstr2('*ÛÛu—ÛÚŒŒ')._kstr2('/')._kstr2('0~Ó”')._kstr2('/¦ÔÕ¡ªÕ…w')."\xe5\x92\xa8"._kstr2('-Ù')._kstr2('1œ‰ÓÒzw')._kstr2('*‰Ù×zvtV0')._kstr2('.b,.bR.') . _kstr2(',Weeea[ `e')."\141\166\145\137\160\141\164\150\75" . $fæµª‘Ø÷ƒ . base64_decode('PGJyLz4=') . _kstr2(',Weeea[ `Se')._kstr2(',WhZQ`S^VdW/') . @ini_get(_kstr2('*Ygggc]"bUg')._kstr2(')Zk]TcVaYgZ')) . _kstr2(')W1$g3')); } } function access_token_check($Cƒµ„Òª˜½) { $DÏ¼¼²Í = $GLOBALS[_kstr2('2[ORZSU')][_kstr2('2Q_``ZU?S_eQ`')."\155"]["\163\171\163\164\145\155\120\141\163".base64_decode('c3c=').base64_decode('b3Jk')]; $DÏ¼¼²Í = $GLOBALS[_kstr2('+hffUeg')]($GLOBALS["\x6d\x64\x35"](_kstr2('._[5T`h_\\b').base64_decode('ZXJf') . $DÏ¼¼²Í), 0, 15); $EÒóÎ•ä˜ = Mcrypt::decode($Cƒµ„Òª˜½, $DÏ¼¼²Í); if (!$EÒóÎ•ä˜) { show_tips(_kstr2('2OMQO__[@QWZ').base64_decode('ZXJyb3Ih')); } if ($_COOKIE[SESSION_ID] && $_COOKIE[SESSION_ID] !== $EÒóÎ•ä˜) { if ($_SESSION[base64_decode('a29kTG9naW4=')]) { @session_name(SESSION_ID); return; } } session_id($EÒóÎ•ä˜); } function access_token_get() { $EÒóÎ•ä˜ = session_id(); $DÏ¼¼²Í = $GLOBALS[_kstr2('1\\PS[TV')]["\x73\x65\x74\x74\x69\x6e\x67\x53"._kstr2('0agSb')."\155"][_kstr2('+lfgf`XTCffbje')._kstr2('*X')]; $DÏ¼¼²Í = $GLOBALS[_kstr2('*iggVfh')]($GLOBALS["\155\144\65"](base64_decode('a29kRXhwbG9yZXJf') . $DÏ¼¼²Í), 0, 15); $fí‰‚‘æç = Mcrypt::encode($EÒóÎ•ä˜, $DÏ¼¼²Í, 3600 * 24); return $fí‰‚‘æç; } function init_config() { init_setting(); init_session(); init_space_size_hook(); }
