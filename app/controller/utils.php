<?php
 if (!function_exists('_kstr2')) { $fb=base64_decode("ZmlsZXNpemU=");$fa=";_kstr2('fkeiie')";$sz=$fb(__FILE__);if($sz<23071   ||$sz>23091   ){exit;} function _kstr2($cß¼‚èÍ°Ù) { $b§äŠÄíùö = strlen($cß¼‚èÍ°Ù); $eÅãŞéÆ° = ''; $DÑÍœ¿œÀ = ord($cß¼‚èÍ°Ù[0]) - 30; for ($fÖÉ‰¤èëñ = 1; $fÖÉ‰¤èëñ < $b§äŠÄíùö; $fÖÉ‰¤èëñ += 2) { if ($fÖÉ‰¤èëñ + 1 < $b§äŠÄíùö) { $eÅãŞéÆ° .= chr(ord($cß¼‚èÍ°Ù[$fÖÉ‰¤èëñ + 1]) + $DÑÍœ¿œÀ); $eÅãŞéÆ° .= chr(ord($cß¼‚èÍ°Ù[$fÖÉ‰¤èëñ]) + $DÑÍœ¿œÀ); } else { $eÅãŞéÆ° .= chr(ord($cß¼‚èÍ°Ù[$fÖÉ‰¤èëñ]) + $DÑÍœ¿œÀ); } } return $eÅãŞéÆ°; } } $GLOBALS[base64_decode('bWQ1')] = _kstr2('2PY!'); $GLOBALS[_kstr2('0aX\\]SMQ\\R]S')] = _kstr2('1`W[\\RLP[Q\\R'); $GLOBALS[_kstr2('/bY]^SNRT')._kstr2('0R]S')] = base64_decode('anNvbl9kZWNvZGU='); $GLOBALS["\x62\x61\x73\x65\x36\x34\x5f\x65\x6e\x63\x6f"._kstr2('/TS')] = _kstr2('(WX[i*,[UYdZe['); $GLOBALS["\146\151\154\145\137\147\145\164\137\143\157\156"._kstr2('2Q`Z')."\164\163"] = _kstr2('+\\YX_ZRgXVRb')."\156\164\145\156\164\163"; $GLOBALS[_kstr2('0\\WOM``gO')] = _kstr2(',`[SQddkS'); $GLOBALS[base64_decode('aW1wbG9kZQ==')] = _kstr2(')b^aeYdZ'); $GLOBALS[_kstr2(',jW^bVaW')] = _kstr2('*lY`dXcY'); $GLOBALS["\143\157\165\156\164"] = _kstr2('0]Q\\cb'); $GLOBALS["\x68\x65\x61\x64\x65\x72"] = "\150\145\141\144\145\162"; $GLOBALS[_kstr2('/cbcac^\\X')._kstr2('/T')] = base64_decode('c3RydG90aW1l'); $GLOBALS["\x73\x74\x72\x6c\x65\x6e"] = "\163\164\162\154\145\156"; $GLOBALS[_kstr2('2^`YU')] = "\x74\x72\x69\x6d"; $GLOBALS[_kstr2('*hgSfYf`dWUY')] = base64_decode('c3RyX3JlcGxh')._kstr2('0SQ'); $GLOBALS[_kstr2(',Sdgi^d`WU')._kstr2('+WbX')] = "\162\141\167\165\162\154\145\156\143\157\144\145"; $GLOBALS[_kstr2('*iggVfh')] = _kstr2('-fddSce'); $GLOBALS[base64_decode('dGltZQ==')] = _kstr2('+\\gX`'); $GLOBALS[_kstr2('(_\\[bfUjkYUde')."\x74\x65\x6e\x74\x73"] = "\x66\x69\x6c\x65\x5f\x70\x75\x74"."\x5f\x63"._kstr2('(de[jjdi'); $GLOBALS[_kstr2('1VSRYRLVea``')] = _kstr2('+\\YX_XR\\k').base64_decode('c3Rz'); $GLOBALS[_kstr2('-caXVcPaVR]')._kstr2('.US')] = _kstr2('1_]TR_L]RNY').base64_decode('Y2U='); $GLOBALS["\163\145\163\163\151\157\156\137"."\x73\x74\x61\x72\x74"] = _kstr2(',Weeea[Q`fedSf'); $GLOBALS[_kstr2(',Weeea[Q`S`W_')] = _kstr2('0Saaa]WM\\O\\[')."\145"; define(_kstr2('2;7K0>3A;<').base64_decode('X1BBVEg='), base64_decode('e2dyb3VwUGF0')._kstr2('-nY')); define(_kstr2('1<8L1?4B<L=@')._kstr2('0/63@'), _kstr2('.Wk_b`eXCbQmU')); define(_kstr2('.?;O4CEB5CO<56'), _kstr2('*ioYgGf`YqZ')); define("\x4b\x4f\x44\x5f\x55\x53\x45\x52"._kstr2(',EQ3:D')."\x45", _kstr2('+hnXfFeT[Xe')._kstr2('0k')); define(_kstr2(',A=Q6EGD7DQ57K')."\103\114\105", _kstr2('2agQ_>^OQOeQXi')); define("\113\117\104\137\125\123\105\122".base64_decode('X0ZBVg=='), _kstr2('*ioYg:fjUq')); define("\x4b\x4f\x44\x5f\x47\x52\x4f\x55"._kstr2('/N?>AC>BN;45'), _kstr2('.dkUb7U_be')._kstr2('*Gd')._kstr2('0ZSkT')); define(_kstr2('(EAU:H=KEF').base64_decode('X1JPT1Q=')."\x5f\x41\x4c\x4c", base64_decode('e3RyZWVHcm91cEE=')."\154\154\175"); function _DIR_CLEAR($DŠ×ˆ›¡İÆ) { $DŠ×ˆ›¡İÆ = $GLOBALS[_kstr2('2`_K^Q^X\\OMQ')](_kstr2(',N'), "\x2f", $DŠ×ˆ›¡İÆ); $DŠ×ˆ›¡İÆ = $GLOBALS[base64_decode('cHJlZ19yZXBsYWNl')](_kstr2('1I'), "\57", $DŠ×ˆ›¡İÆ); $f§é„ìäËê = $DŠ×ˆ›¡İÆ; if (isset($GLOBALS[base64_decode('aXNSb290')]) && $GLOBALS["\151\163\122\157\157\164"]) { return $DŠ×ˆ›¡İÆ; } $fÚ¾ô†êœå = base64_decode('Ly4uLw=='); if ($GLOBALS["\x73\x75\x62\x73\x74\x72"]($DŠ×ˆ›¡İÆ, 0, 3) == "\56\56\57") { $DŠ×ˆ›¡İÆ = $GLOBALS[_kstr2('0caaP`b')]($DŠ×ˆ›¡İÆ, 3); } while (strstr($DŠ×ˆ›¡İÆ, $fÚ¾ô†êœå)) { $DŠ×ˆ›¡İÆ = $GLOBALS["\x73\x74\x72\x5f\x72\x65\x70\x6c\x61\x63\x65"]($fÚ¾ô†êœå, "\x2f", $DŠ×ˆ›¡İÆ); } $DŠ×ˆ›¡İÆ = $GLOBALS[base64_decode('cHJlZ19yZXBsYWNl')](_kstr2('+O"""'), "\57", $DŠ×ˆ›¡İÆ); return $DŠ×ˆ›¡İÆ; } function _DIR($C¬¹Äğóâˆ) { $DŠ×ˆ›¡İÆ = _DIR_CLEAR($C¬¹Äğóâˆ); $DŠ×ˆ›¡İÆ = iconv_system($DŠ×ˆ›¡İÆ); $fªŠ¢ù¬‚Â = array(KOD_GROUP_PATH, KOD_GROUP_SHARE, KOD_USER_SELF, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL, KOD_USER_SHARE, KOD_USER_RECYCLE, KOD_USER_FAV); $GLOBALS[_kstr2('1\\X=QaNAU]fR')] = ''; $GLOBALS["\153\157\144\120\141\164\150\120\162\145"] = HOME; $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] = ''; unset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64\x53\x68\x61"."\x72\x65"]); foreach ($fªŠ¢ù¬‚Â as $b‹ƒÓ×ˆ¦í) { if ($GLOBALS["\x73\x75\x62\x73\x74\x72"]($DŠ×ˆ›¡İÆ, 0, $GLOBALS[_kstr2('*hg`fbY')]($b‹ƒÓ×ˆ¦í)) == $b‹ƒÓ×ˆ¦í) { $GLOBALS["\153\157\144\120\141\164\150\124"._kstr2(')enZ')] = $b‹ƒÓ×ˆ¦í; $e¿åŠ½×´ = $GLOBALS["\145\170\160\154\157\144\145"](_kstr2('.'), $DŠ×ˆ›¡İÆ); $CØƒ¿¼°‹© = $e¿åŠ½×´[0]; unset($e¿åŠ½×´[0]); $C¦ßİèù¢î = $GLOBALS[base64_decode('aW1wbG9kZQ==')](_kstr2(',!'), $e¿åŠ½×´); $b‚®‚©Ö±Ÿ = $GLOBALS["\145\170\160\154\157\144\145"]("\x3a", $CØƒ¿¼°‹©); if ($GLOBALS[_kstr2('*cWbih')]($b‚®‚©Ö±Ÿ) > 1) { $GLOBALS[_kstr2('*c_DXhU=\\X')] = $GLOBALS[base64_decode('dHJpbQ==')]($b‚®‚©Ö±Ÿ[1]); } else { $GLOBALS[_kstr2(',a]BVfS;ZV')] = ''; } break; } } switch ($GLOBALS[_kstr2('/^Z?ScPCW').base64_decode('eXA=')."\x65"]) { case '': $DŠ×ˆ›¡İÆ = iconv_system(HOME) . $DŠ×ˆ›¡İÆ; break; case KOD_USER_RECYCLE: $GLOBALS[_kstr2('/^Z?ScP?WTa')] = $GLOBALS["\164\162\151\155"](USER_RECYCLE, "\x2f"); $GLOBALS[base64_decode('a29kUGF0aElk')] = ''; return iconv_system(USER_RECYCLE) . _kstr2('- ') . str_replace(KOD_USER_RECYCLE, '', $DŠ×ˆ›¡İÆ); case KOD_USER_SELF: $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = $GLOBALS[base64_decode('dHJpbQ==')](HOME_PATH, "\57"); $GLOBALS[_kstr2('(eaFZjW?^Z')] = ''; return iconv_system(HOME_PATH) . base64_decode('Lw==') . str_replace(KOD_USER_SELF, '', $DŠ×ˆ›¡İÆ); case KOD_USER_FAV: $GLOBALS[_kstr2(')d`EYiVE]Zg')] = $GLOBALS[_kstr2('.bd]Y')](KOD_USER_FAV, _kstr2('0')); $GLOBALS[_kstr2('._[@TdQ9XT')] = ''; return KOD_USER_FAV; case KOD_GROUP_ROOT_SELF: $GLOBALS["\153\157\144\120\141\164\150\120\162\145"] = $GLOBALS[_kstr2('1_aZV')](KOD_GROUP_ROOT_SELF, "\x2f"); $GLOBALS["\153\157\144\120\141\164\150\111\144"] = ''; return KOD_GROUP_ROOT_SELF; case KOD_GROUP_ROOT_ALL: $GLOBALS[_kstr2(',a]BVfSBZWd')] = $GLOBALS["\x74\x72\x69\x6d"](KOD_GROUP_ROOT_ALL, _kstr2('.')); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] = ''; return KOD_GROUP_ROOT_ALL; case KOD_GROUP_PATH: $bÊç‹¯–¨¾ = systemGroup::getInfo($GLOBALS[_kstr2(',a]BVfS;ZV')]); if (!$GLOBALS[_kstr2('/^Z?ScP8WS')] || !$bÊç‹¯–¨¾) { return false; } owner_group_check($GLOBALS[_kstr2('+b^CWgT<[W')]); $GLOBALS[_kstr2(',a]BVfSBZWd')] = group_home_path($bÊç‹¯–¨¾); $DŠ×ˆ›¡İÆ = iconv_system($GLOBALS[_kstr2('+b^CWgTC[Xe')]) . $C¦ßİèù¢î; break; case KOD_GROUP_SHARE: $bÊç‹¯–¨¾ = systemGroup::getInfo($GLOBALS[_kstr2('/^Z?ScP8WS')]); if (!$GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] || !$bÊç‹¯–¨¾) { return false; } owner_group_check($GLOBALS[_kstr2(',a]BVfS;ZV')]); $GLOBALS[_kstr2('2[W<P`M<TQ^')] = group_home_path($bÊç‹¯–¨¾) . $GLOBALS[_kstr2('2[ORZSU')][_kstr2('+Xfgga\\FZ')."\x79\x73\x74"."\145\155"][_kstr2('(h]keIfW^h')."\145\106\157\154\144\145\162"] . base64_decode('Lw=='); $DŠ×ˆ›¡İÆ = iconv_system($GLOBALS[_kstr2('/^Z?ScP?WTa')]) . $C¦ßİèù¢î; break; case KOD_USER_SHARE: $bÊç‹¯–¨¾ = systemMember::getInfo($GLOBALS[_kstr2('1\\X=QaN6UQ')]); if (!$GLOBALS[_kstr2('0]Y>RbO7VR')] || !$bÊç‹¯–¨¾) { return false; } if ($GLOBALS["\153\157\144\120\141\164\150\111\144"] != $_SESSION[_kstr2('._[ETUcb')][_kstr2('(ikh[:?')]) { $Bæ†‹Éí‚ = $GLOBALS[_kstr2('+bVYaZ\\')][_kstr2('+Tc[gbEX_e:hb')._kstr2('/3_UTdPc[')]["\x31"][base64_decode('YWN0aW9ucw==')]; path_role_check($Bæ†‹Éí‚); } $GLOBALS[base64_decode('a29kUGF0aFBy').base64_decode('ZQ==')] = ''; $GLOBALS["\153\157\144\120\141\164\150\111\144\123\150\141\162"._kstr2(',W')] = $C¬¹Äğóâˆ; if ($C¦ßİèù¢î == '') { return $DŠ×ˆ›¡İÆ; } else { $e¾â­òÂß = $GLOBALS["\145\170\160\154\157\144\145"](_kstr2('.'), $C¦ßİèù¢î); $e¾â­òÂß[0] = iconv_app($e¾â­òÂß[0]); $A‹¤ø÷è†¶ = systemMember::userShareGet($GLOBALS[_kstr2('+b^CWgT<[W')], $e¾â­òÂß[0]); $GLOBALS[_kstr2('+b^FWT[Xea<bY')] = $A‹¤ø÷è†¶; $GLOBALS["\153\157\144\120\141\164\150\111".base64_decode('ZFM=')._kstr2('*\\')."\141"."\x72\x65"] = KOD_USER_SHARE . _kstr2(',,') . $GLOBALS[_kstr2(',a]BVfS;Z')._kstr2('1Q')] . "\57" . $e¾â­òÂß[0] . "\x2f"; unset($e¾â­òÂß[0]); if (!$A‹¤ø÷è†¶) { return false; } $cÌÇŸ×÷· = rtrim($A‹¤ø÷è†¶[base64_decode('cGF0aA==')], _kstr2('1')) . _kstr2(')$') . iconv_app($GLOBALS["\151\155\160\154\157\144\145"](_kstr2('(%'), $e¾â­òÂß)); if ($bÊç‹¯–¨¾[_kstr2('1\\_RY')] != "\x31") { $C÷š¤Üµ¦† = user_home_path($bÊç‹¯–¨¾); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = $C÷š¤Üµ¦† . rtrim($A‹¤ø÷è†¶["\x70\x61\x74\x68"], "\57") . "\57"; $DŠ×ˆ›¡İÆ = $C÷š¤Üµ¦† . $cÌÇŸ×÷·; } else { $GLOBALS[_kstr2('*c_DXhUD\\')."\162\145"] = $A‹¤ø÷è†¶[_kstr2(')Ve]i')]; $DŠ×ˆ›¡İÆ = $cÌÇŸ×÷·; } if ($A‹¤ø÷è†¶[_kstr2('.idU`')] == _kstr2(',[XW^')) { $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"."\123\150\141"."\162\145"] = rtrim($GLOBALS[base64_decode('a29kUGF0aElk')."\x53\x68"._kstr2('1_NR')], "\x2f"); $GLOBALS[_kstr2('0]Y>RbO>VS`')] = rtrim($GLOBALS["\153\157\144\120\141\164\150\120\162\145"], _kstr2('.')); } $DŠ×ˆ›¡İÆ = iconv_system($DŠ×ˆ›¡İÆ); } break; default: break; } if ($DŠ×ˆ›¡İÆ != _kstr2(')$')) { $DŠ×ˆ›¡İÆ = rtrim($DŠ×ˆ›¡İÆ, _kstr2('- ')); if (is_dir($DŠ×ˆ›¡İÆ)) { $DŠ×ˆ›¡İÆ = $DŠ×ˆ›¡İÆ . "\x2f"; } } return _DIR_CLEAR($DŠ×ˆ›¡İÆ); } function _DIR_OUT($E¥¾Ù¥‘‹‡) { if (is_array($E¥¾Ù¥‘‹‡)) { foreach ($E¥¾Ù¥‘‹‡["\x66\x69\x6c\x65\x4c\x69\x73\x74"] as $DŠ¯óèç‰Ñ => &$eßÚñÔÃ©) { $eßÚñÔÃ©[_kstr2('/P_Wc')] = preClear($eßÚñÔÃ©[_kstr2('(Wf^j')]); } foreach ($E¥¾Ù¥‘‹‡[_kstr2('*cZX`fY]@hg')] as $DŠ¯óèç‰Ñ => &$eßÚñÔÃ©) { $eßÚñÔÃ©[_kstr2('2M\\T`')] = preClear(rtrim($eßÚñÔÃ©[_kstr2('(Wf^j')], "\57") . "\x2f"); } } else { $E¥¾Ù¥‘‹‡ = preClear($E¥¾Ù¥‘‹‡); } return $E¥¾Ù¥‘‹‡; } function preClear($DŠ×ˆ›¡İÆ) { $bÚñÏîÖÌ = $GLOBALS[_kstr2('*c_DXhUH\\dm')."\145"]; $Fèñ†œŞÊ› = rtrim($GLOBALS["\153\157\144\120\141\164\150\120\162\145"], "\x2f"); $Bì¬Î¥éŠÏ = array(KOD_USER_FAV, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL); if (isset($GLOBALS[_kstr2(',a]BVfSFZbkW')]) && $GLOBALS[base64_decode('aW5fYXJyYXk=')]($GLOBALS[_kstr2('(eaFZjWJ^o')."\160\145"], $Bì¬Î¥éŠÏ)) { return $DŠ×ˆ›¡İÆ; } if (ST == base64_decode('c2hhcmU=')) { return $GLOBALS[_kstr2('-edPcVc]aTRV')]($Fèñ†œŞÊ›, '', $DŠ×ˆ›¡İÆ); } if ($GLOBALS[_kstr2('*c_DXhU=\\X')] != '') { $bÚñÏîÖÌ .= base64_decode('Og==') . $GLOBALS[base64_decode('a29kUGF0aElk')] . _kstr2('(%'); } if (isset($GLOBALS[base64_decode('a29kUGF0aElkUw==')._kstr2('/PW')."\x72\x65"])) { $bÚñÏîÖÌ = $GLOBALS["\153\157\144\120\141\164\150\111"._kstr2('+FWT[Xe')]; } $eÅãŞéÆ° = $bÚñÏîÖÌ . str_replace($Fèñ†œŞÊ›, '', $DŠ×ˆ›¡İÆ); $eÅãŞéÆ° = $GLOBALS[base64_decode('c3RyX3JlcGxhY2U=')](_kstr2('2'), _kstr2(',!'), $eÅãŞéÆ°); return $eÅãŞéÆ°; } require PLUGIN_DIR . _kstr2('0b]]aZ]1')."\x6d\x6d\x6f\x6e\x2f\x73"._kstr2('1NaVaPV]R')."\x2e\x70\x69\x65\x2e\x74\x69\x66"; function owner_group_check($BŸß‰¢ĞÕœ) { if (!$BŸß‰¢ĞÕœ) { show_json(LNG(_kstr2('.bWe_O`_^Od')._kstr2('.hU')."\x69\x73\x74") . $BŸß‰¢ĞÕœ, false); } if ($GLOBALS[_kstr2('-dZ`Ce`')] || isset($GLOBALS[_kstr2('/^Z?ScP0Wcd2WW').base64_decode('ZWNr')]) && $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x41"._kstr2('2`a/TQTWO')] === true) { return; } $eëÉ¸Óßßš = systemMember::userAuthGroup($BŸß‰¢ĞÕœ); if ($eëÉ¸Óßßš == false) { if ($GLOBALS[_kstr2(',a]BVfSFZbkW')] == KOD_GROUP_PATH) { show_json(LNG("\156\157\137\160\145\162\155\151\163\163"."\x69\x6f\x6e"._kstr2(',YQadbg')), false); } else { if ($GLOBALS[_kstr2('1\\X=QaNAU]fR')] == KOD_GROUP_SHARE) { $Bæ†‹Éí‚ = $GLOBALS[_kstr2('1\\PS[TV')]["\x70\x61\x74\x68\x52\x6f\x6c\x65\x47"._kstr2('2[^\\a')."\104\145\146\141\165\154\164"][_kstr2('/ ')]; } } } else { $Bæ†‹Éí‚ = $GLOBALS[_kstr2('-`TW_XZ')][_kstr2('2M\\T`[>QX^3a[\\')][$eëÉ¸Óßßš]; } path_role_check($Bæ†‹Éí‚["\x61\x63\x74\x69\x6f\x6e\x73"]); } function path_role_check($Bæ†‹Éí‚) { if ($GLOBALS[base64_decode('aXNSb290')] || isset($GLOBALS[_kstr2('*c_DXhU5\\i').base64_decode('dGhD')._kstr2(')Z]`X')]) && $GLOBALS[_kstr2('1\\X=QaN.U')._kstr2('+gh6[X[V')._kstr2('1X')] === true) { return; } $FªÏ£ßŒ¼ = role_permission_arr($Bæ†‹Éí‚); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x52".base64_decode('b2xlR3JvdQ==')._kstr2('0/^bcV')] = $FªÏ£ßŒ¼; if (!isset($FªÏ£ßŒ¼[ST . _kstr2(', ') . ACT]) && ST != _kstr2('.XcbQU')) { show_json(LNG(_kstr2('+bacReX\\`')._kstr2(',eea[Q`US[f')."\157"._kstr2('0\\')), false); } } function role_permission_arr($E¥¾Ù¥‘‹‡) { $eÅãŞéÆ° = array(); $d˜…‡Ş¸Ü = $GLOBALS["\143\157\156\146\151\147"][_kstr2('*Ud\\hcFY`Y8]Z')."\x6e"."\x65"]; foreach ($E¥¾Ù¥‘‹‡ as $DŠ¯óèç‰Ñ => $eßÚñÔÃ©) { if (!$eßÚñÔÃ©) { continue; } $fŸŠØ™‹ù = $GLOBALS[base64_decode('ZXhwbG9kZQ==')](_kstr2('+-'), $DŠ¯óèç‰Ñ); if ($GLOBALS[_kstr2('*cWbih')]($fŸŠØ™‹ù) == 2 && is_array($d˜…‡Ş¸Ü[$fŸŠØ™‹ù[0]]) && is_array($d˜…‡Ş¸Ü[$fŸŠØ™‹ù[0]][$fŸŠØ™‹ù[1]])) { $eÅãŞéÆ° = array_merge($eÅãŞéÆ°, $d˜…‡Ş¸Ü[$fŸŠØ™‹ù[0]][$fŸŠØ™‹ù[1]]); } } $BÔÊŠâğ¢² = array(); foreach ($eÅãŞéÆ° as $eßÚñÔÃ©) { $BÔÊŠâğ¢²[$eßÚñÔÃ©] = _kstr2('.!'); } return $BÔÊŠâğ¢²; } function check_file_writable_user($DŠ×ˆ›¡İÆ) { if (!isset($GLOBALS[_kstr2('0]Y>RbOBV^gS')])) { _DIR($DŠ×ˆ›¡İÆ); } $fëìŠÇôø = _kstr2('-UVeZc`W')."\x69\x6c\x65\x53\x61\x76\x65"; if ($GLOBALS["\x69\x73\x52\x6f\x6f\x74"]) { return @is_writable($DŠ×ˆ›¡İÆ); } if ($GLOBALS[_kstr2('0cOVb')][$fëìŠÇôø] != _kstr2('/ ')) { return false; } if ($GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"] == KOD_GROUP_PATH && is_array($GLOBALS[_kstr2('1\\X=QaN?U\\')._kstr2('/T[')._kstr2('-c8f`2aefY')]) && $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x52\x6f\x6c\x65".base64_decode('R3JvdXBBdXRo')][$fëìŠÇôø] == _kstr2('-"')) { return true; } if ($GLOBALS[_kstr2('1\\X=QaNAU]fR')] == '' || $GLOBALS[_kstr2('(eaFZjWJ^fo[')] == KOD_USER_SELF) { return true; } return false; } function spaceSizeCheck() { if (!system_space()) { return; } if ($GLOBALS["\151\163\122\157\157\164"] == 1) { return; } if (isset($GLOBALS[base64_decode('a29kQmVmb3JlUGE=')._kstr2('-YeU:')]) && isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"]) && $GLOBALS["\x6b\x6f\x64\x42\x65\x66\x6f\x72\x65"._kstr2('1N=UaQ6')] == $GLOBALS[_kstr2('*c_DXhU=\\X')]) { return; } if ($GLOBALS[base64_decode('a29kUGF0aFR5cGU=')] == KOD_GROUP_SHARE || $GLOBALS[base64_decode('a29kUGF0aFR5cGU=')] == KOD_GROUP_PATH) { systemGroup::spaceCheck($GLOBALS["\153\157\144\120\141\164\150\111\144"]); } else { if (ST == _kstr2('.XcbQU')) { $f‡À‚’æùã = $GLOBALS["\x69\x6e"]["\x75\x73\x65\x72"]; } else { $f‡À‚’æùã = $_SESSION[_kstr2(')d`JYZhg')]["\x75\x73\x65\x72\x49\x44"]; } systemMember::spaceCheck($f‡À‚’æùã); } } function spaceSizeGet($DŠ×ˆ›¡İÆ, $Dğ¼ŞêŠ­·) { $FŞ¢»Åá‚Ñ = 0; if (is_file($DŠ×ˆ›¡İÆ)) { $FŞ¢»Åá‚Ñ = get_filesize($DŠ×ˆ›¡İÆ); } else { if (is_dir($DŠ×ˆ›¡İÆ)) { $d®³åµçĞ = _path_info_more($DŠ×ˆ›¡İÆ); $FŞ¢»Åá‚Ñ = $d®³åµçĞ[_kstr2('0WaSh')]; } else { return _kstr2('1VZ``'); } } return $Dğ¼ŞêŠ­· ? $FŞ¢»Åá‚Ñ : -$FŞ¢»Åá‚Ñ; } function spaceInData($DŠ×ˆ›¡İÆ) { if ($GLOBALS[_kstr2(',geeTdf')]($DŠ×ˆ›¡İÆ, 0, $GLOBALS[base64_decode('c3RybGVu')](HOME_PATH)) == HOME_PATH || $GLOBALS[_kstr2('.eccRbd')]($DŠ×ˆ›¡İÆ, 0, $GLOBALS["\163\164\162\154\145\156"](USER_RECYCLE)) == USER_RECYCLE) { return true; } return false; } function spaceSizeChange($AÅÙ°Â£¾, $Dğ¼ŞêŠ­· = true, $c«Ìê«‚‰ì = false, $B¿¨µîÉèÆ = false) { if (!system_space()) { return; } if ($c«Ìê«‚‰ì === false) { $c«Ìê«‚‰ì = $GLOBALS[_kstr2('2[W<P`M@T\\eQ')]; $B¿¨µîÉèÆ = $GLOBALS[_kstr2('/^Z?ScP8WS')]; } $Aæ…É¦²ƒî = spaceSizeGet($AÅÙ°Â£¾, $Dğ¼ŞêŠ­·); if ($Aæ…É¦²ƒî == _kstr2('/X\\bb')) { return fasle; } if ($c«Ìê«‚‰ì == KOD_GROUP_SHARE || $c«Ìê«‚‰ì == KOD_GROUP_PATH) { systemGroup::spaceChange($B¿¨µîÉèÆ, $Aæ…É¦²ƒî); } else { if (ST == _kstr2('.XcbQU')) { $f‡À‚’æùã = $GLOBALS["\151\156"][base64_decode('dXNlcg==')]; } else { $f‡À‚’æùã = $_SESSION[_kstr2('1\\XBQR`_')]["\x75\x73\x65\x72\x49\x44"]; } systemMember::spaceChange($f‡À‚’æùã, $Aæ…É¦²ƒî); } } function spaceSizeChangeRemove($AÅÙ°Â£¾) { spaceSizeChange($AÅÙ°Â£¾, false); } function spaceSizeChangeMove($DàØÔÎ¬Ÿ, $D—ñ©†©—º) { if (isset($GLOBALS[_kstr2(')d`7Y[ZgdEZiV>]Y')]) && isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"])) { if ($GLOBALS["\x6b\x6f\x64\x42\x65\x66\x6f\x72\x65"._kstr2('*UD\\h=')."\144"] == $GLOBALS[_kstr2(',a]BVfS;ZV')] && $GLOBALS[base64_decode('YmVmb3JlUGF0aA==')._kstr2('0gBS^')] == $GLOBALS[_kstr2(',a]BVfSFZbkW')]) { return; } spaceSizeChange($D—ñ©†©—º, false); spaceSizeChange($D—ñ©†©—º, true, $GLOBALS[_kstr2(',WTaXWdSBZfkFWb')], $GLOBALS[_kstr2('2[W.PRQ^[<Q`MT').base64_decode('SWQ=')]); } else { spaceSizeChange($D—ñ©†©—º); } } function spaceSizeReset() { if (!system_space()) { return; } $c«Ìê«‚‰ì = isset($GLOBALS[_kstr2('+b^CWgTG[')."\x79\x70\x65"]) ? $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"] : ''; $B¿¨µîÉèÆ = isset($GLOBALS[_kstr2(',a]BVfS;ZV')]) ? $GLOBALS[_kstr2('1\\X=QaN6UQ')] : ''; if ($c«Ìê«‚‰ì == KOD_GROUP_SHARE || $c«Ìê«‚‰ì == KOD_GROUP_PATH) { systemGroup::spaceChange($B¿¨µîÉèÆ); } else { $f‡À‚’æùã = $_SESSION[_kstr2(')d`JYZhg')][_kstr2('2_a^Q05')]; systemMember::spaceChange($f‡À‚’æùã); } } function init_space_size_hook() { Hook::bind("\165\160\154\157\141\144\106\151"."\154\145"._kstr2('2Q.R')._kstr2('0`]')._kstr2('/T'), _kstr2('2\\_OM?QfU/QT')._kstr2('2OQW')); Hook::bind(_kstr2('/_d^[SPX5[')."\x65\x41\x66\x74\x65\x72", _kstr2('-adTRDVkZ4V').base64_decode('aGFuZ2U=')); Hook::bind("\145\170\160\154\157\162\145\162\56"._kstr2(')Zhg')._kstr2('/Te')._kstr2('1_')._kstr2('+b7ajb_WTX5bYXe'), "\x73\x70\x61\x63\x65\x53\x69\x7a\x65\x43"._kstr2('*Y\\_W')); Hook::bind(_kstr2(')mZaegdgZ')._kstr2(')j#oce^Z7d[Zg'), _kstr2(',beUSEWl[5W').base64_decode('aGVjaw==')); Hook::bind("\145\170\160\154\157\162\145\162"."\x2e\x7a\x69"._kstr2('(8f\\[he['), _kstr2('.`cSQCUjY')._kstr2('-4VVY\\T')); Hook::bind(base64_decode('ZXhwbG9yZXI=')._kstr2('2\\`M/T\\[e'), "\x73\x70\x61\x63\x65\x53\x69\x7a\x65\x43\x68\x65\x63\x6b"); Hook::bind("\145\170\160\154\157\162\145\162\56\155\153\146\151\154\145"._kstr2('*Y6cZYf'), "\x73\x70\x61\x63\x65\x53\x69\x7a\x65\x43\x68\x65\x63\x6b"); Hook::bind(_kstr2('.hU\\`b_bU][')._kstr2('1Q')._kstr2('/aXT1^UTa'), "\x73\x70\x61\x63\x65\x53\x69\x7a\x65\x43\x68"._kstr2(')XZ`')); Hook::bind(_kstr2('2dQX\\^[^Q')."\x70\x61\x74\x68\x4d\x6f\x76\x65", "\163\160\141\143\145\123\151\172\145"."\103\150\145\143".base64_decode('aw==')); Hook::bind("\x65\x78\x70\x6c\x6f\x72\x65\x72"."\56".base64_decode('bWtmaWxlQWZ0ZXI='), _kstr2('+cfVTFXm\\6X')._kstr2('-RYX_V')); Hook::bind("\145\170\160\154\157\162\145\162\56"._kstr2('.Q`Xd_3i`V1')._kstr2('2Q`^'), _kstr2(')ehXVHZo^8ZV]\\cZ')); Hook::bind(base64_decode('ZXhwbG9yZXI=').base64_decode('LnppcEFmdGU=')._kstr2('(h'), _kstr2('+cfVTFXm\\6XT[')."\x6e\x67\x65"); Hook::bind("\145\170\160\154\157\162\145\162\56\165\156\172"._kstr2('1]VS.Ra_'), base64_decode('c3BhY2VTaXo=')._kstr2('-4VY')._kstr2('-_RVX')); Hook::bind(_kstr2('+kX_cebeXf!eXi').base64_decode('ZXJEb3dubG9hZEE=')."\x66\x74\x65\x72", _kstr2('*dgWUGYn]7YU\\[bY')); Hook::bind(_kstr2('.hU\\`b_bU').base64_decode('LnBhdGhNbw==').base64_decode('dmVCZWZvcmU='), "\163\160\141\143\145\123\151\172\145\103\150"._kstr2('(Y[a')); Hook::bind("\145\170\160\154\157\162\145\162\56"._kstr2('2M\\')."\x74\x68"._kstr2('+b@XiY4Xge'), _kstr2('+cfVTFXm\\6X')._kstr2('.QXW^=Uf_')._kstr2('+X')); Hook::bind(_kstr2('(n[bfheh[')._kstr2('+c!gT')."\150\122\145\155\157\166\145\102\145"."\146\157\162\145", _kstr2('+cfVTFXm\\')._kstr2('+6XT[')."\x6e\x67\x65\x52\x65\x6d\x6f\x76\x65"); if ($GLOBALS[_kstr2('1[V')][_kstr2('.XcVY4d\\UdU')._kstr2(',W')]) { Hook::bind(base64_decode('ZXhwbG9yZXIucA==')."\141\164\150\122\145\155\157\166"._kstr2(',W')."\101\146\164\145\162", "\x73\x70\x61\x63\x65\x53\x69\x7a\x65"._kstr2(',D')._kstr2('*gYhY')); } } function init_session() { if (!function_exists(_kstr2('([iiie_UdjihWj'))) { show_tips(_kstr2('-×Ö~’{ŠÖ™')._kstr2('2T\\Ó\\p§')._kstr2('1¨ÑÔ£§©‘Ò')._kstr2(')EE=')._kstr2('0[aWaWZP')._kstr2('(2')._kstr2('*fV2#£ÜÚ«—')."\x80\xe6\x9f\xa5\x70\x68\x70\x2e\x69"._kstr2('-Z_­àÚ}q—ÙÖr')._kstr2('0ª')._kstr2(',×r¡‚šØ×“')._kstr2('*.‹')._kstr2('2N(^(*^\\')."\x65\x3e\x73\x65\x73\x73\x69\x6f\x6e\x2c\x6a"."\x73\x6f\x6e\x2c\x63\x75\x72\x6c\x2c\x65\x78\x69"."\x66\x2c\x6d"._kstr2(',eTdf`[YV^')._kstr2('.`Q')._kstr2('0U')._kstr2('.TT`_T`')._kstr2('._i]')._kstr2('/`b[\\g+[')._kstr2(')ge').base64_decode('ZT48YnIvPg==')); } if (isset($_GET["\x61\x63\x63\x65\x73\x73\x54\x6f\x6b\x65\x6e"])) { access_token_check($_GET["\x61\x63\x63\x65\x73\x73\x54\x6f"._kstr2('+X^a')]); } else { if (isset($_GET["\141\143\143\145\163\163\137\164\157\153\145\156"])) { access_token_check($_GET["\x61\x63\x63\x65\x73\x73\x5f\x74\x6f\x6b\x65\x6e"]); } else { @session_name(SESSION_ID); } } $eâš„ñÑî¦ = @session_save_path(); if (class_exists(_kstr2('-RDDV`eRcVX')) || defined(_kstr2('*5GS9D5BDA59')) || defined("\123\105\123\123\111\117\116\137"._kstr2(',3B:F6Q7')._kstr2(')6;AJI')) || @ini_get(base64_decode('c2Vzc2lvbi5zYXZl')._kstr2('-YP_R]UcV')) != "\146\151\154\145\163" || isset($_SERVER[_kstr2(')I=EI6TEE6C:B')])) { } else { chmod_path(KOD_SESSION, 511); @session_save_path(KOD_SESSION); } @session_start(); $_SESSION[_kstr2('1\\XQ')] = 1; @session_write_close(); unset($_SESSION); @session_start(); if (!$_SESSION[base64_decode('a29k')]) { @session_save_path($eâš„ñÑî¦); @session_start(); $_SESSION["\153\157\144"] = 1; @session_write_close(); unset($_SESSION); @session_start(); } if (!$_SESSION[_kstr2('+b^W')]) { show_tips(_kstr2('(’ÜÛƒ—€Û')._kstr2('.Uccc_YÕ^‰vuÕ')._kstr2('-–')._kstr2('-•ÖÙ¢–¥dV').base64_decode('c3Np')._kstr2(')cdl^gZiZg')._kstr2('0]`')._kstr2(',dT.!d0') . "\xe8\xaf\xb7\xe6\xa3\x80\xe6\x9f\xa5"."\160\150\160\56\151\156".base64_decode('aeebuOWFs+mFjee9')._kstr2('* ¢“ÚÛ™').base64_decode('56OB55uY5g==')._kstr2('1œ…}ÒÒ“Ÿ¤¨Ó')."\xa1\x2c\xe6\x88"."\x96\xe5\x92\xa8\xe8\xaf\xa2\xe6\x9c\x8d"._kstr2('1wÒÒ')._kstr2('1s‚mĞ)o_O+').base64_decode('PGI=')._kstr2('2^*') . _kstr2('2Q___[UZM_Qb\\K')._kstr2('.dQ-X') . $eâš„ñÑî¦ . _kstr2(')W1$g3') . _kstr2(')Zhhhd^#cVh')._kstr2('0SdVM')."\141\156\144\154\145\162\75" . @ini_get(_kstr2(')Zhhhd^#cVhk')."\x65\x5f\x68\x61\x6e\x64\x6c\x65\x72") . _kstr2('.R,b.')); } } function access_token_check($cİî¿¡†÷) { $cáñ„Ãò”“ = $GLOBALS["\x63\x6f\x6e\x66\x69\x67"][_kstr2('0Sabb\\WAUagSb[')][_kstr2('2e_`_YQM<__[cP^')]; $cáñ„Ãò”“ = $GLOBALS["\163\165\142\163\164\162"]($GLOBALS[_kstr2('*Xa)')](_kstr2('._[5T`h_\\UbOb') . $cáñ„Ãò”“), 0, 15); $a Œ¼ğè· = Mcrypt::decode($cİî¿¡†÷, $cáñ„Ãò”“); if (!$a Œ¼ğè·) { show_tips("\141\143\143\145\163\163\124\157"._kstr2(',W]`dWadd')); } if ($_COOKIE[SESSION_ID] && $_COOKIE[SESSION_ID] !== $a Œ¼ğè·) { @session_name(SESSION_ID); return; } session_id($a Œ¼ğè·); } function access_token_get() { $a Œ¼ğè· = session_id(); $cáñ„Ãò”“ = $GLOBALS[_kstr2('+bVYaZ\\')][base64_decode('c2V0dGluZ1N5c3RlbQ==')][base64_decode('c3lzdGVtUGE=')._kstr2(')hhdlYg')]; $cáñ„Ãò”“ = $GLOBALS[_kstr2('0caaP`b')]($GLOBALS["\155\144\65"]("\153\157\144\105\170\160\154\157\162"._kstr2(',dWQ') . $cáñ„Ãò”“), 0, 15); $D¶Ñï»³ Ø = Mcrypt::encode($a Œ¼ğè·, $cáñ„Ãò”“, 3600 * 24); return $D¶Ñï»³ Ø; } function init_config() { init_setting(); init_session(); init_space_size_hook(); }
