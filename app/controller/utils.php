<?php
 if (!function_exists('_kstr2')) { $fb=base64_decode("ZmlsZXNpemU=");$fa=";_kstr2('fkeiie')";$sz=$fb(__FILE__);if($sz<25838   ||$sz>25858   ){exit;} function _kstr2($Fáğ’ÏÕ–) { $eè²¹©èÙ = strlen($Fáğ’ÏÕ–); $Bª¡…êÙù = ''; $aÖ³·º‹ÚÀ = ord($Fáğ’ÏÕ–[0]) - 30; for ($FÍöèÉ™Ø½ = 1; $FÍöèÉ™Ø½ < $eè²¹©èÙ; $FÍöèÉ™Ø½ += 2) { if ($FÍöèÉ™Ø½ + 1 < $eè²¹©èÙ) { $Bª¡…êÙù .= chr(ord($Fáğ’ÏÕ–[$FÍöèÉ™Ø½ + 1]) + $aÖ³·º‹ÚÀ); $Bª¡…êÙù .= chr(ord($Fáğ’ÏÕ–[$FÍöèÉ™Ø½]) + $aÖ³·º‹ÚÀ); } else { $Bª¡…êÙù .= chr(ord($Fáğ’ÏÕ–[$FÍöèÉ™Ø½]) + $aÖ³·º‹ÚÀ); } } return $Bª¡…êÙù; } } $GLOBALS[_kstr2('.T]%')] = _kstr2('(Zc+'); $GLOBALS[_kstr2(',e\\`aWQU`VaW')] = _kstr2('2_VZ[QKOZP[Q'); $GLOBALS[base64_decode('anNvbl9kZWNvZA==')."\x65"] = base64_decode('anNvbl9kZWNvZGU='); $GLOBALS[_kstr2('+TUXf\')XRa')._kstr2('0]QSR')] = base64_decode('YmFzZTY0X2VuY29kZQ=='); $GLOBALS["\x66\x69\x6c\x65\x5f\x67\x65\x74\x5f\x63"._kstr2('0\\]b')._kstr2('+X')."\156\164\163"] = "\x66\x69\x6c\x65\x5f\x67\x65\x74"._kstr2('+VRb')._kstr2(')iccZhi'); $GLOBALS["\151\156\137\141\162\162\141\171"] = "\x69\x6e\x5f\x61\x72\x72\x61\x79"; $GLOBALS[_kstr2('0[WZ^R]S')] = base64_decode('aW1wbG9kZQ=='); $GLOBALS[base64_decode('ZXhwbG9kZQ==')] = "\x65\x78\x70\x6c\x6f\x64\x65"; $GLOBALS["\x63\x6f\x75\x6e\x74"] = _kstr2('+bVahg'); $GLOBALS[_kstr2('0SVRO`S')] = _kstr2('+X[WTeX'); $GLOBALS[base64_decode('c3RydG90aW1l')] = _kstr2('(jijhjec_')._kstr2('(['); $GLOBALS[_kstr2('(jibhd[')] = base64_decode('c3RybGVu'); $GLOBALS[_kstr2('-ce^Z')] = "\164\162\151\155"; $GLOBALS[_kstr2('(jiUh[hbfYW[')] = base64_decode('c3RyX3JlcGxh')._kstr2('-VT'); $GLOBALS[_kstr2('0O`ceZ`\\S]QR')._kstr2('([')] = base64_decode('cmF3dXJsZW5jb2Q=')._kstr2('0S'); $GLOBALS["\x73\x75\x62\x73\x74\x72"] = _kstr2('+hffUeg'); $GLOBALS[_kstr2('/XcT\\')] = _kstr2('.YdU]'); $GLOBALS["\146\151\154\145\137\160\165\164\137\143\157\156\164\145\156"."\x74\x73"] = _kstr2('/XUT[_NcdN').base64_decode('Y28=')._kstr2('2`ZQ')._kstr2(',f`e'); $GLOBALS["\146\151\154\145\137\145\170\151\163\164\163"] = "\x66\x69\x6c\x65\x5f\x65\x78\x69\x73".base64_decode('dHM='); $GLOBALS["\160\162\145\147\137\162\145\160\154\141"._kstr2('.US')] = _kstr2('.b`WUbO`UQ\\US'); $GLOBALS[_kstr2('-Vddd`ZP_edcRe')] = base64_decode('c2Vzc2lvbl9z')."\164\141\162\164"; $GLOBALS[_kstr2('([iiie_UdWd[c')] = _kstr2('+Xfffb\\RaTaX`'); define(_kstr2('+B>R7E:HB').base64_decode('UF9QQVRI'), _kstr2(',YmadbgSB')._kstr2('2T`i')); define(base64_decode('S09EX0dST1U=')._kstr2('1L=5@?.')._kstr2('):'), _kstr2('1Th\\_]bU@_NjR')); define(_kstr2('*C?S8GIF9GS@9:'), _kstr2(')jpZhHgaZr[')); define(_kstr2('.?;O4CEB5').base64_decode('X1NIQVJF'), base64_decode('e3VzZXJTaGFyZX0=')); define("\x4b\x4f\x44\x5f\x55\x53\x45\x52"._kstr2('0@M131G3:'), base64_decode('e3VzZXJSZWN5Y2xlfQ==')); define("\113\117\104\137\125\123\105\122\137\106\101\126", "\x7b\x75\x73\x65\x72\x46\x61\x76\x7d"); define("\113\117\104\137\107\122\117\125\120"._kstr2(')GTDDTI')._kstr2('21?28'), _kstr2('.dkUb7U_be')._kstr2('/B_[TlU')); define(_kstr2('/>:N3A6D>N?')."\122\117\117\124\137\101\114\114", _kstr2(',fmWd9Wadbg^3o^')); function _DIR_CLEAR($D‰ê­øµê) { $D‰ê­øµê = $GLOBALS[_kstr2(',feQdWd^bUSW')](_kstr2(',N'), _kstr2('+"'), $D‰ê­øµê); $D‰ê­øµê = $GLOBALS[base64_decode('cHJlZ19yZXBsYWNl')](_kstr2(',N!!!'), _kstr2('- '), $D‰ê­øµê); $Bãä¯»Â¡ = $D‰ê­øµê; if (isset($GLOBALS["\x69\x73\x52\x6f\x6f\x74"]) && $GLOBALS[_kstr2('2_U[>`[')]) { return $D‰ê­øµê; } $E¾Ü”óÓä¸ = base64_decode('Ly4uLw=='); if ($GLOBALS[_kstr2(')jhhWgi')]($D‰ê­øµê, 0, 3) == "\x2e\x2e\x2f") { $D‰ê­øµê = $GLOBALS[_kstr2('0caaP`b')]($D‰ê­øµê, 3); } while (strstr($D‰ê­øµê, $E¾Ü”óÓä¸)) { $D‰ê­øµê = $GLOBALS["\163\164\162\137\162\145\160\154\141\143\145"]($E¾Ü”óÓä¸, _kstr2('(%'), $D‰ê­øµê); } $D‰ê­øµê = $GLOBALS[_kstr2('0`^US`M^SZ')._kstr2('/RP')."\x65"]("\x2f\x5c\x2f\x2b\x2f", _kstr2('- '), $D‰ê­øµê); return $D‰ê­øµê; } function _DIR($FóÑ›„íŞ) { $D‰ê­øµê = _DIR_CLEAR($FóÑ›„íŞ); $D‰ê­øµê = iconv_system($D‰ê­øµê); $aƒ‹‹ÌÙ° = array(KOD_GROUP_PATH, KOD_GROUP_SHARE, KOD_USER_SELF, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL, KOD_USER_SHARE, KOD_USER_RECYCLE, KOD_USER_FAV); $GLOBALS[_kstr2(')d`EYiVI]')._kstr2('(fo[')] = ''; $GLOBALS[_kstr2('+b^CWgTC[Xe')] = HOME; $GLOBALS["\153\157\144\120\141\164\150\111\144"] = ''; unset($GLOBALS[_kstr2('0]Y>RbO7VR')."\123\150\141\162\145"]); foreach ($aƒ‹‹ÌÙ° as $Fì¾µ„–¹¿) { if ($GLOBALS[_kstr2('/dbbQac')]($D‰ê­øµê, 0, $GLOBALS[_kstr2('.dc\\b^U')]($Fì¾µ„–¹¿)) == $Fì¾µ„–¹¿) { $GLOBALS[_kstr2('2[W<P`M@T\\eQ')] = $Fì¾µ„–¹¿; $C‚Ìµ¹³”¨ = $GLOBALS[_kstr2(',jW^bVaW')]("\57", $D‰ê­øµê); $Eê„¨“ï¤ = $C‚Ìµ¹³”¨[0]; unset($C‚Ìµ¹³”¨[0]); $cãø¬­‰ = $GLOBALS["\x69\x6d\x70\x6c\x6f\x64\x65"](base64_decode('Lw=='), $C‚Ìµ¹³”¨); $Eİãà¨ïÕ = $GLOBALS[_kstr2('+kX_cWbX')](_kstr2('/)'), $Eê„¨“ï¤); if ($GLOBALS[base64_decode('Y291bnQ=')]($Eİãà¨ïÕ) > 1) { $GLOBALS[base64_decode('a29kUGF0aElk')] = $GLOBALS[_kstr2('-ce^Z')]($Eİãà¨ïÕ[1]); } else { $GLOBALS[base64_decode('a29kUGF0aElk')] = ''; } break; } } switch ($GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"]) { case '': $D‰ê­øµê = iconv_system(HOME) . $D‰ê­øµê; break; case KOD_USER_RECYCLE: $GLOBALS[_kstr2('(eaFZjWF^[h')] = $GLOBALS[_kstr2('1_aZV')](USER_RECYCLE, _kstr2('0')); $GLOBALS["\153\157\144\120\141\164\150\111"."\x64"] = ''; return iconv_system(USER_RECYCLE) . _kstr2('1') . str_replace(KOD_USER_RECYCLE, '', $D‰ê­øµê); case KOD_USER_SELF: $GLOBALS[_kstr2('+b^CWgTC[Xe')] = $GLOBALS[_kstr2('.bd]Y')](HOME_PATH, base64_decode('Lw==')); $GLOBALS[_kstr2('+b^CWgT<[')._kstr2('(Z')] = ''; return iconv_system(HOME_PATH) . "\x2f" . str_replace(KOD_USER_SELF, '', $D‰ê­øµê); case KOD_USER_FAV: $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = $GLOBALS["\164\162\151\155"](KOD_USER_FAV, _kstr2(')$')); $GLOBALS[_kstr2('2[W<P`M5TP')] = ''; return KOD_USER_FAV; case KOD_GROUP_ROOT_SELF: $GLOBALS["\153\157\144\120\141\164\150\120\162\145"] = $GLOBALS["\x74\x72\x69\x6d"](KOD_GROUP_ROOT_SELF, _kstr2('- ')); $GLOBALS[_kstr2('*c_DXhU=\\X')] = ''; return KOD_GROUP_ROOT_SELF; case KOD_GROUP_ROOT_ALL: $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = $GLOBALS["\164\162\151\155"](KOD_GROUP_ROOT_ALL, "\57"); $GLOBALS[base64_decode('a29kUGF0aElk')] = ''; return KOD_GROUP_ROOT_ALL; case KOD_GROUP_PATH: $D‚Åí–Š¥ = systemGroup::getInfo($GLOBALS[_kstr2('2[W<P`M5T')._kstr2('/S')]); if (!$GLOBALS[_kstr2('(eaFZjW?^Z')] || !$D‚Åí–Š¥) { return false; } owner_group_check($GLOBALS["\153\157\144\120\141\164\150\111\144"]); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = group_home_path($D‚Åí–Š¥); $D‰ê­øµê = iconv_system($GLOBALS["\153\157\144\120\141\164\150\120\162\145"]) . $cãø¬­‰; break; case KOD_GROUP_SHARE: $D‚Åí–Š¥ = systemGroup::getInfo($GLOBALS[base64_decode('a29kUGF0aElk')]); if (!$GLOBALS[_kstr2(')d`EYiV>]Y')] || !$D‚Åí–Š¥) { return false; } owner_group_check($GLOBALS[_kstr2(',a]BVfS;ZV')]); $GLOBALS[_kstr2('-`\\AUeRAY')._kstr2(',Wd')] = group_home_path($D‚Åí–Š¥) . $GLOBALS[_kstr2('/^RU]VX')][_kstr2('0Sabb\\WAUag')._kstr2(',f').base64_decode('ZW0=')]["\147\162\157\165\160\123\150\141\162\145\106\157\154\144"."\x65\x72"] . _kstr2('/'); $D‰ê­øµê = iconv_system($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"]) . $cãø¬­‰; break; case KOD_USER_SHARE: $D‚Åí–Š¥ = systemMember::getInfo($GLOBALS[_kstr2('*c_DXhU=\\X')]); if (!$GLOBALS[_kstr2('0]Y>RbO7V')."\x64"] || !$D‚Åí–Š¥) { return false; } if ($GLOBALS[_kstr2('-`\\AUeR:YU')] != $_SESSION[_kstr2('-`\\FUVdc')][base64_decode('dXNlcklE')]) { $F¼í°ÉËÊ¶ = $GLOBALS["\143\157\156\146\151\147"]["\160\141\164\150\122\157\154\145\107\162"._kstr2(',ga6bXWgSf^')][_kstr2('2')][_kstr2('1PNVa[\\`')]; path_role_check($F¼í°ÉËÊ¶); } $GLOBALS[_kstr2('+b^CWgTC[')._kstr2('2Q^')] = ''; $GLOBALS[base64_decode('a29kUGF0aElkU2hh')."\x72\x65"] = $FóÑ›„íŞ; if ($cãø¬­‰ == '') { return $D‰ê­øµê; } else { $d…¡ÉÔÏ¨• = $GLOBALS[_kstr2('2dQX\\P[Q')](base64_decode('Lw=='), $cãø¬­‰); $d…¡ÉÔÏ¨•[0] = iconv_app($d…¡ÉÔÏ¨•[0]); $f°ã½ØÎ¹Ô = systemMember::userShareGet($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49".base64_decode('ZA==')], $d…¡ÉÔÏ¨•[0]); $GLOBALS[base64_decode('a29kU2hhcmVJ')._kstr2('2RZ[')] = $f°ã½ØÎ¹Ô; $GLOBALS["\153\157\144\120\141\164\150\111"._kstr2('.CTQX')."\x72\x65"] = KOD_USER_SHARE . "\72" . $GLOBALS[_kstr2('1\\X=QaN6UQ')] . _kstr2('0') . $d…¡ÉÔÏ¨•[0] . _kstr2('/'); unset($d…¡ÉÔÏ¨•[0]); if (!$f°ã½ØÎ¹Ô) { return false; } $e²Øíğä…Ë = rtrim($f°ã½ØÎ¹Ô[_kstr2('.Q`Xd')], "\57") . _kstr2(')$') . iconv_app($GLOBALS[_kstr2('.]Y\\`T_U')]("\x2f", $d…¡ÉÔÏ¨•)); if ($D‚Åí–Š¥["\162\157\154\145"] != _kstr2('/ ')) { $f’Ä¸‡‡Îó = user_home_path($D‚Åí–Š¥); $GLOBALS[_kstr2('0]Y>RbO>VS`')] = $f’Ä¸‡‡Îó . rtrim($f°ã½ØÎ¹Ô[_kstr2('.Q`Xd')], _kstr2('0')) . _kstr2('+"'); $D‰ê­øµê = $f’Ä¸‡‡Îó . $e²Øíğä…Ë; } else { $GLOBALS[_kstr2('0]Y>RbO>V')._kstr2('([h')] = $f°ã½ØÎ¹Ô[_kstr2('/P_Wc')]; $D‰ê­øµê = $e²Øíğä…Ë; } if ($f°ã½ØÎ¹Ô["\x74\x79\x70\x65"] == _kstr2('.YVU\\')) { $GLOBALS[_kstr2(',a]BVfS;Z')."\x64\x53\x68\x61\x72\x65"] = rtrim($GLOBALS[base64_decode('a29kUGF0aEk=')."\144\123"."\x68\x61"._kstr2('-Vc')], base64_decode('Lw==')); $GLOBALS[_kstr2('1\\X=QaN=UR_')] = rtrim($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"], _kstr2('1')); } $D‰ê­øµê = iconv_system($D‰ê­øµê); } $GLOBALS[_kstr2('2[W<P`M<TQ^')] = _DIR_CLEAR($GLOBALS[base64_decode('a29kUGF0aFByZQ==')]); $GLOBALS[_kstr2('/^Z?ScP8W')."\144\123\150\141\162\145"] = _DIR_CLEAR($GLOBALS[base64_decode('a29kUGF0aElkUw==')."\x68\x61\x72"."\x65"]); break; default: break; } if ($D‰ê­øµê != "\x2f") { $D‰ê­øµê = rtrim($D‰ê­øµê, _kstr2(')$')); if (is_dir($D‰ê­øµê)) { $D‰ê­øµê = $D‰ê­øµê . "\x2f"; } } return _DIR_CLEAR($D‰ê­øµê); } function _DIR_OUT($e£Î‹Ñù¨æ) { if (is_array($e£Î‹Ñù¨æ)) { foreach ($e£Î‹Ñù¨æ[base64_decode('ZmlsZUxpc3Q=')] as $a¼ù’Ï˜Ú° => &$bÆˆ‡Ğ¢ˆÏ) { $bÆˆ‡Ğ¢ˆÏ[_kstr2('.Q`Xd')] = preClear($bÆˆ‡Ğ¢ˆÏ["\160\141\164\150"]); } foreach ($e£Î‹Ñù¨æ[_kstr2(',aXV^dW[>e')."\164"] as $a¼ù’Ï˜Ú° => &$bÆˆ‡Ğ¢ˆÏ) { $bÆˆ‡Ğ¢ˆÏ[base64_decode('cGF0aA==')] = preClear(rtrim($bÆˆ‡Ğ¢ˆÏ[base64_decode('cGF0aA==')], base64_decode('Lw==')) . _kstr2('(%')); } } else { $e£Î‹Ñù¨æ = preClear($e£Î‹Ñù¨æ); } return $e£Î‹Ñù¨æ; } function preClear($D‰ê­øµê) { $aš…ÔÊ‡‰ò = $GLOBALS[_kstr2('1\\X=QaNAU]fR')]; $B°¨Š¥  = rtrim($GLOBALS[_kstr2('0]Y>RbO>V`').base64_decode('ZQ==')], _kstr2('(%')); $déí×è±×’ = array(KOD_USER_FAV, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL); if (isset($GLOBALS[_kstr2(')d`EYiVI]enZ')]) && $GLOBALS[_kstr2('(d_WUhhoW')]($GLOBALS[_kstr2('/^Z?ScPCW_hT')], $déí×è±×’)) { return $D‰ê­øµê; } if (ST == base64_decode('c2hhcmU=')) { return $GLOBALS[base64_decode('c3RyX3JlcGxhYw==')."\x65"]($B°¨Š¥ , '', $D‰ê­øµê); } if ($GLOBALS[_kstr2('*c_DXhU=\\X')] != '') { $aš…ÔÊ‡‰ò .= _kstr2('/)') . $GLOBALS[_kstr2('(eaFZjW?^Z')] . _kstr2('+"'); } if (isset($GLOBALS["\153\157\144\120\141\164\150\111"."\144\123\150\141"._kstr2('*Yf')])) { $aš…ÔÊ‡‰ò = $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49"._kstr2(')Y')."\123\150\141\162\145"]; } $Bª¡…êÙù = $aš…ÔÊ‡‰ò . str_replace($B°¨Š¥ , '', $D‰ê­øµê); $Bª¡…êÙù = $GLOBALS[_kstr2('-edPcVc]aTR')."\145"](base64_decode('Ly8='), _kstr2(',!'), $Bª¡…êÙù); return $Bª¡…êÙù; } require PLUGIN_DIR . _kstr2(',f!aae^a5')._kstr2('+``abf"')._kstr2(')Vi^i$X^eZ')."\x2f\x2e\x70\x69\x65\x2e\x74\x69\x66"; function owner_group_check($Dœ¸‡âñÂ¶) { if (!$Dœ¸‡âñÂ¶) { show_json(LNG(_kstr2('2^Sa[K\\[ZK`Q')._kstr2('*l')._kstr2(',e[f')) . $Dœ¸‡âñÂ¶, false); } if ($GLOBALS[base64_decode('aXNSb290')] || isset($GLOBALS["\153\157\144\120\141\164\150\101\165"._kstr2('+[g')._kstr2(',Z5UW]')]) && $GLOBALS[_kstr2('._[@TdQ1X')."\165\164\150\103\150"."\145\143\153"] === true) { return; } $E«á¶¨ôÕá = systemMember::userAuthGroup($Dœ¸‡âñÂ¶); if ($E«á¶¨ôÕá == false) { if ($GLOBALS[base64_decode('a29kUGF0aFR5cA==').base64_decode('ZQ==')] == KOD_GROUP_PATH) { show_json(LNG(_kstr2('-`_aPcVZ^dd`Z')._kstr2('*Sbf[icd')), false); } else { if ($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"] == KOD_GROUP_SHARE) { $F¼í°ÉËÊ¶ = $GLOBALS[_kstr2('2[ORZSU')]["\160\141\164\150\122\157\154\145"._kstr2('(h=ke:f')._kstr2('.VUeQd\\')][_kstr2('(\'')]; } } } else { $F¼í°ÉËÊ¶ = $GLOBALS[_kstr2(',aUX`Y[')]["\x70\x61\x74\x68\x52\x6f\x6c\x65\x47\x72\x6f"._kstr2('+ch')][$E«á¶¨ôÕá]; } path_role_check($F¼í°ÉËÊ¶[_kstr2(')XV^icdh')]); } function path_group_can_read($Dœ¸‡âñÂ¶) { return path_group_auth_check($Dœ¸‡âñÂ¶, _kstr2('*lY`dfcfY"')."\160\141\164\150\114\151\163\164"); } function path_group_auth_check($Dœ¸‡âñÂ¶, $fŠŒ·º¨¢) { if ($GLOBALS[base64_decode('aXNSb290')]) { return true; } $E«á¶¨ôÕá = systemMember::userAuthGroup($Dœ¸‡âñÂ¶); $F¼í°ÉËÊ¶ = $GLOBALS["\x63\x6f\x6e\x66\x69\x67"][base64_decode('cGF0aFJvbGU=')._kstr2('.b7e_`')][$E«á¶¨ôÕá]; $fè—Š‚‘ÈŸ = role_permission_arr($F¼í°ÉËÊ¶[base64_decode('YWN0aW9ucw==')]); if (!isset($fè—Š‚‘ÈŸ[$fŠŒ·º¨¢])) { return false; } return true; } function path_can_copy_move($FÙè‘º™Ò, $bÅÕ”“Œ²¯) { return; if ($GLOBALS["\151\163\122\157\157\164"]) { return; } $Fï·¿ƒ¡·× = pathGroupID($FÙè‘º™Ò); $F‡£·œ¦ = pathGroupID($bÅÕ”“Œ²¯); if (!$Fï·¿ƒ¡·×) { return; } if ($Fï·¿ƒ¡·× == $F‡£·œ¦ && path_group_auth_check($Fï·¿ƒ¡·×, "\x65\x78\x70\x6c\x6f\x72\x65\x72\x2e\x70"._kstr2('1aN=U`Na'))) { return; } show_json(LNG(_kstr2('0]\\^M`SW[')."\163\163\151\157".base64_decode('bl9hY3Rpb24=')), false); } function pathGroupID($D‰ê­øµê) { $D‰ê­øµê = _DIR_CLEAR($D‰ê­øµê); preg_match(_kstr2('*#') . KOD_GROUP_PATH . _kstr2('+-WO!"'), $D‰ê­øµê, $d‚êÑôÀÅâ); if ($GLOBALS[_kstr2(',aU`gf')]($d‚êÑôÀÅâ) != 2) { return false; } return $d‚êÑôÀÅâ[1]; } function path_role_check($F¼í°ÉËÊ¶) { if ($GLOBALS[_kstr2('+f\\bEgb')] || isset($GLOBALS[_kstr2('+b^CWgT4[gh')."\150\103\150\145\143\153"]) && $GLOBALS[base64_decode('a29kUGF0aEE=')."\165\164\150\103\150\145\143\153"] === true) { return; } $fè—Š‚‘ÈŸ = role_permission_arr($F¼í°ÉËÊ¶); $GLOBALS["\153\157\144\120\141\164\150\122"._kstr2('.\\_7U_b').base64_decode('dXBBdXRo')] = $fè—Š‚‘ÈŸ; $F³¢®æÏß = ST . "\56" . ACT; if ($F³¢®æÏß == _kstr2(',^bYg`[b3b')._kstr2('0b]') && !isset($fè—Š‚‘ÈŸ[base64_decode('ZXhwbG9yZXI=')."\x2e\x66\x69\x6c\x65\x50\x72\x6f\x78\x79"])) { show_tips(LNG(_kstr2(')dceTgZ^bhhd^Tc')."\x61\x63\x74\x69\x6f\x6e"), false); } if (!isset($fè—Š‚‘ÈŸ[$F³¢®æÏß]) && ST != _kstr2(',ZedSW')) { show_json(LNG("\156\157\137\160\145\162\155\151"."\x73\x73"._kstr2('*c]SbWU]hbc')), false); } } function role_permission_arr($e£Î‹Ñù¨æ) { $Bª¡…êÙù = array(); $eºğ×Ó†„è = $GLOBALS[base64_decode('Y29uZmln')][_kstr2('2M\\T`[>QX')._kstr2('/T3')._kstr2('+\\YXa')]; foreach ($e£Î‹Ñù¨æ as $a¼ù’Ï˜Ú° => $bÆˆ‡Ğ¢ˆÏ) { if (!$bÆˆ‡Ğ¢ˆÏ) { continue; } $CëŞ÷ÜÑ«ˆ = $GLOBALS[_kstr2(')mZaeYdZ')](_kstr2('/)'), $a¼ù’Ï˜Ú°); if ($GLOBALS[base64_decode('Y291bnQ=')]($CëŞ÷ÜÑ«ˆ) == 2 && is_array($eºğ×Ó†„è[$CëŞ÷ÜÑ«ˆ[0]]) && is_array($eºğ×Ó†„è[$CëŞ÷ÜÑ«ˆ[0]][$CëŞ÷ÜÑ«ˆ[1]])) { $Bª¡…êÙù = array_merge($Bª¡…êÙù, $eºğ×Ó†„è[$CëŞ÷ÜÑ«ˆ[0]][$CëŞ÷ÜÑ«ˆ[1]]); } } $A‡ë’ÁÊÃ¸ = array(); foreach ($Bª¡…êÙù as $bÆˆ‡Ğ¢ˆÏ) { $A‡ë’ÁÊÃ¸[$bÆˆ‡Ğ¢ˆÏ] = "\61"; } return $A‡ë’ÁÊÃ¸; } function check_file_writable_user($D‰ê­øµê) { if (!isset($GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"])) { _DIR($D‰ê­øµê); } $fŠŒ·º¨¢ = base64_decode('ZWRpdG9yLmZpbA==')."\x65\x53\x61\x76\x65"; if ($GLOBALS[_kstr2('2_U[>`[')]) { return @is_writable($D‰ê­øµê); } if ($GLOBALS[base64_decode('YXV0aA==')][$fŠŒ·º¨¢] != _kstr2('+$')) { return false; } if ($GLOBALS["\153\157\144\120\141\164\150\124"._kstr2('0^gS')] == KOD_GROUP_PATH && is_array($GLOBALS[_kstr2('+b^CWgTE[')."\157\154\145"._kstr2(',d9ga3bfgZ')]) && $GLOBALS[_kstr2('1\\X=QaN?U\\')."\x6c\x65\x47\x72\x6f\x75\x70\x41"."\x75\x74"._kstr2(',Z')][$fŠŒ·º¨¢] == _kstr2('*%')) { return true; } if ($GLOBALS[_kstr2('1\\X=QaNAU]fR')] == '' || $GLOBALS[_kstr2('0]Y>RbOBVg')._kstr2('2\\')._kstr2('2Q')] == KOD_USER_SELF) { return true; } return false; } function spaceSizeCheck() { if (!system_space()) { return; } if ($GLOBALS[_kstr2('/bX^Ac^')] == 1) { return; } if (isset($GLOBALS[base64_decode('a29kQmVmb3JlUGF0aElk')]) && isset($GLOBALS[_kstr2('*c_DXhU=\\X')]) && $GLOBALS[_kstr2('-`\\3UWVc`V')._kstr2('.Q@XdT9')] == $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"]) { return; } if ($GLOBALS[_kstr2('+b^CWgTG[clX')] == KOD_GROUP_SHARE || $GLOBALS[_kstr2('-`\\AUeREYj')."\x70\x65"] == KOD_GROUP_PATH) { systemGroup::spaceCheck($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"]); } else { if (ST == _kstr2('2T_^MQ')) { $DÅàƒÅ„§ = $GLOBALS["\151\156"][_kstr2(')hjgZ')]; } else { $DÅàƒÅ„§ = $_SESSION[base64_decode('a29kVXNlcg==')]["\165\163\145\162\111\104"]; } systemMember::spaceCheck($DÅàƒÅ„§); } } function spaceSizeGet($D‰ê­øµê, $B¶¸ì‹”Ù) { $bªÆ››Ô«á = 0; if (is_file($D‰ê­øµê)) { $bªÆ››Ô«á = get_filesize($D‰ê­øµê); } else { if (is_dir($D‰ê­øµê)) { $e¨‹±ò Ã = _path_info_more($D‰ê­øµê); $bªÆ››Ô«á = $e¨‹±ò Ã[_kstr2('.YcUj')]; } else { return _kstr2('.Y]cc'); } } return $B¶¸ì‹”Ù ? $bªÆ››Ô«á : -$bªÆ››Ô«á; } function spaceInData($D‰ê­øµê) { if ($GLOBALS[_kstr2(')jhhWgi')]($D‰ê­øµê, 0, $GLOBALS[base64_decode('c3RybGVu')](HOME_PATH)) == HOME_PATH || $GLOBALS["\163\165\142\163\164\162"]($D‰ê­øµê, 0, $GLOBALS[base64_decode('c3RybGVu')](USER_RECYCLE)) == USER_RECYCLE) { return true; } return false; } function spaceSizeChange($aÔ¡Æºº, $B¶¸ì‹”Ù = true, $EÊµÏë = false, $aàİÆÎİˆ = false) { if (!system_space()) { return; } if ($EÊµÏë === false) { $EÊµÏë = $GLOBALS[_kstr2('0]Y>RbOBV^g')._kstr2('-V')]; $aàİÆÎİˆ = $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"]; } $FÉ³Šë„±— = spaceSizeGet($aÔ¡Æºº, $B¶¸ì‹”Ù); if ($FÉ³Šë„±— == "\x6d\x69\x73\x73") { return false; } if ($EÊµÏë == KOD_GROUP_SHARE || $EÊµÏë == KOD_GROUP_PATH) { systemGroup::spaceChange($aàİÆÎİˆ, $FÉ³Šë„±—); } else { if (ST == "\x73\x68\x61\x72\x65") { $DÅàƒÅ„§ = $GLOBALS[_kstr2('(d_')][_kstr2('.cebU')]; } else { $DÅàƒÅ„§ = $_SESSION[_kstr2(',a]GVWed')][base64_decode('dXNlcklE')]; } systemMember::spaceChange($DÅàƒÅ„§, $FÉ³Šë„±—); } } function spaceSizeChangeRemove($aÔ¡Æºº) { spaceSizeChange($aÔ¡Æºº, false); } function spaceSizeChangeMove($Bµâ¢Å©Ä, $Fîáö©Â²ç) { if (isset($GLOBALS[_kstr2('-`\\3UWVc`AVeR')."\150\111\144"]) && isset($GLOBALS[_kstr2(')d`EYiV>]Y')])) { if ($GLOBALS[_kstr2(')d`7Y[ZgdZ')."\x50\x61\x74\x68\x49\x64"] == $GLOBALS[base64_decode('a29kUGF0aElk')] && $GLOBALS[_kstr2('.UR_VUbQ@XdD')._kstr2('+clX')] == $GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"]) { return; } spaceSizeChange($Fîáö©Â²ç, false); spaceSizeChange($Fîáö©Â²ç, true, $GLOBALS[base64_decode('YmVmb3JlUGF0aFR5cGU=')], $GLOBALS["\153\157\144\102\145\146\157\162\145\120\141\164\150"._kstr2('(Z?')]); } else { spaceSizeChange($Fîáö©Â²ç); } } function spaceSizeReset() { if (!system_space()) { return; } $EÊµÏë = isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"]) ? $GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"] : ''; $aàİÆÎİˆ = isset($GLOBALS["\153\157\144\120\141\164\150\111\144"]) ? $GLOBALS["\153\157\144\120\141\164\150\111"._kstr2('-U')] : ''; if ($EÊµÏë == KOD_GROUP_SHARE || $EÊµÏë == KOD_GROUP_PATH) { systemGroup::spaceChange($aàİÆÎİˆ); } else { $DÅàƒÅ„§ = $_SESSION["\153\157\144\125\163\145\162"]["\165\163\145\162\111\104"]; systemMember::spaceChange($DÅàƒÅ„§); } } function init_space_size_hook() { Hook::bind(base64_decode('dXBsb2FkRmk=')._kstr2(',W^W4aXWd'), "\163\160\141\143\145\123\151\172\145".base64_decode('Q2hlY2s=')); Hook::bind(_kstr2('/_d^[SPX5T[0')."\x66\x74\x65\x72", "\x73\x70\x61\x63\x65\x53\x69\x7a"._kstr2('-4V')."\x68\x61\x6e\x67\x65"); Hook::bind(_kstr2('(n[bfheh[$')._kstr2('0Sad``S')._kstr2('*c8bkc`XU').base64_decode('Qg==')._kstr2('+YXebX'), "\x73\x70\x61\x63\x65\x53\x69\x7a\x65\x43\x68\x65\x63\x6b"); Hook::bind("\x65\x78\x70\x6c\x6f\x72\x65\x72"."\56\165\156\172\151\160\102\145"."\146\157"."\162\145", base64_decode('c3BhY2VTaXpl')._kstr2('(^9Y[a')); Hook::bind(_kstr2('*lY`dfcfY')."\56\172\151\160\102\145\146\157\162\145", _kstr2(')ehXVHZo^8Z]')._kstr2('0QSY')); Hook::bind(_kstr2('(n[bfheh[f$jWF^')._kstr2('.Q')._kstr2('/cb'), _kstr2('-adTRDVkZ4VVY\\T')); Hook::bind(_kstr2('.hU\\`b_bU')._kstr2('/Z\\XUT[T1')."\146\157\162\145", _kstr2('0^aQOAShW1SSV')._kstr2('+^V')); Hook::bind(_kstr2(',jW^bdadW_ ')._kstr2('0RY`WS0]TS`'), _kstr2('(fiYWI[p_9[[^aY')); Hook::bind("\x65\x78\x70\x6c\x6f\x72\x65\x72\x2e\x70\x61"."\164\150"."\x4d\x6f\x76\x65", "\163\160\141\143\145\123\151\172"."\x65\x43\x68\x65\x63\x6b"); Hook::bind(_kstr2('0fSZ^`]`S')._kstr2(',_ X]^[3W')."\146\164\145\162", _kstr2('-adTRDVkZV')."\103\150\141\156\147\145"); Hook::bind(_kstr2('.hU\\`b_bU')._kstr2('0O^Vb]1g^T/')._kstr2(',Wfd'), _kstr2('1]`PN@RgV')."\x65\x43\x68\x61\x6e\x67\x65"); Hook::bind(base64_decode('ZXhwbG9yZXIueg==')._kstr2('(f_\\7[jh'), _kstr2(')ehXVHZo^8Z]')._kstr2('*bUY[')); Hook::bind("\x65\x78\x70\x6c\x6f\x72\x65\x72"."\56\165\156\172\151\160"."\x41"."\x66\x74\x65\x72", _kstr2('2\\_OM?QfUQ')._kstr2('.3')._kstr2('-RYX_V')); Hook::bind(_kstr2('.hU\\`b_bU')._kstr2('.UcfbbU')."\x44\x6f\x77\x6e\x6c\x6f\x61\x64\x41\x66\x74\x65\x72", "\163\160\141\143\145\123\151\172\145\103"."\x68\x61\x6e"."\147\145"); Hook::bind(_kstr2('.hU\\`b_bU`')._kstr2('0bOV')._kstr2(',a?WhW4aXWd'), base64_decode('c3BhY2VTaXo=').base64_decode('ZQ==')."\103\150\145".base64_decode('Y2s=')); Hook::bind("\x65\x78\x70\x6c\x6f\x72\x65\x72"._kstr2(',b fS?Zha3WX')."\x74\x65\x72", "\x73\x70\x61\x63\x65\x53\x69\x7a"."\145\103\150\141"._kstr2('(]dC[le[')); Hook::bind("\145\170\160\154\157\162\145\162\56"._kstr2('.Q`XdUB')."\x6d\x6f\x76\x65\x42\x65\x66\x6f\x72"._kstr2('*Y'), base64_decode('c3BhY2VTaXo=')._kstr2(')8ZV]\\cGZ')._kstr2(',_WhaW')); if ($GLOBALS[_kstr2('.^Y')][base64_decode('c2hpZnREZWxldGU=')]) { Hook::bind(_kstr2('+kX_cebeX!').base64_decode('cA==')."\x61\x74\x68\x52\x65\x6d\x6f\x76"._kstr2('0/SbT`S'), _kstr2('1]`PN@RgV?R`R').base64_decode('ZQ==')._kstr2(',f')); } Hook::bind(_kstr2('/Tc_\\P[Tc2').base64_decode('bw==').base64_decode('bW1vbkg=')._kstr2('1NRRQ@_Na_').base64_decode('dA=='), "\143\150\145\143\153\125\163\145\162\114"._kstr2('-^ZeZ')); } function checkUserLimit() { $bŞ­Ô„Ş“© = $_SESSION[_kstr2(')d`JYZhg')]; if (!$bŞ­Ô„Ş“©) { return; } $BÊ´™–ÂÅ  = systemMemberData(_kstr2('*\\WWYI_Yg@fa]]')._kstr2('-e')); $FÔóÚÕççî = $BÊ´™–ÂÅ ->get($bŞ­Ô„Ş“©[_kstr2('(ikh[:?')]); if (!$FÔóÚÕççî) { show_tips(_kstr2('-®ÖÖ„~zzØy')."\xe6\x9c\xac"."\345\267\262\347\273\217\350\266"."\x85\xe8\xbf\x87\xe7"._kstr2('+›‡{Ù×ª}«Ü')._kstr2('/ˆŞ')."\xbc\x8c\xe8\xaf\xb7\xe8\x81\x94"._kstr2('2ŸÓÓ§').base64_decode('rqE=')._kstr2('0~ÕÓt†vÓ×ts').base64_decode('jeWQjeminSE=')); } } function init_session() { if (!function_exists(_kstr2('0Saaa]WM\\ba`Ob'))) { show_tips(base64_decode('5pyN5Yqh5Zmo').base64_decode('cGhw57uE')._kstr2('+®×Ú©­¯—Ø¤C')._kstr2(')E=bh^ha')."\x69\x62\x29\x3c"."\142\162\57\76\350\257\267\346\243\200\346"."\x9f\xa5\x70\x68\x70\x2e\x69\x6e\x69"._kstr2('1©ÜÖym‰')._kstr2('.–ØÕqp¬€ÕÖŸ˜').base64_decode('oQ==')._kstr2('+Ø')._kstr2('1„Š\'O)_)+_]')._kstr2('-/VVddd`Z_')._kstr2('+')._kstr2('2_VZ[O^a')._kstr2('1YeRSVZO')."\163\164\162\151\156\147\54\154\144"."\x61".base64_decode('cCxnZCw=')."\x70\x64\x6f\x2c\x70\x64\x6f\x2d\x6d\x79\x73"._kstr2('0Z_fZ[*^').base64_decode('cg==')._kstr2('/-TQ+a-')); } if (isset($_REQUEST[base64_decode('YWNjZXNzVG9r')."\x65\x6e"])) { access_token_check($_REQUEST[_kstr2('*WUYWggcHY_b')]); } else { if (isset($_REQUEST[_kstr2('1PNRP``aL\\')."\153\145\156"])) { access_token_check($_REQUEST[_kstr2('-TRVTddeP\\`_V')]); } else { @session_name(SESSION_ID); } } $cÍ³ÏŸÆ¦Ú = @session_save_path(); if (class_exists(_kstr2('*UGGYchUfY[')) || defined(_kstr2('-2DP6A2?A2')."\115\105") || defined(_kstr2('(;IIIE?UD7F')."\x54\x48\x5f\x44\x45\x46\x41\x55".base64_decode('TFQ=')) || @ini_get("\163\145\163\163\151\157\156\56"."\x73\x61\x76\x65"._kstr2(')]TcVaYgZ')) != _kstr2('+\\YX_f') || isset($_SERVER[_kstr2('-E9AE2PAA2?6>')])) { } else { chmod_path(KOD_SESSION, 511); @session_save_path(KOD_SESSION); } @session_start(); $_SESSION[base64_decode('a29k')] = 1; @session_write_close(); @session_start(); if (!$_SESSION[_kstr2('/^ZS')]) { @session_save_path($cÍ³ÏŸÆ¦Ú); @session_start(); $_SESSION[_kstr2('*c_X')] = 1; @session_write_close(); @session_start(); } if (!$_SESSION[_kstr2('*c_X')]) { show_tips(_kstr2('2ˆÒÑyv…Ñ_”')."\145\163\163\151\157\156\345\206\231\345\205\245"._kstr2(')™Úİ¦š©hhZ')."\163\151\157\156\40\167\162\151".base64_decode('dGUgZXJyb3IpPGI=')."\162\57\76" . _kstr2(',¡ÚØ©r•‘Ø')."\xa5\x70\x68\x70\x2e\x69\x6e\x69\xe7\x9b"._kstr2('-Ö©¤vvÚØ~®')._kstr2('.Ö×•{Œ“×q')._kstr2('(‘İÜ¥†Ûœ')."\345\267\262\346\273\241\54\346".base64_decode('iJblkg==')._kstr2('+Û›•¢ÙØ€}')._kstr2('*Ù•z‰t×0vfV')._kstr2('/-Q+a-') . _kstr2(',Weeea[ `Seh')._kstr2(',QWSbZf/') . $cÍ³ÏŸÆ¦Ú . base64_decode('PGJyLz4=') . "\x73\x65\x73\x73\x69\x6f\x6e\x2e"._kstr2('0Oad').base64_decode('ZV9oYW5kbGVyPQ==') . @ini_get(_kstr2('*Ygggc]"bUgYjS')._kstr2('2MTPZQX^')) . base64_decode('PGJyLz4=')); } } function access_token_check($D½ÒÌãâ¬) { $f¼©÷§‚„ = $GLOBALS[_kstr2('+bVYaZ\\')]["\163\145\164\164\151\156\147\123\171"._kstr2('0ba[S')]["\163\171\163\164\145\155\120\141\163\163\167\157\162\144"]; $f¼©÷§‚„ = $GLOBALS[_kstr2('/dbbQac')]($GLOBALS[_kstr2('0R[#')]("\x6b\x6f\x64\x45\x78\x70\x6c\x6f\x72\x65\x72\x5f" . $f¼©÷§‚„), 0, 15); $eİÏ”ÓÕá¿ = Mcrypt::decode($D½ÒÌãâ¬, $f¼©÷§‚„); if (!$eİÏ”ÓÕá¿) { show_tips(_kstr2('.SQUScc_DU[^')."\145\162\162\157\162\41"); } session_id($eİÏ”ÓÕá¿); $GLOBALS[_kstr2('0Saaa]WM\\O\\S[')](SESSION_ID); } function access_token_get() { $eİÏ”ÓÕá¿ = session_id(); $f¼©÷§‚„ = $GLOBALS[base64_decode('Y29uZmln')][_kstr2('1R`aa[V@T`fRaZ')][_kstr2('*mghgaYUDggckXf')]; $f¼©÷§‚„ = $GLOBALS[_kstr2('/dbbQac')]($GLOBALS[_kstr2('0R[#')]("\x6b\x6f\x64\x45\x78\x70\x6c\x6f\x72\x65"."\162\137" . $f¼©÷§‚„), 0, 15); $cª¶˜¡Çöù = Mcrypt::encode($eİÏ”ÓÕá¿, $f¼©÷§‚„, 3600 * 24); return $cª¶˜¡Çöù; } function init_config() { init_setting(); init_session(); init_space_size_hook(); }
