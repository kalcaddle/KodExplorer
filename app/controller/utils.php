<?php
 if (!function_exists('_kstr2')) { $fb=base64_decode("ZmlsZXNpemU=");$fa=";_kstr2('fkeiie')";$sz=$fb(__FILE__);if($sz<23427   ||$sz>23447   ){exit;} function _kstr2($AŸÕ’ò¸ë) { $A‹ç·óªÊğ = strlen($AŸÕ’ò¸ë); $Ağ®Å˜Ã© = ''; $BŒ×¸Ÿ¡ = ord($AŸÕ’ò¸ë[0]) - 30; for ($A…»Ó§åš† = 1; $A…»Ó§åš† < $A‹ç·óªÊğ; $A…»Ó§åš† += 2) { if ($A…»Ó§åš† + 1 < $A‹ç·óªÊğ) { $Ağ®Å˜Ã© .= chr(ord($AŸÕ’ò¸ë[$A…»Ó§åš† + 1]) + $BŒ×¸Ÿ¡); $Ağ®Å˜Ã© .= chr(ord($AŸÕ’ò¸ë[$A…»Ó§åš†]) + $BŒ×¸Ÿ¡); } else { $Ağ®Å˜Ã© .= chr(ord($AŸÕ’ò¸ë[$A…»Ó§åš†]) + $BŒ×¸Ÿ¡); } } return $Ağ®Å˜Ã©; } } $GLOBALS[base64_decode('bWQ1')] = "\x6d\x64\x35"; $GLOBALS[_kstr2('(i`de[UYd')._kstr2('-U`V')] = base64_decode('anNvbl9lbmNvZGU='); $GLOBALS[_kstr2('1`W[\\QLPRQ\\R')] = _kstr2('1`W[\\QLPR\\')._kstr2('/TS'); $GLOBALS[_kstr2('1NOR`!#RL[').base64_decode('Y29kZQ==')] = _kstr2(')VWZh)+ZTXcd')."\x64\x65"; $GLOBALS["\x66\x69\x6c\x65\x5f\x67\x65\x74\x5f"."\x63\x6f\x6e\x74\x65\x6e\x74\x73"] = _kstr2(',[XW^YQfWUQ')._kstr2(',`a')._kstr2('.Udd^c'); $GLOBALS["\x69\x6e\x5f\x61\x72\x72\x61\x79"] = _kstr2('0\\WOM``gO'); $GLOBALS[_kstr2('1ZVY]Q\\R')] = _kstr2('-^Z]aU`V'); $GLOBALS["\x65\x78\x70\x6c\x6f\x64\x65"] = _kstr2('2dQX\\P[Q'); $GLOBALS["\x63\x6f\x75\x6e\x74"] = _kstr2('/^R]dc'); $GLOBALS["\150\145\141\144\145\162"] = "\150\145\141\144\145\162"; $GLOBALS[_kstr2(')ihigidb^Z')] = _kstr2(')ihigidb^Z'); $GLOBALS[_kstr2('+gf_eaX')] = _kstr2('1a`Y_[R'); $GLOBALS[_kstr2('+eg`\\')] = "\x74\x72\x69\x6d"; $GLOBALS[_kstr2('+gfReXe_cT')."\143\145"] = _kstr2(',feQdWd^bUSW'); $GLOBALS["\x72\x61\x77\x75\x72\x6c\x65\x6e\x63\x6f\x64\x65"] = _kstr2('*Ufik`fbYcWYX'); $GLOBALS[_kstr2('/dbbQac')] = base64_decode('c3Vic3Ry'); $GLOBALS[base64_decode('dGltZQ==')] = _kstr2('1VaRZ'); $GLOBALS["\x66\x69\x6c\x65\x5f\x70\x75\x74"._kstr2(')XTd')."\156\164\145"."\x6e\x74\x73"] = _kstr2(')^[ZaeTijT')."\143\157\156\164\145\156\164\163"; $GLOBALS["\x66\x69\x6c\x65\x5f\x65\x78\x69"._kstr2('(jii')] = base64_decode('ZmlsZV9leGlzdHM='); $GLOBALS[_kstr2('0`^US`M^SOZQ').base64_decode('ZQ==')] = _kstr2(',dbYWdQbWS^WU'); $GLOBALS["\x73\x65\x73\x73\x69\x6f\x6e\x5f\x73\x74\x61\x72\x74"] = _kstr2(',Weeea[Q`feS')._kstr2('+ge'); $GLOBALS[base64_decode('c2Vzc2lvbl9u')._kstr2('*aUY')] = _kstr2('.Uccc_YO^Q^U]'); define(_kstr2('+B>R7E:HBC')._kstr2(')ETI6='), _kstr2('/Vj^a_dP?Wcl')); define(_kstr2('*C?S8F;ICSD<G').base64_decode('QVI=')._kstr2('/4'), "\x7b\x67\x72\x6f\x75\x70\x53\x68\x61\x72"._kstr2('0kS')); define(_kstr2('.?;O4CEB5O')._kstr2('0A')._kstr2('):').base64_decode('TEY='), "\x7b\x75\x73\x65\x72\x53\x65\x6c\x66\x7d"); define("\x4b\x4f\x44\x5f\x55\x53\x45\x52\x5f\x53"."\110\101\122\105", _kstr2('2agQ_?^MT')._kstr2('1R_j')); define(_kstr2('1<8L1@B?2?L02')."\131\103\114\105", "\x7b\x75\x73\x65\x72\x52\x65\x63"."\x79\x63\x6c\x65\x7d"); define(_kstr2('*C?S8GIF9:SJ5'), base64_decode('e3VzZXJGYXZ9')); define(_kstr2('*C?S8F;ICD')._kstr2('0@M==')."\124\137\123\105\114\106", base64_decode('e3RyZWVHcm91cFNl')._kstr2('0Z')._kstr2('.mV')); define("\113\117\104\137\107\122\117\125"._kstr2('/N?A').base64_decode('T09UX0FMTA=='), "\173\164\162\145\145\107\162\157\165\160\101"."\154\154\175"); function _DIR_CLEAR($f­µÉ¹õ™É) { $f­µÉ¹õ™É = $GLOBALS["\163\164\162\137\162\145\160\154"."\141\143\145"](_kstr2(',N'), _kstr2('(%'), $f­µÉ¹õ™É); $f­µÉ¹õ™É = $GLOBALS[_kstr2(',dbYWdQbWS^WU')]("\x2f\x5c\x2f\x2b\x2f", "\57", $f­µÉ¹õ™É); $Fˆ©–…®£Ğ = $f­µÉ¹õ™É; if (isset($GLOBALS[_kstr2('.cY_Bd_')]) && $GLOBALS[_kstr2('/bX^Ac^')]) { return $f­µÉ¹õ™É; } $Cµ“•Ò¤ìØ = _kstr2('+!""!'); if ($GLOBALS[_kstr2('+hffUeg')]($f­µÉ¹õ™É, 0, 3) == "\x2e\x2e\x2f") { $f­µÉ¹õ™É = $GLOBALS[_kstr2(')jhhWgi')]($f­µÉ¹õ™É, 3); } while (strstr($f­µÉ¹õ™É, $Cµ“•Ò¤ìØ)) { $f­µÉ¹õ™É = $GLOBALS["\163\164\162\137\162\145\160\154"._kstr2('1PNR')]($Cµ“•Ò¤ìØ, _kstr2('2'), $f­µÉ¹õ™É); } $f­µÉ¹õ™É = $GLOBALS["\160\162\145\147\137\162\145\160"._kstr2('(Wb[Y')](base64_decode('L1wvKy8='), "\x2f", $f­µÉ¹õ™É); return $f­µÉ¹õ™É; } function _DIR($d§Ô»‡íš) { $f­µÉ¹õ™É = _DIR_CLEAR($d§Ô»‡íš); $f­µÉ¹õ™É = iconv_system($f­µÉ¹õ™É); $A·îÜ£ÜÊñ = array(KOD_GROUP_PATH, KOD_GROUP_SHARE, KOD_USER_SELF, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL, KOD_USER_SHARE, KOD_USER_RECYCLE, KOD_USER_FAV); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"] = ''; $GLOBALS[_kstr2('-`\\AUeRAYVc')] = HOME; $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] = ''; unset($GLOBALS[base64_decode('a29kUGF0aElkU2hhcg==')._kstr2(')Z')]); foreach ($A·îÜ£ÜÊñ as $dÎ íŒ™ì) { if ($GLOBALS["\x73\x75\x62\x73\x74\x72"]($f­µÉ¹õ™É, 0, $GLOBALS[_kstr2('/cb[a]T')]($dÎ íŒ™ì)) == $dÎ íŒ™ì) { $GLOBALS[base64_decode('a29kUGF0aFR5cGU=')] = $dÎ íŒ™ì; $b·óã©¤¹— = $GLOBALS["\145\170\160\154\157\144\145"](_kstr2('- '), $f­µÉ¹õ™É); $Fì‰†ˆ§î‚ = $b·óã©¤¹—[0]; unset($b·óã©¤¹—[0]); $E„½ùÇ„ÇÕ = $GLOBALS[_kstr2('2YUX\\P[Q')](_kstr2('*#'), $b·óã©¤¹—); $e¹Ê¦ãâß³ = $GLOBALS[_kstr2('.hU\\`T_U')](_kstr2('-+'), $Fì‰†ˆ§î‚); if ($GLOBALS[_kstr2('-`T_fe')]($e¹Ê¦ãâß³) > 1) { $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] = $GLOBALS["\x74\x72\x69\x6d"]($e¹Ê¦ãâß³[1]); } else { $GLOBALS[_kstr2('1\\X=QaN6UQ')] = ''; } break; } } switch ($GLOBALS[_kstr2('._[@TdQDX`i')._kstr2('-V')]) { case '': $f­µÉ¹õ™É = iconv_system(HOME) . $f­µÉ¹õ™É; break; case KOD_USER_RECYCLE: $GLOBALS[_kstr2('2[W<P`M<TQ^')] = $GLOBALS["\x74\x72\x69\x6d"](USER_RECYCLE, _kstr2('*#')); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49"._kstr2('+W')] = ''; return iconv_system(USER_RECYCLE) . "\x2f" . str_replace(KOD_USER_RECYCLE, '', $f­µÉ¹õ™É); case KOD_USER_SELF: $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = $GLOBALS[base64_decode('dHJpbQ==')](HOME_PATH, _kstr2('1')); $GLOBALS[_kstr2('._[@TdQ9XT')] = ''; return iconv_system(HOME_PATH) . _kstr2('/') . str_replace(KOD_USER_SELF, '', $f­µÉ¹õ™É); case KOD_USER_FAV: $GLOBALS[base64_decode('a29kUGF0aFByZQ==')] = $GLOBALS["\164\162\151\155"](KOD_USER_FAV, _kstr2(')$')); $GLOBALS[_kstr2('+b^CWgT<[W')] = ''; return KOD_USER_FAV; case KOD_GROUP_ROOT_SELF: $GLOBALS[_kstr2('1\\X=QaN=U_')._kstr2('2Q')] = $GLOBALS[_kstr2('2^`YU')](KOD_GROUP_ROOT_SELF, _kstr2(',!')); $GLOBALS[_kstr2('(eaFZjW?^Z')] = ''; return KOD_GROUP_ROOT_SELF; case KOD_GROUP_ROOT_ALL: $GLOBALS[_kstr2(')d`EYiVE]Zg')] = $GLOBALS[base64_decode('dHJpbQ==')](KOD_GROUP_ROOT_ALL, "\x2f"); $GLOBALS[_kstr2('._[@TdQ9XT')] = ''; return KOD_GROUP_ROOT_ALL; case KOD_GROUP_PATH: $b›ßÒ·í¸Æ = systemGroup::getInfo($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"]); if (!$GLOBALS[_kstr2(',a]BVfS;ZV')] || !$b›ßÒ·í¸Æ) { return false; } owner_group_check($GLOBALS["\153\157\144\120\141\164\150\111"."\x64"]); $GLOBALS["\153\157\144\120\141\164\150\120\162"._kstr2('/T')] = group_home_path($b›ßÒ·í¸Æ); $f­µÉ¹õ™É = iconv_system($GLOBALS[_kstr2('0]Y>RbO>V')."\x72".base64_decode('ZQ==')]) . $E„½ùÇ„ÇÕ; break; case KOD_GROUP_SHARE: $b›ßÒ·í¸Æ = systemGroup::getInfo($GLOBALS[_kstr2('(eaFZjW?^Z')]); if (!$GLOBALS[_kstr2('+b^CWgT<[W')] || !$b›ßÒ·í¸Æ) { return false; } owner_group_check($GLOBALS[_kstr2('*c_DXhU=\\X')]); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = group_home_path($b›ßÒ·í¸Æ) . $GLOBALS["\x63\x6f\x6e\x66\x69\x67"][_kstr2('.Ucdd^YCW')._kstr2('(o')._kstr2('1a`ZR')][_kstr2(',dYgaEbSZWd')._kstr2('2[2')._kstr2(')Ya')."\145\162"] . "\x2f"; $f­µÉ¹õ™É = iconv_system($GLOBALS[_kstr2('1\\X=QaN=UR_')]) . $E„½ùÇ„ÇÕ; break; case KOD_USER_SHARE: $b›ßÒ·í¸Æ = systemMember::getInfo($GLOBALS[base64_decode('a29kUGF0aElk')]); if (!$GLOBALS[_kstr2('(eaFZjW?^Z')] || !$b›ßÒ·í¸Æ) { return false; } if ($GLOBALS[base64_decode('a29kUGF0aEk=')."\x64"] != $_SESSION[_kstr2('*c_IXYgf')][_kstr2(',egdW6;')]) { $dæÕ¶‘–¢° = $GLOBALS[_kstr2('+bVYaZ\\')][_kstr2('(Wf^jeH[bh=ke')._kstr2(')9e')._kstr2('1SRbNaY')][_kstr2('0')][_kstr2('*WU]hbcg')]; path_role_check($dæÕ¶‘–¢°); } $GLOBALS[base64_decode('a29kUGF0aFByZQ==')] = ''; $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49"._kstr2(',EVZ').base64_decode('YXJl')] = $d§Ô»‡íš; if ($E„½ùÇ„ÇÕ == '') { return $f­µÉ¹õ™É; } else { $aÇ‹¿»Ğ = $GLOBALS[_kstr2(',jW^bVaW')](_kstr2(')$'), $E„½ùÇ„ÇÕ); $aÇ‹¿»Ğ[0] = iconv_app($aÇ‹¿»Ğ[0]); $fÃå‡‰šê = systemMember::userShareGet($GLOBALS[_kstr2(',a]BVfS;ZV')], $aÇ‹¿»Ğ[0]); $GLOBALS["\153\157\144\123\150\141\162\145\111\156\146\157"] = $fÃå‡‰šê; $GLOBALS[_kstr2('0]Y>RbO7VAROVS`')] = KOD_USER_SHARE . _kstr2('.*') . $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] . _kstr2('2') . $aÇ‹¿»Ğ[0] . _kstr2(')$'); unset($aÇ‹¿»Ğ[0]); if (!$fÃå‡‰šê) { return false; } $cÄó¤õ²†Ä = rtrim($fÃå‡‰šê[_kstr2('(Wf^j')], _kstr2('- ')) . _kstr2('*#') . iconv_app($GLOBALS[_kstr2('1ZVY]Q\\R')]("\57", $aÇ‹¿»Ğ)); if ($b›ßÒ·í¸Æ["\162\157\154\145"] != _kstr2('+$')) { $BÖìóÜ––¾ = user_home_path($b›ßÒ·í¸Æ); $GLOBALS[_kstr2('._[@TdQ@XUb')] = $BÖìóÜ––¾ . rtrim($fÃå‡‰šê[base64_decode('cGF0aA==')], "\57") . base64_decode('Lw=='); $f­µÉ¹õ™É = $BÖìóÜ––¾ . $cÄó¤õ²†Ä; } else { $GLOBALS[_kstr2('1\\X=QaN=UR_')] = $fÃå‡‰šê[_kstr2('.Q`Xd')]; $f­µÉ¹õ™É = $cÄó¤õ²†Ä; } if ($fÃå‡‰šê[_kstr2('/hcT_')] == _kstr2(',[XW^')) { $GLOBALS[_kstr2('0]Y>RbO7VR')."\x53"._kstr2('2MTQ^')] = rtrim($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49"._kstr2('*X')._kstr2('.XC')._kstr2(')gVZ')], _kstr2('(%')); $GLOBALS[_kstr2(')d`EYiVE]Zg')] = rtrim($GLOBALS["\153\157\144\120\141\164\150\120\162\145"], _kstr2('- ')); } $f­µÉ¹õ™É = iconv_system($f­µÉ¹õ™É); } break; default: break; } if ($f­µÉ¹õ™É != _kstr2('+"')) { $f­µÉ¹õ™É = rtrim($f­µÉ¹õ™É, "\57"); if (is_dir($f­µÉ¹õ™É)) { $f­µÉ¹õ™É = $f­µÉ¹õ™É . _kstr2('1'); } } return _DIR_CLEAR($f­µÉ¹õ™É); } function _DIR_OUT($Cñç°‚â÷¿) { if (is_array($Cñç°‚â÷¿)) { foreach ($Cñç°‚â÷¿[_kstr2('-ZWV]Z=ed')] as $fñ‰ˆØøèà => &$c±´ƒœ ©ë) { $c±´ƒœ ©ë[_kstr2('2M\\T`')] = preClear($c±´ƒœ ©ë[_kstr2('2M\\T`')]); } foreach ($Cñç°‚â÷¿["\x66\x6f\x6c\x64\x65\x72\x4c\x69\x73"."\x74"] as $fñ‰ˆØøèà => &$c±´ƒœ ©ë) { $c±´ƒœ ©ë[_kstr2('(Wf^j')] = preClear(rtrim($c±´ƒœ ©ë[_kstr2(',SbZf')], _kstr2('.')) . "\x2f"); } } else { $Cñç°‚â÷¿ = preClear($Cñç°‚â÷¿); } return $Cñç°‚â÷¿; } function preClear($f­µÉ¹õ™É) { $EˆÙÆë•¢È = $GLOBALS[_kstr2(')d`EYiVI]enZ')]; $eÊ¢°÷æÌÈ = rtrim($GLOBALS[_kstr2('-`\\AUeRAYVc')], "\57"); $Fò¹Ô¼‰†ƒ = array(KOD_USER_FAV, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL); if (isset($GLOBALS[_kstr2('/^Z?ScPCW_hT')]) && $GLOBALS[_kstr2('1[VNL__fN')]($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70"."\x65"], $Fò¹Ô¼‰†ƒ)) { return $f­µÉ¹õ™É; } if (ST == "\x73\x68\x61\x72\x65") { return $GLOBALS["\163\164\162\137\162\145\160\154\141\143\145"]($eÊ¢°÷æÌÈ, '', $f­µÉ¹õ™É); } if ($GLOBALS[_kstr2('._[@TdQ9XT')] != '') { $EˆÙÆë•¢È .= "\72" . $GLOBALS[_kstr2('._[@TdQ9XT')] . _kstr2('1'); } if (isset($GLOBALS[_kstr2('(eaFZjW?^IZW^[h')])) { $EˆÙÆë•¢È = $GLOBALS["\153\157\144\120\141\164\150\111\144\123\150\141"._kstr2(')Zg')]; } $Ağ®Å˜Ã© = $EˆÙÆë•¢È . str_replace($eÊ¢°÷æÌÈ, '', $f­µÉ¹õ™É); $Ağ®Å˜Ã© = $GLOBALS[_kstr2('-edPcVc]aTRV')](_kstr2('(%%'), _kstr2('0'), $Ağ®Å˜Ã©); return $Ağ®Å˜Ã©; } require PLUGIN_DIR . "\57\164\157\157\154\163\103\157\155"._kstr2('/^\\]cbcP').base64_decode('aWMvcGllLy5waWU=')."\56"._kstr2('.d')._kstr2('2RU'); function owner_group_check($c‘“‹Ì–ˆ) { if (!$c‘“‹Ì–ˆ) { show_json(LNG(_kstr2('/aVd^N_^]NcT')._kstr2('2Ud_')."\x74") . $c‘“‹Ì–ˆ, false); } if ($GLOBALS["\151\163\122\157\157\164"] || isset($GLOBALS[base64_decode('a29kUGF0aEE=')._kstr2('2`a/TQTO')."\x6b"]) && $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x41\x75"._kstr2('(^j^9Y[a')] === true) { return; } $Eï©Šôñ³í = systemMember::userAuthGroup($c‘“‹Ì–ˆ); if ($Eï©Šôñ³í == false) { if ($GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"] == KOD_GROUP_PATH) { show_json(LNG(_kstr2('-`_aPcVZ^dd`ZP_')._kstr2('.bWe_`')), false); } else { if ($GLOBALS[base64_decode('a29kUGF0aFR5cGU=')] == KOD_GROUP_SHARE) { $dæÕ¶‘–¢° = $GLOBALS[_kstr2('._SV^WY')]["\x70\x61\x74\x68\x52\x6f\x6c\x65\x47\x72"._kstr2('0c]2^TScObZ')][base64_decode('MQ==')]; } } } else { $dæÕ¶‘–¢° = $GLOBALS["\x63\x6f\x6e\x66\x69\x67"]["\x70\x61\x74\x68\x52\x6f\x6c\x65\x47\x72\x6f\x75"."\x70"][$Eï©Šôñ³í]; } path_role_check($dæÕ¶‘–¢°[_kstr2(',US[f`ae')]); } function path_role_check($dæÕ¶‘–¢°) { if ($GLOBALS[_kstr2('/bX^Ac^')] || isset($GLOBALS[_kstr2('(eaFZjW7^jk9^')._kstr2('0SVYQ')]) && $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x41"._kstr2('1ab0URUXP')] === true) { return; } $a³Æãá©ª = role_permission_arr($dæÕ¶‘–¢°); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x52\x6f\x6c".base64_decode('ZUdyb3VwQXU=').base64_decode('dGg=')] = $a³Æãá©ª; if (!isset($a³Æãá©ª[ST . base64_decode('Lg==') . ACT]) && ST != "\x73\x68\x61\x72\x65") { show_json(LNG("\156\157\137\160\145\162\155\151"._kstr2('(iie_d')."\137\141"."\x63\x74\x69\x6f\x6e"), false); } } function role_permission_arr($Cñç°‚â÷¿) { $Ağ®Å˜Ã© = array(); $E‡ˆ£Ş–Îä = $GLOBALS[_kstr2(')dX[c\\^')][_kstr2('.Q`Xd_BU\\U4YV')._kstr2('0S\\')]; foreach ($Cñç°‚â÷¿ as $fñ‰ˆØøèà => $c±´ƒœ ©ë) { if (!$c±´ƒœ ©ë) { continue; } $C’õ¢«®ê© = $GLOBALS[_kstr2('.hU\\`T_U')](_kstr2('2&'), $fñ‰ˆØøèà); if ($GLOBALS["\143\157\165\156\164"]($C’õ¢«®ê©) == 2 && is_array($E‡ˆ£Ş–Îä[$C’õ¢«®ê©[0]]) && is_array($E‡ˆ£Ş–Îä[$C’õ¢«®ê©[0]][$C’õ¢«®ê©[1]])) { $Ağ®Å˜Ã© = array_merge($Ağ®Å˜Ã©, $E‡ˆ£Ş–Îä[$C’õ¢«®ê©[0]][$C’õ¢«®ê©[1]]); } } $dùÌ½Ìá°¹ = array(); foreach ($Ağ®Å˜Ã© as $c±´ƒœ ©ë) { $dùÌ½Ìá°¹[$c±´ƒœ ©ë] = _kstr2('0'); } return $dùÌ½Ìá°¹; } function check_file_writable_user($f­µÉ¹õ™É) { if (!isset($GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"])) { _DIR($f­µÉ¹õ™É); } $f¦°ŠÖ´´« = _kstr2('+WXg\\ebY!_\\')."\x65\x53\x61\x76\x65"; if ($GLOBALS["\x69\x73\x52\x6f\x6f\x74"]) { return @is_writable($f­µÉ¹õ™É); } if ($GLOBALS[_kstr2('0cOVb')][$f¦°ŠÖ´´«] != _kstr2(')&')) { return false; } if ($GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"] == KOD_GROUP_PATH && is_array($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x52\x6f\x6c\x65"."\107\162"._kstr2('0c]/^bcV')]) && $GLOBALS[_kstr2('._[@TdQBX_')."\154\145"._kstr2('1_4b\\.]ab')."\150"][$f¦°ŠÖ´´«] == "\61") { return true; } if ($GLOBALS["\153\157\144\120\141\164\150\124"._kstr2('1]fR')] == '' || $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"] == KOD_USER_SELF) { return true; } return false; } function spaceSizeCheck() { if (!system_space()) { return; } if ($GLOBALS[_kstr2('0aW]@b]')] == 1) { return; } if (isset($GLOBALS["\153\157\144\102\145\146\157\162\145\120\141"."\x74\x68\x49\x64"]) && isset($GLOBALS[base64_decode('a29kUGF0aElk')]) && $GLOBALS[_kstr2(',a]4VXWdaW')._kstr2('2M<T`5')._kstr2('.T')] == $GLOBALS[_kstr2('2[W<P`M5TP')]) { return; } if ($GLOBALS[base64_decode('a29kUGF0aFR5cGU=')] == KOD_GROUP_SHARE || $GLOBALS[_kstr2(',a]BVfSFZbkW')] == KOD_GROUP_PATH) { systemGroup::spaceCheck($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49"._kstr2('0R')]); } else { if (ST == base64_decode('c2hhcmU=')) { $D×°±í‰”é = $GLOBALS["\x69\x6e"][_kstr2('/bdaT')]; } else { $D×°±í‰”é = $_SESSION[_kstr2('/^ZDSTba')][_kstr2('1`b_R16')]; } systemMember::spaceCheck($D×°±í‰”é); } } function spaceSizeGet($f­µÉ¹õ™É, $cÎµÚÁĞ­) { $Cßæá²»‘¡ = 0; if (is_file($f­µÉ¹õ™É)) { $Cßæá²»‘¡ = get_filesize($f­µÉ¹õ™É); } else { if (is_dir($f­µÉ¹õ™É)) { $Aƒê´óêŒ• = _path_info_more($f­µÉ¹õ™É); $Cßæá²»‘¡ = $Aƒê´óêŒ•[_kstr2('0WaSh')]; } else { return _kstr2('/X\\bb'); } } return $cÎµÚÁĞ­ ? $Cßæá²»‘¡ : -$Cßæá²»‘¡; } function spaceInData($f­µÉ¹õ™É) { if ($GLOBALS[_kstr2('1b``O_a')]($f­µÉ¹õ™É, 0, $GLOBALS[_kstr2('1a`Y_[R')](HOME_PATH)) == HOME_PATH || $GLOBALS[_kstr2(')jhhWgi')]($f­µÉ¹õ™É, 0, $GLOBALS["\x73\x74\x72\x6c\x65\x6e"](USER_RECYCLE)) == USER_RECYCLE) { return true; } return false; } function spaceSizeChange($aùÂœªÑ›, $cÎµÚÁĞ­ = true, $eµöÑ…Ìëø = false, $dÕà„‚š´„ = false) { if (!system_space()) { return; } if ($eµöÑ…Ìëø === false) { $eµöÑ…Ìëø = $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"]; $dÕà„‚š´„ = $GLOBALS[base64_decode('a29kUGF0aElk')]; } $DŒ‘ºÆ¶‰« = spaceSizeGet($aùÂœªÑ›, $cÎµÚÁĞ­); if ($DŒ‘ºÆ¶‰« == _kstr2('.Y]cc')) { return fasle; } if ($eµöÑ…Ìëø == KOD_GROUP_SHARE || $eµöÑ…Ìëø == KOD_GROUP_PATH) { systemGroup::spaceChange($dÕà„‚š´„, $DŒ‘ºÆ¶‰«); } else { if (ST == _kstr2('1U`_NR')) { $D×°±í‰”é = $GLOBALS[base64_decode('aW4=')]["\x75\x73\x65\x72"]; } else { $D×°±í‰”é = $_SESSION["\x6b\x6f\x64\x55\x73\x65\x72"][_kstr2('/bdaT38')]; } systemMember::spaceChange($D×°±í‰”é, $DŒ‘ºÆ¶‰«); } } function spaceSizeChangeRemove($aùÂœªÑ›) { spaceSizeChange($aùÂœªÑ›, false); } function spaceSizeChangeMove($fÅäâÊ´±Š, $A™Í‚œåµ) { if (isset($GLOBALS["\153\157\144\102\145\146\157\162\145\120\141\164\150\111\144"]) && isset($GLOBALS[base64_decode('a29kUGF0aElk')])) { if ($GLOBALS[_kstr2('1\\X/QSR_\\=RN').base64_decode('dGg=')."\111\144"] == $GLOBALS[_kstr2('+b^CWgT<[W')] && $GLOBALS[_kstr2('.UR_VUbQ@Xd')._kstr2('/hC')."\160\145"] == $GLOBALS[_kstr2('+b^CWgTG[l')."\x70\x65"]) { return; } spaceSizeChange($A™Í‚œåµ, false); spaceSizeChange($A™Í‚œåµ, true, $GLOBALS[_kstr2(')ZWd[ZgVE]i')._kstr2('(J')._kstr2(')enZ')], $GLOBALS[base64_decode('a29kQmVmb3I=')._kstr2('(F[jW')._kstr2('16UQ')]); } else { spaceSizeChange($A™Í‚œåµ); } } function spaceSizeReset() { if (!system_space()) { return; } $eµöÑ…Ìëø = isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"]) ? $GLOBALS[base64_decode('a29kUGF0aFR5cA==')._kstr2(',W')] : ''; $dÕà„‚š´„ = isset($GLOBALS["\153\157\144\120\141\164\150\111\144"]) ? $GLOBALS[base64_decode('a29kUGF0aEk=')._kstr2('2P')] : ''; if ($eµöÑ…Ìëø == KOD_GROUP_SHARE || $eµöÑ…Ìëø == KOD_GROUP_PATH) { systemGroup::spaceChange($dÕà„‚š´„); } else { $D×°±í‰”é = $_SESSION[base64_decode('a29kVXNlcg==')]["\165\163\145\162\111\104"]; systemMember::spaceChange($D×°±í‰”é); } } function init_space_size_hook() { Hook::bind(base64_decode('dXBsb2FkRmk=')."\x6c\x65\x42\x65\x66\x6f\x72\x65", _kstr2('-adTRDVkZ4VY').base64_decode('ZWNr')); Hook::bind(_kstr2('/_d^[SPX5')."\154\145\101\146\164\145\162", "\x73\x70\x61\x63\x65\x53\x69\x7a\x65\x43"."\150\141"._kstr2('0U\\S')); Hook::bind(base64_decode('ZXhwbG9yZXIu')._kstr2('-VdgcV')._kstr2('+e')._kstr2('._4^g_\\TQU2_VUb'), _kstr2('1]`PN@RgV')."\x65\x43\x68\x65\x63\x6b"); Hook::bind(_kstr2('(n[bfheh[$')."\x75\x6e\x7a\x69\x70\x42\x65\x66"._kstr2('/a^')._kstr2('(['), _kstr2('0^aQOAShW1S')._kstr2('-VY')._kstr2('0Q')._kstr2('.[')); Hook::bind(_kstr2(',jW^bdadW ')._kstr2('.Yj2`VUb_U'), "\163\160\141\143\145\123\151\172\145\103"._kstr2('1U')."\x65"._kstr2(')X')._kstr2('(a')); Hook::bind(_kstr2(')mZaegdgZ#')._kstr2('*Ud\\hc7md'), _kstr2('*dgWUGYn]Y')."\103\150\145\143\153"); Hook::bind(_kstr2(')mZaegdgZ')._kstr2(',_ X]^[4W')."\x65\x66".base64_decode('b3Jl'), _kstr2('(fiYWI[p_9[')._kstr2('*Y\\_W')); Hook::bind(_kstr2('.hU\\`b_bU')."\x6d\x6b\x64\x69\x72\x42\x65\x66\x6f\x72\x65", _kstr2('.`cSQCUjYU')."\x43\x68\x65\x63".base64_decode('aw==')); Hook::bind(_kstr2(')mZaegdgZe#V').base64_decode('dGg=')._kstr2('-`>Vg'), _kstr2('0^aQOAShW').base64_decode('ZUNoZWNr')); Hook::bind(_kstr2('1eRY]_\\_R')."\155"._kstr2(')[`a^6Zi[gZ'), "\x73\x70\x61\x63\x65\x53\x69\x7a\x65\x43".base64_decode('aGFuZw==').base64_decode('ZQ==')); Hook::bind(base64_decode('ZXhwbG9yZXIu')."\160\141\164\150\103\157\160\171\101"._kstr2('0bT`S'), _kstr2(')ehXVHZo^Z')._kstr2('2T/M')."\x6e\x67\x65"); Hook::bind(_kstr2('*lY`dfcfY')._kstr2('*n"d]')._kstr2('*Z5Yhf'), "\x73\x70\x61\x63\x65\x53\x69\x7a"."\145\103\150\141\156\147\145"); Hook::bind(base64_decode('ZXhwbG9yZXIudW56')._kstr2(')e^[6Zig'), _kstr2('*dgWUGYn]7YU\\[bY')); Hook::bind(_kstr2('+kX_cebeX')._kstr2('0a`SSd2`')._kstr2('/f^[]P^0ScU')._kstr2('*fY'), _kstr2('(fiYWI[p_9[W^')."\156"._kstr2('1T').base64_decode('ZQ==')); Hook::bind("\x65\x78\x70\x6c\x6f\x72\x65\x72\x2e"._kstr2('-RaYe`>VgV3`W')."\162\145", "\163\160\141\143\145\123\151\172\145\103\150\145\143\153"); Hook::bind("\145\170\160\154\157\162\145\162\56\160\141\164"."\150\115\157\166\145\101\146\164"."\x65\x72", base64_decode('c3BhY2VTaXo=')."\145\103\150\141\156\147\145\115\157\166\145"); Hook::bind("\145\170\160\154\157\162\145\162\56"."\x70\x61\x74\x68\x52\x65\x6d\x6f\x76"._kstr2('/1TUT^')."\x72\x65", _kstr2('/_bRPBTiX')._kstr2('(9[W^]d').base64_decode('ZVJlbW92ZQ==')); if ($GLOBALS["\151\156"]["\x73\x68\x69\x66\x74\x44\x65\x6c\x65\x74\x65"]) { Hook::bind(_kstr2(')mZaegdgZe#iV]')."\122\145\155\157\166\145\101\146\164\145\162", _kstr2('*dgWUGYn]Y')._kstr2('/TATb')."\x74"); } } function init_session() { if (!function_exists("\x73\x65\x73\x73\x69\x6f\x6e\x5f\x73\x74\x61\x72\x74")) { show_tips("\xe6\x9c\x8d\xe5\x8a\xa1\xe5\x99\xa8\x70\x68"."\160\347\273\204\344\273\266\347\274\272"._kstr2(')Ú')._kstr2('(§šFF>')._kstr2(')b^')._kstr2('0aaZPW*`P')._kstr2('*2#£Ü«')._kstr2('2ÒÒl‘‹T\\')."\x70\x2e\x69\x6e"._kstr2(',á[~®ÛÚrs˜')."\345\274\200\345\220"._kstr2('*Ú£•œ‘Ù.‹')._kstr2('1)_O+])')._kstr2('([hi4i[_i')._kstr2('-_`')."\54\152\163\157\156\54\143\165\162\154\54"._kstr2(')mZ[^b!hWgic^\\')."\54\154\144\141\160\54\147\144\54"._kstr2('+Wcb')._kstr2('+Wc bl`df_')._kstr2('.]h,\\`Ub,.bR.')); } if (isset($_GET[_kstr2('(YW[YiieJ[a').base64_decode('bg==')])) { access_token_check($_GET[_kstr2('*WUYWggcH')._kstr2('-V\\_')]); } else { if (isset($_GET[_kstr2('-TRVTddeP\\`_V')])) { access_token_check($_GET["\141\143\143\145\163\163\137\164\157\153"."\x65\x6e"]); } else { @session_name(SESSION_ID); } } $c¶Ç±ÎÏ¹´ = @session_save_path(); if (class_exists(_kstr2(')VHHZdiVgZ\\')) || defined(_kstr2('(7IU;F7DFC7;')) || defined(_kstr2('12@@@<6L;.=')._kstr2('*<H8S:9I5H@')) || @ini_get("\x73\x65\x73\x73\x69\x6f\x6e\x2e\x73\x61"."\166\145"."\x5f\x68\x61\x6e\x64\x6c\x65\x72") != _kstr2('+\\YX_f') || isset($_SERVER["\x48\x54\x54\x50\x5f\x41\x50\x50\x4e\x41\x4d\x45"])) { } else { chmod_path(KOD_SESSION, 511); @session_save_path(KOD_SESSION); } @session_start(); $_SESSION[base64_decode('a29k')] = 1; @session_write_close(); unset($_SESSION); @session_start(); if (!$_SESSION[_kstr2('1\\XQ')]) { @session_save_path($c¶Ç±ÎÏ¹´); @session_start(); $_SESSION["\153\157\144"] = 1; @session_write_close(); unset($_SESSION); @session_start(); } if (!$_SESSION[_kstr2('0]YR')]) { show_tips(_kstr2('0ŠÔÓ{x‡Óa–')._kstr2('+fX\\fabyØØŒ˜x')._kstr2('2Ñ')._kstr2('0ÖŸ“¢aaSa')."\x69\x6f\x6e".base64_decode('IHdyaXRlIGVycg==')._kstr2('-c`-cS/ ') . _kstr2('+¢ÛÙªs–’Ù')."\245\160"._kstr2('2\\TUUZ‡ÓÑ¤q')._kstr2(',Û¥w¯Ù ‘ØÙ—')."\x9c"._kstr2(')Ü€v˜ÜÛ¤')._kstr2(',‚××˜¤©­Ø“')._kstr2(')}ÛÚ‹‡').base64_decode('qOivouacjeWKoQ==')._kstr2('-†Öw')."\xe3\x80\x82\x3c\x62\x72\x2f\x3e\x3c"._kstr2('/aQ-') . "\x73\x65\x73\x73\x69\x6f\x6e\x2e\x73\x61\x76\x65"."\x5f\x70\x61\x74\x68\x3d" . $c¶Ç±ÎÏ¹´ . _kstr2('(X2%h4') . "\163\145\163\163\151\157\156\56\163"._kstr2('.fQOUQXT^U\\-b') . @ini_get("\163\145\163\163\151\157\156\56\163".base64_decode('YXZlX2hhbmRsZQ==')."\162") . "\74\142\162\57\76"); } } function access_token_check($A›§²æª¢í) { $F§ŸùÍÈ½ß = $GLOBALS[_kstr2('._SV^WY')][_kstr2('-Vdee_ZDXdjVe^')][_kstr2('(oijic[WFiiemZh')]; $F§ŸùÍÈ½ß = $GLOBALS[_kstr2('0caaP`b')]($GLOBALS["\x6d\x64\x35"](_kstr2('+b^8Wckb_XeRe') . $F§ŸùÍÈ½ß), 0, 15); $BƒÄĞã ÂÄ = Mcrypt::decode($A›§²æª¢í, $F§ŸùÍÈ½ß); if (!$BƒÄĞã ÂÄ) { show_tips(_kstr2('0QOSQaa]BSY\\`S`')._kstr2('/a^')); } if ($_COOKIE[SESSION_ID] && $_COOKIE[SESSION_ID] !== $BƒÄĞã ÂÄ) { @session_name(SESSION_ID); return; } session_id($BƒÄĞã ÂÄ); } function access_token_get() { $BƒÄĞã ÂÄ = session_id(); $F§ŸùÍÈ½ß = $GLOBALS[_kstr2('0]QT\\UW')][_kstr2('0Sabb\\WAUagSb')._kstr2('*a')][_kstr2(')nhihbZVEhhdlYg')]; $F§ŸùÍÈ½ß = $GLOBALS[_kstr2('0caaP`b')]($GLOBALS[_kstr2(')Yb*')](_kstr2('+b^8Wckb_')._kstr2('+XeRe') . $F§ŸùÍÈ½ß), 0, 15); $eˆ¿‰¢¯ƒÒ = Mcrypt::encode($BƒÄĞã ÂÄ, $F§ŸùÍÈ½ß, 3600 * 24); return $eˆ¿‰¢¯ƒÒ; } function init_config() { init_setting(); init_session(); init_space_size_hook(); }
