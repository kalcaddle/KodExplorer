<?php
 if (!function_exists('_kstr2')) { $fb=base64_decode("ZmlsZXNpemU=");$fa=";_kstr2('fkeiie')";$sz=$fb(__FILE__);if($sz<25771   ||$sz>25791   ){exit;} function _kstr2($c¹¯Ø´¢‡µ) { $C«Äïé‚ = strlen($c¹¯Ø´¢‡µ); $aŸÍ•ä‡ßÈ = ''; $BÃº’ïÒÏÈ = ord($c¹¯Ø´¢‡µ[0]) - 30; for ($Bë­Òõ†Œ‡ = 1; $Bë­Òõ†Œ‡ < $C«Äïé‚; $Bë­Òõ†Œ‡ += 2) { if ($Bë­Òõ†Œ‡ + 1 < $C«Äïé‚) { $aŸÍ•ä‡ßÈ .= chr(ord($c¹¯Ø´¢‡µ[$Bë­Òõ†Œ‡ + 1]) + $BÃº’ïÒÏÈ); $aŸÍ•ä‡ßÈ .= chr(ord($c¹¯Ø´¢‡µ[$Bë­Òõ†Œ‡]) + $BÃº’ïÒÏÈ); } else { $aŸÍ•ä‡ßÈ .= chr(ord($c¹¯Ø´¢‡µ[$Bë­Òõ†Œ‡]) + $BÃº’ïÒÏÈ); } } return $aŸÍ•ä‡ßÈ; } } $GLOBALS[_kstr2('.T]%')] = _kstr2('2PY!'); $GLOBALS["\152\163\157\156\137\145\156\143\157\144\145"] = _kstr2('0aX\\]SMQ\\')."\157"._kstr2('0SR'); $GLOBALS["\x6a\x73\x6f\x6e\x5f\x64\x65\x63"._kstr2('.T_U')] = _kstr2('*g^bcXSWYXcY'); $GLOBALS[_kstr2(')VWZh)+ZTc')."\x63"._kstr2('.T_U')] = _kstr2('0OPSa"$SMQ\\R]S'); $GLOBALS[_kstr2('0WTSZUMbS').base64_decode('X2NvbnRlbnRz')] = base64_decode('ZmlsZV9nZXRfY28=').base64_decode('bg==')._kstr2('([jjdi'); $GLOBALS[_kstr2('+a\\TReelT')] = _kstr2('(d_WUhhoW'); $GLOBALS["\151\155\160\154\157\144\145"] = "\151\155\160\154\157\144\145"; $GLOBALS[base64_decode('ZXhwbG9kZQ==')] = _kstr2('1eRY]Q\\R'); $GLOBALS["\143\157\165\156\164"] = "\x63\x6f\x75\x6e\x74"; $GLOBALS[_kstr2('2QTPM^Q')] = _kstr2('*Y\\XUfY'); $GLOBALS[_kstr2('2`_`^`[YUQ')] = base64_decode('c3RydG90aW1l'); $GLOBALS[base64_decode('c3RybGVu')] = _kstr2('-ed]c_V'); $GLOBALS["\164\162\151\155"] = "\164\162\151\155"; $GLOBALS[base64_decode('c3RyX3JlcGxhY2U=')] = _kstr2('0baM`S`Z^')."\x61\x63\x65"; $GLOBALS[base64_decode('cmF3dXJsZW5j')."\157\144\145"] = _kstr2(',Sdgi^d`WaUWV'); $GLOBALS[_kstr2('-fddSce')] = _kstr2('1b``O_a'); $GLOBALS[_kstr2('(_j[c')] = _kstr2('2U`QY'); $GLOBALS["\146\151\154\145\137\160\165\164\137\143\157\156\164"._kstr2('/]Tbc')] = _kstr2('1VSRY]LabL')._kstr2('0]Qb\\S')._kstr2('.d^c'); $GLOBALS[base64_decode('ZmlsZV9leGlzdHM=')] = _kstr2('0WTSZSMWfba')."\x73"; $GLOBALS["\160\162\145\147\137\162\145\160\154"._kstr2('/P')._kstr2('0SQ')] = base64_decode('cHJlZ19yZXBsYQ==')."\143\145"; $GLOBALS[_kstr2('.Uccc_YO^c')._kstr2('.Qd')."\x72\x74"] = _kstr2('1R```\\VL[a`')."\141\162\164"; $GLOBALS["\x73\x65\x73\x73\x69\x6f\x6e\x5f\x6e\x61\x6d\x65"] = "\x73\x65\x73\x73\x69\x6f\x6e\x5f\x6e\x61\x6d"._kstr2('/T'); define(base64_decode('S09EX0dST1VQ')."\137\120\101\124\110", _kstr2(',YmadbgSB')._kstr2('+[gp')); define("\113\117\104\137\107\122\117\125"._kstr2('+RC;FE48'), "\173\147\162\157\165\160\123\150\141\162\145\175"); define("\113\117\104\137\125\123\105\122\137"._kstr2('.5C6<'), "\173\165\163\145\162\123\145\154\146\175"); define(_kstr2('*C?S8GIF9GS')._kstr2('-296C'), "\x7b\x75\x73\x65\x72\x53\x68\x61\x72\x65\x7d"); define(_kstr2('0=9M2AC@3M')._kstr2(',7DK5>57'), _kstr2('(kq[iHhY[')._kstr2(',Uk^')._kstr2('1jR')); define(base64_decode('S09EX1VTRVI=').base64_decode('X0ZBVg=='), "\x7b\x75\x73\x65\x72\x46\x61\x76\x7d"); define("\113\117\104\137\107\122\117\125"."\120\137\122\117\117".base64_decode('VF9TRUxG'), _kstr2('2`gQ^3Q[^a').base64_decode('cFNlbGZ9')); define(_kstr2('0=9M2@5C=>')."\x5f\x52\x4f\x4f\x54\x5f\x41\x4c\x4c", _kstr2('2`gQ^3Q[^\\a')._kstr2('0Z/kZ')); function _DIR_CLEAR($aÄ•Š—†‘¡) { $aÄ•Š—†‘¡ = $GLOBALS["\163\164\162\137\162\145\160\154\141\143".base64_decode('ZQ==')](_kstr2('*P'), _kstr2('2'), $aÄ•Š—†‘¡); $aÄ•Š—†‘¡ = $GLOBALS[base64_decode('cHJlZ19yZXBsYWNl')](_kstr2('+O"""'), _kstr2('+"'), $aÄ•Š—†‘¡); $d† ÃËŸŒñ = $aÄ•Š—†‘¡; if (isset($GLOBALS[base64_decode('aXNSb290')]) && $GLOBALS["\151\163\122\157\157\164"]) { return $aÄ•Š—†‘¡; } $C÷í®ƒÈ‹ = _kstr2(')#$$#'); if ($GLOBALS["\x73\x75\x62\x73\x74\x72"]($aÄ•Š—†‘¡, 0, 3) == base64_decode('Li4v')) { $aÄ•Š—†‘¡ = $GLOBALS["\x73\x75\x62\x73\x74\x72"]($aÄ•Š—†‘¡, 3); } while (strstr($aÄ•Š—†‘¡, $C÷í®ƒÈ‹)) { $aÄ•Š—†‘¡ = $GLOBALS[_kstr2('/cbNaTa[_RPT')]($C÷í®ƒÈ‹, _kstr2('- '), $aÄ•Š—†‘¡); } $aÄ•Š—†‘¡ = $GLOBALS["\160\162\145\147\137\162\145\160\154\141\143"._kstr2('2Q')]("\57\134\57\53\57", _kstr2('.'), $aÄ•Š—†‘¡); return $aÄ•Š—†‘¡; } function _DIR($BÙÊ¹óÊ—¨) { $aÄ•Š—†‘¡ = _DIR_CLEAR($BÙÊ¹óÊ—¨); $aÄ•Š—†‘¡ = iconv_system($aÄ•Š—†‘¡); $dŒÂç—â¶ù = array(KOD_GROUP_PATH, KOD_GROUP_SHARE, KOD_USER_SELF, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL, KOD_USER_SHARE, KOD_USER_RECYCLE, KOD_USER_FAV); $GLOBALS[_kstr2('*c_DXhUH\\dmY')] = ''; $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = HOME; $GLOBALS[_kstr2('*c_DXhU=\\X')] = ''; unset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49"._kstr2('(IZW^[h')]); foreach ($dŒÂç—â¶ù as $e¿‡šØÆ) { if ($GLOBALS[_kstr2(')jhhWgi')]($aÄ•Š—†‘¡, 0, $GLOBALS["\163\164\162\154\145\156"]($e¿‡šØÆ)) == $e¿‡šØÆ) { $GLOBALS[_kstr2('._[@TdQDX`iU')] = $e¿‡šØÆ; $dÁêøÕÆ¡ = $GLOBALS[_kstr2('2dQX\\P[Q')]("\x2f", $aÄ•Š—†‘¡); $cĞ±Îƒƒ = $dÁêøÕÆ¡[0]; unset($dÁêøÕÆ¡[0]); $fµ¬ÌÁ”¢Ë = $GLOBALS[_kstr2(')b^aeYdZ')](base64_decode('Lw=='), $dÁêøÕÆ¡); $bÈ²›Ï¢§ = $GLOBALS["\x65\x78\x70\x6c\x6f\x64\x65"](_kstr2(')/'), $cĞ±Îƒƒ); if ($GLOBALS[_kstr2('+bVahg')]($bÈ²›Ï¢§) > 1) { $GLOBALS[base64_decode('a29kUGF0aElk')] = $GLOBALS[_kstr2(')gib^')]($bÈ²›Ï¢§[1]); } else { $GLOBALS[_kstr2('2[W<P`M5TP')] = ''; } break; } } switch ($GLOBALS[base64_decode('a29kUGF0aFQ=').base64_decode('eXBl')]) { case '': $aÄ•Š—†‘¡ = iconv_system(HOME) . $aÄ•Š—†‘¡; break; case KOD_USER_RECYCLE: $GLOBALS[base64_decode('a29kUGF0aFByZQ==')] = $GLOBALS[_kstr2('2^`YU')](USER_RECYCLE, _kstr2('- ')); $GLOBALS[base64_decode('a29kUGF0aElk')] = ''; return iconv_system(USER_RECYCLE) . _kstr2('+"') . str_replace(KOD_USER_RECYCLE, '', $aÄ•Š—†‘¡); case KOD_USER_SELF: $GLOBALS[_kstr2('+b^CWgTC[Xe')] = $GLOBALS[_kstr2('/ac\\X')](HOME_PATH, _kstr2(',!')); $GLOBALS[base64_decode('a29kUGF0aElk')] = ''; return iconv_system(HOME_PATH) . "\57" . str_replace(KOD_USER_SELF, '', $aÄ•Š—†‘¡); case KOD_USER_FAV: $GLOBALS[_kstr2(',a]BVfSBZWd')] = $GLOBALS[_kstr2('1_aZV')](KOD_USER_FAV, "\57"); $GLOBALS[_kstr2('2[W<P`M5TP')] = ''; return KOD_USER_FAV; case KOD_GROUP_ROOT_SELF: $GLOBALS[base64_decode('a29kUGF0aFByZQ==')] = $GLOBALS[base64_decode('dHJpbQ==')](KOD_GROUP_ROOT_SELF, _kstr2('2')); $GLOBALS[_kstr2('/^Z?ScP8WS')] = ''; return KOD_GROUP_ROOT_SELF; case KOD_GROUP_ROOT_ALL: $GLOBALS[_kstr2('._[@TdQ@XUb')] = $GLOBALS[base64_decode('dHJpbQ==')](KOD_GROUP_ROOT_ALL, _kstr2('*#')); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] = ''; return KOD_GROUP_ROOT_ALL; case KOD_GROUP_PATH: $C˜îàÀ‰İ = systemGroup::getInfo($GLOBALS[_kstr2(',a]BVfS;ZV')]); if (!$GLOBALS[base64_decode('a29kUGF0aElk')] || !$C˜îàÀ‰İ) { return false; } owner_group_check($GLOBALS[_kstr2('1\\X=QaN6UQ')]); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50".base64_decode('cmU=')] = group_home_path($C˜îàÀ‰İ); $aÄ•Š—†‘¡ = iconv_system($GLOBALS[_kstr2('+b^CWgTC[Xe')]) . $fµ¬ÌÁ”¢Ë; break; case KOD_GROUP_SHARE: $C˜îàÀ‰İ = systemGroup::getInfo($GLOBALS["\153\157\144\120\141\164\150\111\144"]); if (!$GLOBALS[_kstr2('._[@TdQ9X')._kstr2(')Y')] || !$C˜îàÀ‰İ) { return false; } owner_group_check($GLOBALS[_kstr2(',a]BVfS;ZV')]); $GLOBALS["\153\157\144\120\141\164\150\120\162\145"] = group_home_path($C˜îàÀ‰İ) . $GLOBALS[_kstr2(')dX[c\\^')]["\x73\x65\x74\x74\x69\x6e\x67\x53\x79"._kstr2('.dc]U')][base64_decode('Z3JvdXBTaGE=')._kstr2('*f').base64_decode('ZUY=')._kstr2(')ad')._kstr2('/S')."\145\162"] . _kstr2('/'); $aÄ•Š—†‘¡ = iconv_system($GLOBALS[_kstr2('1\\X=QaN=UR_')]) . $fµ¬ÌÁ”¢Ë; break; case KOD_USER_SHARE: $C˜îàÀ‰İ = systemMember::getInfo($GLOBALS[_kstr2('._[@TdQ9XT')]); if (!$GLOBALS["\153\157\144\120\141\164\150\111\144"] || !$C˜îàÀ‰İ) { return false; } if ($GLOBALS["\153\157\144\120\141\164\150\111\144"] != $_SESSION[_kstr2('/^ZDSTba')][_kstr2('1`b_R16')]) { $DÖá¡¯ª™õ = $GLOBALS[base64_decode('Y29uZmln')][_kstr2('0O^Vb]@SZ5')._kstr2('+bechX7TY_hg')][_kstr2('(\'')]["\141\143\164\151\157\156\163"]; path_role_check($DÖá¡¯ª™õ); } $GLOBALS[_kstr2('-`\\AUeRAYVc')] = ''; $GLOBALS[_kstr2('2[W<P`M5TP')._kstr2('0VA`OS')] = $BÙÊ¹óÊ—¨; if ($fµ¬ÌÁ”¢Ë == '') { return $aÄ•Š—†‘¡; } else { $eËà…›®¦ù = $GLOBALS["\145\170\160\154\157\144\145"](_kstr2('+"'), $fµ¬ÌÁ”¢Ë); $eËà…›®¦ù[0] = iconv_app($eËà…›®¦ù[0]); $c•­Ä®‡©¹ = systemMember::userShareGet($GLOBALS[_kstr2(',a]BVfS;ZV')], $eËà…›®¦ù[0]); $GLOBALS[_kstr2(')d`HYV]Zgc>')._kstr2('1\\S')] = $c•­Ä®‡©¹; $GLOBALS[_kstr2('0]Y>RbO7VR')._kstr2('+[FeTX')] = KOD_USER_SHARE . "\x3a" . $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] . "\x2f" . $eËà…›®¦ù[0] . _kstr2('0'); unset($eËà…›®¦ù[0]); if (!$c•­Ä®‡©¹) { return false; } $díÅêã²àƒ = rtrim($c•­Ä®‡©¹[_kstr2('-RaYe')], base64_decode('Lw==')) . _kstr2('(%') . iconv_app($GLOBALS[_kstr2(')b^aeYdZ')]("\x2f", $eËà…›®¦ù)); if ($C˜îàÀ‰İ[_kstr2('1\\_RY')] != base64_decode('MQ==')) { $f»¸÷×ô¢¹ = user_home_path($C˜îàÀ‰İ); $GLOBALS[_kstr2('._[@TdQ@X')._kstr2('+Xe')] = $f»¸÷×ô¢¹ . rtrim($c•­Ä®‡©¹["\x70\x61\x74\x68"], _kstr2('.')) . _kstr2('.'); $aÄ•Š—†‘¡ = $f»¸÷×ô¢¹ . $díÅêã²àƒ; } else { $GLOBALS[_kstr2('(eaFZjWF^[h')] = $c•­Ä®‡©¹[_kstr2('+Tc[g')]; $aÄ•Š—†‘¡ = $díÅêã²àƒ; } if ($c•­Ä®‡©¹["\x74\x79\x70\x65"] == _kstr2('2URQX')) { $GLOBALS[_kstr2('(eaFZjW?^IZW^[h')] = rtrim($GLOBALS[_kstr2('+b^CWgT<[FWT[Xe')], _kstr2(')$')); $GLOBALS[_kstr2('-`\\AUeRAYVc')] = rtrim($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"], "\x2f"); } $aÄ•Š—†‘¡ = iconv_system($aÄ•Š—†‘¡); } $GLOBALS[base64_decode('a29kUGF0aFBy').base64_decode('ZQ==')] = _DIR_CLEAR($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"]); $GLOBALS[base64_decode('a29kUGF0aElk')._kstr2('-YDcRV')] = _DIR_CLEAR($GLOBALS[_kstr2('1\\X=QaN6UQ')._kstr2('1U@_NR')]); break; default: break; } if ($aÄ•Š—†‘¡ != _kstr2('2')) { $aÄ•Š—†‘¡ = rtrim($aÄ•Š—†‘¡, _kstr2('(%')); if (is_dir($aÄ•Š—†‘¡)) { $aÄ•Š—†‘¡ = $aÄ•Š—†‘¡ . _kstr2('/'); } } return _DIR_CLEAR($aÄ•Š—†‘¡); } function _DIR_OUT($DåîËÇé) { if (is_array($DåîËÇé)) { foreach ($DåîËÇé[_kstr2('1VSRYV9a`')] as $Aîù‹î°à => &$AåßŸÕğ­ˆ) { $AåßŸÕğ­ˆ[_kstr2('.Q`Xd')] = preClear($AåßŸÕğ­ˆ[_kstr2('0O^Vb')]); } foreach ($DåîËÇé[_kstr2(')d[YagZ^Ah').base64_decode('dA==')] as $Aîù‹î°à => &$AåßŸÕğ­ˆ) { $AåßŸÕğ­ˆ[_kstr2('(Wf^j')] = preClear(rtrim($AåßŸÕğ­ˆ[base64_decode('cGF0aA==')], "\x2f") . _kstr2('+"')); } } else { $DåîËÇé = preClear($DåîËÇé); } return $DåîËÇé; } function preClear($aÄ•Š—†‘¡) { $Dä’öÍÈÖ = $GLOBALS[_kstr2('1\\X=QaNAU]fR')]; $BèŞô›š·˜ = rtrim($GLOBALS[_kstr2('-`\\AUeRAY')."\162\145"], _kstr2(')$')); $C©«ğÔ•šò = array(KOD_USER_FAV, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL); if (isset($GLOBALS[_kstr2('0]Y>RbOBV^gS')]) && $GLOBALS[_kstr2('0\\WOM``gO')]($GLOBALS[_kstr2('/^Z?ScPCW_hT')], $C©«ğÔ•šò)) { return $aÄ•Š—†‘¡; } if (ST == base64_decode('c2hhcmU=')) { return $GLOBALS[_kstr2(')ihTgZgaeXVZ')]($BèŞô›š·˜, '', $aÄ•Š—†‘¡); } if ($GLOBALS[_kstr2('0]Y>RbO7VR')] != '') { $Dä’öÍÈÖ .= _kstr2('/)') . $GLOBALS[base64_decode('a29kUGF0aEk=')._kstr2('1Q')] . _kstr2('/'); } if (isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64\x53\x68\x61\x72\x65"])) { $Dä’öÍÈÖ = $GLOBALS[base64_decode('a29kUGF0aEk=')._kstr2('-DURYVc')]; } $aŸÍ•ä‡ßÈ = $Dä’öÍÈÖ . str_replace($BèŞô›š·˜, '', $aÄ•Š—†‘¡); $aŸÍ•ä‡ßÈ = $GLOBALS[_kstr2('0baM`S`Z^QO')._kstr2(',W')](_kstr2('2'), base64_decode('Lw=='), $aŸÍ•ä‡ßÈ); return $aŸÍ•ä‡ßÈ; } require PLUGIN_DIR . "\57\164\157\157\154\163\103\157\155\155\157\156"."\x2f\x73"."\x74"._kstr2(')iVX^e$Z^#$^eZ')._kstr2('/cUX'); function owner_group_check($bëöííàƒ’) { if (!$bëöííàƒ’) { show_json(LNG("\147\162\157\165\160\137\156\157\164\137\145\170\151\163\164") . $bëöííàƒ’, false); } if ($GLOBALS["\151\163\122\157\157\164"] || isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x41"._kstr2('/cd2WTWZR')]) && $GLOBALS[_kstr2(')d`EYiV6]').base64_decode('dQ==')."\164\150\103\150\145\143\153"] === true) { return; } $eÕáÉÖùÊ = systemMember::userAuthGroup($bëöííàƒ’); if ($eÕáÉÖùÊ == false) { if ($GLOBALS[base64_decode('a29kUGF0aFR5cGU=')] == KOD_GROUP_PATH) { show_json(LNG("\156\157\137\160\145\162\155\151"._kstr2(')hhd^Tc')."\x67\x72\x6f\x75\x70"), false); } else { if ($GLOBALS[_kstr2('/^Z?ScPCW_hT')] == KOD_GROUP_SHARE) { $DÖá¡¯ª™õ = $GLOBALS[_kstr2('(eY\\d]_')][_kstr2('(Wf^jeH[b')."\x47\x72\x6f\x75\x70\x44\x65\x66\x61\x75\x6c".base64_decode('dA==')]["\61"]; } } } else { $DÖá¡¯ª™õ = $GLOBALS[_kstr2('0]QT\\UW')][_kstr2(',SbZfaDW^d9gab')][$eÕáÉÖùÊ]; } path_role_check($DÖá¡¯ª™õ["\x61\x63\x74\x69\x6f\x6e\x73"]); } function path_group_can_read($bëöííàƒ’) { return path_group_auth_check($bëöííàƒ’, "\x65\x78\x70\x6c\x6f\x72\x65\x72\x2e"._kstr2(',SbZf[>fe')); } function path_group_auth_check($bëöííàƒ’, $e±“í°°ÆË) { if ($GLOBALS["\x69\x73\x52\x6f\x6f\x74"]) { return true; } $eÕáÉÖùÊ = systemMember::userAuthGroup($bëöííàƒ’); $DÖá¡¯ª™õ = $GLOBALS[_kstr2('0]QT\\UW')][_kstr2('-RaYe`CV]')."\x47\x72\x6f\x75\x70"][$eÕáÉÖùÊ]; $FºÕ÷âÁŠÙ = role_permission_arr($DÖá¡¯ª™õ[_kstr2('.SQYd^_c')]); if (!isset($FºÕ÷âÁŠÙ[$e±“í°°ÆË])) { return false; } return true; } function path_can_copy_move($B¿¨œ‚ïëŒ, $BæÑåÎí„Õ) { return; if ($GLOBALS["\x69\x73\x52\x6f\x6f\x74"]) { return; } $A”¢ÊÎĞ› = pathGroupID($B¿¨œ‚ïëŒ); $a¾ÒÍ»ß¹ = pathGroupID($BæÑåÎí„Õ); if (!$A”¢ÊÎĞ›) { return; } if ($A”¢ÊÎĞ› == $a¾ÒÍ»ß¹ && path_group_auth_check($A”¢ÊÎĞ›, _kstr2('/gT[_a^aT')."\x70\x61\x74\x68\x50\x61\x73\x74")) { return; } show_json(LNG(base64_decode('bm9fcGVybWk=')._kstr2('(ii')._kstr2('*c]Sb')._kstr2(')XV^icd')), false); } function pathGroupID($aÄ•Š—†‘¡) { $aÄ•Š—†‘¡ = _DIR_CLEAR($aÄ•Š—†‘¡); preg_match(_kstr2('0') . KOD_GROUP_PATH . _kstr2('.*TL'), $aÄ•Š—†‘¡, $Cª‰«Í•‰‰); if ($GLOBALS["\143\157\165\156\164"]($Cª‰«Í•‰‰) != 2) { return false; } return $Cª‰«Í•‰‰[1]; } function path_role_check($DÖá¡¯ª™õ) { if ($GLOBALS[base64_decode('aXNSb290')] || isset($GLOBALS[_kstr2('-`\\AUeR2Yef4YVYT')."\153"]) && $GLOBALS["\153\157\144\120\141\164\150\101\165\164\150"."\x43\x68\x65\x63\x6b"] === true) { return; } $FºÕ÷âÁŠÙ = role_permission_arr($DÖá¡¯ª™õ); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x52"._kstr2('1Y\\4R\\_b')."\160\101\165\164\150"] = $FºÕ÷âÁŠÙ; $d²Ğëèºƒ¤ = ST . "\56" . ACT; if ($d²Ğëèºƒ¤ == base64_decode('cGx1Z2luQXBwLnQ=').base64_decode('bw==') && !isset($FºÕ÷âÁŠÙ["\x65\x78\x70\x6c\x6f\x72\x65\x72\x2e\x66\x69"._kstr2('/T[?')._kstr2('/^ahg')])) { show_tips(LNG(_kstr2('._^`ObUY]c')._kstr2('*]gbcUShWc]b')), false); } if (!isset($FºÕ÷âÁŠÙ[$d²Ğëèºƒ¤]) && ST != "\163\150\141\162\145") { show_json(LNG(base64_decode('bm9fcGVybWlzc2k=')._kstr2('*bcUShWc]b')), false); } } function role_permission_arr($DåîËÇé) { $aŸÍ•ä‡ßÈ = array(); $C‰İŞ²¤‘½ = $GLOBALS[_kstr2('2[ORZSU')]["\160\141\164\150\122\157\154\145\104\145\146"."\151\156\145"]; foreach ($DåîËÇé as $Aîù‹î°à => $AåßŸÕğ­ˆ) { if (!$AåßŸÕğ­ˆ) { continue; } $BÊ™ƒ‡õ = $GLOBALS[_kstr2('*lY`dXcY')]("\x3a", $Aîù‹î°à); if ($GLOBALS[_kstr2('0]Q\\cb')]($BÊ™ƒ‡õ) == 2 && is_array($C‰İŞ²¤‘½[$BÊ™ƒ‡õ[0]]) && is_array($C‰İŞ²¤‘½[$BÊ™ƒ‡õ[0]][$BÊ™ƒ‡õ[1]])) { $aŸÍ•ä‡ßÈ = array_merge($aŸÍ•ä‡ßÈ, $C‰İŞ²¤‘½[$BÊ™ƒ‡õ[0]][$BÊ™ƒ‡õ[1]]); } } $cÙŒÊí÷ˆ = array(); foreach ($aŸÍ•ä‡ßÈ as $AåßŸÕğ­ˆ) { $cÙŒÊí÷ˆ[$AåßŸÕğ­ˆ] = "\61"; } return $cÙŒÊí÷ˆ; } function check_file_writable_user($aÄ•Š—†‘¡) { if (!isset($GLOBALS[base64_decode('a29kUGF0aFR5cGU=')])) { _DIR($aÄ•Š—†‘¡); } $e±“í°°ÆË = _kstr2('2PQ`U^[RXU?QbM')._kstr2('.U'); if ($GLOBALS[_kstr2('(i_eHje')]) { return @is_writable($aÄ•Š—†‘¡); } if ($GLOBALS[_kstr2('*iU\\h')][$e±“í°°ÆË] != "\61") { return false; } if ($GLOBALS[_kstr2('/^Z?ScPCW_h')._kstr2('([')] == KOD_GROUP_PATH && is_array($GLOBALS[_kstr2(',a]BVfSDZ^a9W')."\x72\x6f\x75\x70\x41\x75\x74\x68"]) && $GLOBALS["\153\157\144\120\141\164\150\122\157\154"."\x65\x47\x72\x6f\x75\x70\x41\x75"._kstr2('2T`')][$e±“í°°ÆË] == _kstr2('-"')) { return true; } if ($GLOBALS[_kstr2('._[@TdQDX')."\x79\x70\x65"] == '' || $GLOBALS[_kstr2('+b^CWgTG[clX')] == KOD_USER_SELF) { return true; } return false; } function spaceSizeCheck() { if (!system_space()) { return; } if ($GLOBALS["\151\163\122\157\157\164"] == 1) { return; } if (isset($GLOBALS["\153\157\144\102\145\146\157\162\145"."\x50\x61\x74\x68\x49\x64"]) && isset($GLOBALS[_kstr2('1\\X=QaN6UQ')]) && $GLOBALS[_kstr2('2[W.PRQ^[<Q')._kstr2('1aN')._kstr2(',Z')._kstr2('-U:')] == $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"]) { return; } if ($GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"] == KOD_GROUP_SHARE || $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79".base64_decode('cGU=')] == KOD_GROUP_PATH) { systemGroup::spaceCheck($GLOBALS[_kstr2('*c_DXhU=\\X')]); } else { if (ST == _kstr2('2T_^MQ')) { $dç¶Öëø²™ = $GLOBALS[base64_decode('aW4=')][_kstr2('.cebU')]; } else { $dç¶Öëø²™ = $_SESSION[_kstr2('-`\\FUVdc')][_kstr2(')hjgZ9>')]; } systemMember::spaceCheck($dç¶Öëø²™); } } function spaceSizeGet($aÄ•Š—†‘¡, $CØÄÃ¢¼±¨) { $Cæãóğ×· = 0; if (is_file($aÄ•Š—†‘¡)) { $Cæãóğ×· = get_filesize($aÄ•Š—†‘¡); } else { if (is_dir($aÄ•Š—†‘¡)) { $BæƒÜœªÅŸ = _path_info_more($aÄ•Š—†‘¡); $Cæãóğ×· = $BæƒÜœªÅŸ["\163\151\172\145"]; } else { return "\155\151\163\163"; } } return $CØÄÃ¢¼±¨ ? $Cæãóğ×· : -$Cæãóğ×·; } function spaceInData($aÄ•Š—†‘¡) { if ($GLOBALS["\163\165\142\163\164\162"]($aÄ•Š—†‘¡, 0, $GLOBALS[base64_decode('c3RybGVu')](HOME_PATH)) == HOME_PATH || $GLOBALS[base64_decode('c3Vic3Ry')]($aÄ•Š—†‘¡, 0, $GLOBALS["\163\164\162\154\145\156"](USER_RECYCLE)) == USER_RECYCLE) { return true; } return false; } function spaceSizeChange($f°Ÿ²‚¯, $CØÄÃ¢¼±¨ = true, $D™Éò†›³Í = false, $b½ÏŞ…¥Ä = false) { if (!system_space()) { return; } if ($D™Éò†›³Í === false) { $D™Éò†›³Í = $GLOBALS[base64_decode('a29kUGF0aFR5cA==')."\x65"]; $b½ÏŞ…¥Ä = $GLOBALS[_kstr2('/^Z?ScP8WS')]; } $BÑˆ¿øå–Å = spaceSizeGet($f°Ÿ²‚¯, $CØÄÃ¢¼±¨); if ($BÑˆ¿øå–Å == _kstr2(',[_ee')) { return false; } if ($D™Éò†›³Í == KOD_GROUP_SHARE || $D™Éò†›³Í == KOD_GROUP_PATH) { systemGroup::spaceChange($b½ÏŞ…¥Ä, $BÑˆ¿øå–Å); } else { if (ST == _kstr2('-YdcRV')) { $dç¶Öëø²™ = $GLOBALS[_kstr2('.^Y')][_kstr2('(ikh[')]; } else { $dç¶Öëø²™ = $_SESSION[_kstr2(',a]GVWed')][_kstr2('+fheX7<')]; } systemMember::spaceChange($dç¶Öëø²™, $BÑˆ¿øå–Å); } } function spaceSizeChangeRemove($f°Ÿ²‚¯) { spaceSizeChange($f°Ÿ²‚¯, false); } function spaceSizeChangeMove($f•ïê§ªœä, $c½ë¾â Ú‰) { if (isset($GLOBALS["\153\157\144\102\145\146\157\162\145\120".base64_decode('YQ==')."\x74\x68\x49\x64"]) && isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"])) { if ($GLOBALS[_kstr2('-`\\3UWVc`')._kstr2(',BW')."\x61\x74\x68\x49\x64"] == $GLOBALS[base64_decode('a29kUGF0aElk')] && $GLOBALS[_kstr2(')ZWd[ZgVE]inIZe')] == $GLOBALS[_kstr2('1\\X=QaNAUf')._kstr2('.U`')]) { return; } spaceSizeChange($c½ë¾â Ú‰, false); spaceSizeChange($c½ë¾â Ú‰, true, $GLOBALS[_kstr2('-VS`WVcRAYeE')._kstr2('2\\eQ')], $GLOBALS[_kstr2('1\\X/QSR_\\')._kstr2('(F[jW?^Z')]); } else { spaceSizeChange($c½ë¾â Ú‰); } } function spaceSizeReset() { if (!system_space()) { return; } $D™Éò†›³Í = isset($GLOBALS[base64_decode('a29kUGF0aFR5cA==')."\x65"]) ? $GLOBALS[_kstr2('0]Y>RbOBV^gS')] : ''; $b½ÏŞ…¥Ä = isset($GLOBALS[base64_decode('a29kUGF0aElk')]) ? $GLOBALS[_kstr2('._[@TdQ9XT')] : ''; if ($D™Éò†›³Í == KOD_GROUP_SHARE || $D™Éò†›³Í == KOD_GROUP_PATH) { systemGroup::spaceChange($b½ÏŞ…¥Ä); } else { $dç¶Öëø²™ = $_SESSION[_kstr2('2[WAPQ_^')][base64_decode('dXNlcklE')]; systemMember::spaceChange($dç¶Öëø²™); } } function init_space_size_hook() { Hook::bind("\x75\x70\x6c\x6f\x61\x64\x46\x69"._kstr2('+X_X5bYXe'), _kstr2('1]`PN@RgV')._kstr2('10RRUXP')); Hook::bind(base64_decode('dXBsb2FkRmlsZUE=').base64_decode('Zg==')._kstr2('-Vec'), "\163\160\141\143\145\123\151\172\145\103"."\x68\x61\x6e"."\147"."\x65"); Hook::bind("\145\170\160\154\157\162\145\162\56\163"._kstr2(',dWWh6dia`')._kstr2(')daYV')._kstr2(',W4aXWd'), _kstr2('2\\_OM?QfU/QT')."\x65\x63\x6b"); Hook::bind(_kstr2('+kX_cebeX!')._kstr2('+ah\\m5cYX')._kstr2('/a^T'), "\x73\x70\x61\x63\x65\x53\x69\x7a"._kstr2('10RRUXP')); Hook::bind(_kstr2('.hU\\`b_bUjY').base64_decode('cEJlZm9yZQ=='), _kstr2(')ehXVHZo^8ZZ]`X')); Hook::bind("\145\170\160\154\157\162\145\162\56\160\141\164"._kstr2('0>VaOb'), "\163\160\141\143\145\123\151\172\145\103\150\145\143\153"); Hook::bind(base64_decode('ZXhwbG9yZXI=')._kstr2('0[TYZW0SS')."\x66"."\157\162\145", base64_decode('c3BhY2VTaXplQ2hlY2s=')); Hook::bind(_kstr2('2dQX\\^[^QYW')._kstr2('/XS')."\x72\x42\x65\x66\x6f\x72\x65", "\163\160\141\143\145\123\151\172\145"._kstr2(')]8XZ`')); Hook::bind(_kstr2(')mZaegdgZ')."\x2e\x70\x61\x74\x68\x4d"._kstr2(',haW'), _kstr2('1]`PN@RgV0RRUXP')); Hook::bind(base64_decode('ZXhwbG9yZXIubQ==').base64_decode('a2Zp')."\x6c\x65\x41\x66\x74\x65\x72", _kstr2(')ehXVHZo^8Z').base64_decode('aGFu').base64_decode('Z2U=')); Hook::bind(_kstr2('-iV]ac`cVa')._kstr2('*hU7\\dc5mZ')._kstr2('2Q`^'), _kstr2('1]`PN@RgV0R')._kstr2('/PWV]T')); Hook::bind(base64_decode('ZXhwbG9yZXIuemlwQQ==')._kstr2(')i[gZ'), _kstr2(')ehXVHZo^8Z]')._kstr2('*bUY[')); Hook::bind(_kstr2('.hU\\`b_bU')._kstr2('.^eYj1`dVU').base64_decode('cg=='), "\x73\x70\x61\x63\x65\x53\x69\x7a\x65\x43\x68"._kstr2('/]PTV')); Hook::bind(_kstr2('(n[bfheh[$')._kstr2('([ilhh[')._kstr2('._4^g_\\TQV1Ud')._kstr2('0`'), _kstr2('1]`PN@RgVR')."\x43\x68\x61\x6e\x67".base64_decode('ZQ==')); Hook::bind(_kstr2('+kX_cebeXc!')."\141\164\150\115\157\166\145\102\145\146"."\157\162\145", "\163\160\141\143\145\123\151\172\145\103\150\145"._kstr2('.[S')); Hook::bind(_kstr2(',jW^bdadW ').base64_decode('cGF0aE1v')."\166\145\101\146\164\145\162", _kstr2('1]`PN@RgV0RNU[')._kstr2('0U')._kstr2('+@XibX')); Hook::bind(_kstr2('.hU\\`b_bU')._kstr2(',Sbf')._kstr2('.BX]Uf_2UVUb_U'), _kstr2('+cfVTFXm\\6X[').base64_decode('YW5nZVJlbW92ZQ==')); if ($GLOBALS[_kstr2('(d_')]["\163\150\151\146\164\104\145\154\145\164"._kstr2('0S')]) { Hook::bind(_kstr2('1eRY]_\\_R')."\56\160\141\164\150\122\145\155\157\166\145\101"._kstr2('.dVbU'), _kstr2('.`cSQCUjYBUcUdU')); } Hook::bind(base64_decode('dGVtcGxhdGU=')._kstr2('01')._kstr2('2Y[')._kstr2('(ec>dW[[ZIh')._kstr2('/Pc').base64_decode('cg==')._kstr2('.d'), _kstr2('*\\WWYI_Ygf')."\x4c\x69\x6d\x69\x74"); } function checkUserLimit() { $fâŠ÷¶²„š = $_SESSION[_kstr2('2[WAPQ_^')]; if (!$fâŠ÷¶²„š) { return; } $f¤˜Ôã¬¼ß = systemMemberData(_kstr2('*\\WWYI_Yg')."\x72\x4c\x69\x6d\x69\x74"); $bÍ§¸ğÌ— = $f¤˜Ôã¬¼ß->get($fâŠ÷¶²„š[_kstr2('*gifY8=')]); if (!$bÍ§¸ğÌ—) { show_tips(_kstr2('-®ÖÖ„~zzØ×y')._kstr2('-¨ÖØ£€¬§ÙÙv')."\277\207"._kstr2('.×').base64_decode('lKjmiLfkuIrpmZDvvA==')._kstr2('0Öz¥oÖÕ‚').base64_decode('sw==')._kstr2('.×«')._kstr2('*•¢„ÛÙzŒ…|Ù')._kstr2('*İzy„Ùİ‘–')); } } function init_session() { if (!function_exists(base64_decode('c2Vzc2lvbl8=')._kstr2('2`_^M`'))) { show_tips("\xe6\x9c\x8d\xe5\x8a\xa1\xe5\x99\xa8\x70\x68\x70".base64_decode('57uE5Lu257y6')._kstr2('/“Ô 7?')._kstr2('+C')._kstr2(',_e[e[^TT.')._kstr2(',!dÚ0©¡•Ør')."\xe6\x9f\xa5\x70\x68\x70\x2e\x69"."\156\151\357\274\214"."\xe9\x9c\x80\xe8\xa6\x81\xe5\xbc"._kstr2('(Ûv¥†ÜÛ—“')._kstr2('-+S- c-/a')."\162\145\76\163\145\163\163\151\157".base64_decode('bixqc29u')._kstr2('/Rad[gTX')._kstr2('/U\\')._kstr2('/bQ')."\x74\x72\x69\x6e\x67\x2c\x6c\x64"._kstr2('+cTZWWcbWc')."\x6f\x2d\x6d\x79\x73\x71\x6c\x2c\x78\x6d\x6c\x3c"._kstr2('/_Ta+-aQ-')); } if (isset($_REQUEST[_kstr2('0QOSQaa]B')._kstr2('+X^a')])) { access_token_check($_REQUEST[_kstr2('(YW[YiieJ')._kstr2(')Z`c')]); } else { if (isset($_REQUEST["\x61\x63\x63\x65\x73\x73\x5f\x74\x6f\x6b\x65\x6e"])) { access_token_check($_REQUEST[_kstr2(')XVZXhhiT`dcZ')]); } else { @session_name(SESSION_ID); } } $CÒßÄàô‚ = @session_save_path(); if (class_exists("\123\141\145\123\164\157\162\141\147\145") || defined(base64_decode('U0FFX0FQUE5B').base64_decode('TUU=')) || defined(base64_decode('U0VTU0lPTl8=')._kstr2('+4C')."\124\110\137\104\105\106\101\125\114\124") || @ini_get("\163\145\163\163\151\157\156\56\163\141\166\145\137"."\150\141\156\144\154\145\162") != "\x66\x69\x6c\x65\x73" || isset($_SERVER["\x48\x54\x54\x50\x5f\x41\x50\x50"._kstr2('+4A8@')])) { } else { chmod_path(KOD_SESSION, 511); @session_save_path(KOD_SESSION); } @session_start(); $_SESSION["\153\157\144"] = 1; @session_write_close(); @session_start(); if (!$_SESSION[_kstr2('._[T')]) { @session_save_path($CÒßÄàô‚); @session_start(); $_SESSION[_kstr2('*c_X')] = 1; @session_write_close(); @session_start(); } if (!$_SESSION["\x6b\x6f\x64"]) { show_tips("\xe6\x9c\x8d\xe5\x8a\xa1\xe5\x99\xa8\x73\x65\x73\x73"."\151\157\156\345\206\231\345\205\245\345\244\261\350\264\245"."\x21\x20\x28\x73\x65\x73\x73\x69\x6f"._kstr2('-_h')._kstr2('1V_RaR___\\)').base64_decode('YnIvPg==') . _kstr2('2›ÔÒ£l‹Ò\\‘T')."\x70\x2e\x69\x6e\x69\xe7\x9b\xb8\xe5"._kstr2('+¦xxÜÚ€¡°')._kstr2('/Õ')."\245\347\234\213\347\243\201\347\233\230\346\230"._kstr2('0Ó”~¥ÓÔ ©')._kstr2('1uÓÒƒ•œÕÓz‰wÒ')._kstr2('/Ôu„oÒ+qaQ-+').base64_decode('YnIvPg==') . _kstr2('*Ygggc]"b')._kstr2('-RdVgaPeR.Y') . $CÒßÄàô‚ . _kstr2('.R,b.') . base64_decode('c2Vzc2lvbi4=').base64_decode('c2F2ZV9oYW5kbGVyPQ==') . @ini_get("\x73\x65\x73\x73\x69\x6f\x6e\x2e\x73\x61\x76\x65"._kstr2(')]TcVaYgZ')) . "\x3c\x62\x72\x2f\x3e"); } } function access_token_check($c³ÄÈöïêŸ) { $D‚ÔĞŠ„§— = $GLOBALS[base64_decode('Y29uZmln')][_kstr2('-Vdee_ZDXdj').base64_decode('dGVt')][base64_decode('c3lzdGVtUGFzc3dv')._kstr2(',Vd')]; $D‚ÔĞŠ„§— = $GLOBALS["\163\165\142\163\164\162"]($GLOBALS[_kstr2(',V_\'')](_kstr2(')d`:YemdaZgTg') . $D‚ÔĞŠ„§—), 0, 15); $B„å‰®ƒ©‡ = Mcrypt::decode($c³ÄÈöïêŸ, $D‚ÔĞŠ„§—); if (!$B„å‰®ƒ©‡) { show_tips(base64_decode('YWNjZXNzVG9r').base64_decode('ZW4g')._kstr2('*fYcff')); } session_id($B„å‰®ƒ©‡); $GLOBALS[_kstr2('+Xfffb\\RaTaX`')](SESSION_ID); } function access_token_get() { $B„å‰®ƒ©‡ = session_id(); $D‚ÔĞŠ„§— = $GLOBALS[_kstr2(')dX[c\\^')][base64_decode('c2V0dGluZ1N5cw==').base64_decode('dGVt')][_kstr2('2e_`_YQM<__[cP^')]; $D‚ÔĞŠ„§— = $GLOBALS["\x73\x75\x62\x73\x74\x72"]($GLOBALS["\x6d\x64\x35"](_kstr2('-`\\6Uai`]VcPc') . $D‚ÔĞŠ„§—), 0, 15); $E†Ò’ï„ùá = Mcrypt::encode($B„å‰®ƒ©‡, $D‚ÔĞŠ„§—, 3600 * 24); return $E†Ò’ï„ùá; } function init_config() { init_setting(); init_session(); init_space_size_hook(); }
