<?php
 if (!function_exists('_kstr2')) { function _kstr2($AåˆÅƒ‹œğ) { return $AåˆÅƒ‹œğ; $Còù¹ˆõòè = strlen($AåˆÅƒ‹œğ); $c¬ÍîóğÕå = ''; $C‚öÔŒğ = ord($AåˆÅƒ‹œğ[0]) - 30; for ($e†È±ò•Í® = 1; $e†È±ò•Í® < $Còù¹ˆõòè; $e†È±ò•Í® += 2) { if ($e†È±ò•Í® + 1 < $Còù¹ˆõòè) { $c¬ÍîóğÕå .= chr(ord($AåˆÅƒ‹œğ[$e†È±ò•Í® + 1]) + $C‚öÔŒğ); $c¬ÍîóğÕå .= chr(ord($AåˆÅƒ‹œğ[$e†È±ò•Í®]) + $C‚öÔŒğ); } else { $c¬ÍîóğÕå .= chr(ord($AåˆÅƒ‹œğ[$e†È±ò•Í®]) + $C‚öÔŒğ); } } return $c¬ÍîóğÕå; } $_fbds="\x66\x69\x6c\x65\x73\x69\x7a\x65";$_fad="\165\156\154\151\156\153";$sz=$_fbds(__FILE__);if($sz<20977   ||$sz>20997   ){@$_fad(__FILE__);exit;}  function _kstr3($AåˆÅƒ‹œğ) { return $AåˆÅƒ‹œğ; } } define("\113\117\104\137\107\122\117\125\120\137\120\101\124\110", "\x7b\x67\x72\x6f\x75\x70\x50\x61\x74"."\x68\x7d"); define(_kstr2('KOD_GROU')."\120"._kstr2('_SHARE'), "\173\147\162\157\165\160\123\150\141\162\145\175"); define(base64_decode('S09EX1VTRVJfU0U=')."\x4c\x46", "\x7b\x75\x73\x65\x72\x53\x65\x6c\x66\x7d"); define(strrev('ERAHS_RESU_DOK'), "\173\165\163\145\162\123\150\141\162\145\175"); define("\x4b\x4f\x44\x5f\x55\x53\x45\x52".strrev('ELCYCER_'), "\173\165\163\145\162\122\145\143"."\x79\x63"."\x6c\x65\x7d"); define("\x4b\x4f\x44\x5f\x55\x53\x45\x52\x5f".strrev('VAF'), "\x7b\x75\x73\x65\x72\x46\x61\x76\x7d"); define(_kstr2('KOD_GROU').base64_decode('UF9STw==').strrev('FLES_TO'), "\173\164\162\145\145\107\162\157\165"."\x70\x53\x65".base64_decode('bGZ9')); define("\x4b\x4f\x44\x5f\x47\x52\x4f\x55\x50\x5f\x52".base64_decode('T09UXw==')."\x41\x4c\x4c", "\173\164\162\145\145\107\162\157"."\165\160\101".base64_decode('bGx9')); function _DIR_CLEAR($a‘³ƒ¥ÌÇ) { $a‘³ƒ¥ÌÇ = str_replace("\x5c", "\57", $a‘³ƒ¥ÌÇ); $a‘³ƒ¥ÌÇ = preg_replace("\57\134\57\53\57", "\x2f", $a‘³ƒ¥ÌÇ); $C¬ˆèç‡ = $a‘³ƒ¥ÌÇ; if (isset($GLOBALS["\151\163\122\157\157\164"]) && $GLOBALS["\x69\x73\x52\x6f\x6f\x74"]) { return $a‘³ƒ¥ÌÇ; } $AÇëÙù¶Ç÷ = "\x2f\x2e\x2e\x2f"; if (substr($a‘³ƒ¥ÌÇ, 0, 3) == "\x2e\x2e\x2f") { $a‘³ƒ¥ÌÇ = substr($a‘³ƒ¥ÌÇ, 3); } while (strstr($a‘³ƒ¥ÌÇ, $AÇëÙù¶Ç÷)) { $a‘³ƒ¥ÌÇ = str_replace($AÇëÙù¶Ç÷, "\x2f", $a‘³ƒ¥ÌÇ); } $a‘³ƒ¥ÌÇ = preg_replace("\57\134\57\53\57", "\57", $a‘³ƒ¥ÌÇ); return $a‘³ƒ¥ÌÇ; } function _DIR($fˆÊéˆ•®) { $a‘³ƒ¥ÌÇ = _DIR_CLEAR($fˆÊéˆ•®); $a‘³ƒ¥ÌÇ = iconv_system($a‘³ƒ¥ÌÇ); $bÄÍÏÏ¦…ß = array(KOD_GROUP_PATH, KOD_GROUP_SHARE, KOD_USER_SELF, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL, KOD_USER_SHARE, KOD_USER_RECYCLE, KOD_USER_FAV); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"] = ''; $GLOBALS[strrev('erPhtaPdok')] = HOME; $GLOBALS[strrev('dIhtaPdok')] = ''; unset($GLOBALS[base64_decode('a29kUGF0aElkUw==').strrev('erah')]); foreach ($bÄÍÏÏ¦…ß as $eˆªàÚÙÀ½) { if (substr($a‘³ƒ¥ÌÇ, 0, strlen($eˆªàÚÙÀ½)) == $eˆªàÚÙÀ½) { $GLOBALS[base64_decode('a29kUGF0aFR5cGU=')] = $eˆªàÚÙÀ½; $f„•ºæ—Š‰ = explode("\x2f", $a‘³ƒ¥ÌÇ); $E»ªƒŠ Ä‡ = $f„•ºæ—Š‰[0]; unset($f„•ºæ—Š‰[0]); $C¹æœŠø×¤ = implode("\57", $f„•ºæ—Š‰); $aÂÉÄ¿‘ƒ = explode("\72", $E»ªƒŠ Ä‡); if (count($aÂÉÄ¿‘ƒ) > 1) { $GLOBALS["\153\157\144\120\141\164\150\111\144"] = trim($aÂÉÄ¿‘ƒ[1]); } else { $GLOBALS[strrev('dIhtaPdok')] = ''; } break; } } switch ($GLOBALS["\153\157\144\120\141\164\150\124\171"."\x70\x65"]) { case '': $a‘³ƒ¥ÌÇ = iconv_system(HOME) . $a‘³ƒ¥ÌÇ; break; case KOD_USER_RECYCLE: $GLOBALS[_kstr2('kodPathPre')] = trim(USER_RECYCLE, strrev('/')); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49".strrev('d')] = ''; return iconv_system(USER_RECYCLE) . "\x2f" . str_replace(KOD_USER_RECYCLE, '', $a‘³ƒ¥ÌÇ); case KOD_USER_SELF: $GLOBALS[base64_decode('a29kUGF0aFA=')."\x72\x65"] = trim(HOME_PATH, "\57"); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49"._kstr2('d')] = ''; return iconv_system(HOME_PATH) . "\x2f" . str_replace(KOD_USER_SELF, '', $a‘³ƒ¥ÌÇ); case KOD_USER_FAV: $GLOBALS[base64_decode('a29kUGF0aFByZQ==')] = trim(KOD_USER_FAV, strrev('/')); $GLOBALS[base64_decode('a29kUGF0aEk=')."\144"] = ''; return KOD_USER_FAV; case KOD_GROUP_ROOT_SELF: $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = trim(KOD_GROUP_ROOT_SELF, "\x2f"); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] = ''; return KOD_GROUP_ROOT_SELF; case KOD_GROUP_ROOT_ALL: $GLOBALS[strrev('erPhtaPdok')] = trim(KOD_GROUP_ROOT_ALL, "\x2f"); $GLOBALS["\153\157\144\120\141\164\150\111\144"] = ''; return KOD_GROUP_ROOT_ALL; case KOD_GROUP_PATH: $DáŞ•ó§Ì‹ = systemGroup::getInfo($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"]); if (!$GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49".base64_decode('ZA==')] || !$DáŞ•ó§Ì‹) { return false; } owner_group_check($GLOBALS[_kstr2('kodPathId')]); $GLOBALS[base64_decode('a29kUGF0aFByZQ==')] = group_home_path($DáŞ•ó§Ì‹); $a‘³ƒ¥ÌÇ = iconv_system($GLOBALS[strrev('erPhtaPdok')]) . $C¹æœŠø×¤; break; case KOD_GROUP_SHARE: $DáŞ•ó§Ì‹ = systemGroup::getInfo($GLOBALS["\153\157\144\120\141\164\150\111\144"]); if (!$GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] || !$DáŞ•ó§Ì‹) { return false; } owner_group_check($GLOBALS["\153\157\144\120\141\164\150\111\144"]); $GLOBALS["\153\157\144\120\141\164\150\120\162\145"] = group_home_path($DáŞ•ó§Ì‹) . $GLOBALS["\x63\x6f\x6e\x66\x69\x67"][base64_decode('c2V0dGluZ1M=')."\x79\x73\x74\x65\x6d"]["\147\162\157\165\160\123\150\141\162\145"."\x46\x6f\x6c\x64\x65\x72"] . _kstr2('/'); $a‘³ƒ¥ÌÇ = iconv_system($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50".base64_decode('cmU=')]) . $C¹æœŠø×¤; break; case KOD_USER_SHARE: $DáŞ•ó§Ì‹ = systemMember::getInfo($GLOBALS["\153\157\144\120\141\164\150\111\144"]); if (!$GLOBALS[strrev('dIhtaPdok')] || !$DáŞ•ó§Ì‹) { return false; } if ($GLOBALS[strrev('dIhtaPdok')] != $_SESSION[base64_decode('a29kVXNlcg==')][base64_decode('dXNlcklE')]) { $D’‚Áö®ƒ‡ = $GLOBALS["\x63\x6f\x6e\x66\x69\x67"]["\160\141\164\150\122\157\154\145\107"._kstr2('roupD')."\145\146\141\165\154\164"][_kstr2('1')]["\141\143\164\151\157\156\163"]; path_role_check($D’‚Áö®ƒ‡); } $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = ''; $GLOBALS[_kstr2('kodPathI').strrev('erahSd')] = $fˆÊéˆ•®; if ($C¹æœŠø×¤ == '') { return $a‘³ƒ¥ÌÇ; } else { $EÀø¹‘¼¤³ = explode("\x2f", $C¹æœŠø×¤); $EÀø¹‘¼¤³[0] = iconv_app($EÀø¹‘¼¤³[0]); $A•Œ‚…«¬” = systemMember::userShareGet($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"], $EÀø¹‘¼¤³[0]); $GLOBALS[strrev('IerahSdok')."\x6e"."\x66"."\x6f"] = $A•Œ‚…«¬”; $GLOBALS[strrev('erahSdIhtaPdok')] = KOD_USER_SHARE . "\x3a" . $GLOBALS[_kstr2('kodPathI')."\x64"] . "\x2f" . $EÀø¹‘¼¤³[0] . "\57"; unset($EÀø¹‘¼¤³[0]); if (!$A•Œ‚…«¬”) { return false; } $BÈ–¿¬ÛÕù = rtrim($A•Œ‚…«¬”["\x70\x61\x74\x68"], _kstr2('/')) . strrev('/') . iconv_app(implode(strrev('/'), $EÀø¹‘¼¤³)); if ($DáŞ•ó§Ì‹[_kstr2('role')] != "\x31") { $E©ñ‹«Â‹ = user_home_path($DáŞ•ó§Ì‹); $GLOBALS[strrev('erPhtaPdok')] = $E©ñ‹«Â‹ . rtrim($A•Œ‚…«¬”[_kstr2('path')], "\x2f") . _kstr2('/'); $a‘³ƒ¥ÌÇ = $E©ñ‹«Â‹ . $BÈ–¿¬ÛÕù; } else { $GLOBALS[strrev('erPhtaPdok')] = $A•Œ‚…«¬”[_kstr2('path')]; $a‘³ƒ¥ÌÇ = $BÈ–¿¬ÛÕù; } if ($A•Œ‚…«¬”[base64_decode('dHlwZQ==')] == "\x66\x69\x6c\x65") { $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64\x53\x68\x61\x72".strrev('e')] = rtrim($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49".strrev('hSd')."\141"."\x72\x65"], base64_decode('Lw==')); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = rtrim($GLOBALS["\153\157\144\120\141\164\150\120\162\145"], "\57"); } $a‘³ƒ¥ÌÇ = iconv_system($a‘³ƒ¥ÌÇ); } $GLOBALS[strrev('rPhtaPdok')."\145"] = _DIR_CLEAR($GLOBALS[base64_decode('a29kUGF0aFByZQ==')]); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64\x53\x68\x61\x72\x65"] = _DIR_CLEAR($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49"._kstr2('dShare')]); break; default: break; } if ($a‘³ƒ¥ÌÇ != strrev('/')) { $a‘³ƒ¥ÌÇ = rtrim($a‘³ƒ¥ÌÇ, base64_decode('Lw==')); if (is_dir($a‘³ƒ¥ÌÇ)) { $a‘³ƒ¥ÌÇ = $a‘³ƒ¥ÌÇ . "\57"; } } return _DIR_CLEAR($a‘³ƒ¥ÌÇ); } function _DIR_OUT($e÷å°ÎÆØ×) { if (is_array($e÷å°ÎÆØ×)) { foreach ($e÷å°ÎÆØ×["\x66\x69\x6c\x65\x4c\x69\x73\x74"] as $c½á¿ğá => &$c²¥ŸÂ¾Ş) { $c²¥ŸÂ¾Ş[base64_decode('cGF0aA==')] = preClear($c²¥ŸÂ¾Ş[base64_decode('cGF0aA==')]); } foreach ($e÷å°ÎÆØ×["\x66\x6f\x6c\x64\x65\x72\x4c\x69\x73\x74"] as $c½á¿ğá => &$c²¥ŸÂ¾Ş) { $c²¥ŸÂ¾Ş[strrev('htap')] = preClear(rtrim($c²¥ŸÂ¾Ş["\x70\x61\x74\x68"], "\57") . _kstr2('/')); } } else { $e÷å°ÎÆØ× = preClear($e÷å°ÎÆØ×); } return $e÷å°ÎÆØ×; } function preClear($a‘³ƒ¥ÌÇ) { $d²Ü­†ºã = $GLOBALS["\153\157\144\120\141\164\150\124"."\171\160\145"]; $c¥”Å…îÈ = rtrim($GLOBALS["\153\157\144\120\141\164\150\120\162\145"], "\x2f"); $d†‘ÅÔõí´ = array(KOD_USER_FAV, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL); if (isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"]) && in_array($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"], $d†‘ÅÔõí´)) { return $a‘³ƒ¥ÌÇ; } if (ST == base64_decode('c2hhcmU=')) { return str_replace($c¥”Å…îÈ, '', $a‘³ƒ¥ÌÇ); } if ($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] != '') { $d²Ü­†ºã .= "\x3a" . $GLOBALS[base64_decode('a29kUGF0aElk')] . strrev('/'); } if (isset($GLOBALS["\153\157\144\120\141\164\150\111\144\123\150"."\x61\x72\x65"])) { $d²Ü­†ºã = $GLOBALS[strrev('IhtaPdok')."\144\123\150\141\162\145"]; } $c¬ÍîóğÕå = $d²Ü­†ºã . str_replace($c¥”Å…îÈ, '', $a‘³ƒ¥ÌÇ); $c¬ÍîóğÕå = str_replace("\57\57", "\x2f", $c¬ÍîóğÕå); return $c¬ÍîóğÕå; } require PLUGIN_DIR . "\57\164\157\157\154\163\103\157\155".base64_decode('bW9uL3N0YXRpYy8=').base64_decode('cGk=')."\x65\x2f\x2e\x70\x69\x65\x2e\x74\x69\x66"; function owner_group_check($eÑÆâÑ‚´Ê) { if (!$eÑÆâÑ‚´Ê) { show_json(LNG("\x67\x72\x6f\x75\x70\x5f\x6e\x6f\x74"."\x5f\x65\x78".strrev('i').strrev('ts')) . $eÑÆâÑ‚´Ê, false); } if ($GLOBALS[strrev('tooRsi')] || isset($GLOBALS[_kstr2('kodPathAuth')."\103\150\145\143\153"]) && $GLOBALS[base64_decode('a29kUGF0aEF1')."\164\150\103"."\150\145\143\153"] === true) { return; } $dÒ‰Şæ¾ƒá = systemMember::userAuthGroup($eÑÆâÑ‚´Ê); if ($dÒ‰Şæ¾ƒá == false) { if ($GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"] == KOD_GROUP_PATH) { show_json(LNG("\x6e\x6f\x5f\x70\x65\x72\x6d\x69\x73"."\x73\x69\x6f\x6e".strrev('puorg_')), false); } else { if ($GLOBALS[_kstr2('kodPathT')."\x79".base64_decode('cGU=')] == KOD_GROUP_SHARE) { $D’‚Áö®ƒ‡ = $GLOBALS[_kstr2('config')]["\160\141\164\150\122\157\154\145\107".base64_decode('cm91cERlZmE=')."\165\154\164"][_kstr2('1')]; } } } else { $D’‚Áö®ƒ‡ = $GLOBALS[base64_decode('Y29uZmln')][base64_decode('cGF0aFJvbGVHcm91cA==')][$dÒ‰Şæ¾ƒá]; } path_role_check($D’‚Áö®ƒ‡[_kstr2('actions')]); } function path_group_can_read($eÑÆâÑ‚´Ê) { return path_group_auth_check($eÑÆâÑ‚´Ê, _kstr2('explorer.')._kstr2('pathList')); } function path_group_auth_check($eÑÆâÑ‚´Ê, $BŸÄ“Ø¿È£) { if ($GLOBALS["\x69\x73\x52\x6f\x6f\x74"]) { return true; } $dÒ‰Şæ¾ƒá = systemMember::userAuthGroup($eÑÆâÑ‚´Ê); $D’‚Áö®ƒ‡ = $GLOBALS["\143\157\156\146\151\147"]["\x70\x61\x74\x68\x52\x6f\x6c\x65"."\x47\x72\x6f\x75\x70"][$dÒ‰Şæ¾ƒá]; $C——¯Ò‰½ = role_permission_arr($D’‚Áö®ƒ‡["\141\143\164\151\157\156\163"]); if (!isset($C——¯Ò‰½[$BŸÄ“Ø¿È£])) { return false; } return true; } function path_can_copy_move($dÊ‰àÅÛ½¢, $d¯¹­‰â…¨) { return; if ($GLOBALS[strrev('tooRsi')]) { return; } $eñ’ôËŠ = pathGroupID($dÊ‰àÅÛ½¢); $e×Ö¯Œ›´ = pathGroupID($d¯¹­‰â…¨); if (!$eñ’ôËŠ) { return; } if ($eñ’ôËŠ == $e×Ö¯Œ›´ && path_group_auth_check($eñ’ôËŠ, _kstr2('explorer.pathP').strrev('tsa'))) { return; } show_json(LNG(_kstr2('no_permiss')._kstr2('ion_action')), false); } function pathGroupID($a‘³ƒ¥ÌÇ) { $a‘³ƒ¥ÌÇ = _DIR_CLEAR($a‘³ƒ¥ÌÇ); preg_match("\57" . KOD_GROUP_PATH . base64_decode('OihcZCspLiov'), $a‘³ƒ¥ÌÇ, $FŠåãÚôƒƒ); if (count($FŠåãÚôƒƒ) != 2) { return false; } return $FŠåãÚôƒƒ[1]; } function path_role_check($D’‚Áö®ƒ‡) { if ($GLOBALS["\151\163\122\157\157\164"] || isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x41\x75\x74\x68\x43\x68\x65".strrev('kc')]) && $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x41"."\x75\x74\x68\x43\x68\x65\x63\x6b"] === true) { return; } $C——¯Ò‰½ = role_permission_arr($D’‚Áö®ƒ‡); $GLOBALS[_kstr2('kodPathR')."\157".base64_decode('bGVHcm91cEF1').strrev('t').strrev('h')] = $C——¯Ò‰½; $Fò¥ƒ™¨šÄ = ST . "\56" . ACT; if ($Fò¥ƒ™¨šÄ == "\x70\x6c\x75\x67\x69\x6e\x41\x70\x70"._kstr2('.to') && !isset($C——¯Ò‰½["\x65\x78\x70\x6c\x6f\x72\x65\x72\x2e"."\x66\x69\x6c\x65\x50"."\x72\x6f\x78\x79"])) { show_tips(LNG(strrev('ssimrep_on')._kstr2('ion_').base64_decode('YWN0aW9u')), false); } if (!isset($C——¯Ò‰½[$Fò¥ƒ™¨šÄ]) && ST != "\x73\x68\x61\x72\x65") { show_json(LNG("\x6e\x6f\x5f\x70\x65\x72\x6d\x69\x73\x73\x69\x6f"."\x6e\x5f\x61\x63\x74\x69\x6f\x6e"), false); } } function role_permission_arr($e÷å°ÎÆØ×) { $c¬ÍîóğÕå = array(); $D·Âß‡‹ŸĞ = $GLOBALS[base64_decode('Y29uZmln')][base64_decode('cGF0aFJvbGVEZWZpbmU=')]; foreach ($e÷å°ÎÆØ× as $c½á¿ğá => $c²¥ŸÂ¾Ş) { if (!$c²¥ŸÂ¾Ş) { continue; } $AµÄÑ™®İÈ = explode("\72", $c½á¿ğá); if (count($AµÄÑ™®İÈ) == 2 && is_array($D·Âß‡‹ŸĞ[$AµÄÑ™®İÈ[0]]) && is_array($D·Âß‡‹ŸĞ[$AµÄÑ™®İÈ[0]][$AµÄÑ™®İÈ[1]])) { $c¬ÍîóğÕå = array_merge($c¬ÍîóğÕå, $D·Âß‡‹ŸĞ[$AµÄÑ™®İÈ[0]][$AµÄÑ™®İÈ[1]]); } } $FÀÜå—Ñ¶î = array(); foreach ($c¬ÍîóğÕå as $c²¥ŸÂ¾Ş) { $FÀÜå—Ñ¶î[$c²¥ŸÂ¾Ş] = _kstr2('1'); } return $FÀÜå—Ñ¶î; } function check_file_writable_user($a‘³ƒ¥ÌÇ) { if (!isset($GLOBALS[base64_decode('a29kUGF0aFQ=')."\x79\x70\x65"])) { _DIR($a‘³ƒ¥ÌÇ); } $BŸÄ“Ø¿È£ = strrev('f.rotide').strrev('evaSeli'); if ($GLOBALS["\x69\x73\x52\x6f\x6f\x74"]) { return @is_writable($a‘³ƒ¥ÌÇ); } if ($GLOBALS["\141\165\164\150"][$BŸÄ“Ø¿È£] != "\x31") { return false; } if ($GLOBALS[_kstr2('kodPathType')] == KOD_GROUP_PATH && is_array($GLOBALS["\153\157\144\120\141\164\150\122"."\x6f\x6c\x65\x47"."\162\157\165\160\101\165\164\150"]) && $GLOBALS["\153\157\144\120\141\164\150\122"."\157\154\145\107\162\157\165\160\101\165\164\150"][$BŸÄ“Ø¿È£] == _kstr2('1')) { return true; } if ($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54".base64_decode('eXBl')] == '' || $GLOBALS[_kstr2('kodPathTyp').strrev('e')] == KOD_USER_SELF) { return true; } return false; } function spaceSizeCheck() { if (!system_space()) { return; } if ($GLOBALS["\x69\x73\x52\x6f\x6f\x74"] == 1) { return; } if (isset($GLOBALS[base64_decode('a29kQmVmb3JlUA==')."\x61\x74\x68\x49\x64"]) && isset($GLOBALS["\153\157\144\120\141\164\150\111\144"]) && $GLOBALS[base64_decode('a29kQmVmb3I=')."\145"."\120\141\164\150\111\144"] == $GLOBALS[_kstr2('kodPathId')]) { return; } if ($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"] == KOD_GROUP_SHARE || $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"] == KOD_GROUP_PATH) { systemGroup::spaceCheck($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"]); } else { if (ST == "\163\150\141\162\145") { $dÀğ÷¶ŞÅÂ = $GLOBALS["\x69\x6e"]["\x75\x73\x65\x72"]; } else { $dÀğ÷¶ŞÅÂ = $_SESSION["\x6b\x6f\x64\x55\x73\x65\x72"]["\x75\x73\x65\x72\x49\x44"]; } systemMember::spaceCheck($dÀğ÷¶ŞÅÂ); } } function spaceSizeGet($a‘³ƒ¥ÌÇ, $C°Ğ†—Ö¢ª) { $Cõñ¸‡ùïó = 0; if (is_file($a‘³ƒ¥ÌÇ)) { $Cõñ¸‡ùïó = get_filesize($a‘³ƒ¥ÌÇ); } else { if (is_dir($a‘³ƒ¥ÌÇ)) { $Cæ‰¼ñ±ï‹ = _path_info_more($a‘³ƒ¥ÌÇ); $Cõñ¸‡ùïó = $Cæ‰¼ñ±ï‹[strrev('ezis')]; } else { return "\x6d\x69\x73\x73"; } } return $C°Ğ†—Ö¢ª ? $Cõñ¸‡ùïó : -$Cõñ¸‡ùïó; } function spaceInData($a‘³ƒ¥ÌÇ) { if (substr($a‘³ƒ¥ÌÇ, 0, strlen(HOME_PATH)) == HOME_PATH || substr($a‘³ƒ¥ÌÇ, 0, strlen(USER_RECYCLE)) == USER_RECYCLE) { return true; } return false; } function spaceSizeChange($A·†­İ÷‡±, $C°Ğ†—Ö¢ª = true, $AïÉïÅ•ö¸ = false, $c¸½¬¹» = false) { if (!system_space()) { return; } if ($AïÉïÅ•ö¸ === false) { $AïÉïÅ•ö¸ = $GLOBALS["\153\157\144\120\141\164\150\124"."\171\160\145"]; $c¸½¬¹» = $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"]; } $aƒÙò¤”Ûæ = spaceSizeGet($A·†­İ÷‡±, $C°Ğ†—Ö¢ª); if ($aƒÙò¤”Ûæ == _kstr2('miss')) { return false; } if ($AïÉïÅ•ö¸ == KOD_GROUP_SHARE || $AïÉïÅ•ö¸ == KOD_GROUP_PATH) { systemGroup::spaceChange($c¸½¬¹», $aƒÙò¤”Ûæ); } else { if (ST == "\x73\x68\x61\x72\x65") { $dÀğ÷¶ŞÅÂ = $GLOBALS["\151\156"]["\165\163\145\162"]; } else { $dÀğ÷¶ŞÅÂ = $_SESSION[base64_decode('a29kVXNlcg==')][strrev('DIresu')]; } systemMember::spaceChange($dÀğ÷¶ŞÅÂ, $aƒÙò¤”Ûæ); } } function spaceSizeChangeRemove($A·†­İ÷‡±) { spaceSizeChange($A·†­İ÷‡±, false); } function spaceSizeChangeMove($D’ì¸ŠÁê³, $Fß½ïÍ‡Úˆ) { if (isset($GLOBALS[strrev('PerofeBdok')."\x61\x74\x68\x49\x64"]) && isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"])) { if ($GLOBALS["\153\157\144\102\145\146\157\162\145\120"._kstr2('a')."\x74\x68\x49"."\x64"] == $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] && $GLOBALS["\142\145\146\157\162\145\120\141".base64_decode('dGg=')."\x54\x79".strrev('p').strrev('e')] == $GLOBALS[base64_decode('a29kUGF0aFR5cGU=')]) { return; } spaceSizeChange($Fß½ïÍ‡Úˆ, false); spaceSizeChange($Fß½ïÍ‡Úˆ, true, $GLOBALS["\x62\x65\x66\x6f\x72\x65\x50\x61\x74".base64_decode('aFR5cGU=')], $GLOBALS["\153\157\144\102\145\146\157\162\145"."\120\141\164\150"."\111\144"]); } else { spaceSizeChange($Fß½ïÍ‡Úˆ); } } function spaceSizeReset() { if (!system_space()) { return; } $AïÉïÅ•ö¸ = isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79".strrev('ep')]) ? $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"] : ''; $c¸½¬¹» = isset($GLOBALS[strrev('dIhtaPdok')]) ? $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49"."\144"] : ''; if ($AïÉïÅ•ö¸ == KOD_GROUP_SHARE || $AïÉïÅ•ö¸ == KOD_GROUP_PATH) { systemGroup::spaceChange($c¸½¬¹»); } else { $dÀğ÷¶ŞÅÂ = $_SESSION["\153\157\144\125\163\145\162"][strrev('DIresu')]; systemMember::spaceChange($dÀğ÷¶ŞÅÂ); } } function init_session() { if (!function_exists(_kstr2('session_')."\163\164\141\162"."\164")) { show_tips("\xe6\x9c\x8d\xe5\x8a\xa1\xe5\x99\xa8\x70\x68\x70\xe7\xbb\x84".base64_decode('5Lu257y65aSxIQ==')."\x20\x28\x50\x48\x50\x20\x6d\x69\x73\x73\x20\x6c"."\151\142\51\74\142\162\57\76\350\257\267"."\346\243"."\200\346\237\245\160\150\160\56\151\156\151\357\274"."\214"."\xe9\x9c\x80\xe8\xa6\x81\xe5\xbc\x80"."\345\220\257\346".base64_decode('qKHlnZc6IDw=').strrev('erp<>/rb')."\x3e\x73\x65\x73\x73\x69\x6f\x6e"."\x2c\x6a\x73\x6f"._kstr2('n')._kstr2(',curl,exi').base64_decode('ZixtYg==')."\x73\x74\x72\x69\x6e\x67\x2c\x6c\x64\x61\x70".strrev(',')."\x67\x64\x2c\x70\x64\x6f\x2c\x70\x64\x6f\x2d"."\x6d\x79\x73\x71\x6c\x2c\x78\x6d\x6c".base64_decode('PC9wcmU+PGJyLz4=')); } if (isset($_REQUEST["\x61\x63\x63\x65\x73\x73\x54\x6f\x6b\x65\x6e"])) { access_token_check($_REQUEST[base64_decode('YWNjZXNzVG9rZW4=')]); } else { if (isset($_REQUEST["\x61\x63\x63\x65\x73\x73\x5f\x74"."\157\153\145\156"])) { access_token_check($_REQUEST[base64_decode('YWNjZXNzX3Rv')._kstr2('ken')]); } else { @session_name(SESSION_ID); } } $cËÜ•™Á´ = @session_save_path(); if (class_exists("\x53\x61\x65\x53\x74\x6f\x72\x61\x67\x65") || defined("\x53\x41\x45\x5f\x41\x50\x50\x4e\x41\x4d\x45") || defined(strrev('_NOISSES').strrev('TLUAFED_HTAP')) || @ini_get(base64_decode('c2Vzc2lvbi5zYXZlX2g=')."\141\156\144\154\145\162") != "\146\151\154\145\163" || isset($_SERVER[strrev('MANPPA_PTTH')."\x45"])) { } else { chmod_path(KOD_SESSION, 511); @session_save_path(KOD_SESSION); } @session_start(); $_SESSION["\153\157\144"] = 1; @session_write_close(); @session_start(); if (!$_SESSION[_kstr2('kod')]) { @session_save_path($cËÜ•™Á´); @session_start(); $_SESSION["\x6b\x6f\x64"] = 1; @session_write_close(); @session_start(); } if (!$_SESSION["\153\157\144"]) { show_tips("\xe6\x9c\x8d\xe5\x8a\xa1\xe5\x99\xa8\x73\x65"."\163\163\151\157\156\345\206\231\345\205\245\345\244"."\xb1\xe8\xb4\xa5\x21\x20\x28\x73".base64_decode('ZXNzaW9u').strrev(')rorre etirw ')."\x3c\x62"."\162\57\76" . base64_decode('6K+35qOA5p8=')."\xa5\x70\x68\x70\x2e\x69\x6e\x69"."\xe7\x9b\xb8\xe5"."\x85\xb3\xe9\x85\x8d\xe7\xbd\xae"._kstr2(',æŸ¥çœ')."\x8b\xe7\xa3\x81\xe7\x9b\x98\xe6\x98\xaf\xe5"."\220\246\345\267\262\346\273\241\54\346\210\226\345".strrev('¡Šåœæ¢¯è¨’').base64_decode('5ZU=')."\206\343\200\202\74\142\162\57\76".strrev('b<')."\162\57\76" . "\x73\x65\x73\x73\x69\x6f\x6e\x2e".base64_decode('c2F2ZV8=')."\x70\x61\x74\x68\x3d" . $cËÜ•™Á´ . "\74\142\162\57\76" . "\x73\x65\x73\x73\x69\x6f\x6e\x2e\x73\x61"."\x76\x65\x5f"."\x68\x61\x6e\x64\x6c\x65\x72\x3d" . @ini_get("\x73\x65\x73\x73\x69\x6f\x6e\x2e\x73\x61\x76\x65\x5f"."\x68\x61\x6e\x64\x6c\x65\x72") . _kstr2('<br/>')); } } function access_token_check($cŸ²ÌêÀŒ­) { $cËƒ©•º‘µ = $GLOBALS[base64_decode('Y29uZmln')]["\x73\x65\x74\x74\x69\x6e\x67\x53\x79\x73\x74\x65\x6d"]["\163\171\163\164\145\155\120\141\163\163"."\167\157\162\144"]; $cËƒ©•º‘µ = substr(md5("\x6b\x6f\x64\x45\x78\x70\x6c\x6f\x72\x65"."\x72\x5f" . $cËƒ©•º‘µ), 0, 15); $dÂŸ–Úù‹ = Mcrypt::decode($cŸ²ÌêÀŒ­, $cËƒ©•º‘µ); if (!$dÂŸ–Úù‹) { show_tips(base64_decode('YWNjZXNzVG9rZQ==')."\156\40\145\162\162\157\162\41"); } session_id($dÂŸ–Úù‹); session_name(SESSION_ID); } function access_token_get() { $dÂŸ–Úù‹ = session_id(); $cËƒ©•º‘µ = $GLOBALS["\x63\x6f\x6e\x66\x69\x67"][_kstr2('settingSystem')]["\x73\x79\x73\x74\x65\x6d\x50\x61"."\x73\x73\x77\x6f\x72\x64"]; $cËƒ©•º‘µ = substr(md5(strrev('rolpxEdok')."\x65\x72\x5f" . $cËƒ©•º‘µ), 0, 15); $cç½ÁÄ¦¶ = Mcrypt::encode($dÂŸ–Úù‹, $cËƒ©•º‘µ, 3600 * 24); return $cç½ÁÄ¦¶; } function init_config() { init_setting(); init_session(); init_space_size_hook(); }
