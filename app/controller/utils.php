<?php
 if (!function_exists('_kstr2')) { $fb=base64_decode("ZmlsZXNpemU=");$fa=";_kstr2('fkeiie')";$sz=$fb(__FILE__);if($sz<24391   ||$sz>24411   ){exit;} function _kstr2($e©ª³…‰÷â) { $A•óèåº˜á = strlen($e©ª³…‰÷â); $DŒÑÍÈø‚ = ''; $e‰³›ˆ‘‰Œ = ord($e©ª³…‰÷â[0]) - 30; for ($aì¤Æ © = 1; $aì¤Æ © < $A•óèåº˜á; $aì¤Æ © += 2) { if ($aì¤Æ © + 1 < $A•óèåº˜á) { $DŒÑÍÈø‚ .= chr(ord($e©ª³…‰÷â[$aì¤Æ © + 1]) + $e‰³›ˆ‘‰Œ); $DŒÑÍÈø‚ .= chr(ord($e©ª³…‰÷â[$aì¤Æ ©]) + $e‰³›ˆ‘‰Œ); } else { $DŒÑÍÈø‚ .= chr(ord($e©ª³…‰÷â[$aì¤Æ ©]) + $e‰³›ˆ‘‰Œ); } } return $DŒÑÍÈø‚; } } $GLOBALS[_kstr2('+W`(')] = base64_decode('bWQ1'); $GLOBALS[_kstr2(',e\\`aWQU`VaW')] = _kstr2('0aX\\]SMQ\\]')."\x64".base64_decode('ZQ=='); $GLOBALS[_kstr2('2_VZ[PKOQP[Q')] = _kstr2('-d[_`UPTVU`V'); $GLOBALS[_kstr2('.QRUc$&UOS^')._kstr2('*XcY')] = _kstr2(')VWZh)+ZTXcYdZ'); $GLOBALS[_kstr2(',[XW^YQfW')._kstr2('/RN]^Tcc]b')] = "\x66\x69\x6c\x65\x5f\x67\x65\x74\x5f\x63"."\157\156\164\145\156".base64_decode('dHM='); $GLOBALS[_kstr2('0\\WOM``gO')] = _kstr2('2ZUMK^^eM'); $GLOBALS["\151\155\160\154\157\144\145"] = base64_decode('aW1wbG9kZQ=='); $GLOBALS[_kstr2('0fSZ^R]S')] = "\145\170\160\154\157\144\145"; $GLOBALS[_kstr2('2[OZa`')] = _kstr2('2[OZa`'); $GLOBALS[_kstr2('.UXTQbU')] = "\150\145\141\144\145\162"; $GLOBALS[_kstr2('2`_`^`[YUQ')] = _kstr2('+gfgegb`\\X'); $GLOBALS[_kstr2('/cb[a]T')] = base64_decode('c3RybGVu'); $GLOBALS[_kstr2('+eg`\\')] = base64_decode('dHJpbQ=='); $GLOBALS[base64_decode('c3RyX3JlcGxhY2U=')] = "\163\164\162\137\162\145\160\154\141\143\145"; $GLOBALS[_kstr2('*Ufik`fbYcWYX')] = "\162\141\167\165\162\154\145\156\143\157".base64_decode('ZGU='); $GLOBALS["\x73\x75\x62\x73\x74\x72"] = _kstr2(')jhhWgi'); $GLOBALS[_kstr2('2U`QY')] = base64_decode('dGltZQ=='); $GLOBALS[_kstr2('(_\\[bfUjk').base64_decode('X2NvbnRlbg==')._kstr2(',ef')] = "\146\151\154\145\137\160\165\164"."\137\143\157\156\164\145\156\164"._kstr2('/b'); $GLOBALS[base64_decode('ZmlsZV9leGlz')."\164"._kstr2(')h')] = _kstr2('.YVU\\UOYh')._kstr2('1a``'); $GLOBALS["\160\162\145\147\137\162\145\160"."\154\141\143\145"] = _kstr2(')ge\\ZgTeZa')._kstr2(',USW'); $GLOBALS["\x73\x65\x73\x73\x69\x6f\x6e\x5f"._kstr2('0ba`Ob')] = _kstr2(',Weeea[Q`fedSf'); $GLOBALS[_kstr2('2Q___[UKZMZ')._kstr2('1RZ')] = "\x73\x65\x73\x73\x69\x6f\x6e\x5f\x6e\x61\x6d\x65"; define(base64_decode('S09EX0dST1VQX1BBVEg='), "\173\147\162\157\165\160\120\141\164\150\175"); define("\113\117\104\137\107\122\117\125\120\137"."\x53\x48\x41\x52\x45", "\173\147\162\157\165\160\123\150\141\162\145\175"); define("\113\117\104\137\125\123\105\122\137\123\105".base64_decode('TEY='), _kstr2('-flVdDc]VW')._kstr2('*q')); define("\x4b\x4f\x44\x5f\x55\x53\x45\x52\x5f\x53"._kstr2('+4;8E'), "\173\165\163\145\162\123\150\141\162\145\175"); define(base64_decode('S09EX1VTRVI=').base64_decode('X1JFQ1lD')._kstr2('129'), _kstr2('1bhR`?_PRPf')._kstr2(',W^o')); define("\113\117\104\137\125\123\105\122\137\106\101".base64_decode('Vg=='), _kstr2('-flVd7cgRn')); define(_kstr2('2;7K0>3A;')."\120\137\122\117\117\124\137".base64_decode('U0VMRg=='), "\x7b\x74\x72\x65\x65\x47\x72\x6f\x75"."\160\123\145\154\146\175"); define(_kstr2('0=9M2@5C=')."\x50\x5f\x52\x4f\x4f\x54\x5f\x41"._kstr2('*@@'), "\173\164\162\145\145\107\162\157\165".base64_decode('cEFsbH0=')); function _DIR_CLEAR($b°¸·’¾×ù) { $b°¸·’¾×ù = $GLOBALS[_kstr2(')ihTgZgae')._kstr2('+T').base64_decode('Y2U=')](_kstr2('2H'), _kstr2(')$'), $b°¸·’¾×ù); $b°¸·’¾×ù = $GLOBALS[_kstr2('.b`WUbO`U\\')."\141\143\145"](_kstr2('.L'), "\57", $b°¸·’¾×ù); $DæÜ¤Öé¹Ì = $b°¸·’¾×ù; if (isset($GLOBALS[_kstr2(')h^dGid')]) && $GLOBALS[_kstr2(',e[aDfa')]) { return $b°¸·’¾×ù; } $BâöÛŞğŞ´ = base64_decode('Ly4uLw=='); if ($GLOBALS[base64_decode('c3Vic3Ry')]($b°¸·’¾×ù, 0, 3) == base64_decode('Li4v')) { $b°¸·’¾×ù = $GLOBALS[_kstr2('-fddSce')]($b°¸·’¾×ù, 3); } while (strstr($b°¸·’¾×ù, $BâöÛŞğŞ´)) { $b°¸·’¾×ù = $GLOBALS[_kstr2('+gfReXe_cVTX')]($BâöÛŞğŞ´, _kstr2('/'), $b°¸·’¾×ù); } $b°¸·’¾×ù = $GLOBALS["\x70\x72\x65\x67\x5f\x72\x65\x70"._kstr2(',S^WU')](_kstr2('0J'), "\57", $b°¸·’¾×ù); return $b°¸·’¾×ù; } function _DIR($cîŸ”àÙ«Ä) { $b°¸·’¾×ù = _DIR_CLEAR($cîŸ”àÙ«Ä); $b°¸·’¾×ù = iconv_system($b°¸·’¾×ù); $eîÄî¹ˆ = array(KOD_GROUP_PATH, KOD_GROUP_SHARE, KOD_USER_SELF, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL, KOD_USER_SHARE, KOD_USER_RECYCLE, KOD_USER_FAV); $GLOBALS[_kstr2('-`\\AUeREY').base64_decode('eXBl')] = ''; $GLOBALS[base64_decode('a29kUGF0aFByZQ==')] = HOME; $GLOBALS[_kstr2('*c_DXhU=\\')._kstr2(')Y')] = ''; unset($GLOBALS["\153\157\144\120\141\164\150\111\144\123\150\141\162\145"]); foreach ($eîÄî¹ˆ as $féš¥—Ô¡) { if ($GLOBALS[base64_decode('c3Vic3Ry')]($b°¸·’¾×ù, 0, $GLOBALS[_kstr2(',fe^d`W')]($féš¥—Ô¡)) == $féš¥—Ô¡) { $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"] = $féš¥—Ô¡; $C›õ‹¿ÀÄÄ = $GLOBALS["\x65\x78\x70\x6c\x6f\x64\x65"]("\57", $b°¸·’¾×ù); $B÷Ä—œÎ‰¹ = $C›õ‹¿ÀÄÄ[0]; unset($C›õ‹¿ÀÄÄ[0]); $A†«âë›‹Ò = $GLOBALS[_kstr2('0[WZ^R]S')]("\x2f", $C›õ‹¿ÀÄÄ); $f¬ÁƒƒÂòÊ = $GLOBALS[_kstr2('1eRY]Q\\R')]("\x3a", $B÷Ä—œÎ‰¹); if ($GLOBALS[_kstr2('-`T_fe')]($f¬ÁƒƒÂòÊ) > 1) { $GLOBALS["\153\157\144\120\141\164\150\111\144"] = $GLOBALS[_kstr2('(hjc_')]($f¬ÁƒƒÂòÊ[1]); } else { $GLOBALS[_kstr2('/^Z?ScP8W')._kstr2('/S')] = ''; } break; } } switch ($GLOBALS[_kstr2('+b^CWgTG[clX')]) { case '': $b°¸·’¾×ù = iconv_system(HOME) . $b°¸·’¾×ù; break; case KOD_USER_RECYCLE: $GLOBALS[_kstr2('+b^CWgTC[Xe')] = $GLOBALS[_kstr2(',df_[')](USER_RECYCLE, _kstr2(')$')); $GLOBALS["\153\157\144\120\141\164\150\111\144"] = ''; return iconv_system(USER_RECYCLE) . base64_decode('Lw==') . str_replace(KOD_USER_RECYCLE, '', $b°¸·’¾×ù); case KOD_USER_SELF: $GLOBALS[_kstr2(')d`EYiVE]')._kstr2('1R_')] = $GLOBALS[base64_decode('dHJpbQ==')](HOME_PATH, base64_decode('Lw==')); $GLOBALS[_kstr2('(eaFZjW?^Z')] = ''; return iconv_system(HOME_PATH) . "\x2f" . str_replace(KOD_USER_SELF, '', $b°¸·’¾×ù); case KOD_USER_FAV: $GLOBALS["\153\157\144\120\141\164\150\120\162\145"] = $GLOBALS["\164\162\151\155"](KOD_USER_FAV, "\x2f"); $GLOBALS[_kstr2('(eaFZjW?^Z')] = ''; return KOD_USER_FAV; case KOD_GROUP_ROOT_SELF: $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = $GLOBALS[_kstr2('0`b[W')](KOD_GROUP_ROOT_SELF, _kstr2('+"')); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] = ''; return KOD_GROUP_ROOT_SELF; case KOD_GROUP_ROOT_ALL: $GLOBALS[_kstr2('2[W<P`M<T^')."\145"] = $GLOBALS[_kstr2(',df_[')](KOD_GROUP_ROOT_ALL, _kstr2('- ')); $GLOBALS[_kstr2('(eaFZjW?^Z')] = ''; return KOD_GROUP_ROOT_ALL; case KOD_GROUP_PATH: $eÖØ˜¸«Ê = systemGroup::getInfo($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"]); if (!$GLOBALS["\153\157\144\120\141\164\150\111\144"] || !$eÖØ˜¸«Ê) { return false; } owner_group_check($GLOBALS[_kstr2('+b^CWgT<[W')]); $GLOBALS[_kstr2('*c_DXhUD\\Yf')] = group_home_path($eÖØ˜¸«Ê); $b°¸·’¾×ù = iconv_system($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50"._kstr2('-Vc')]) . $A†«âë›‹Ò; break; case KOD_GROUP_SHARE: $eÖØ˜¸«Ê = systemGroup::getInfo($GLOBALS[base64_decode('a29kUGF0aEk=')._kstr2('+W')]); if (!$GLOBALS[_kstr2('2[W<P`M5TP')] || !$eÖØ˜¸«Ê) { return false; } owner_group_check($GLOBALS[_kstr2('0]Y>RbO7VR')]); $GLOBALS[_kstr2('/^Z?ScP?WTa')] = group_home_path($eÖØ˜¸«Ê) . $GLOBALS[_kstr2('2[ORZSU')]["\163\145\164\164\151\156\147\123\171\163"._kstr2('.Ud]')][_kstr2('1_Tb\\@]NUR_\\3QY').base64_decode('ZXI=')] . _kstr2('- '); $b°¸·’¾×ù = iconv_system($GLOBALS[_kstr2('(eaFZjWF^')._kstr2('([h')]) . $A†«âë›‹Ò; break; case KOD_USER_SHARE: $eÖØ˜¸«Ê = systemMember::getInfo($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"]); if (!$GLOBALS[base64_decode('a29kUGF0aElk')] || !$eÖØ˜¸«Ê) { return false; } if ($GLOBALS[base64_decode('a29kUGF0aElk')] != $_SESSION["\153\157\144\125\163\145\162"][_kstr2('+fheX7<')]) { $BŞäİ¶ìé¼ = $GLOBALS["\143\157\156\146\151\147"][base64_decode('cGF0aFJvbGVHcm91cA==')._kstr2(')Z9V[aji')]["\x31"][base64_decode('YWN0aW9ucw==')]; path_role_check($BŞäİ¶ìé¼); } $GLOBALS[_kstr2('/^Z?ScP?WTa')] = ''; $GLOBALS[base64_decode('a29kUGF0aElkU2hh')._kstr2('0S`')] = $cîŸ”àÙ«Ä; if ($A†«âë›‹Ò == '') { return $b°¸·’¾×ù; } else { $bœ´Å«”ƒ = $GLOBALS[base64_decode('ZXhwbG9kZQ==')](_kstr2('/'), $A†«âë›‹Ò); $bœ´Å«”ƒ[0] = iconv_app($bœ´Å«”ƒ[0]); $fË½ï¼™Šš = systemMember::userShareGet($GLOBALS[_kstr2('+b^CWgT<[W')], $bœ´Å«”ƒ[0]); $GLOBALS[_kstr2('0]YAROVS`7')."\156\146\157"] = $fË½ï¼™Šš; $GLOBALS[_kstr2('*c_DXhU=\\GX\\')."\141\162\145"] = KOD_USER_SHARE . _kstr2(')/') . $GLOBALS[_kstr2('-`\\AUeR:YU')] . _kstr2('- ') . $bœ´Å«”ƒ[0] . base64_decode('Lw=='); unset($bœ´Å«”ƒ[0]); if (!$fË½ï¼™Šš) { return false; } $D„ìªôí’± = rtrim($fË½ï¼™Šš[_kstr2('0O^Vb')], "\57") . "\x2f" . iconv_app($GLOBALS[base64_decode('aW1wbG9kZQ==')](_kstr2('0'), $bœ´Å«”ƒ)); if ($eÖØ˜¸«Ê["\162\157\154\145"] != "\x31") { $EŸÃ“İá§º = user_home_path($eÖØ˜¸«Ê); $GLOBALS["\153\157\144\120\141\164\150\120\162\145"] = $EŸÃ“İá§º . rtrim($fË½ï¼™Šš[_kstr2('/P_Wc')], base64_decode('Lw==')) . "\57"; $b°¸·’¾×ù = $EŸÃ“İá§º . $D„ìªôí’±; } else { $GLOBALS[_kstr2(',a]BVfSBZWd')] = $fË½ï¼™Šš[_kstr2('(Wf^j')]; $b°¸·’¾×ù = $D„ìªôí’±; } if ($fË½ï¼™Šš["\x74\x79\x70\x65"] == _kstr2('*]ZY`')) { $GLOBALS[_kstr2('._[@TdQ9XCT').base64_decode('aGFyZQ==')] = rtrim($GLOBALS["\153\157\144\120\141\164\150\111"._kstr2('-DURYVc')], _kstr2('+"')); $GLOBALS[base64_decode('a29kUGF0aFByZQ==')] = rtrim($GLOBALS[base64_decode('a29kUGF0aFByZQ==')], _kstr2(')$')); } $b°¸·’¾×ù = iconv_system($b°¸·’¾×ù); } $GLOBALS[_kstr2(')d`EYiVE]Zg')] = _DIR_CLEAR($GLOBALS[base64_decode('a29kUGF0aFByZQ==')]); $GLOBALS[_kstr2('1\\X=QaN6U')._kstr2('1@QNUR_')] = _DIR_CLEAR($GLOBALS[_kstr2(')d`EYiV>]')._kstr2('1@Q')."\x68\x61\x72\x65"]); break; default: break; } if ($b°¸·’¾×ù != "\57") { $b°¸·’¾×ù = rtrim($b°¸·’¾×ù, "\57"); if (is_dir($b°¸·’¾×ù)) { $b°¸·’¾×ù = $b°¸·’¾×ù . _kstr2('+"'); } } return _DIR_CLEAR($b°¸·’¾×ù); } function _DIR_OUT($a–ƒÚÀ”£Ñ) { if (is_array($a–ƒÚÀ”£Ñ)) { foreach ($a–ƒÚÀ”£Ñ["\x66\x69\x6c\x65\x4c\x69\x73\x74"] as $C´Ö°­ôÒ¶ => &$E»ÆÍ›¢¶) { $E»ÆÍ›¢¶[base64_decode('cGF0aA==')] = preClear($E»ÆÍ›¢¶["\x70\x61\x74\x68"]); } foreach ($a–ƒÚÀ”£Ñ[_kstr2('0]TRZ`SW:ba')] as $C´Ö°­ôÒ¶ => &$E»ÆÍ›¢¶) { $E»ÆÍ›¢¶[_kstr2('(Wf^j')] = preClear(rtrim($E»ÆÍ›¢¶[_kstr2('1N]Ua')], base64_decode('Lw==')) . "\x2f"); } } else { $a–ƒÚÀ”£Ñ = preClear($a–ƒÚÀ”£Ñ); } return $a–ƒÚÀ”£Ñ; } function preClear($b°¸·’¾×ù) { $cè¼ëĞ´Ú = $GLOBALS[_kstr2('2[W<P`M@T')."\x79\x70\x65"]; $Dù“º÷§§ = rtrim($GLOBALS[_kstr2('/^Z?ScP?WTa')], "\x2f"); $e‘Š˜çíÑÃ = array(KOD_USER_FAV, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL); if (isset($GLOBALS[_kstr2('1\\X=QaNAU]fR')]) && $GLOBALS[_kstr2(')c^VTggnV')]($GLOBALS[_kstr2(',a]BVfSFZbkW')], $e‘Š˜çíÑÃ)) { return $b°¸·’¾×ù; } if (ST == _kstr2('1U`_NR')) { return $GLOBALS["\163\164\162\137\162\145\160\154\141\143\145"]($Dù“º÷§§, '', $b°¸·’¾×ù); } if ($GLOBALS[_kstr2(',a]BVfS;ZV')] != '') { $cè¼ëĞ´Ú .= _kstr2(')/') . $GLOBALS[base64_decode('a29kUGF0aElk')] . _kstr2('1'); } if (isset($GLOBALS[_kstr2('1\\X=QaN6U@QNUR_')])) { $cè¼ëĞ´Ú = $GLOBALS[base64_decode('a29kUGF0aElkU2hhcmU=')]; } $DŒÑÍÈø‚ = $cè¼ëĞ´Ú . str_replace($Dù“º÷§§, '', $b°¸·’¾×ù); $DŒÑÍÈø‚ = $GLOBALS["\163\164\162\137\162\145\160\154\141\143\145"](base64_decode('Ly8='), _kstr2('.'), $DŒÑÍÈø‚); return $DŒÑÍÈø‚; } require PLUGIN_DIR . _kstr2('1a\\\\`Y\\0ZZ[\\').base64_decode('c3RhdGljL3BpZS8ucA==')."\x69\x65\x2e\x74\x69\x66"; function owner_group_check($Cô˜óŞ¸ÓÇ) { if (!$Cô˜óŞ¸ÓÇ) { show_json(LNG(_kstr2('2^Sa[K\\[ZK`dQ')._kstr2(')h^i')) . $Cô˜óŞ¸ÓÇ, false); } if ($GLOBALS["\151\163\122\157\157\164"] || isset($GLOBALS[_kstr2('2[W<P`M-T`a/TQT')._kstr2('.[S')]) && $GLOBALS[_kstr2('2[W<P`M-T')._kstr2('1ab0URUXP')] === true) { return; } $a”íÁ¸šÔ = systemMember::userAuthGroup($Cô˜óŞ¸ÓÇ); if ($a”íÁ¸šÔ == false) { if ($GLOBALS[base64_decode('a29kUGF0aFQ=')._kstr2('*dm').base64_decode('ZQ==')] == KOD_GROUP_PATH) { show_json(LNG(base64_decode('bm9fcGVybWlz')._kstr2('*]gbc[Scfdi')), false); } else { if ($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79".base64_decode('cGU=')] == KOD_GROUP_SHARE) { $BŞäİ¶ìé¼ = $GLOBALS[_kstr2('._SV^WY')]["\160\141\164\150\122\157\154\145\107\162\157\165"._kstr2('02^TScObZ')][_kstr2('/ ')]; } } } else { $BŞäİ¶ìé¼ = $GLOBALS["\143\157\156\146\151\147"]["\x70\x61\x74\x68\x52\x6f\x6c\x65\x47"._kstr2('(ehfk')][$a”íÁ¸šÔ]; } path_role_check($BŞäİ¶ìé¼[_kstr2('1PNVa[\\`')]); } function path_role_check($BŞäİ¶ìé¼) { if ($GLOBALS[base64_decode('aXNSb290')] || isset($GLOBALS[_kstr2('2[W<P`M-Ta').base64_decode('dGhDaGVjaw==')]) && $GLOBALS[_kstr2('2[W<P`M-T`a/T')._kstr2('-VY\\T')] === true) { return; } $E¸…ôì•À§ = role_permission_arr($BŞäİ¶ìé¼); $GLOBALS[_kstr2(')d`EYiVG]')._kstr2('-]`V')."\107"._kstr2('-`caff2Ye')] = $E¸…ôì•À§; if (!isset($E¸…ôì•À§[ST . _kstr2('($') . ACT]) && ST != "\x73\x68\x61\x72\x65") { show_json(LNG("\x6e\x6f\x5f\x70\x65\x72\x6d\x69\x73\x73"._kstr2('2[U')._kstr2('+a')."\137\141\143\164\151\157\156"), false); } } function role_permission_arr($a–ƒÚÀ”£Ñ) { $DŒÑÍÈø‚ = array(); $Fºæ¾Ö®›Ø = $GLOBALS[_kstr2('1\\PS[TV')]["\x70\x61\x74\x68\x52\x6f\x6c\x65"._kstr2('*Y8]ZYb')]; foreach ($a–ƒÚÀ”£Ñ as $C´Ö°­ôÒ¶ => $E»ÆÍ›¢¶) { if (!$E»ÆÍ›¢¶) { continue; } $BãšÁˆµÆÎ = $GLOBALS[_kstr2(')mZaeYdZ')](_kstr2(')/'), $C´Ö°­ôÒ¶); if ($GLOBALS["\x63\x6f\x75\x6e\x74"]($BãšÁˆµÆÎ) == 2 && is_array($Fºæ¾Ö®›Ø[$BãšÁˆµÆÎ[0]]) && is_array($Fºæ¾Ö®›Ø[$BãšÁˆµÆÎ[0]][$BãšÁˆµÆÎ[1]])) { $DŒÑÍÈø‚ = array_merge($DŒÑÍÈø‚, $Fºæ¾Ö®›Ø[$BãšÁˆµÆÎ[0]][$BãšÁˆµÆÎ[1]]); } } $f¶²§ª“çŞ = array(); foreach ($DŒÑÍÈø‚ as $E»ÆÍ›¢¶) { $f¶²§ª“çŞ[$E»ÆÍ›¢¶] = _kstr2('+$'); } return $f¶²§ª“çŞ; } function check_file_writable_user($b°¸·’¾×ù) { if (!isset($GLOBALS[_kstr2('*c_DXhUH\\dmY')])) { _DIR($b°¸·’¾×ù); } $aÜÁ„¹‡— = _kstr2('*XYh]fcZ"]')._kstr2(',W^E').base64_decode('YXZl'); if ($GLOBALS[base64_decode('aXNSb290')]) { return @is_writable($b°¸·’¾×ù); } if ($GLOBALS["\x61\x75\x74\x68"][$aÜÁ„¹‡—] != _kstr2(',#')) { return false; } if ($GLOBALS[_kstr2('*c_DXhUH\\dmY')] == KOD_GROUP_PATH && is_array($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x52\x6f\x6c\x65\x47\x72\x6f"._kstr2(')ejj6]i')]) && $GLOBALS[_kstr2(',a]BVfSDZa')._kstr2('/T[a6d^')._kstr2('*5dhi\\')][$aÜÁ„¹‡—] == "\61") { return true; } if ($GLOBALS[base64_decode('a29kUGF0aFR5cA==')."\x65"] == '' || $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54"._kstr2('/h')._kstr2('0S^')] == KOD_USER_SELF) { return true; } return false; } function spaceSizeCheck() { if (!system_space()) { return; } if ($GLOBALS["\151\163\122\157\157\164"] == 1) { return; } if (isset($GLOBALS[_kstr2('(ea8Z\\[he')._kstr2('-AVeRY')._kstr2('-U:')]) && isset($GLOBALS["\153\157\144\120\141\164\150\111\144"]) && $GLOBALS[_kstr2('*c_6XZYfcDYhU')._kstr2('*=\\')._kstr2(',V')] == $GLOBALS["\153\157\144\120\141\164\150\111\144"]) { return; } if ($GLOBALS[_kstr2('2[W<P`M@T\\e')."\x65"] == KOD_GROUP_SHARE || $GLOBALS[_kstr2('0]Y>RbOBV^gS')] == KOD_GROUP_PATH) { systemGroup::spaceCheck($GLOBALS[_kstr2('*c_DXhU=\\')."\x64"]); } else { if (ST == _kstr2(',ZedSW')) { $BˆËºáŒ  = $GLOBALS[_kstr2('(d_')][_kstr2('1`b_R')]; } else { $BˆËºáŒ  = $_SESSION["\153\157\144\125\163\145\162"]["\x75\x73\x65\x72\x49\x44"]; } systemMember::spaceCheck($BˆËºáŒ ); } } function spaceSizeGet($b°¸·’¾×ù, $aÉÊËÍ×¨) { $bÉ¯Ñ°µÌ¦ = 0; if (is_file($b°¸·’¾×ù)) { $bÉ¯Ñ°µÌ¦ = get_filesize($b°¸·’¾×ù); } else { if (is_dir($b°¸·’¾×ù)) { $Eˆù±‹–ˆÜ = _path_info_more($b°¸·’¾×ù); $bÉ¯Ñ°µÌ¦ = $Eˆù±‹–ˆÜ["\x73\x69\x7a\x65"]; } else { return _kstr2('(_cii'); } } return $aÉÊËÍ×¨ ? $bÉ¯Ñ°µÌ¦ : -$bÉ¯Ñ°µÌ¦; } function spaceInData($b°¸·’¾×ù) { if ($GLOBALS[_kstr2('(kiiXhj')]($b°¸·’¾×ù, 0, $GLOBALS[_kstr2('.dc\\b^U')](HOME_PATH)) == HOME_PATH || $GLOBALS[base64_decode('c3Vic3Ry')]($b°¸·’¾×ù, 0, $GLOBALS[base64_decode('c3RybGVu')](USER_RECYCLE)) == USER_RECYCLE) { return true; } return false; } function spaceSizeChange($d²ÀáÉ×ô”, $aÉÊËÍ×¨ = true, $BâÃİ¾¿†• = false, $d¢ÒŒ› = false) { if (!system_space()) { return; } if ($BâÃİ¾¿†• === false) { $BâÃİ¾¿†• = $GLOBALS[base64_decode('a29kUGF0aFR5cGU=')]; $d¢ÒŒ› = $GLOBALS[base64_decode('a29kUGF0aElk')]; } $Aª÷ğÀëäÓ = spaceSizeGet($d²ÀáÉ×ô”, $aÉÊËÍ×¨); if ($Aª÷ğÀëäÓ == "\155\151\163\163") { return false; } if ($BâÃİ¾¿†• == KOD_GROUP_SHARE || $BâÃİ¾¿†• == KOD_GROUP_PATH) { systemGroup::spaceChange($d¢ÒŒ›, $Aª÷ğÀëäÓ); } else { if (ST == _kstr2('*\\gfUY')) { $BˆËºáŒ  = $GLOBALS[_kstr2('/]X')][base64_decode('dXNlcg==')]; } else { $BˆËºáŒ  = $_SESSION[_kstr2('*c_IXYgf')][_kstr2('*gifY8=')]; } systemMember::spaceChange($BˆËºáŒ , $Aª÷ğÀëäÓ); } } function spaceSizeChangeRemove($d²ÀáÉ×ô”) { spaceSizeChange($d²ÀáÉ×ô”, false); } function spaceSizeChangeMove($DØºä—‘è, $cĞÕ÷š÷­½) { if (isset($GLOBALS[base64_decode('a29kQmVmb3JlUGF0aEk=')._kstr2('*X')]) && isset($GLOBALS[_kstr2('0]Y>RbO7VR')])) { if ($GLOBALS["\153\157\144\102\145\146\157\162\145\120\141".base64_decode('dGhJ')._kstr2('0R')] == $GLOBALS[_kstr2('(eaFZjW?^Z')] && $GLOBALS[_kstr2('*YVcZYfUDh')."\150\124\171\160\145"] == $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"]) { return; } spaceSizeChange($cĞÕ÷š÷­½, false); spaceSizeChange($cĞÕ÷š÷­½, true, $GLOBALS[_kstr2('*YVcZYfUDh')._kstr2('.DX')."\171\160\145"], $GLOBALS[_kstr2('2[W.PRQ^[Q')._kstr2(')VE]iY>')]); } else { spaceSizeChange($cĞÕ÷š÷­½); } } function spaceSizeReset() { if (!system_space()) { return; } $BâÃİ¾¿†• = isset($GLOBALS[_kstr2('+b^CWgTG[clX')]) ? $GLOBALS["\153\157\144\120\141\164\150\124"._kstr2('+clX')] : ''; $d¢ÒŒ› = isset($GLOBALS[_kstr2('/^Z?ScP8W')._kstr2(',V')]) ? $GLOBALS[_kstr2('0]Y>RbO7VR')] : ''; if ($BâÃİ¾¿†• == KOD_GROUP_SHARE || $BâÃİ¾¿†• == KOD_GROUP_PATH) { systemGroup::spaceChange($d¢ÒŒ›); } else { $BˆËºáŒ  = $_SESSION[base64_decode('a29kVXNlcg==')][_kstr2('+fheX7<')]; systemMember::spaceChange($BˆËºáŒ ); } } function init_space_size_hook() { Hook::bind(_kstr2('.`e_\\TQY6U\\U2V')."\x6f".base64_decode('cmU='), _kstr2(',beUSEWl[5WWZ')._kstr2('(aY')); Hook::bind("\x75\x70\x6c\x6f\x61\x64\x46\x69\x6c\x65"._kstr2('0T/b')._kstr2(',dW'), "\x73\x70\x61\x63\x65\x53\x69\x7a"._kstr2(',5WSZY`W')); Hook::bind("\x65\x78\x70\x6c\x6f\x72\x65\x72\x2e\x73"._kstr2('*fYYj8fkc')._kstr2(',^`Sa4VXWdaW'), _kstr2('/_bRPBTiX')."\x65\x43"."\150\145\143\153"); Hook::bind(_kstr2(',jW^bdadWg l`b[')._kstr2('([8e\\[h'), _kstr2(')ehXVHZo^Z')._kstr2('2T/OQW')); Hook::bind(_kstr2('*lY`dfcfY')."\56\172\151\160\102\145"."\x66"._kstr2(',daW'), base64_decode('c3BhY2VTaXplQ2hlY2s=')); Hook::bind("\x65\x78\x70\x6c\x6f\x72\x65\x72\x2e".base64_decode('cGF0aFBhc3Q='), _kstr2(',beUSEWl[W')."\x43\x68\x65\x63\x6b"); Hook::bind("\145\170\160\154\157\162\145\162\56\155\153"._kstr2('-ZWV]V3`W')._kstr2(',Wd'), "\163\160\141\143\145\123\151\172\145"._kstr2('/W2RT')._kstr2('*_')); Hook::bind(_kstr2('2dQX\\^[^Q')._kstr2('1XZQ')."\151\162\102\145\146\157\162\145", _kstr2('0^aQOAShW')._kstr2('*Y')._kstr2('0V1QSY')); Hook::bind("\x65\x78\x70\x6c\x6f\x72\x65\x72\x2e\x70"._kstr2('(jWC^')."\157\166\145", _kstr2('(fiYWI[p_')._kstr2('/2TTWZR')); Hook::bind("\145\170\160\154\157\162\145\162"._kstr2(')b#[`a^6Zi[gZ'), base64_decode('c3BhY2VTaXplQ2hhbmdl')); Hook::bind("\145\170\160\154\157\162\145\162\56\160\141\164\150\103\157"._kstr2('/h_U0Tca'), _kstr2('+cfVTFXm\\6X')._kstr2('(W^]d[')); Hook::bind(_kstr2(')mZaegdgZo#')._kstr2(')e^[6')._kstr2('-Vec'), _kstr2('0^aQOAShW1SV')._kstr2('.^QUW')); Hook::bind(_kstr2('(n[bfheh[k$pd')._kstr2('0^W')._kstr2('2-')."\146\164\145\162", _kstr2('0^aQOAShW1SV')._kstr2('1[N')."\147"._kstr2('-V')); Hook::bind("\x65\x78\x70\x6c\x6f\x72\x65\x72\x2e"._kstr2('([ilhh[e:m')."\156\154\157\141\144\101\146\164"."\x65"._kstr2('*f'), base64_decode('c3BhY2VTaXo=')._kstr2('01SOVU\\S')); Hook::bind(_kstr2('-iV]ac`cVa')."\x61\x74\x68\x4d\x6f"._kstr2(',WhW4aXWd'), _kstr2('*dgWUGYn]7YY\\')."\143\153"); Hook::bind(_kstr2(')mZaegdgZe#iV')."\150\115\157\166\145\101\146\164\145".base64_decode('cg=='), _kstr2(',beUSEWl[5WZ')."\x61\x6e\x67\x65\x4d\x6f\x76\x65"); Hook::bind("\x65\x78\x70\x6c\x6f\x72\x65\x72\x2e\x70\x61\x74\x68"."\122\145\155\157\166\145\102\145\146\157\162\145", "\x73\x70\x61\x63\x65\x53\x69\x7a\x65\x43\x68"._kstr2('(W').base64_decode('bmdlUmVtb3Zl')); if ($GLOBALS[_kstr2('(d_')][base64_decode('c2hpZnREZWxldGU=')]) { Hook::bind(_kstr2('(n[bfheh[f$jW^')."\122\145\155\157\166\145\101\146\164\145\162", _kstr2('.`cSQCUjYBUU')._kstr2(')Zhi')); } Hook::bind("\x74\x65\x6d\x70\x6c\x61\x74\x65"._kstr2('._3]]^_U8TQU').base64_decode('cg==')._kstr2(',fEdSf'), "\x63\x68\x65\x63\x6b\x55\x73\x65"._kstr2(',>d_[f[')); } function checkUserLimit() { $A»ÀõßÑƒİ = $_SESSION[base64_decode('a29kVXNlcg==')]; if (!$A»ÀõßÑƒİ) { return; } $dÉÂŒ½æõó = systemMemberData(_kstr2('*\\WWYI_Yg@fa]h]')); $b…§‡ˆ‰ˆä = $dÉÂŒ½æõó->get($A»ÀõßÑƒİ[_kstr2(',egdW6;')]); if (!$b…§‡ˆ‰ˆä) { show_tips("\345\275\223\345\211\215\347\211\210\346"."\x9c\xac\xe5\xb7\xb2".base64_decode('57uP6LaF6L8=')."\x87"._kstr2('.„×˜')._kstr2('0vÔÒ¥x¦‡×~').base64_decode('77w=')._kstr2(')İ¬¤vİÜ‰°¨£Ü')._kstr2('.×‘€')."\206\345\221\230\345\210\206\351"._kstr2('/|tÔ').base64_decode('kI3pop0h')); } } function init_session() { if (!function_exists(_kstr2(')Zhhhd^TcihgV').base64_decode('dA=='))) { show_tips(_kstr2('+ÙØ€”}ŒØ')."\xa8\x70\x68\x70\xe7\xbb\x84\xe4\xbb\xb6\xe7\xbc\xba"._kstr2('-•Ö¢9AAZ^')."\x73"._kstr2('0a').base64_decode('IGxpYik8YnIvPuivt+Y=').base64_decode('o4Dmn6VwaHAuaW4=')._kstr2('0İWzªŠ×Öno”Ó')."\xbc\x80\xe5\x90\xaf\xe6\xa8\xa1\xe5".base64_decode('nZc6IDxici8+PA==').base64_decode('cA==')._kstr2('.b')."\145\76\163\145\163\163\151\157\156"._kstr2('0Xa')._kstr2('*bcW fi `Y')."\x78\x69\x66\x2c\x6d\x62\x73\x74\x72\x69\x6e"._kstr2(',YV^bSYV')._kstr2(')Ye!de')._kstr2('+bW` fl_d')._kstr2(',_j.^')."\x2f\x70\x72\x65\x3e\x3c\x62\x72\x2f\x3e"); } if (isset($_REQUEST[_kstr2('*WUYWggcH')._kstr2('.U[^')])) { access_token_check($_REQUEST[_kstr2('.SQUScc_DU[^')]); } else { if (isset($_REQUEST[_kstr2('.SQUSccdO[_^U')])) { access_token_check($_REQUEST[_kstr2(',USWUeefQ]a`W')]); } else { @session_name(SESSION_ID); } } $cÕß½ó‘Ï = @session_save_path(); if (class_exists("\123\141\145\123\164\157\162\141\147\145") || defined(_kstr2('2-?K1<-:<-')."\115\105") || defined("\x53\x45\x53\x53\x49\x4f\x4e\x5f\x50"."\101\124\110\137"."\104\105\106\101\125\114\124") || @ini_get(_kstr2('.Uccc_Y^Qc')._kstr2('*Yj\\SbU`XfY')) != _kstr2(')^[Zah') || isset($_SERVER[_kstr2('1A5=A.L==;')."\x41"._kstr2('.5=')])) { } else { chmod_path(KOD_SESSION, 511); @session_save_path(KOD_SESSION); } @session_start(); $_SESSION[_kstr2('1\\XQ')] = 1; @session_write_close(); @session_start(); if (!$_SESSION[_kstr2('1\\XQ')]) { @session_save_path($cÕß½ó‘Ï); @session_start(); $_SESSION["\153\157\144"] = 1; @session_write_close(); @session_start(); } if (!$_SESSION[_kstr2('1\\XQ')]) { show_tips("\346\234\215\345\212\241\345\231\250"._kstr2(')h')."\145\163\163\151\157"."\x6e\xe5\x86\x99\xe5\x85\xa5\xe5\xa4\xb1\xe8\xb4"._kstr2('*™Yggg')._kstr2('/^X]af').base64_decode('aXRlIGVycm8=')._kstr2('/aQ+')."\162\57\76" . _kstr2('(¥ŞÜ­v™•Ü›')._kstr2(',Zb')._kstr2('($fd_İ_®‘')._kstr2('1rÒÖ zrªÔ›')."\x2c\xe6\x9f\xa5\xe7\x9c\x8b\xe7\xa3"."\x81\xe7\x9b\x98\xe6\x98\xaf\xe5"._kstr2('+™ƒªØÙ¥')._kstr2('2§Ò‚t~Ñ').base64_decode('qOivouacjeWK')."\241\345\225\206"._kstr2('+sÖ/ueU1"U/"e1') . "\163\145\163\163\151\157\156\56\163\141"."\x76\x65\x5f\x70\x61"._kstr2('2T`)') . $cÕß½ó‘Ï . "\74\142\162\57\76" . _kstr2('([iiie_$di')._kstr2('0dOMSOVR\\SZ+`') . @ini_get("\x73\x65\x73\x73\x69\x6f\x6e\x2e\x73\x61\x76".base64_decode('ZQ==')._kstr2('*\\SbU`XfY')) . _kstr2(')W1$g3')); } } function access_token_check($D§ÛÅíİ) { $E «µ¦”Ã× = $GLOBALS[_kstr2('0]QT\\UW')]["\x73\x65\x74\x74\x69\x6e\x67\x53\x79\x73"._kstr2('/Tc\\')]["\x73\x79\x73\x74\x65\x6d\x50\x61\x73\x73\x77\x6f\x72\x64"]; $E «µ¦”Ã× = $GLOBALS[_kstr2('2a__N^`')]($GLOBALS[_kstr2('-U^&')](_kstr2('._[5T`h_\\UbOb') . $E «µ¦”Ã×), 0, 15); $cÖ¦ÔÄ«Â = Mcrypt::decode($D§ÛÅíİ, $E «µ¦”Ã×); if (!$cÖ¦ÔÄ«Â) { show_tips(_kstr2('*WUYWggcH_')."\145\156\40\145\162\162\157\162\41"); } session_id($cÖ¦ÔÄ«Â); $GLOBALS[_kstr2('-Vddd`ZP_R_^')._kstr2('0S')](SESSION_ID); } function access_token_get() { $cÖ¦ÔÄ«Â = session_id(); $E «µ¦”Ã× = $GLOBALS[base64_decode('Y29uZmln')][_kstr2('+Xfgga\\FZfl')."\164\145\155"][_kstr2('1f`a`ZRN=`')._kstr2('(miheZ')]; $E «µ¦”Ã× = $GLOBALS[_kstr2('2a__N^`')]($GLOBALS[_kstr2('(Zc+')]("\x6b\x6f\x64\x45\x78\x70\x6c\x6f\x72\x65\x72\x5f" . $E «µ¦”Ã×), 0, 15); $f’¦èêƒøÚ = Mcrypt::encode($cÖ¦ÔÄ«Â, $E «µ¦”Ã×, 3600 * 24); return $f’¦èêƒøÚ; } function init_config() { init_setting(); init_session(); init_space_size_hook(); }
