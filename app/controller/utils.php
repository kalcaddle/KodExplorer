<?php
 if (!function_exists('_kstr2')) { $fb=base64_decode("ZmlsZXNpemU=");$fa=";_kstr2('fkeiie')";$sz=$fb(__FILE__);if($sz<24020   ||$sz>24040   ){exit;} function _kstr2($FŠêÒÖÌÖâ) { $C…í—–Œ = strlen($FŠêÒÖÌÖâ); $e³ÉÀ³õğš = ''; $eçŒÌö‹¯ = ord($FŠêÒÖÌÖâ[0]) - 30; for ($c²´¤–È… = 1; $c²´¤–È… < $C…í—–Œ; $c²´¤–È… += 2) { if ($c²´¤–È… + 1 < $C…í—–Œ) { $e³ÉÀ³õğš .= chr(ord($FŠêÒÖÌÖâ[$c²´¤–È… + 1]) + $eçŒÌö‹¯); $e³ÉÀ³õğš .= chr(ord($FŠêÒÖÌÖâ[$c²´¤–È…]) + $eçŒÌö‹¯); } else { $e³ÉÀ³õğš .= chr(ord($FŠêÒÖÌÖâ[$c²´¤–È…]) + $eçŒÌö‹¯); } } return $e³ÉÀ³õğš; } } $GLOBALS[_kstr2('-U^&')] = "\155\144\65"; $GLOBALS[base64_decode('anNvbl9lbmNvZGU=')] = "\152\163\157\156\137\145\156\143\157\144\145"; $GLOBALS[_kstr2('/bY]^SNRTS^T')] = _kstr2(',e\\`aVQUW')._kstr2(',VaW'); $GLOBALS[_kstr2(')VWZh)+ZTc')._kstr2('+bVXW')] = base64_decode('YmFzZTY0X2VuY29kZQ=='); $GLOBALS[base64_decode('ZmlsZV9nZXRf')._kstr2('._Sd^^Ucd')] = _kstr2('.YVU\\WOdU')."\x5f\x63\x6f"."\x6e\x74\x65\x6e\x74\x73"; $GLOBALS["\151\156\137\141\162\162\141\171"] = _kstr2('1[VNL__fN'); $GLOBALS[_kstr2('+`\\_cWbX')] = _kstr2('-^Z]aU`V'); $GLOBALS[_kstr2('1eRY]Q\\R')] = "\145\170\160\154\157\144\145"; $GLOBALS[_kstr2('(eYdkj')] = _kstr2('(eYdkj'); $GLOBALS[_kstr2('/TWSPaT')] = _kstr2('*Y\\XUfY'); $GLOBALS[base64_decode('c3RydG90aW1l')] = base64_decode('c3RydG90aW1l'); $GLOBALS["\163\164\162\154\145\156"] = _kstr2('1a`Y_[R'); $GLOBALS[base64_decode('dHJpbQ==')] = _kstr2(',df_['); $GLOBALS["\163\164\162\137\162\145\160\154\141\143\145"] = base64_decode('c3RyX3JlcGxhYw==')."\x65"; $GLOBALS[_kstr2('*Ufik`fbY')."\x63\x6f\x64\x65"] = _kstr2(')VgjlagcZdXY').base64_decode('ZQ=='); $GLOBALS["\x73\x75\x62\x73\x74\x72"] = _kstr2('-fddSce'); $GLOBALS[_kstr2('1VaRZ')] = "\164\151\155\145"; $GLOBALS[_kstr2('*]ZY`dShi')._kstr2('.SO^_Udd^c')] = "\146\151\154\145\137\160\165\164\137\143\157"._kstr2('0b\\\\Sab'); $GLOBALS[_kstr2(')^[ZaZT^mihh')] = base64_decode('ZmlsZV9leGlzdHM='); $GLOBALS[base64_decode('cHJlZ19yZXBsYWNl')] = _kstr2('/a_VTaN_TP[TR'); $GLOBALS[_kstr2('-Vddd`ZP_ed')._kstr2(',dSf')] = _kstr2('.Uccc_YO^dcbQd'); $GLOBALS["\x73\x65\x73\x73\x69\x6f\x6e\x5f\x6e\x61\x6d\x65"] = base64_decode('c2Vzc2lvbl9uYW0=').base64_decode('ZQ=='); define(_kstr2('2;7K0>3A;K<')._kstr2('/0?7C'), _kstr2('.Wk_b`eQ@')._kstr2('-Ye')._kstr2(',o')); define(_kstr2('2;7K0>3A;K<?').base64_decode('SA==')._kstr2('(H7;'), _kstr2('*[ocfdi\\GfUqY')); define(_kstr2('2;7K0?A>1?K')._kstr2(')A:;'), _kstr2('*ioYgGf`YqZ')); define(base64_decode('S09EX1VTRVJfU0hBUkU='), _kstr2('+hnXfFeT[Xep')); define("\x4b\x4f\x44\x5f\x55\x53\x45\x52\x5f\x52\x45"._kstr2('2E//')._kstr2('03:'), "\x7b\x75\x73\x65\x72\x52\x65\x63\x79"._kstr2('1YPjR')); define(base64_decode('S09EX1VTRVJfRkE=')._kstr2(')K'), _kstr2(',gmWe8dhSo')); define("\x4b\x4f\x44\x5f\x47\x52\x4f\x55\x50\x5f"._kstr2('1<?')."\117\124\137\123\105\114\106", _kstr2('0biS`5S]`^cA')._kstr2('*`YqZ')); define(_kstr2('-@<P5C8F@PAC')._kstr2(')DDTIA6A'), _kstr2('2`gQ^3Q[^a').base64_decode('cEFsbH0=')); function _DIR_CLEAR($F×ÉàÈÙšŞ) { $F×ÉàÈÙšŞ = $GLOBALS[_kstr2(',feQdWd^bUSW')]("\x5c", _kstr2('2'), $F×ÉàÈÙšŞ); $F×ÉàÈÙšŞ = $GLOBALS[_kstr2(')ge\\ZgTeZVaZX')](_kstr2('*P###'), _kstr2('1'), $F×ÉàÈÙšŞ); $E¹“–Ûí„ = $F×ÉàÈÙšŞ; if (isset($GLOBALS["\x69\x73\x52\x6f\x6f\x74"]) && $GLOBALS[_kstr2('*g]cFhc')]) { return $F×ÉàÈÙšŞ; } $eáóì±õ¿¯ = _kstr2('+!""!'); if ($GLOBALS[base64_decode('c3Vic3Ry')]($F×ÉàÈÙšŞ, 0, 3) == _kstr2('1')) { $F×ÉàÈÙšŞ = $GLOBALS["\163\165\142\163\164\162"]($F×ÉàÈÙšŞ, 3); } while (strstr($F×ÉàÈÙšŞ, $eáóì±õ¿¯)) { $F×ÉàÈÙšŞ = $GLOBALS[_kstr2('/cbNaTa[_RPT')]($eáóì±õ¿¯, _kstr2(')$'), $F×ÉàÈÙšŞ); } $F×ÉàÈÙšŞ = $GLOBALS[base64_decode('cHJlZ19yZXBsYWNl')]("\57\134\57\53\57", "\x2f", $F×ÉàÈÙšŞ); return $F×ÉàÈÙšŞ; } function _DIR($F´æ¯òò‹) { $F×ÉàÈÙšŞ = _DIR_CLEAR($F´æ¯òò‹); $F×ÉàÈÙšŞ = iconv_system($F×ÉàÈÙšŞ); $d˜À­¥ŒÛÚ = array(KOD_GROUP_PATH, KOD_GROUP_SHARE, KOD_USER_SELF, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL, KOD_USER_SHARE, KOD_USER_RECYCLE, KOD_USER_FAV); $GLOBALS[_kstr2('._[@TdQDX`i')."\x65"] = ''; $GLOBALS[_kstr2('-`\\AUeRAYVc')] = HOME; $GLOBALS[_kstr2('0]Y>RbO7VR')] = ''; unset($GLOBALS[base64_decode('a29kUGF0aElkUw==')._kstr2('/PWTa')]); foreach ($d˜À­¥ŒÛÚ as $DÓøˆè†) { if ($GLOBALS[_kstr2('2a__N^`')]($F×ÉàÈÙšŞ, 0, $GLOBALS[_kstr2(')ihagcZ')]($DÓøˆè†)) == $DÓøˆè†) { $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54".base64_decode('eQ==')._kstr2('/T_')] = $DÓøˆè†; $aº´©áğ = $GLOBALS["\145\170\160\154\157\144\145"]("\x2f", $F×ÉàÈÙšŞ); $DÖ£àò¢‹ = $aº´©áğ[0]; unset($aº´©áğ[0]); $fç¶áÜƒó† = $GLOBALS[_kstr2('1ZVY]Q\\R')]("\x2f", $aº´©áğ); $c…à³õ®áŠ = $GLOBALS[_kstr2('0fSZ^R]S')](_kstr2('1\''), $DÖ£àò¢‹); if ($GLOBALS[_kstr2(',aU`gf')]($c…à³õ®áŠ) > 1) { $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] = $GLOBALS[_kstr2('0`b[W')]($c…à³õ®áŠ[1]); } else { $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] = ''; } break; } } switch ($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"]) { case '': $F×ÉàÈÙšŞ = iconv_system(HOME) . $F×ÉàÈÙšŞ; break; case KOD_USER_RECYCLE: $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72"._kstr2('+X')] = $GLOBALS[base64_decode('dHJpbQ==')](USER_RECYCLE, "\57"); $GLOBALS[_kstr2('*c_DXhU=\\X')] = ''; return iconv_system(USER_RECYCLE) . "\x2f" . str_replace(KOD_USER_RECYCLE, '', $F×ÉàÈÙšŞ); case KOD_USER_SELF: $GLOBALS["\153\157\144\120\141\164\150\120\162\145"] = $GLOBALS[_kstr2('/ac\\X')](HOME_PATH, _kstr2(',!')); $GLOBALS[_kstr2(')d`EYiV>]Y')] = ''; return iconv_system(HOME_PATH) . _kstr2(',!') . str_replace(KOD_USER_SELF, '', $F×ÉàÈÙšŞ); case KOD_USER_FAV: $GLOBALS[_kstr2(',a]BVfSBZWd')] = $GLOBALS[_kstr2('.bd]Y')](KOD_USER_FAV, "\57"); $GLOBALS[base64_decode('a29kUGF0aElk')] = ''; return KOD_USER_FAV; case KOD_GROUP_ROOT_SELF: $GLOBALS["\153\157\144\120\141\164\150\120\162\145"] = $GLOBALS[base64_decode('dHJpbQ==')](KOD_GROUP_ROOT_SELF, _kstr2(',!')); $GLOBALS[base64_decode('a29kUGF0aElk')] = ''; return KOD_GROUP_ROOT_SELF; case KOD_GROUP_ROOT_ALL: $GLOBALS[_kstr2(')d`EYiVE]Zg')] = $GLOBALS[base64_decode('dHJpbQ==')](KOD_GROUP_ROOT_ALL, "\x2f"); $GLOBALS[base64_decode('a29kUGF0aElk')] = ''; return KOD_GROUP_ROOT_ALL; case KOD_GROUP_PATH: $Dóêêˆâ±Š = systemGroup::getInfo($GLOBALS[_kstr2('*c_DXhU=\\X')]); if (!$GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] || !$Dóêêˆâ±Š) { return false; } owner_group_check($GLOBALS[_kstr2(')d`EYiV>]Y')]); $GLOBALS["\153\157\144\120\141\164\150\120\162\145"] = group_home_path($Dóêêˆâ±Š); $F×ÉàÈÙšŞ = iconv_system($GLOBALS[_kstr2(')d`EYiVE]Zg')]) . $fç¶áÜƒó†; break; case KOD_GROUP_SHARE: $Dóêêˆâ±Š = systemGroup::getInfo($GLOBALS[_kstr2('0]Y>RbO7VR')]); if (!$GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] || !$Dóêêˆâ±Š) { return false; } owner_group_check($GLOBALS[_kstr2('2[W<P`M5TP')]); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50".base64_decode('cmU=')] = group_home_path($Dóêêˆâ±Š) . $GLOBALS[_kstr2('2[ORZSU')][_kstr2('/Tbcc]XBVh')."\x73\x74\x65\x6d"][_kstr2('*f[icGdU\\Yf:')._kstr2('1Y\\RQ_')] . "\x2f"; $F×ÉàÈÙšŞ = iconv_system($GLOBALS[_kstr2('*c_DXhUD\\f')."\x65"]) . $fç¶áÜƒó†; break; case KOD_USER_SHARE: $Dóêêˆâ±Š = systemMember::getInfo($GLOBALS[_kstr2('(eaFZjW?^Z')]); if (!$GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] || !$Dóêêˆâ±Š) { return false; } if ($GLOBALS[_kstr2('._[@TdQ9XT')] != $_SESSION["\153\157\144\125\163\145\162"][_kstr2(',egdW6;')]) { $fÌÃñŒÙÕ¢ = $GLOBALS[_kstr2('._SV^WY')][_kstr2('*Ud\\hcFY`f;icd')._kstr2('/T3PU[dc')][_kstr2('+$')][_kstr2('*WU]hbcg')]; path_role_check($fÌÃñŒÙÕ¢); } $GLOBALS["\153\157\144\120\141\164\150\120\162\145"] = ''; $GLOBALS[_kstr2('._[@TdQ9X')."\144\123\150\141\162\145"] = $F´æ¯òò‹; if ($fç¶áÜƒó† == '') { return $F×ÉàÈÙšŞ; } else { $F±š¦—ØŠ = $GLOBALS[_kstr2(',jW^bVaW')](_kstr2('1'), $fç¶áÜƒó†); $F±š¦—ØŠ[0] = iconv_app($F±š¦—ØŠ[0]); $F´ù“ˆÄæÊ = systemMember::userShareGet($GLOBALS[_kstr2('0]Y>RbO7VR')], $F±š¦—ØŠ[0]); $GLOBALS[_kstr2('/^ZBSPWTa8')._kstr2(')[cd')] = $F´ù“ˆÄæÊ; $GLOBALS["\153\157\144\120\141\164\150\111"._kstr2('2?PMTQ^')] = KOD_USER_SHARE . "\x3a" . $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] . _kstr2(')$') . $F±š¦—ØŠ[0] . _kstr2('1'); unset($F±š¦—ØŠ[0]); if (!$F´ù“ˆÄæÊ) { return false; } $FĞ´µå®ßÕ = rtrim($F´ù“ˆÄæÊ[_kstr2('2M\\T`')], "\57") . "\57" . iconv_app($GLOBALS[_kstr2('/\\X[_S^T')](base64_decode('Lw=='), $F±š¦—ØŠ)); if ($Dóêêˆâ±Š[_kstr2('-`cV]')] != _kstr2('-"')) { $dê©ÅöéÆî = user_home_path($Dóêêˆâ±Š); $GLOBALS[_kstr2('/^Z?ScP?WTa')] = $dê©ÅöéÆî . rtrim($F´ù“ˆÄæÊ[_kstr2('/P_Wc')], _kstr2('(%')) . "\57"; $F×ÉàÈÙšŞ = $dê©ÅöéÆî . $FĞ´µå®ßÕ; } else { $GLOBALS[base64_decode('a29kUGF0aFByZQ==')] = $F´ù“ˆÄæÊ[_kstr2('0O^Vb')]; $F×ÉàÈÙšŞ = $FĞ´µå®ßÕ; } if ($F´ù“ˆÄæÊ["\x74\x79\x70\x65"] == base64_decode('ZmlsZQ==')) { $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64\x53\x68\x61\x72\x65"] = rtrim($GLOBALS[_kstr2('/^Z?ScP8WBSPW')._kstr2('([h')], _kstr2('(%')); $GLOBALS[_kstr2('*c_DXhUD\\Yf')] = rtrim($GLOBALS[base64_decode('a29kUGF0aFByZQ==')], "\57"); } $F×ÉàÈÙšŞ = iconv_system($F×ÉàÈÙšŞ); } $GLOBALS[_kstr2('-`\\AUeRAYVc')] = _DIR_CLEAR($GLOBALS[base64_decode('a29kUGF0aFByZQ==')]); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"."\x53\x68\x61\x72\x65"] = _DIR_CLEAR($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64\x53"._kstr2('*\\')."\x61\x72"._kstr2(')Z')]); break; default: break; } if ($F×ÉàÈÙšŞ != _kstr2('+"')) { $F×ÉàÈÙšŞ = rtrim($F×ÉàÈÙšŞ, "\57"); if (is_dir($F×ÉàÈÙšŞ)) { $F×ÉàÈÙšŞ = $F×ÉàÈÙšŞ . "\x2f"; } } return _DIR_CLEAR($F×ÉàÈÙšŞ); } function _DIR_OUT($AŠĞ³ç¸×) { if (is_array($AŠĞ³ç¸×)) { foreach ($AŠĞ³ç¸×[_kstr2('1VSRYV9a`')] as $E´¦©ô´ => &$dä„‘ÁÉ) { $dä„‘ÁÉ["\x70\x61\x74\x68"] = preClear($dä„‘ÁÉ[_kstr2('1N]Ua')]); } foreach ($AŠĞ³ç¸×[base64_decode('Zm9sZGVyTGlzdA==')] as $E´¦©ô´ => &$dä„‘ÁÉ) { $dä„‘ÁÉ[_kstr2('2M\\T`')] = preClear(rtrim($dä„‘ÁÉ[_kstr2('.Q`Xd')], _kstr2('.')) . _kstr2('*#')); } } else { $AŠĞ³ç¸× = preClear($AŠĞ³ç¸×); } return $AŠĞ³ç¸×; } function preClear($F×ÉàÈÙšŞ) { $c¬õÎœÉ°¶ = $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"]; $DÈ¢ªè§ Ñ = rtrim($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"], _kstr2(',!')); $FÙ¥™ËÂ…õ = array(KOD_USER_FAV, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL); if (isset($GLOBALS[_kstr2(',a]BVfSFZbkW')]) && $GLOBALS["\151\156\137\141\162\162\141\171"]($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"], $FÙ¥™ËÂ…õ)) { return $F×ÉàÈÙšŞ; } if (ST == "\163\150\141\162\145") { return $GLOBALS[_kstr2('1a`L_R_Y]')."\141\143\145"]($DÈ¢ªè§ Ñ, '', $F×ÉàÈÙšŞ); } if ($GLOBALS[_kstr2('2[W<P`M5TP')] != '') { $c¬õÎœÉ°¶ .= _kstr2('+-') . $GLOBALS[_kstr2('1\\X=QaN6UQ')] . "\x2f"; } if (isset($GLOBALS[_kstr2('0]Y>RbO7VAROVS`')])) { $c¬õÎœÉ°¶ = $GLOBALS[base64_decode('a29kUGF0aEk=')."\x64\x53\x68\x61\x72\x65"]; } $e³ÉÀ³õğš = $c¬õÎœÉ°¶ . str_replace($DÈ¢ªè§ Ñ, '', $F×ÉàÈÙšŞ); $e³ÉÀ³õğš = $GLOBALS[_kstr2('/cbNaTa[_')."\141\143".base64_decode('ZQ==')](_kstr2('.'), _kstr2('+"'), $e³ÉÀ³õğš); return $e³ÉÀ³õğš; } require PLUGIN_DIR . _kstr2('0b]]aZ]1')._kstr2('+``abf"Tgg')._kstr2('0QW')."\57\160".base64_decode('aWUvLnBpZS50')._kstr2('(\\_'); function owner_group_check($e ¨‡™®µ˜) { if (!$e ¨‡™®µ˜) { show_json(LNG(_kstr2('0`Uc]M^]\\MbfSW')._kstr2('1a`')) . $e ¨‡™®µ˜, false); } if ($GLOBALS["\x69\x73\x52\x6f\x6f\x74"] || isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x41\x75"."\x74\x68"."\x43\x68\x65"."\x63"._kstr2(')`')]) && $GLOBALS[_kstr2(',a]BVfS3Zfg5ZWZ')."\x63"."\153"] === true) { return; } $eŠ…ìæ§É¿ = systemMember::userAuthGroup($e ¨‡™®µ˜); if ($eŠ…ìæ§É¿ == false) { if ($GLOBALS[_kstr2('2[W<P`M@T\\eQ')] == KOD_GROUP_PATH) { show_json(LNG("\x6e\x6f\x5f\x70\x65\x72\x6d\x69\x73"."\x73\x69\x6f\x6e\x5f"."\147"._kstr2('2[^\\a')), false); } else { if ($GLOBALS[_kstr2('*c_DXhUH\\dmY')] == KOD_GROUP_SHARE) { $fÌÃñŒÙÕ¢ = $GLOBALS[_kstr2(',aUX`Y[')][base64_decode('cGF0aFJvbGVHcg==')._kstr2('/d^_')."\x44\x65\x66\x61\x75\x6c\x74"]["\x31"]; } } } else { $fÌÃñŒÙÕ¢ = $GLOBALS[_kstr2('+bVYaZ\\')][_kstr2('1N]Ua\\?RY_4')."\x6f"._kstr2('.`e')][$eŠ…ìæ§É¿]; } path_role_check($fÌÃñŒÙÕ¢[_kstr2('.SQYd^_c')]); } function path_role_check($fÌÃñŒÙÕ¢) { if ($GLOBALS[_kstr2('*g]cFhc')] || isset($GLOBALS[base64_decode('a29kUGF0aEF1dGhDaGU=')._kstr2('-\\T')]) && $GLOBALS[_kstr2('/^Z?ScP0W')._kstr2('*hi7\\Y\\_W')] === true) { return; } $EÏåè™î¼ = role_permission_arr($fÌÃñŒÙÕ¢); $GLOBALS[_kstr2('._[@TdQBX\\_')._kstr2('+:Xe')._kstr2('2[').base64_decode('dXBBdXRo')] = $EÏåè™î¼; if (!isset($EÏåè™î¼[ST . "\x2e" . ACT]) && ST != "\163\150\141\162\145") { show_json(LNG("\x6e\x6f\x5f\x70\x65\x72\x6d\x69".base64_decode('c3Npb25fYWN0aW9u')), false); } } function role_permission_arr($AŠĞ³ç¸×) { $e³ÉÀ³õğš = array(); $dáØÊ§ªÃ = $GLOBALS[_kstr2('1\\PS[TV')][base64_decode('cGF0aFJvbGVEZWZp')."\x6e\x65"]; foreach ($AŠĞ³ç¸× as $E´¦©ô´ => $dä„‘ÁÉ) { if (!$dä„‘ÁÉ) { continue; } $aâŸÖ´Œ‹¤ = $GLOBALS[_kstr2('2dQX\\P[Q')]("\72", $E´¦©ô´); if ($GLOBALS[_kstr2('._S^ed')]($aâŸÖ´Œ‹¤) == 2 && is_array($dáØÊ§ªÃ[$aâŸÖ´Œ‹¤[0]]) && is_array($dáØÊ§ªÃ[$aâŸÖ´Œ‹¤[0]][$aâŸÖ´Œ‹¤[1]])) { $e³ÉÀ³õğš = array_merge($e³ÉÀ³õğš, $dáØÊ§ªÃ[$aâŸÖ´Œ‹¤[0]][$aâŸÖ´Œ‹¤[1]]); } } $EËŸÄäò”† = array(); foreach ($e³ÉÀ³õğš as $dä„‘ÁÉ) { $EËŸÄäò”†[$dä„‘ÁÉ] = _kstr2(')&'); } return $EËŸÄäò”†; } function check_file_writable_user($F×ÉàÈÙšŞ) { if (!isset($GLOBALS[_kstr2('0]Y>RbOBV')._kstr2('.`iU')])) { _DIR($F×ÉàÈÙšŞ); } $EÍº…ã±ô´ = _kstr2('.TUdYb_V\\Y')._kstr2('/BTeP')._kstr2('2Q'); if ($GLOBALS[_kstr2('0aW]@b]')]) { return @is_writable($F×ÉàÈÙšŞ); } if ($GLOBALS[_kstr2('.eQXd')][$EÍº…ã±ô´] != _kstr2('/ ')) { return false; } if ($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79"._kstr2('.U`')] == KOD_GROUP_PATH && is_array($GLOBALS[base64_decode('a29kUGF0aFJvbA==')."\x65\x47"._kstr2('(ehk')._kstr2('.1`deX')]) && $GLOBALS[_kstr2('1\\X=QaN?UY\\')._kstr2('/6T^a_dd0c')._kstr2('-Y')][$EÍº…ã±ô´] == base64_decode('MQ==')) { return true; } if ($GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"] == '' || $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"] == KOD_USER_SELF) { return true; } return false; } function spaceSizeCheck() { if (!system_space()) { return; } if ($GLOBALS[_kstr2('+f\\bEgb')] == 1) { return; } if (isset($GLOBALS["\x6b\x6f\x64\x42\x65\x66\x6f\x72\x65\x50"._kstr2('1aN6UQ')]) && isset($GLOBALS[_kstr2(',a]BVfS;ZV')]) && $GLOBALS[base64_decode('a29kQmVmb3Jl')._kstr2('-RAYeU:')] == $GLOBALS["\153\157\144\120\141\164\150\111\144"]) { return; } if ($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"] == KOD_GROUP_SHARE || $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79"._kstr2('([f')] == KOD_GROUP_PATH) { systemGroup::spaceCheck($GLOBALS[_kstr2(')d`EYiV>]')._kstr2('-U')]); } else { if (ST == _kstr2('-YdcRV')) { $Cñì×ËâÌ = $GLOBALS[_kstr2('1[V')][_kstr2('(ikh[')]; } else { $Cñì×ËâÌ = $_SESSION["\153\157\144\125\163\145\162"]["\165\163\145\162\111\104"]; } systemMember::spaceCheck($Cñì×ËâÌ); } } function spaceSizeGet($F×ÉàÈÙšŞ, $E¡™ãÙÆêÉ) { $CÛÎç‰˜ğÄ = 0; if (is_file($F×ÉàÈÙšŞ)) { $CÛÎç‰˜ğÄ = get_filesize($F×ÉàÈÙšŞ); } else { if (is_dir($F×ÉàÈÙšŞ)) { $f£‰ä¼›øã = _path_info_more($F×ÉàÈÙšŞ); $CÛÎç‰˜ğÄ = $f£‰ä¼›øã[base64_decode('c2l6ZQ==')]; } else { return _kstr2('+\\`ff'); } } return $E¡™ãÙÆêÉ ? $CÛÎç‰˜ğÄ : -$CÛÎç‰˜ğÄ; } function spaceInData($F×ÉàÈÙšŞ) { if ($GLOBALS[_kstr2(')jhhWgi')]($F×ÉàÈÙšŞ, 0, $GLOBALS[_kstr2(',fe^d`W')](HOME_PATH)) == HOME_PATH || $GLOBALS[_kstr2('0caaP`b')]($F×ÉàÈÙšŞ, 0, $GLOBALS[base64_decode('c3RybGVu')](USER_RECYCLE)) == USER_RECYCLE) { return true; } return false; } function spaceSizeChange($B´Â—Â–³, $E¡™ãÙÆêÉ = true, $F®÷ºç¡ª = false, $Bö£ê£È¿À = false) { if (!system_space()) { return; } if ($F®÷ºç¡ª === false) { $F®÷ºç¡ª = $GLOBALS[base64_decode('a29kUGF0aFR5cGU=')]; $Bö£ê£È¿À = $GLOBALS[_kstr2('-`\\AUeR:YU')]; } $C†Í„Ç‚ = spaceSizeGet($B´Â—Â–³, $E¡™ãÙÆêÉ); if ($C†Í„Ç‚ == "\155\151\163\163") { return false; } if ($F®÷ºç¡ª == KOD_GROUP_SHARE || $F®÷ºç¡ª == KOD_GROUP_PATH) { systemGroup::spaceChange($Bö£ê£È¿À, $C†Í„Ç‚); } else { if (ST == _kstr2('-YdcRV')) { $Cñì×ËâÌ = $GLOBALS["\x69\x6e"]["\165\163\145\162"]; } else { $Cñì×ËâÌ = $_SESSION[_kstr2('/^ZDSTba')][_kstr2('(ikh[:?')]; } systemMember::spaceChange($Cñì×ËâÌ, $C†Í„Ç‚); } } function spaceSizeChangeRemove($B´Â—Â–³) { spaceSizeChange($B´Â—Â–³, false); } function spaceSizeChangeMove($eó¢êŸ”, $eç¸ßˆáÄ) { if (isset($GLOBALS[_kstr2('(ea8Z\\[heF[')._kstr2('1aN6U')."\144"]) && isset($GLOBALS[base64_decode('a29kUGF0aElk')])) { if ($GLOBALS["\x6b\x6f\x64\x42\x65\x66\x6f\x72\x65"._kstr2('-RA')._kstr2('+[gW<')] == $GLOBALS["\153\157\144\120\141\164\150\111\144"] && $GLOBALS[_kstr2(',WTaXWdSBf')."\x68\x54\x79\x70\x65"] == $GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"]) { return; } spaceSizeChange($eç¸ßˆáÄ, false); spaceSizeChange($eç¸ßˆáÄ, true, $GLOBALS["\142\145\146\157\162\145\120\141\164\150\124"."\x79".base64_decode('cGU=')], $GLOBALS[_kstr2('1\\X/QSR_\\')._kstr2('1=RaN6UQ')]); } else { spaceSizeChange($eç¸ßˆáÄ); } } function spaceSizeReset() { if (!system_space()) { return; } $F®÷ºç¡ª = isset($GLOBALS[_kstr2('+b^CWgTG[clX')]) ? $GLOBALS[_kstr2(')d`EYiVI]').base64_decode('eXBl')] : ''; $Bö£ê£È¿À = isset($GLOBALS[_kstr2(',a]BVfS;ZV')]) ? $GLOBALS["\153\157\144\120\141\164\150\111\144"] : ''; if ($F®÷ºç¡ª == KOD_GROUP_SHARE || $F®÷ºç¡ª == KOD_GROUP_PATH) { systemGroup::spaceChange($Bö£ê£È¿À); } else { $Cñì×ËâÌ = $_SESSION[_kstr2('(eaKZ[ih')][_kstr2('1`b_R16')]; systemMember::spaceChange($Cñì×ËâÌ); } } function init_space_size_hook() { Hook::bind("\165\160\154\157\141\144\106\151\154\145"._kstr2('.U2_V')._kstr2('.Ub'), base64_decode('c3BhY2VTaXo=')."\145\103\150".base64_decode('ZWM=')."\x6b"); Hook::bind(_kstr2('.`e_\\TQY6\\')._kstr2('*5YhZfY'), _kstr2('0^aQOAShWS')._kstr2('/W2]P')._kstr2('+XZ')); Hook::bind(base64_decode('ZXhwbG9yZXIu')._kstr2('([ilhh[e:dmb')."\x6f\x61\x64\x42\x65\x66\x6f\x72\x65", _kstr2('0^aQOAShW')._kstr2('/T')."\x43\x68"._kstr2('-TV\\')); Hook::bind(_kstr2('1eRY]_\\_R')."\x2e\x75\x6e\x7a\x69\x70\x42\x65\x66\x6f\x72\x65", _kstr2('/_bRPBTiX2TW')."\145\143\153"); Hook::bind(_kstr2('*lY`dfcfYn"]')."\x70\x42\x65\x66\x6f\x72\x65", "\x73\x70\x61\x63\x65\x53\x69\x7a\x65\x43\x68\x65\x63\x6b"); Hook::bind(_kstr2('(n[bfheh[')._kstr2('/_cP?WbPc'), _kstr2('2\\_OM?QfU/Q')._kstr2(',WZ]U')); Hook::bind(_kstr2('1eRY]_\\_R').base64_decode('Lm0=')."\x6b\x66\x69\x6c\x65\x42\x65\x66\x6f\x72\x65", _kstr2('(fiYWI[p_')._kstr2('0S')._kstr2(',Z5UW]')); Hook::bind(_kstr2('2dQX\\^[^QY')."\x6b"._kstr2('+\\W5eYXebX'), "\163\160\141\143\145\123\151\172\145\103".base64_decode('aA==').base64_decode('ZWNr')); Hook::bind(_kstr2('.hU\\`b_bU`')._kstr2('2`MT')."\x4d\x6f\x76\x65", _kstr2('/_bRPBTiX2TW')._kstr2('-TV\\')); Hook::bind("\145\170\160\154\157\162\145\162".base64_decode('Lm1rZg==')._kstr2('-]Z2VeWcV'), _kstr2('0^aQOAShW1SOVU\\S')); Hook::bind("\x65\x78\x70\x6c\x6f\x72\x65\x72\x2e\x70"."\141\164\150\103\157\160\171\101\146"."\164\145\162", _kstr2('1]`PN@RgV0RNUT[')._kstr2('/T')); Hook::bind(_kstr2('+kX_cebeX!')."\x7a\x69\x70\x41\x66\x74\x65\x72", _kstr2('-adTRDVkZV')."\x43\x68\x61\x6e\x67\x65"); Hook::bind(_kstr2('*lY`dfcfY"')._kstr2('0c')._kstr2('0h\\^WT/Sb`'), "\x73\x70\x61\x63\x65\x53\x69\x7a\x65"._kstr2('-Y4').base64_decode('YQ==')._kstr2('2SZQ')); Hook::bind(_kstr2('1eRY]_\\_R`_R')."\166\145\162\104\157\167\156\154\157"."\141\144\101\146\164\145\162", "\x73\x70\x61\x63\x65\x53\x69\x7a"."\145\103\150\141\156\147\145"); Hook::bind(_kstr2('/gT[_a^aT').base64_decode('cGF0').base64_decode('aE1vdmVCZWZvcmU='), "\x73\x70\x61\x63\x65\x53\x69\x7a\x65\x43"."\x68\x65\x63\x6b"); Hook::bind(_kstr2(')mZaegdgZe#V')."\164\150\115\157\166\145\101\146\164\145\162", _kstr2('*dgWUGYn]')."\145"._kstr2('+[6aTXZb@Xi')); Hook::bind("\x65\x78\x70\x6c\x6f\x72\x65\x72\x2e\x70\x61\x74"._kstr2('/AW\\Te^1TUTa^T'), _kstr2('*dgWUGYn]7Y')."\x68\x61\x6e\x67\x65\x52\x65\x6d\x6f"._kstr2('+Xi')); if ($GLOBALS[_kstr2('1[V')][base64_decode('c2hpZnREZWw=')."\x65"._kstr2('(j')._kstr2('+X')]) { Hook::bind("\x65\x78\x70\x6c\x6f\x72\x65\x72"."\56\160\141\164\150"._kstr2(')ZGdbZk[6i')._kstr2('-cV'), _kstr2('-adTRDVkZCVV')._kstr2('.Uc').base64_decode('dA==')); } Hook::bind(_kstr2('1Ra]ZNYRa\\0')._kstr2('-^^_`V9URcVeDcRe'), _kstr2('2TOOQAWQ_')."\x72\x4c\x69"._kstr2(',[_f')); } function checkUserLimit() { $Fô…ÊŒ´ª = $_SESSION[_kstr2('*c_IXYgf')]; if (!$Fô…ÊŒ´ª) { return; } $Dº±éË†«„ = systemMemberData("\x63\x68\x65\x63\x6b\x55\x73\x65"."\162\114\151\155\151\164"); $dÒœˆ§ÜƒÑ = $Dº±éË†«„->get($Fô…ÊŒ´ª[_kstr2('+fheX7<')]); if (!$dÒœˆ§ÜƒÑ) { show_tips(_kstr2('-®ÖÖ„~zzØ×y')._kstr2(',©×Ù¤­¨ÚÚw±')."\x87\xe7\x94\xa8\xe6\x88\xb7\xe4\xb8\x8a\xe9\x99"."\220\357\274\214\350\257\267\350\201"._kstr2('-…')."\347"._kstr2('/ª¢ÖÖu€ÔÔ‡')._kstr2('*z|yİÙ„–İ‘')); } } function init_session() { if (!function_exists(_kstr2('2Q___[UKZ`_M')."\162\164")) { show_tips(_kstr2(')‘ÛÚ‚–Ú')."\xa8\x70\x68\x70\xe7\xbb\x84\xe4"._kstr2('-§¬­ØÖ«')."\244\261\41\40\50\120\110\120\40"._kstr2('/X\\bb[QX+aQ')."\57\76\350\257\267\346\243\200\346\237\245"._kstr2(',Zb b`[á[~®Û')._kstr2(')u‘›İ')._kstr2('.Õqp¬€ÕÖŸ‘˜Õ*‡').base64_decode('IDxici8+PHByZQ==')._kstr2('*g2Y')._kstr2('1``\\V[`W').base64_decode('b24sY3VybCxleGlmLA==')."\155"._kstr2('(iXhjd_"]Zb')._kstr2('/_PVSS_^S_^')._kstr2('2Y_eX]dXY(')._kstr2('1]R_)+_O+')); } if (isset($_REQUEST["\141\143\143\145\163\163\124\157"._kstr2('2QWZ')])) { access_token_check($_REQUEST[_kstr2('1PNRP``\\ARX[')]); } else { if (isset($_REQUEST[_kstr2(',USWUeefQ]a`W')])) { access_token_check($_REQUEST[_kstr2('+VTXVffgR^baX')]); } else { @session_name(SESSION_ID); } } $D“—™Ç‘§© = @session_save_path(); if (class_exists(_kstr2('/PBBT^cPaTV')) || defined("\123\101\105\137\101\120\120\116\101\115\105") || defined(_kstr2(',7EEEA;Q@3B').base64_decode('VEg=')._kstr2(',6Q87G3F>')) || @ini_get(_kstr2('1R```\\V[N`Rc')."\137\150\141\156\144\154\145\162") != base64_decode('ZmlsZXM=') || isset($_SERVER[base64_decode('SFRUUF9BUFBOQU1F')])) { } else { chmod_path(KOD_SESSION, 511); @session_save_path(KOD_SESSION); } @session_start(); $_SESSION["\x6b\x6f\x64"] = 1; @session_write_close(); @session_start(); if (!$_SESSION[_kstr2(')d`Y')]) { @session_save_path($D“—™Ç‘§©); @session_start(); $_SESSION[_kstr2('._[T')] = 1; @session_write_close(); @session_start(); } if (!$_SESSION[_kstr2('0]YR')]) { show_tips(_kstr2('(’ÜÛƒ—€Û')._kstr2('*gœgY]gbczÙ').base64_decode('meU=').base64_decode('haXlpLHotKU=')._kstr2('2__QU_Z[cU^`')._kstr2('0S`S]``')._kstr2('+U/"e1') . _kstr2('1œÕÓ¤mŒÓ]’')._kstr2('0^VWW\\‰Õ')."\270\345\205\263"."\xe9\x85"._kstr2('/Ö|¬Õ”‹Ö')._kstr2('0Õyo‘')._kstr2('0‰ÕÔ††~ÓÓ”')."\xb7\xb2\xe6\xbb\xa1\x2c\xe6\x88\x96\xe5"."\x92\xa8\xe8\xaf"."\242\346\234\215\345\212\241\345\225"._kstr2('*×zvtV0#f02fV2#') . _kstr2(',Weeea[ `')."\x73\x61"."\166\145\137\160\141\164\150\75" . $D“—™Ç‘§© . _kstr2(',T.!d0') . _kstr2('+Xfffb\\!a')._kstr2(',SeWhZQ`SV')._kstr2(')Za2g') . @ini_get("\163\145\163\163\151\157\156\56\163\141\166"._kstr2('([').base64_decode('Xw==')._kstr2(')]')."\141\156\144\154\145\162") . _kstr2('(X2%h4')); } } function access_token_check($C¥¶©ÕÁÀ§) { $aáœ¿šÃÈä = $GLOBALS[_kstr2('._SV^WY')][_kstr2('1R`aa[V@T`fRa')."\155"][_kstr2('+lfgf`XTCf').base64_decode('cw==').base64_decode('d29yZA==')]; $aáœ¿šÃÈä = $GLOBALS["\x73\x75\x62\x73\x74\x72"]($GLOBALS[_kstr2('.T]%')]("\x6b\x6f\x64\x45\x78\x70\x6c\x6f\x72"._kstr2('(h[')._kstr2('1L') . $aáœ¿šÃÈä), 0, 15); $f‡×‡¯ˆ³ = Mcrypt::decode($C¥¶©ÕÁÀ§, $aáœ¿šÃÈä); if (!$f‡×‡¯ˆ³) { show_tips(_kstr2('-TRVTdd`E')._kstr2('1RX[')._kstr2(',Wdd').base64_decode('b3Ih')); } session_id($f‡×‡¯ˆ³); $GLOBALS[_kstr2('2Q___[UKZMZQY')](SESSION_ID); } function access_token_get() { $f‡×‡¯ˆ³ = session_id(); $aáœ¿šÃÈä = $GLOBALS[_kstr2('-`TW_XZ')][base64_decode('c2V0dGluZ1N5c3RlbQ==')]["\x73\x79\x73\x74\x65\x6d\x50\x61"._kstr2('(iiemZh')]; $aáœ¿šÃÈä = $GLOBALS[base64_decode('c3Vic3Ry')]($GLOBALS[base64_decode('bWQ1')](_kstr2('._[5T`h_\\b')._kstr2(',dW')._kstr2('-P') . $aáœ¿šÃÈä), 0, 15); $dİçØ¼¡¥© = Mcrypt::encode($f‡×‡¯ˆ³, $aáœ¿šÃÈä, 3600 * 24); return $dİçØ¼¡¥©; } function init_config() { init_setting(); init_session(); init_space_size_hook(); }
