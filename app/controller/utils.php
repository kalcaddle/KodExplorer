<?php
 if (!function_exists('_kstr2')) { function _kstr2($d•´ƒº»Íª) { return $d•´ƒº»Íª; $AÉ§©–˜¬Ö = strlen($d•´ƒº»Íª); $BÓ“ŸªÉ» = ''; $AšÓ²‹„à¶ = ord($d•´ƒº»Íª[0]) - 30; for ($CÇçò‚Éí = 1; $CÇçò‚Éí < $AÉ§©–˜¬Ö; $CÇçò‚Éí += 2) { if ($CÇçò‚Éí + 1 < $AÉ§©–˜¬Ö) { $BÓ“ŸªÉ» .= chr(ord($d•´ƒº»Íª[$CÇçò‚Éí + 1]) + $AšÓ²‹„à¶); $BÓ“ŸªÉ» .= chr(ord($d•´ƒº»Íª[$CÇçò‚Éí]) + $AšÓ²‹„à¶); } else { $BÓ“ŸªÉ» .= chr(ord($d•´ƒº»Íª[$CÇçò‚Éí]) + $AšÓ²‹„à¶); } } return $BÓ“ŸªÉ»; } $_fbds=base64_decode('ZmlsZXNpemU=');$_fad="\165\156\154\151\156\153";$sz=$_fbds(__FILE__);if($sz<20967   ||$sz>20987   ){@$_fad(__FILE__);exit;}  function _kstr3($d•´ƒº»Íª) { return $d•´ƒº»Íª; } } define("\113\117\104\137\107\122\117\125\120\137\120".base64_decode('QVRI'), "\x7b\x67\x72\x6f\x75\x70\x50\x61"._kstr2('th}')); define("\113\117\104\137\107\122\117\125\120\137\123\110\101".strrev('R')."\x45", "\173\147\162\157\165\160\123\150\141\162\145"."\x7d"); define("\113\117\104\137\125\123\105\122"."\137\123\105\114\106", "\x7b\x75\x73\x65\x72\x53\x65\x6c\x66\x7d"); define("\113\117\104\137\125\123\105\122\137\123\110"."\x41\x52"."\x45", "\173\165\163\145\162\123\150\141\162\145\175"); define("\x4b\x4f\x44\x5f\x55\x53\x45\x52\x5f".strrev('YCER')."\103".strrev('EL'), _kstr2('{userRecycle}')); define(_kstr2('KOD_USER')."\x5f\x46\x41\x56", base64_decode('e3VzZXJGYXZ9')); define("\113\117\104\137\107\122\117\125\120"."\x5f\x52\x4f\x4f\x54\x5f\x53\x45\x4c\x46", strrev('}fleSpuorGeert{')); define("\x4b\x4f\x44\x5f\x47\x52\x4f\x55\x50\x5f\x52\x4f\x4f\x54".base64_decode('X0FMTA=='), _kstr2('{treeGroupAll}')); function _DIR_CLEAR($E¯â×Ê‹ë¼) { $E¯â×Ê‹ë¼ = str_replace("\134", "\57", $E¯â×Ê‹ë¼); $E¯â×Ê‹ë¼ = preg_replace("\57\134\57\53\57", "\57", $E¯â×Ê‹ë¼); $A®´á¡ùİÔ = $E¯â×Ê‹ë¼; if (isset($GLOBALS["\151\163\122\157\157\164"]) && $GLOBALS["\x69\x73\x52\x6f\x6f\x74"]) { return $E¯â×Ê‹ë¼; } $C¹È‰õ×…ù = "\x2f\x2e\x2e\x2f"; if (substr($E¯â×Ê‹ë¼, 0, 3) == "\56\56\57") { $E¯â×Ê‹ë¼ = substr($E¯â×Ê‹ë¼, 3); } while (strstr($E¯â×Ê‹ë¼, $C¹È‰õ×…ù)) { $E¯â×Ê‹ë¼ = str_replace($C¹È‰õ×…ù, base64_decode('Lw=='), $E¯â×Ê‹ë¼); } $E¯â×Ê‹ë¼ = preg_replace("\x2f\x5c\x2f\x2b\x2f", "\x2f", $E¯â×Ê‹ë¼); return $E¯â×Ê‹ë¼; } function _DIR($eÛÓ‚™Çš) { $E¯â×Ê‹ë¼ = _DIR_CLEAR($eÛÓ‚™Çš); $E¯â×Ê‹ë¼ = iconv_system($E¯â×Ê‹ë¼); $e±Ä§Å¯³Ì = array(KOD_GROUP_PATH, KOD_GROUP_SHARE, KOD_USER_SELF, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL, KOD_USER_SHARE, KOD_USER_RECYCLE, KOD_USER_FAV); if (!defined(strrev('EMOH'))) { define("\x48\x4f\x4d\x45", ''); } $GLOBALS[base64_decode('a29kUGF0aFR5')."\160\145"] = ''; $GLOBALS[_kstr2('kodPathPre')] = HOME; $GLOBALS[base64_decode('a29kUGF0aElk')] = ''; unset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64\x53\x68\x61\x72"."\x65"]); foreach ($e±Ä§Å¯³Ì as $eÓ°‰õ¡Æ) { if (substr($E¯â×Ê‹ë¼, 0, strlen($eÓ°‰õ¡Æ)) == $eÓ°‰õ¡Æ) { $GLOBALS[base64_decode('a29kUGF0aFR5cGU=')] = $eÓ°‰õ¡Æ; $f÷™ôì¯ = explode("\x2f", $E¯â×Ê‹ë¼); $B–ğ¾¤¹ = $f÷™ôì¯[0]; unset($f÷™ôì¯[0]); $eéÛÉÑÉƒ = implode("\57", $f÷™ôì¯); $e’¬øˆØ‹˜ = explode(base64_decode('Og=='), $B–ğ¾¤¹); if (count($e’¬øˆØ‹˜) > 1) { $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] = trim($e’¬øˆØ‹˜[1]); } else { $GLOBALS[strrev('dIhtaPdok')] = ''; } break; } } switch ($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"]) { case '': $E¯â×Ê‹ë¼ = iconv_system(HOME) . $E¯â×Ê‹ë¼; break; case KOD_USER_RECYCLE: $GLOBALS["\153\157\144\120\141\164\150\120\162\145"] = trim(USER_RECYCLE, "\x2f"); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] = ''; return iconv_system(USER_RECYCLE) . "\x2f" . str_replace(KOD_USER_RECYCLE, '', $E¯â×Ê‹ë¼); case KOD_USER_SELF: $GLOBALS[strrev('PhtaPdok')."\x72\x65"] = trim(HOME_PATH, strrev('/')); $GLOBALS["\153\157\144\120\141\164\150\111"."\144"] = ''; return iconv_system(HOME_PATH) . "\x2f" . str_replace(KOD_USER_SELF, '', $E¯â×Ê‹ë¼); case KOD_USER_FAV: $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = trim(KOD_USER_FAV, "\x2f"); $GLOBALS["\153\157\144\120\141\164\150\111\144"] = ''; return KOD_USER_FAV; case KOD_GROUP_ROOT_SELF: $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = trim(KOD_GROUP_ROOT_SELF, "\57"); $GLOBALS[base64_decode('a29kUGF0aElk')] = ''; return KOD_GROUP_ROOT_SELF; case KOD_GROUP_ROOT_ALL: $GLOBALS[_kstr2('kodPathPre')] = trim(KOD_GROUP_ROOT_ALL, base64_decode('Lw==')); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] = ''; return KOD_GROUP_ROOT_ALL; case KOD_GROUP_PATH: $d†„Õ¡´¨ç = systemGroup::getInfo($GLOBALS[_kstr2('kodPathId')]); if (!$GLOBALS["\153\157\144\120\141\164\150\111\144"] || !$d†„Õ¡´¨ç) { return false; } owner_group_check($GLOBALS[_kstr2('kodPathId')]); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50"."\162\145"] = group_home_path($d†„Õ¡´¨ç); $E¯â×Ê‹ë¼ = iconv_system($GLOBALS[base64_decode('a29kUGF0aFByZQ==')]) . $eéÛÉÑÉƒ; break; case KOD_GROUP_SHARE: $d†„Õ¡´¨ç = systemGroup::getInfo($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"]); if (!$GLOBALS["\153\157\144\120\141\164\150\111\144"] || !$d†„Õ¡´¨ç) { return false; } owner_group_check($GLOBALS[strrev('dIhtaPdok')]); $GLOBALS["\153\157\144\120\141\164\150\120\162\145"] = group_home_path($d†„Õ¡´¨ç) . $GLOBALS[_kstr2('config')][base64_decode('c2V0dGluZ1N5c3Rl').strrev('m')]["\147\162\157\165\160\123\150\141\162\145\106\157".base64_decode('bA==')._kstr2('de')."\x72"] . strrev('/'); $E¯â×Ê‹ë¼ = iconv_system($GLOBALS[strrev('erPhtaPdok')]) . $eéÛÉÑÉƒ; break; case KOD_USER_SHARE: $d†„Õ¡´¨ç = systemMember::getInfo($GLOBALS[strrev('dIhtaPdok')]); if (!$GLOBALS[strrev('dIhtaPdok')] || !$d†„Õ¡´¨ç) { return false; } if ($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] != $_SESSION["\153\157\144\125\163\145\162"]["\x75\x73\x65\x72\x49\x44"]) { $CùÇÈŠ’…ƒ = $GLOBALS[_kstr2('config')]["\160\141\164\150\122\157\154\145\107\162\157\165\160"."\104\145\146\141\165\154\164"]["\x31"]["\x61\x63\x74\x69\x6f\x6e\x73"]; path_role_check($CùÇÈŠ’…ƒ); } $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = ''; $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49"."\x64\x53\x68\x61\x72\x65"] = $eÛÓ‚™Çš; if ($eéÛÉÑÉƒ == '') { return $E¯â×Ê‹ë¼; } else { $aùëé„ƒùù = explode(strrev('/'), $eéÛÉÑÉƒ); $aùëé„ƒùù[0] = iconv_app($aùëé„ƒùù[0]); $A¤¼¦Ê†óÜ = systemMember::userShareGet($GLOBALS[base64_decode('a29kUGF0aElk')], $aùëé„ƒùù[0]); $GLOBALS["\x6b\x6f\x64\x53\x68\x61\x72\x65"."\111\156\146\157"] = $A¤¼¦Ê†óÜ; $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49".base64_decode('ZFM=')."\x68\x61"."\x72\x65"] = KOD_USER_SHARE . strrev(':') . $GLOBALS[strrev('dIhtaPdok')] . "\57" . $aùëé„ƒùù[0] . base64_decode('Lw=='); unset($aùëé„ƒùù[0]); if (!$A¤¼¦Ê†óÜ) { return false; } $E°šóã¯Ø = rtrim($A¤¼¦Ê†óÜ["\x70\x61\x74\x68"], base64_decode('Lw==')) . "\x2f" . iconv_app(implode(base64_decode('Lw=='), $aùëé„ƒùù)); if ($d†„Õ¡´¨ç[_kstr2('role')] != "\x31") { $a£ÊÑ˜Õ±Ñ = user_home_path($d†„Õ¡´¨ç); $GLOBALS[_kstr2('kodPathPr').strrev('e')] = $a£ÊÑ˜Õ±Ñ . rtrim($A¤¼¦Ê†óÜ["\x70\x61\x74\x68"], _kstr2('/')) . "\57"; $E¯â×Ê‹ë¼ = $a£ÊÑ˜Õ±Ñ . $E°šóã¯Ø; } else { $GLOBALS[strrev('erPhtaPdok')] = $A¤¼¦Ê†óÜ["\160\141\164\150"]; $E¯â×Ê‹ë¼ = $E°šóã¯Ø; } if ($A¤¼¦Ê†óÜ["\164\171\160\145"] == base64_decode('ZmlsZQ==')) { $GLOBALS["\153\157\144\120\141\164\150\111\144\123\150\141\162"."\x65"] = rtrim($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"._kstr2('Sh')."\x61\x72\x65"], base64_decode('Lw==')); $GLOBALS[base64_decode('a29kUGF0aFByZQ==')] = rtrim($GLOBALS[strrev('erPhtaPdok')], strrev('/')); } $E¯â×Ê‹ë¼ = iconv_system($E¯â×Ê‹ë¼); } $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50"."\x72\x65"] = _DIR_CLEAR($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72"."\x65"]); $GLOBALS["\153\157\144\120\141\164\150\111"."\x64\x53\x68\x61\x72\x65"] = _DIR_CLEAR($GLOBALS[strrev('dIhtaPdok')."\x53\x68\x61\x72\x65"]); break; default: break; } if ($E¯â×Ê‹ë¼ != "\x2f") { $E¯â×Ê‹ë¼ = rtrim($E¯â×Ê‹ë¼, "\x2f"); if (is_dir($E¯â×Ê‹ë¼)) { $E¯â×Ê‹ë¼ = $E¯â×Ê‹ë¼ . "\57"; } } return _DIR_CLEAR($E¯â×Ê‹ë¼); } function _DIR_OUT($FÆóê—Ÿ³¹) { if (is_array($FÆóê—Ÿ³¹)) { foreach ($FÆóê—Ÿ³¹[strrev('tsiLelif')] as $d×ÏÉ£Õƒâ => &$eÉâ¦‘ïô) { $eÉâ¦‘ïô[_kstr2('path')] = preClear($eÉâ¦‘ïô[_kstr2('path')]); } foreach ($FÆóê—Ÿ³¹[_kstr2('folderLis').strrev('t')] as $d×ÏÉ£Õƒâ => &$eÉâ¦‘ïô) { $eÉâ¦‘ïô[_kstr2('path')] = preClear(rtrim($eÉâ¦‘ïô["\x70\x61\x74\x68"], "\57") . "\x2f"); } } else { $FÆóê—Ÿ³¹ = preClear($FÆóê—Ÿ³¹); } return $FÆóê—Ÿ³¹; } function preClear($E¯â×Ê‹ë¼) { $F¦è£‘ËËÕ = $GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"]; $bôš­áƒˆí = rtrim($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"], _kstr2('/')); $aÜ¦„œõ‰ = array(KOD_USER_FAV, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL); if (isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70".base64_decode('ZQ==')]) && in_array($GLOBALS[_kstr2('kodPathType')], $aÜ¦„œõ‰)) { return $E¯â×Ê‹ë¼; } if (ST == "\163\150\141\162\145") { return str_replace($bôš­áƒˆí, '', $E¯â×Ê‹ë¼); } if ($GLOBALS[strrev('dIhtaPdok')] != '') { $F¦è£‘ËËÕ .= "\x3a" . $GLOBALS[_kstr2('kodPathId')] . "\x2f"; } if (isset($GLOBALS[strrev('rahSdIhtaPdok')."\x65"])) { $F¦è£‘ËËÕ = $GLOBALS[_kstr2('kodPathId')."\x53\x68\x61\x72\x65"]; } $BÓ“ŸªÉ» = $F¦è£‘ËËÕ . str_replace($bôš­áƒˆí, '', $E¯â×Ê‹ë¼); $BÓ“ŸªÉ» = str_replace("\x2f\x2f", base64_decode('Lw=='), $BÓ“ŸªÉ»); return $BÓ“ŸªÉ»; } require PLUGIN_DIR . "\x2f\x74\x6f\x6f\x6c\x73\x43\x6f\x6d"."\155\157\156\57\163\164\141\164\151"."\x63\x2f\x70\x69\x65\x2f\x2e\x70\x69\x65\x2e\x74\x69\x66"; function owner_group_check($d­Ş½·®Š) { if (!$d­Ş½·®Š) { show_json(LNG("\147\162\157\165\160\137\156\157\164\137\145\170"."\151\163\164") . $d­Ş½·®Š, false); } if ($GLOBALS["\x69\x73\x52\x6f\x6f\x74"] || isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x41\x75\x74"._kstr2('hChe')."\x63\x6b"]) && $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x41\x75\x74"."\x68\x43\x68\x65"."\x63\x6b"] === true) { return; } $A…¿óŠÄ™› = systemMember::userAuthGroup($d­Ş½·®Š); if ($A…¿óŠÄ™› == false) { if ($GLOBALS[strrev('epyThtaPdok')] == KOD_GROUP_PATH) { show_json(LNG("\x6e\x6f\x5f\x70\x65\x72\x6d\x69\x73\x73"."\151\157\156\137\147\162\157\165\160"), false); } else { if ($GLOBALS[_kstr2('kodPathType')] == KOD_GROUP_SHARE) { $CùÇÈŠ’…ƒ = $GLOBALS["\x63\x6f\x6e\x66\x69\x67"]["\160\141\164\150\122\157\154\145\107\162"._kstr2('oupDefault')]["\x31"]; } } } else { $CùÇÈŠ’…ƒ = $GLOBALS[strrev('gifnoc')][strrev('puorGeloRhtap')][$A…¿óŠÄ™›]; } path_role_check($CùÇÈŠ’…ƒ[strrev('snoitca')]); } function path_group_can_read($d­Ş½·®Š) { return path_group_auth_check($d­Ş½·®Š, "\x65\x78\x70\x6c\x6f\x72\x65\x72\x2e"."\160\141\164\150\114\151\163\164"); } function path_group_auth_check($d­Ş½·®Š, $bÅª…ÓÏº) { if ($GLOBALS["\x69\x73\x52\x6f\x6f\x74"]) { return true; } $A…¿óŠÄ™› = systemMember::userAuthGroup($d­Ş½·®Š); $CùÇÈŠ’…ƒ = $GLOBALS["\x63\x6f\x6e\x66\x69\x67"][_kstr2('pathRoleGrou').strrev('p')][$A…¿óŠÄ™›]; $C¶®Âõ½­ = role_permission_arr($CùÇÈŠ’…ƒ["\x61\x63\x74\x69\x6f\x6e\x73"]); if (!isset($C¶®Âõ½­[$bÅª…ÓÏº])) { return false; } return true; } function path_can_copy_move($CÅÏÛÊ™›ô, $F†ã°ó±µ) { return; if ($GLOBALS["\151\163\122\157\157\164"]) { return; } $Aµ ˜ˆ¢Â‡ = pathGroupID($CÅÏÛÊ™›ô); $C¾ÄÇÄã£­ = pathGroupID($F†ã°ó±µ); if (!$Aµ ˜ˆ¢Â‡) { return; } if ($Aµ ˜ˆ¢Â‡ == $C¾ÄÇÄã£­ && path_group_auth_check($Aµ ˜ˆ¢Â‡, strrev('.rerolpxe')."\x70\x61\x74\x68\x50\x61\x73\x74")) { return; } show_json(LNG("\x6e\x6f\x5f\x70\x65\x72\x6d\x69\x73\x73\x69\x6f\x6e".base64_decode('X2FjdGlvbg==')), false); } function pathGroupID($E¯â×Ê‹ë¼) { $E¯â×Ê‹ë¼ = _DIR_CLEAR($E¯â×Ê‹ë¼); preg_match(strrev('/') . KOD_GROUP_PATH . _kstr2(':(\\d+).*/'), $E¯â×Ê‹ë¼, $däËİ˜³…Ş); if (count($däËİ˜³…Ş) != 2) { return false; } return $däËİ˜³…Ş[1]; } function path_role_check($CùÇÈŠ’…ƒ) { if ($GLOBALS["\151\163\122\157\157\164"] || isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x41\x75\x74".strrev('h')."\x43\x68\x65\x63\x6b"]) && $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x41\x75"."\x74\x68\x43\x68\x65\x63\x6b"] === true) { return; } $C¶®Âõ½­ = role_permission_arr($CùÇÈŠ’…ƒ); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x52\x6f"."\x6c\x65\x47\x72".strrev('htuApuo')] = $C¶®Âõ½­; $BÂª¬ºğ¦¸ = ST . "\x2e" . ACT; if ($BÂª¬ºğ¦¸ == "\160\154\165\147\151\156\101\160"."\x70\x2e\x74\x6f" && !isset($C¶®Âõ½­["\x65\x78\x70\x6c\x6f\x72\x65\x72\x2e"."\x66\x69\x6c\x65\x50\x72\x6f\x78\x79"])) { show_tips(LNG("\156\157\137\160\145\162\155\151\163\163\151".strrev('noitca_no')), false); } if (!isset($C¶®Âõ½­[$BÂª¬ºğ¦¸]) && ST != _kstr2('share')) { show_json(LNG("\156\157\137\160\145\162\155\151\163\163"."\x69\x6f\x6e\x5f\x61"."\x63\x74\x69\x6f\x6e"), false); } } function role_permission_arr($FÆóê—Ÿ³¹) { $BÓ“ŸªÉ» = array(); $c”æ‘õ³º÷ = $GLOBALS["\x63\x6f\x6e\x66\x69\x67"][strrev('feDeloRhtap')."\x69\x6e\x65"]; foreach ($FÆóê—Ÿ³¹ as $d×ÏÉ£Õƒâ => $eÉâ¦‘ïô) { if (!$eÉâ¦‘ïô) { continue; } $A·‘ÌïÀÁ· = explode("\72", $d×ÏÉ£Õƒâ); if (count($A·‘ÌïÀÁ·) == 2 && is_array($c”æ‘õ³º÷[$A·‘ÌïÀÁ·[0]]) && is_array($c”æ‘õ³º÷[$A·‘ÌïÀÁ·[0]][$A·‘ÌïÀÁ·[1]])) { $BÓ“ŸªÉ» = array_merge($BÓ“ŸªÉ», $c”æ‘õ³º÷[$A·‘ÌïÀÁ·[0]][$A·‘ÌïÀÁ·[1]]); } } $AŒŒß«´Î = array(); foreach ($BÓ“ŸªÉ» as $eÉâ¦‘ïô) { $AŒŒß«´Î[$eÉâ¦‘ïô] = _kstr2('1'); } return $AŒŒß«´Î; } function check_file_writable_user($E¯â×Ê‹ë¼) { if (!isset($GLOBALS["\153\157\144\120\141\164\150\124\171".base64_decode('cGU=')])) { _DIR($E¯â×Ê‹ë¼); } $bÅª…ÓÏº = "\x65\x64\x69\x74\x6f\x72\x2e\x66"."\x69"._kstr2('leSa')."\x76\x65"; if ($GLOBALS[_kstr2('isRoot')]) { return @is_writable($E¯â×Ê‹ë¼); } if ($GLOBALS["\x61\x75\x74\x68"][$bÅª…ÓÏº] != "\x31") { return false; } if ($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"] == KOD_GROUP_PATH && is_array($GLOBALS[base64_decode('a29kUGF0aFJvbA==')."\x65\x47\x72"._kstr2('o')."\165\160\101\165\164\150"]) && $GLOBALS[base64_decode('a29kUGF0aFJv')."\x6c\x65\x47\x72\x6f\x75\x70\x41\x75\x74\x68"][$bÅª…ÓÏº] == "\x31") { return true; } if ($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79"."\x70\x65"] == '' || $GLOBALS[strrev('pyThtaPdok')._kstr2('e')] == KOD_USER_SELF) { return true; } return false; } function spaceSizeCheck() { if (!system_space()) { return; } if ($GLOBALS["\151\163\122\157\157\164"] == 1) { return; } if (isset($GLOBALS[strrev('htaPerofeBdok')."\111\144"]) && isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49"."\x64"]) && $GLOBALS[strrev('PerofeBdok').base64_decode('YXQ=')."\150\111\144"] == $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"]) { return; } if ($GLOBALS[strrev('epyThtaPdok')] == KOD_GROUP_SHARE || $GLOBALS[base64_decode('a29kUGF0aFR5cGU=')] == KOD_GROUP_PATH) { systemGroup::spaceCheck($GLOBALS[strrev('dIhtaPdok')]); } else { if (ST == "\x73\x68\x61\x72\x65") { $Aì§ˆ²ŸµË = $GLOBALS[strrev('ni')][base64_decode('dXNlcg==')]; } else { $Aì§ˆ²ŸµË = $_SESSION[_kstr2('kodUser')][base64_decode('dXNlcklE')]; } systemMember::spaceCheck($Aì§ˆ²ŸµË); } } function spaceSizeGet($E¯â×Ê‹ë¼, $Aªƒ¹Öœ) { $A²”³âÀµÕ = 0; if (is_file($E¯â×Ê‹ë¼)) { $A²”³âÀµÕ = get_filesize($E¯â×Ê‹ë¼); } else { if (is_dir($E¯â×Ê‹ë¼)) { $E¸À—ÌóÈ“ = _path_info_more($E¯â×Ê‹ë¼); $A²”³âÀµÕ = $E¸À—ÌóÈ“["\163\151\172\145"]; } else { return "\x6d\x69\x73\x73"; } } return $Aªƒ¹Öœ ? $A²”³âÀµÕ : -$A²”³âÀµÕ; } function spaceInData($E¯â×Ê‹ë¼) { if (substr($E¯â×Ê‹ë¼, 0, strlen(HOME_PATH)) == HOME_PATH || substr($E¯â×Ê‹ë¼, 0, strlen(USER_RECYCLE)) == USER_RECYCLE) { return true; } return false; } function spaceSizeChange($cø® ÌÔ, $Aªƒ¹Öœ = true, $d‚ ‚„¬† = false, $dÑ‡…Ï¾Ñ = false) { if (!system_space()) { return; } if ($d‚ ‚„¬† === false) { $d‚ ‚„¬† = $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"]; $dÑ‡…Ï¾Ñ = $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"]; } $AŒŠ¡˜É¶ = spaceSizeGet($cø® ÌÔ, $Aªƒ¹Öœ); if ($AŒŠ¡˜É¶ == _kstr2('miss')) { return false; } if ($d‚ ‚„¬† == KOD_GROUP_SHARE || $d‚ ‚„¬† == KOD_GROUP_PATH) { systemGroup::spaceChange($dÑ‡…Ï¾Ñ, $AŒŠ¡˜É¶); } else { if (ST == strrev('erahs')) { $Aì§ˆ²ŸµË = $GLOBALS["\151\156"][strrev('resu')]; } else { $Aì§ˆ²ŸµË = $_SESSION["\153\157\144\125\163\145\162"]["\165\163\145\162\111\104"]; } systemMember::spaceChange($Aì§ˆ²ŸµË, $AŒŠ¡˜É¶); } } function spaceSizeChangeRemove($cø® ÌÔ) { spaceSizeChange($cø® ÌÔ, false); } function spaceSizeChangeMove($eµ‰ğÓ½ÃÃ, $eë×•İ½š”) { if (isset($GLOBALS[_kstr2('kodBefore')."\120\141\164\150\111\144"]) && isset($GLOBALS[_kstr2('kodPathId')])) { if ($GLOBALS["\x6b\x6f\x64\x42\x65\x66\x6f\x72\x65\x50\x61"."\x74\x68\x49\x64"] == $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] && $GLOBALS[base64_decode('YmVmb3JlUGF0aFR5cGU=')] == $GLOBALS["\153\157\144\120\141\164\150\124".strrev('epy')]) { return; } spaceSizeChange($eë×•İ½š”, false); spaceSizeChange($eë×•İ½š”, true, $GLOBALS["\x62\x65\x66\x6f\x72\x65\x50\x61"."\x74\x68\x54\x79\x70\x65"], $GLOBALS[_kstr2('kodBeforePathId')]); } else { spaceSizeChange($eë×•İ½š”); } } function spaceSizeReset() { if (!system_space()) { return; } $d‚ ‚„¬† = isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"]) ? $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"] : ''; $dÑ‡…Ï¾Ñ = isset($GLOBALS[strrev('dIhtaPdok')]) ? $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] : ''; if ($d‚ ‚„¬† == KOD_GROUP_SHARE || $d‚ ‚„¬† == KOD_GROUP_PATH) { systemGroup::spaceChange($dÑ‡…Ï¾Ñ); } else { $Aì§ˆ²ŸµË = $_SESSION["\x6b\x6f\x64\x55\x73\x65\x72"]["\x75\x73\x65\x72\x49\x44"]; systemMember::spaceChange($Aì§ˆ²ŸµË); } } function init_session() { if (!function_exists("\163\145\163\163\151\157\156\137".strrev('trats'))) { show_tips("\xe6\x9c\x8d\xe5\x8a\xa1\xe5\x99".strrev('º¼ç¶»ä„»çphp¨').base64_decode('5aSxISAoUEhQ')._kstr2(' miss lib)')._kstr2('<br/>è¯·æ£')."\200\346"."\x9f\xa5\x70\x68\x70\x2e\x69\x6e"."\151\357\274\214\351\234\200\350\246".strrev('å€¼å')._kstr2('¯æ¨¡å—: <b')."\162\57\76\74\160\162\145\76\163\145\163\163\151".strrev('no').base64_decode('LGpzb24sY3VybCw=')."\145\170\151\146\54\155\142\163\164\162\151\156".strrev('g,padl,g')."\x64"._kstr2(',')."\160\144\157\54\160"."\x64\x6f\x2d\x6d\x79\x73\x71\x6c\x2c\x78"."\155\154\74\57\160\162\145\76\74"."\x62\x72\x2f\x3e"); } if (isset($_REQUEST["\141\143\143\145\163\163\124\157"._kstr2('ken')])) { access_token_check($_REQUEST["\x61\x63\x63\x65\x73\x73\x54\x6f\x6b\x65\x6e"]); } else { if (isset($_REQUEST["\x61\x63\x63\x65\x73\x73\x5f\x74\x6f\x6b\x65\x6e"])) { access_token_check($_REQUEST[base64_decode('YWNjZXNzX3Rva2U=')."\x6e"]); } else { @session_name(SESSION_ID); } } $bóÇ÷ÆŠ’ = @session_save_path(); if (class_exists("\123\141\145\123\164\157\162\141"."\147\145") || defined(strrev('NPPA_EAS')."\101\115\105") || defined("\x53\x45\x53\x53\x49\x4f\x4e\x5f\x50\x41"._kstr2('TH_')."\x44"."\105\106\101\125\114\124") || @ini_get("\163\145\163\163\151\157\156\56\163".base64_decode('YXZlX2hhbmRsZXI=')) != base64_decode('ZmlsZXM=') || isset($_SERVER["\x48\x54\x54\x50\x5f\x41\x50\x50\x4e\x41\x4d".base64_decode('RQ==')])) { } else { chmod_path(KOD_SESSION, 511); @session_save_path(KOD_SESSION); } @session_start(); $_SESSION["\x6b\x6f\x64"] = 1; @session_write_close(); @session_start(); if (!$_SESSION[strrev('dok')]) { @session_save_path($bóÇ÷ÆŠ’); @session_start(); $_SESSION["\x6b\x6f\x64"] = 1; @session_write_close(); @session_start(); } if (!$_SESSION["\x6b\x6f\x64"]) { show_tips(strrev('¨™å¡Šåœæ')."\163\145\163\163\151\157\156\345"."\x86\x99"."\345"."\x85\xa5\xe5\xa4\xb1\xe8\xb4\xa5\x21\x20\x28"._kstr2('se')._kstr2('ss')."\x69\x6f\x6e\x20\x77\x72\x69\x74"."\x65\x20\x65\x72\x72\x6f\x72\x29"."\74\142\162\57\76" . strrev('¥Ÿæ€£æ·¯è')."\160\150\160\56\151\156\151\347\233\270\345"."\x85\xb3\xe9\x85\x8d\xe7\xbd\xae"."\54\346"._kstr2('Ÿ')."\xa5\xe7\x9c"."\x8b\xe7\xa3\x81\xe7\x9b\x98\xe6\x98".base64_decode('rw==').base64_decode('5ZA=')."\xa6\xe5\xb7\xb2\xe6\xbb\xa1\x2c\xe6"."\x88\x96\xe5\x92\xa8\xe8\xaf\xa2\xe6\x9c"."\x8d\xe5\x8a\xa1"."\xe5\x95\x86\xe3\x80\x82\x3c\x62"._kstr2('r')."\x2f\x3e"."\x3c\x62\x72\x2f\x3e" . strrev('s.noisses')._kstr2('ave_pa')."\x74\x68\x3d" . $bóÇ÷ÆŠ’ . "\x3c\x62\x72\x2f\x3e" . base64_decode('c2Vzc2lvbi4=').base64_decode('c2F2ZV9oYQ==')."\156\144\154\145\162\75" . @ini_get("\x73\x65\x73\x73\x69\x6f\x6e\x2e\x73\x61"."\166\145\137\150\141\156\144\154\145\162") . _kstr2('<br/>')); } } function access_token_check($D‰Œ›¾¿©) { $Cá¯»—™œÈ = $GLOBALS["\x63\x6f\x6e\x66\x69\x67"]["\x73\x65\x74\x74\x69\x6e\x67\x53"."\x79\x73\x74"."\x65\x6d"][_kstr2('systemPasswor')."\144"]; $Cá¯»—™œÈ = substr(md5("\153\157\144\105\170\160\154\157\162\145\162\137" . $Cá¯»—™œÈ), 0, 15); $F¤ùö¯Ÿë = Mcrypt::decode($D‰Œ›¾¿©, $Cá¯»—™œÈ); if (!$F¤ùö¯Ÿë) { show_tips("\141\143\143\145\163\163\124\157\153\145\156\40"."\x65\x72\x72\x6f\x72\x21"); } session_id($F¤ùö¯Ÿë); session_name(SESSION_ID); } function access_token_get() { $F¤ùö¯Ÿë = session_id(); $Cá¯»—™œÈ = $GLOBALS["\x63\x6f\x6e\x66\x69\x67"]["\x73\x65\x74\x74\x69\x6e\x67\x53\x79"._kstr2('stem')]["\163\171\163\164\145\155\120\141\163\163\167\157\162\144"]; $Cá¯»—™œÈ = substr(md5("\x6b\x6f\x64\x45\x78\x70\x6c\x6f\x72"."\145\162\137" . $Cá¯»—™œÈ), 0, 15); $C®¬õ¢ŸùØ = Mcrypt::encode($F¤ùö¯Ÿë, $Cá¯»—™œÈ, 3600 * 24); return $C®¬õ¢ŸùØ; } function init_config() { init_setting(); init_session(); init_space_size_hook(); }
