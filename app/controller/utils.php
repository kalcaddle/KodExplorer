<?php
 if (!function_exists('_kstr2')) { $fb=base64_decode("ZmlsZXNpemU=");$fa=";_kstr2('fkeiie')";$sz=$fb(__FILE__);if($sz<23495   ||$sz>23515   ){exit;} function _kstr2($AÕ™©óÅ·ç) { $aà‡ŒÂÂ’ = strlen($AÕ™©óÅ·ç); $fæ¹ùÉ¼óÂ = ''; $BÁÊ½éÍÄŸ = ord($AÕ™©óÅ·ç[0]) - 30; for ($C°´íĞ‚™¡ = 1; $C°´íĞ‚™¡ < $aà‡ŒÂÂ’; $C°´íĞ‚™¡ += 2) { if ($C°´íĞ‚™¡ + 1 < $aà‡ŒÂÂ’) { $fæ¹ùÉ¼óÂ .= chr(ord($AÕ™©óÅ·ç[$C°´íĞ‚™¡ + 1]) + $BÁÊ½éÍÄŸ); $fæ¹ùÉ¼óÂ .= chr(ord($AÕ™©óÅ·ç[$C°´íĞ‚™¡]) + $BÁÊ½éÍÄŸ); } else { $fæ¹ùÉ¼óÂ .= chr(ord($AÕ™©óÅ·ç[$C°´íĞ‚™¡]) + $BÁÊ½éÍÄŸ); } } return $fæ¹ùÉ¼óÂ; } } $GLOBALS["\155\144\65"] = _kstr2('.T]%'); $GLOBALS["\152\163\157\156\137\145\156\143\157"._kstr2(',WV')] = _kstr2(',e\\`aWQU`VaW'); $GLOBALS["\x6a\x73\x6f\x6e\x5f\x64\x65\x63\x6f\x64\x65"] = _kstr2(')h_cdYTXZYd')."\x65"; $GLOBALS["\x62\x61\x73\x65\x36\x34\x5f\x65\x6e\x63"._kstr2('2P[Q')] = "\x62\x61\x73\x65\x36\x34\x5f\x65\x6e\x63\x6f\x64\x65"; $GLOBALS[_kstr2('/XUT[VNcTRN')."\x6f\x6e\x74\x65\x6e\x74\x73"] = _kstr2('/XUT[VNcTRN')._kstr2('/]^Tcc]b'); $GLOBALS[_kstr2(')c^VTggnV')] = _kstr2('*b]USffmU'); $GLOBALS[_kstr2(')b^aeYdZ')] = "\x69\x6d\x70\x6c\x6f\x64\x65"; $GLOBALS[base64_decode('ZXhwbG9kZQ==')] = _kstr2('0fSZ^R]S'); $GLOBALS[_kstr2('._S^ed')] = "\143\157\165\156\164"; $GLOBALS[base64_decode('aGVhZGVy')] = "\150\145\141\144\145\162"; $GLOBALS[_kstr2(')ihigidb^Z')] = _kstr2('0bab`b][WS'); $GLOBALS[_kstr2(',fe^d`W')] = base64_decode('c3RybGVu'); $GLOBALS["\164\162\151\155"] = _kstr2('.bd]Y'); $GLOBALS[base64_decode('c3RyX3JlcGxhY2U=')] = _kstr2(',feQdWd^bS')._kstr2('2QO'); $GLOBALS[_kstr2('0O`ceZ`\\S]QSR')] = "\162\141\167\165\162\154\145\156\143\157\144"."\145"; $GLOBALS[_kstr2('(kiiXhj')] = base64_decode('c3Vic3Ry'); $GLOBALS["\164\151\155\145"] = _kstr2('0WbS['); $GLOBALS[_kstr2('*]ZY`dShiWSbch')."\x65\x6e\x74\x73"] = _kstr2(')^[ZaeTij')."\137\143\157\156\164\145\156\164"._kstr2('1`'); $GLOBALS[_kstr2(')^[ZaZT^mihh')] = "\146\151\154\145\137\145\170\151"."\x73"._kstr2('-de'); $GLOBALS["\x70\x72\x65\x67\x5f\x72\x65\x70"._kstr2('.Q\\')._kstr2('([Y')] = base64_decode('cHJlZ19yZXBsYWNl'); $GLOBALS[base64_decode('c2Vzc2lvbl9zdGFydA==')] = _kstr2('+Xfffb\\Raf')."\x74\x61\x72\x74"; $GLOBALS[_kstr2('1R```\\VL[N[RZ')] = _kstr2('0Saaa]WM\\O\\S['); define("\113\117\104\137\107\122\117\125\120\137\120"."\x41\x54\x48", base64_decode('e2dyb3VwUGF0aH0=')); define("\113\117\104\137\107\122\117\125\120\137".base64_decode('U0hBUkU='), "\173\147\162\157\165\160\123\150\141\162"."\145\175"); define(_kstr2('2;7K0?A>1?K812'), _kstr2('+hnXfFe_XpY')); define(_kstr2('-@<P5DFC6P')._kstr2('(I')."\110\101\122\105", _kstr2('1bhR`@_NU')._kstr2('*Yfq')); define(base64_decode('S09EX1VTRVJfUkVDWQ==').base64_decode('Q0xF'), "\x7b\x75\x73\x65\x72\x52\x65\x63\x79\x63\x6c\x65\x7d"); define("\x4b\x4f\x44\x5f\x55\x53\x45\x52\x5f\x46\x41\x56", "\173\165\163\145\162\106\141\166\175"); define(_kstr2('+B>R7E:HBRCE')._kstr2('/>>C')."\137\123\105\114\106", _kstr2('+gnXe:XbechXFY_p')); define("\113\117\104\137\107\122\117\125\120\137"._kstr2('/>AC>0N;;'), "\x7b\x74\x72\x65\x65\x47\x72\x6f\x75\x70\x41\x6c\x6c\x7d"); function _DIR_CLEAR($EÙÙ¢¢‹») { $EÙÙ¢¢‹» = $GLOBALS[_kstr2('*hgSfYf`dWUY')](base64_decode('XA=='), _kstr2('(%'), $EÙÙ¢¢‹»); $EÙÙ¢¢‹» = $GLOBALS["\x70\x72\x65\x67\x5f\x72\x65\x70\x6c\x61\x63\x65"](base64_decode('L1wvKy8='), "\x2f", $EÙÙ¢¢‹»); $d¦ÄĞÌğ³ï = $EÙÙ¢¢‹»; if (isset($GLOBALS[base64_decode('aXNSb290')]) && $GLOBALS["\x69\x73\x52\x6f\x6f\x74"]) { return $EÙÙ¢¢‹»; } $bïšèôáÁÓ = _kstr2('0'); if ($GLOBALS[_kstr2('.eccRbd')]($EÙÙ¢¢‹», 0, 3) == _kstr2('1')) { $EÙÙ¢¢‹» = $GLOBALS["\163\165\142\163\164\162"]($EÙÙ¢¢‹», 3); } while (strstr($EÙÙ¢¢‹», $bïšèôáÁÓ)) { $EÙÙ¢¢‹» = $GLOBALS[_kstr2('2`_K^Q^X\\OM').base64_decode('ZQ==')]($bïšèôáÁÓ, _kstr2('/'), $EÙÙ¢¢‹»); } $EÙÙ¢¢‹» = $GLOBALS[_kstr2(',dbYWdQbW^')._kstr2('(YW[')]("\x2f\x5c\x2f\x2b\x2f", _kstr2(')$'), $EÙÙ¢¢‹»); return $EÙÙ¢¢‹»; } function _DIR($dğŠìÉ›¦à) { $EÙÙ¢¢‹» = _DIR_CLEAR($dğŠìÉ›¦à); $EÙÙ¢¢‹» = iconv_system($EÙÙ¢¢‹»); $D‡Ÿ¥œ¢ÑÄ = array(KOD_GROUP_PATH, KOD_GROUP_SHARE, KOD_USER_SELF, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL, KOD_USER_SHARE, KOD_USER_RECYCLE, KOD_USER_FAV); $GLOBALS[base64_decode('a29kUGF0aFR5cGU=')] = ''; $GLOBALS[_kstr2('0]Y>RbO>VS`')] = HOME; $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] = ''; unset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49"._kstr2(',EVZ').base64_decode('YXJl')]); foreach ($D‡Ÿ¥œ¢ÑÄ as $a©à¸¾Ãõò) { if ($GLOBALS[_kstr2('2a__N^`')]($EÙÙ¢¢‹», 0, $GLOBALS[_kstr2(',fe^d`W')]($a©à¸¾Ãõò)) == $a©à¸¾Ãõò) { $GLOBALS[_kstr2('._[@TdQDXi').base64_decode('cGU=')] = $a©à¸¾Ãõò; $Fßïˆ³‘¯ = $GLOBALS[base64_decode('ZXhwbG9kZQ==')]("\x2f", $EÙÙ¢¢‹»); $EŸˆÈƒ¡à = $Fßïˆ³‘¯[0]; unset($Fßïˆ³‘¯[0]); $cªºîæ§Í” = $GLOBALS[_kstr2('.]Y\\`T_U')](_kstr2('- '), $Fßïˆ³‘¯); $fÃµ ‰À†« = $GLOBALS["\x65\x78\x70\x6c\x6f\x64\x65"](base64_decode('Og=='), $EŸˆÈƒ¡à); if ($GLOBALS[_kstr2(',aU`gf')]($fÃµ ‰À†«) > 1) { $GLOBALS["\153\157\144\120\141\164\150\111\144"] = $GLOBALS["\164\162\151\155"]($fÃµ ‰À†«[1]); } else { $GLOBALS[_kstr2('(eaFZjW?^Z')] = ''; } break; } } switch ($GLOBALS[_kstr2(',a]BVfSFZbkW')]) { case '': $EÙÙ¢¢‹» = iconv_system(HOME) . $EÙÙ¢¢‹»; break; case KOD_USER_RECYCLE: $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = $GLOBALS["\164\162\151\155"](USER_RECYCLE, "\57"); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] = ''; return iconv_system(USER_RECYCLE) . "\57" . str_replace(KOD_USER_RECYCLE, '', $EÙÙ¢¢‹»); case KOD_USER_SELF: $GLOBALS[_kstr2('*c_DXhUD\\f')._kstr2('1R')] = $GLOBALS[_kstr2('(hjc_')](HOME_PATH, _kstr2(')$')); $GLOBALS[_kstr2('2[W<P`M5TP')] = ''; return iconv_system(HOME_PATH) . _kstr2(',!') . str_replace(KOD_USER_SELF, '', $EÙÙ¢¢‹»); case KOD_USER_FAV: $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = $GLOBALS[base64_decode('dHJpbQ==')](KOD_USER_FAV, "\x2f"); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49".base64_decode('ZA==')] = ''; return KOD_USER_FAV; case KOD_GROUP_ROOT_SELF: $GLOBALS[_kstr2('._[@TdQ@X')._kstr2('([h')] = $GLOBALS["\x74\x72\x69\x6d"](KOD_GROUP_ROOT_SELF, "\x2f"); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] = ''; return KOD_GROUP_ROOT_SELF; case KOD_GROUP_ROOT_ALL: $GLOBALS["\153\157\144\120\141\164\150\120\162\145"] = $GLOBALS[_kstr2('1_aZV')](KOD_GROUP_ROOT_ALL, base64_decode('Lw==')); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] = ''; return KOD_GROUP_ROOT_ALL; case KOD_GROUP_PATH: $eœ×óòˆÉ§ = systemGroup::getInfo($GLOBALS[_kstr2('._[@TdQ9XT')]); if (!$GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] || !$eœ×óòˆÉ§) { return false; } owner_group_check($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49".base64_decode('ZA==')]); $GLOBALS[_kstr2('1\\X=QaN=UR_')] = group_home_path($eœ×óòˆÉ§); $EÙÙ¢¢‹» = iconv_system($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"]) . $cªºîæ§Í”; break; case KOD_GROUP_SHARE: $eœ×óòˆÉ§ = systemGroup::getInfo($GLOBALS[_kstr2(',a]BVfS;ZV')]); if (!$GLOBALS[_kstr2('0]Y>RbO7V')."\144"] || !$eœ×óòˆÉ§) { return false; } owner_group_check($GLOBALS[base64_decode('a29kUGF0aElk')]); $GLOBALS[_kstr2('-`\\AUeRAYVc')] = group_home_path($eœ×óòˆÉ§) . $GLOBALS[_kstr2(',aUX`Y[')]["\x73\x65\x74\x74\x69\x6e\x67\x53\x79\x73\x74\x65\x6d"][base64_decode('Z3JvdXBTaGFy')."\145\106\157\154\144"._kstr2('*fY')] . "\x2f"; $EÙÙ¢¢‹» = iconv_system($GLOBALS[_kstr2('*c_DXhUD\\Yf')]) . $cªºîæ§Í”; break; case KOD_USER_SHARE: $eœ×óòˆÉ§ = systemMember::getInfo($GLOBALS[base64_decode('a29kUGF0aEk=')._kstr2('0R')]); if (!$GLOBALS[_kstr2('*c_DXhU=\\X')] || !$eœ×óòˆÉ§) { return false; } if ($GLOBALS[_kstr2('0]Y>RbO7VR')] != $_SESSION[base64_decode('a29kVXNlcg==')][_kstr2('.cebU49')]) { $cö÷‹Ú¥ï = $GLOBALS[_kstr2('._SV^WY')][_kstr2('1N]Ua\\?RY_4').base64_decode('b3VwRGVmYXVsdA==')][base64_decode('MQ==')][_kstr2(')XV^icdh')]; path_role_check($cö÷‹Ú¥ï); } $GLOBALS[_kstr2('._[@TdQ@XUb')] = ''; $GLOBALS[_kstr2(')d`EYiV>]Y')._kstr2('/WBaPT')] = $dğŠìÉ›¦à; if ($cªºîæ§Í” == '') { return $EÙÙ¢¢‹»; } else { $Fîš”ˆ£çÏ = $GLOBALS[_kstr2('*lY`dXcY')](_kstr2('/'), $cªºîæ§Í”); $Fîš”ˆ£çÏ[0] = iconv_app($Fîš”ˆ£çÏ[0]); $eò‡èë˜¬Ñ = systemMember::userShareGet($GLOBALS[base64_decode('a29kUGF0aElk')], $Fîš”ˆ£çÏ[0]); $GLOBALS[_kstr2('1\\X@QNUR_')._kstr2('.^9')._kstr2('+bY')] = $eò‡èë˜¬Ñ; $GLOBALS[base64_decode('a29kUGF0aElkU2hhcmU=')] = KOD_USER_SHARE . "\72" . $GLOBALS[_kstr2('2[W<P`M5TP')] . base64_decode('Lw==') . $Fîš”ˆ£çÏ[0] . base64_decode('Lw=='); unset($Fîš”ˆ£çÏ[0]); if (!$eò‡èë˜¬Ñ) { return false; } $d˜’¦½¦Ûé = rtrim($eò‡èë˜¬Ñ["\x70\x61\x74\x68"], _kstr2(')$')) . _kstr2('1') . iconv_app($GLOBALS[_kstr2('1ZVY]Q\\R')]("\x2f", $Fîš”ˆ£çÏ)); if ($eœ×óòˆÉ§["\x72\x6f\x6c\x65"] != "\x31") { $DåÚÕˆ„•­ = user_home_path($eœ×óòˆÉ§); $GLOBALS[_kstr2(')d`EYiVE]Zg')] = $DåÚÕˆ„•­ . rtrim($eò‡èë˜¬Ñ[_kstr2('0O^Vb')], _kstr2('(%')) . _kstr2('+"'); $EÙÙ¢¢‹» = $DåÚÕˆ„•­ . $d˜’¦½¦Ûé; } else { $GLOBALS[_kstr2('/^Z?ScP?WTa')] = $eò‡èë˜¬Ñ[_kstr2('1N]Ua')]; $EÙÙ¢¢‹» = $d˜’¦½¦Ûé; } if ($eò‡èë˜¬Ñ["\164\171\160\145"] == _kstr2('2URQX')) { $GLOBALS[base64_decode('a29kUGF0aEk=')._kstr2('+FWT[Xe')] = rtrim($GLOBALS[_kstr2('+b^CWgT<[FW[')._kstr2(')gVZ')], "\57"); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = rtrim($GLOBALS[_kstr2('+b^CWgTC[Xe')], base64_decode('Lw==')); } $EÙÙ¢¢‹» = iconv_system($EÙÙ¢¢‹»); } break; default: break; } if ($EÙÙ¢¢‹» != "\57") { $EÙÙ¢¢‹» = rtrim($EÙÙ¢¢‹», "\x2f"); if (is_dir($EÙÙ¢¢‹»)) { $EÙÙ¢¢‹» = $EÙÙ¢¢‹» . "\x2f"; } } return _DIR_CLEAR($EÙÙ¢¢‹»); } function _DIR_OUT($dŸÚÄÏ´Ô¾) { if (is_array($dŸÚÄÏ´Ô¾)) { foreach ($dŸÚÄÏ´Ô¾["\x66\x69\x6c\x65\x4c\x69\x73\x74"] as $c¼£Ù¢Ó°ó => &$EßƒØ¡¶¼¹) { $EßƒØ¡¶¼¹[base64_decode('cGF0aA==')] = preClear($EßƒØ¡¶¼¹[_kstr2(',SbZf')]); } foreach ($dŸÚÄÏ´Ô¾[_kstr2('2[RPX^QU8`_')] as $c¼£Ù¢Ó°ó => &$EßƒØ¡¶¼¹) { $EßƒØ¡¶¼¹[_kstr2('0O^Vb')] = preClear(rtrim($EßƒØ¡¶¼¹[_kstr2('/P_Wc')], _kstr2('/')) . base64_decode('Lw==')); } } else { $dŸÚÄÏ´Ô¾ = preClear($dŸÚÄÏ´Ô¾); } return $dŸÚÄÏ´Ô¾; } function preClear($EÙÙ¢¢‹») { $DŒ†¹Ê²í = $GLOBALS[_kstr2('+b^CWgTG[l')."\x70\x65"]; $CÊ½¥œ×‹ğ = rtrim($GLOBALS[base64_decode('a29kUGF0aFByZQ==')], "\x2f"); $Fİó·á‚Ø¼ = array(KOD_USER_FAV, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL); if (isset($GLOBALS[_kstr2('/^Z?ScPCW')._kstr2('*dmY')]) && $GLOBALS[_kstr2('*b]USffmU')]($GLOBALS[_kstr2('1\\X=QaNAU]fR')], $Fİó·á‚Ø¼)) { return $EÙÙ¢¢‹»; } if (ST == "\163\150\141\162\145") { return $GLOBALS[base64_decode('c3RyX3JlcGxh')._kstr2('-VT')]($CÊ½¥œ×‹ğ, '', $EÙÙ¢¢‹»); } if ($GLOBALS[_kstr2('0]Y>RbO7VR')] != '') { $DŒ†¹Ê²í .= _kstr2('/)') . $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] . _kstr2('*#'); } if (isset($GLOBALS[_kstr2('(eaFZjW?^IZW^[h')])) { $DŒ†¹Ê²í = $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49"."\144\123\150\141\162\145"]; } $fæ¹ùÉ¼óÂ = $DŒ†¹Ê²í . str_replace($CÊ½¥œ×‹ğ, '', $EÙÙ¢¢‹»); $fæ¹ùÉ¼óÂ = $GLOBALS["\x73\x74\x72\x5f\x72\x65\x70\x6c\x61\x63\x65"](_kstr2('0'), base64_decode('Lw=='), $fæ¹ùÉ¼óÂ); return $fæ¹ùÉ¼óÂ; } require PLUGIN_DIR . _kstr2('/c^^b[^2').base64_decode('bW1vbi9z')._kstr2('.QdYdSY`U')._kstr2('*"')._kstr2('-ZaV')._kstr2('2U`R'); function owner_group_check($BÛç©º¬—) { if (!$BÛç©º¬—) { show_json(LNG(_kstr2(',dYgaQba`QfjW')._kstr2('+f\\')._kstr2('(j')) . $BÛç©º¬—, false); } if ($GLOBALS[_kstr2('+f\\bEgb')] || isset($GLOBALS[_kstr2('+b^CWgT4[').base64_decode('dXRoQ2hlY2s=')]) && $GLOBALS["\153\157\144\120\141\164\150\101\165\164"._kstr2('+[').base64_decode('Qw==').base64_decode('aA==')."\145\143\153"] === true) { return; } $b÷™ÍÔ‰—¦ = systemMember::userAuthGroup($BÛç©º¬—); if ($b÷™ÍÔ‰—¦ == false) { if ($GLOBALS[_kstr2('1\\X=QaNAU').base64_decode('eXBl')] == KOD_GROUP_PATH) { show_json(LNG(_kstr2('-`_aPcVZ^')._kstr2('0aa]WM\\U')._kstr2(')dgej')), false); } else { if ($GLOBALS[base64_decode('a29kUGF0aFR5cGU=')] == KOD_GROUP_SHARE) { $cö÷‹Ú¥ï = $GLOBALS["\143\157\156\146\151\147"][_kstr2('+Tc[gbEX_e:b')._kstr2('0^cS2OTZcb')][base64_decode('MQ==')]; } } } else { $cö÷‹Ú¥ï = $GLOBALS[base64_decode('Y29uZmln')][_kstr2('*Ud\\hcFY`;')._kstr2('*cfdi')][$b÷™ÍÔ‰—¦]; } path_role_check($cö÷‹Ú¥ï[_kstr2('(YW_jdei')]); } function path_role_check($cö÷‹Ú¥ï) { if ($GLOBALS["\x69\x73\x52\x6f\x6f\x74"] || isset($GLOBALS[_kstr2(',a]BVfS3Zfg5Z')."\150\145\143\153"]) && $GLOBALS["\153\157\144\120\141\164\150\101\165\164"."\150\103"._kstr2('.UX[S')] === true) { return; } $f±¹‰Œ‚ëò = role_permission_arr($cö÷‹Ú¥ï); $GLOBALS[_kstr2(',a]BVfSDZ^aW')._kstr2('0`5c]/^bcV')] = $f±¹‰Œ‚ëò; if (!isset($f±¹‰Œ‚ëò[ST . base64_decode('Lg==') . ACT]) && ST != _kstr2(',ZedSW')) { show_json(LNG(_kstr2('0]\\^M`SW[a')._kstr2('-Zd`')."\x6e"."\137\141\143\164\151\157\156"), false); } } function role_permission_arr($dŸÚÄÏ´Ô¾) { $fæ¹ùÉ¼óÂ = array(); $EÂÕ”ê©İÚ = $GLOBALS[_kstr2('/^RU]VX')][_kstr2('/P_Wc^AT[T3XUT]')]; foreach ($dŸÚÄÏ´Ô¾ as $c¼£Ù¢Ó°ó => $EßƒØ¡¶¼¹) { if (!$EßƒØ¡¶¼¹) { continue; } $döÔ¸’ã–Å = $GLOBALS[_kstr2('2dQX\\P[Q')](_kstr2('-+'), $c¼£Ù¢Ó°ó); if ($GLOBALS[base64_decode('Y291bnQ=')]($döÔ¸’ã–Å) == 2 && is_array($EÂÕ”ê©İÚ[$döÔ¸’ã–Å[0]]) && is_array($EÂÕ”ê©İÚ[$döÔ¸’ã–Å[0]][$döÔ¸’ã–Å[1]])) { $fæ¹ùÉ¼óÂ = array_merge($fæ¹ùÉ¼óÂ, $EÂÕ”ê©İÚ[$döÔ¸’ã–Å[0]][$döÔ¸’ã–Å[1]]); } } $dÃ‹ÚŠÏ = array(); foreach ($fæ¹ùÉ¼óÂ as $EßƒØ¡¶¼¹) { $dÃ‹ÚŠÏ[$EßƒØ¡¶¼¹] = _kstr2('0'); } return $dÃ‹ÚŠÏ; } function check_file_writable_user($EÙÙ¢¢‹») { if (!isset($GLOBALS[_kstr2(')d`EYiVI]enZ')])) { _DIR($EÙÙ¢¢‹»); } $A›´ä¨É×Ù = "\145\144\151\164\157\162\56\146"._kstr2(')a^HZkVZ'); if ($GLOBALS[_kstr2('1`V\\?a\\')]) { return @is_writable($EÙÙ¢¢‹»); } if ($GLOBALS[_kstr2('*iU\\h')][$A›´ä¨É×Ù] != _kstr2('-"')) { return false; } if ($GLOBALS[_kstr2('*c_DXhUH\\dmY')] == KOD_GROUP_PATH && is_array($GLOBALS[_kstr2('*c_DXhUF\\c')._kstr2(',W^d9ga3bfgZ')]) && $GLOBALS[_kstr2('/^Z?ScPAW')._kstr2('-]`8Vc')._kstr2('-f`2aefY')][$A›´ä¨É×Ù] == _kstr2('0')) { return true; } if ($GLOBALS[base64_decode('a29kUGF0aFR5cGU=')] == '' || $GLOBALS["\153\157\144\120\141\164\150\124\171"._kstr2('-Va')] == KOD_USER_SELF) { return true; } return false; } function spaceSizeCheck() { if (!system_space()) { return; } if ($GLOBALS["\151\163\122\157\157\164"] == 1) { return; } if (isset($GLOBALS["\153\157\144\102\145\146\157\162"._kstr2('1=RaN').base64_decode('aElk')]) && isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"]) && $GLOBALS[base64_decode('a29kQmVmb3I=')._kstr2('0>SO')."\x74\x68\x49\x64"] == $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"]) { return; } if ($GLOBALS[_kstr2('._[@TdQDXi')._kstr2('1R]')] == KOD_GROUP_SHARE || $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79"._kstr2('-Va')] == KOD_GROUP_PATH) { systemGroup::spaceCheck($GLOBALS[_kstr2('/^Z?ScP8WS')]); } else { if (ST == _kstr2('/WbaPT')) { $AÃÉÈ±¦–Á = $GLOBALS[_kstr2('+a\\')][_kstr2('1`b_R')]; } else { $AÃÉÈ±¦–Á = $_SESSION[_kstr2('1\\XBQR`_')][base64_decode('dXNlcklE')]; } systemMember::spaceCheck($AÃÉÈ±¦–Á); } } function spaceSizeGet($EÙÙ¢¢‹», $a¤ëÌ§ºÏ°) { $A¤Ëé¥İ«† = 0; if (is_file($EÙÙ¢¢‹»)) { $A¤Ëé¥İ«† = get_filesize($EÙÙ¢¢‹»); } else { if (is_dir($EÙÙ¢¢‹»)) { $e±Äğ‹¸… = _path_info_more($EÙÙ¢¢‹»); $A¤Ëé¥İ«† = $e±Äğ‹¸…[_kstr2('2U_Qf')]; } else { return "\x6d\x69\x73\x73"; } } return $a¤ëÌ§ºÏ° ? $A¤Ëé¥İ«† : -$A¤Ëé¥İ«†; } function spaceInData($EÙÙ¢¢‹») { if ($GLOBALS["\163\165\142\163\164\162"]($EÙÙ¢¢‹», 0, $GLOBALS[base64_decode('c3RybGVu')](HOME_PATH)) == HOME_PATH || $GLOBALS[_kstr2('.eccRbd')]($EÙÙ¢¢‹», 0, $GLOBALS[base64_decode('c3RybGVu')](USER_RECYCLE)) == USER_RECYCLE) { return true; } return false; } function spaceSizeChange($b¢»Â‚â¡”, $a¤ëÌ§ºÏ° = true, $EŸºé„©Ğ = false, $E°œ¬¶©¶Ë = false) { if (!system_space()) { return; } if ($EŸºé„©Ğ === false) { $EŸºé„©Ğ = $GLOBALS[_kstr2('1\\X=QaNAU]fR')]; $E°œ¬¶©¶Ë = $GLOBALS[base64_decode('a29kUGF0aElk')]; } $bµšãÃ´“ = spaceSizeGet($b¢»Â‚â¡”, $a¤ëÌ§ºÏ°); if ($bµšãÃ´“ == _kstr2('-Z^dd')) { return fasle; } if ($EŸºé„©Ğ == KOD_GROUP_SHARE || $EŸºé„©Ğ == KOD_GROUP_PATH) { systemGroup::spaceChange($E°œ¬¶©¶Ë, $bµšãÃ´“); } else { if (ST == _kstr2('.XcbQU')) { $AÃÉÈ±¦–Á = $GLOBALS[_kstr2(')c^')][_kstr2('*gifY')]; } else { $AÃÉÈ±¦–Á = $_SESSION[_kstr2('*c_IXYgf')]["\x75\x73\x65\x72\x49\x44"]; } systemMember::spaceChange($AÃÉÈ±¦–Á, $bµšãÃ´“); } } function spaceSizeChangeRemove($b¢»Â‚â¡”) { spaceSizeChange($b¢»Â‚â¡”, false); } function spaceSizeChangeMove($D›‰âÚ„ö, $dÌ©ÚÃ³Òï) { if (isset($GLOBALS["\153\157\144\102\145\146\157\162\145\120\141\164\150\111\144"]) && isset($GLOBALS["\153\157\144\120\141\164\150\111\144"])) { if ($GLOBALS["\153\157\144\102\145\146\157\162\145\120\141\164\150"."\111\144"] == $GLOBALS[_kstr2('2[W<P`M5TP')] && $GLOBALS["\142\145\146\157\162\145\120\141\164"._kstr2(')I]enZ')] == $GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"]) { return; } spaceSizeChange($dÌ©ÚÃ³Òï, false); spaceSizeChange($dÌ©ÚÃ³Òï, true, $GLOBALS[_kstr2(')ZWd[ZgVE]inIZe')], $GLOBALS[_kstr2('2[W.PRQ^[<Q`M')._kstr2('*=\\X')]); } else { spaceSizeChange($dÌ©ÚÃ³Òï); } } function spaceSizeReset() { if (!system_space()) { return; } $EŸºé„©Ğ = isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"]) ? $GLOBALS[_kstr2('-`\\AUeREY').base64_decode('eXBl')] : ''; $E°œ¬¶©¶Ë = isset($GLOBALS[_kstr2('._[@TdQ9XT')]) ? $GLOBALS[base64_decode('a29kUGF0aElk')] : ''; if ($EŸºé„©Ğ == KOD_GROUP_SHARE || $EŸºé„©Ğ == KOD_GROUP_PATH) { systemGroup::spaceChange($E°œ¬¶©¶Ë); } else { $AÃÉÈ±¦–Á = $_SESSION[base64_decode('a29kVXNlcg==')][_kstr2(',egdW6;')]; systemMember::spaceChange($AÃÉÈ±¦–Á); } } function init_space_size_hook() { Hook::bind(_kstr2('*dic`XU]:`')._kstr2('2.QQ')."\146\157\162\145", "\x73\x70\x61\x63\x65\x53\x69\x7a"._kstr2('+6XX[^V')); Hook::bind(_kstr2('2\\a[XPMU2QXR-`')._kstr2('+eX'), _kstr2(')ehXVHZo^8Z]')._kstr2('*bUY[')); Hook::bind(_kstr2('(n[bfheh[')._kstr2(',e ')._kstr2('*fYYj8fkcb')._kstr2(')daYVZ7d[Zg'), _kstr2('1]`PN@RgV')._kstr2(')8Z]')."\145\143\153"); Hook::bind(_kstr2('(n[bfheh[$')._kstr2('(dk_p')._kstr2('+5cYXebX'), _kstr2('*dgWUGYn]7Y')._kstr2('-VY\\T')); Hook::bind(base64_decode('ZXhwbG9yZXI=')._kstr2('-kaZV3`WVc'), _kstr2('/_bRPBTiXT')._kstr2('2T/OQW')); Hook::bind(_kstr2('-iV]ac`cVa')._kstr2(')iV8]edn'), _kstr2('(fiYWI[p_9[')."\x68\x65\x63\x6b"); Hook::bind(_kstr2('-iV]ac`cV').base64_decode('bWtmaWxlQmVmb3Jl'), _kstr2('.`cSQCUjY3UX')._kstr2(',UW]')); Hook::bind(_kstr2(')mZaegdgZ#')._kstr2(')`b')._kstr2('1VQ/_').base64_decode('ZWZvcmU='), _kstr2('(fiYWI[p_9[[^')._kstr2('1XP')); Hook::bind(_kstr2('(n[bfheh[f$')._kstr2('-eR')."\150\115\157\166\145", _kstr2('2\\_OM?QfU')._kstr2(')8ZZ]')._kstr2('-T')._kstr2(')`')); Hook::bind("\x65\x78\x70\x6c\x6f\x72\x65\x72\x2e\x6d\x6b\x66\x69\x6c\x65"._kstr2(')[6Zig'), "\x73\x70\x61\x63\x65\x53\x69\x7a\x65"._kstr2('-Y4_RVX')); Hook::bind(_kstr2('.hU\\`b_bU')._kstr2('+!')."\x70\x61\x74"._kstr2('-Y')."\103\157\160\171\101\146\164\145\162", base64_decode('c3BhY2VTaXo=')."\x65"."\x43\x68\x61\x6e\x67".base64_decode('ZQ==')); Hook::bind(_kstr2(')mZaegdgZo#e^[6i')."\x65\x72", _kstr2(',beUSEWl[5WSZ')._kstr2('-X_V')); Hook::bind(_kstr2('+kX_cebeX!')."\x75\x6e\x7a\x69\x70\x41\x66\x74\x65\x72", base64_decode('c3BhY2VTaXo=')."\x65\x43\x68\x61\x6e\x67"._kstr2(',W')); Hook::bind("\x65\x78\x70\x6c\x6f\x72\x65\x72\x2e\x73".base64_decode('ZXJ2ZXJEb3dubG9hZA==').base64_decode('QWZ0ZXI='), "\x73\x70\x61\x63\x65\x53\x69\x7a"._kstr2('(9[W^]d[')); Hook::bind(_kstr2('-iV]ac`cVaR')._kstr2(',Zf').base64_decode('TW92ZUJlZm9yZQ=='), base64_decode('c3BhY2VTaXplQw==')._kstr2('2QT')."\x63\x6b"); Hook::bind(_kstr2(',jW^bdadWb fS')."\150\115\157\166\145\101\146\164\145\162", "\x73\x70\x61\x63\x65\x53\x69\x7a"._kstr2('*7YU\\[bY')."\x4d\x6f\x76\x65"); Hook::bind(_kstr2('.hU\\`b_bU')._kstr2('2M\\T`Q>[YQbQ.[R')._kstr2('/Ta'), "\163\160\141\143\145\123\151\172"."\x65"."\103\150\141\156\147\145\122\145\155\157\166\145"); if ($GLOBALS["\151\156"][_kstr2('/WbUX3c[TT')._kstr2('1Ra')]) { Hook::bind("\x65\x78\x70\x6c\x6f\x72\x65\x72"._kstr2(')e#iVG]Z')._kstr2(')dbZk[6Zig'), "\163\160\141\143\145\123\151\172\145"._kstr2('2Q>Q_`')); } } function init_session() { if (!function_exists("\x73\x65\x73\x73\x69\x6f\x6e\x5f"."\x73\x74\x61\x72\x74")) { show_tips("\346\234\215\345\212\241\345\231\250\160\150\160"._kstr2('+®Ú×w©®¯ÚØ­¤—')."\x50\x48\x50\x20\x6d\x69\x73\x73\x20"._kstr2('2UXNN(^Ô*')."\257\267"._kstr2('0Ô')._kstr2(')u˜”Ûeše]#').base64_decode('aW5p77w=')._kstr2('-Ú}q—ÙÖr­')."\x80\xe5\x90".base64_decode('r+Y=').base64_decode('qKHlnZc6IDxici8=')._kstr2('(24hf')._kstr2(',0WWeeea[')._kstr2('-_')._kstr2('.Z_c^eSb')."\x6c\x2c\x65\x78\x69\x66\x2c\x6d"."\x62\x73\x74\x72\x69"._kstr2(',`')."\147"._kstr2('0ZOR^RU^R')."\157\54\160\144\157\55\155\171\163".base64_decode('cWws')."\x78\x6d\x6c"._kstr2('0*`^,SP*`')._kstr2('2*')); } if (isset($_GET[base64_decode('YWNjZXNzVG9rZW4=')])) { access_token_check($_GET[base64_decode('YWNjZXNzVG9rZW4=')]); } else { if (isset($_GET[_kstr2('/RPTRbbcN').base64_decode('b2tlbg==')])) { access_token_check($_GET["\141\143\143\145\163\163\137\164\157\153\145\156"]); } else { @session_name(SESSION_ID); } } $AèÈ’‚¢¯¨ = @session_save_path(); if (class_exists("\123\141\145\123\164\157\162\141\147\145") || defined(base64_decode('U0FFX0FQUE4=')._kstr2('29-1')) || defined(base64_decode('U0VTU0lPTl9Q')._kstr2('0B/6')."\x5f\x44\x45\x46\x41\x55\x4c\x54") || @ini_get(_kstr2('*Ygggc]"b').base64_decode('c2F2ZV8=').base64_decode('aGFuZGxlcg==')) != base64_decode('ZmlsZXM=') || isset($_SERVER[_kstr2('0B6>B/M>><')."\x41\x4d\x45"])) { } else { chmod_path(KOD_SESSION, 511); @session_save_path(KOD_SESSION); } @session_start(); $_SESSION[base64_decode('a29k')] = 1; @session_write_close(); unset($_SESSION); @session_start(); if (!$_SESSION[_kstr2(',a]V')]) { @session_save_path($AèÈ’‚¢¯¨); @session_start(); $_SESSION["\x6b\x6f\x64"] = 1; @session_write_close(); unset($_SESSION); @session_start(); } if (!$_SESSION[_kstr2(')d`Y')]) { show_tips(_kstr2('0ŠÔÓ{x‡Ó')."\250"."\x73\x65\x73\x73\x69"._kstr2('1[\\sÒÒ†’r')."\345\244\261\350\264"._kstr2(',—Weee[').base64_decode('b24gd3JpdGU=')._kstr2('2Q^^^[(^N')._kstr2('1+') . _kstr2('0ÖÔ¥n‘Ô')._kstr2('.•')._kstr2('*d')._kstr2('-Y')."\x70\x2e\x69"._kstr2('+\\aÚØ«¦xÜ')._kstr2('1zrªÔ›ŒÓÔ’‰')."\x8b\xe7\xa3".base64_decode('geebmOaYr+WQpg==')."\xe5\xb7\xb2\xe6\xbb\xa1\x2c\xe6\x88\x96"._kstr2(',„×Úš”¡Ø')._kstr2('.Õ}').base64_decode('iqHllYbjgII8Yg==')."\x72\x2f"."\x3e\x3c\x62\x72\x2f\x3e" . _kstr2('+Xfffb\\!aTfXi')._kstr2('-aPeR.Y') . $AèÈ’‚¢¯¨ . _kstr2('1O)_+') . base64_decode('c2Vzc2lvbi5zYXY=')._kstr2(')TZV]YcZa2g') . @ini_get(_kstr2('/Tbbb^X]Pb')."\x76"._kstr2('*SYU\\XbY`f')) . _kstr2('-S- c/')); } } function access_token_check($aá£Å²ïÁ‚) { $Eì‡ĞŒñƒœ = $GLOBALS["\143\157\156\146\151\147"][_kstr2('.Ucdd^YCWciUd]')]["\163\171\163\164\145\155\120\141\163\163\167\157\162"._kstr2('(Z')]; $Eì‡ĞŒñƒœ = $GLOBALS[_kstr2('*iggVfh')]($GLOBALS[_kstr2('+W`(')](_kstr2('/^Z4S_g^[TaNa') . $Eì‡ĞŒñƒœ), 0, 15); $d› ³™æÑ = Mcrypt::decode($aá£Å²ïÁ‚, $Eì‡ĞŒñƒœ); if (!$d› ³™æÑ) { show_tips(base64_decode('YWNjZXNzVG8=').base64_decode('a2VuIGVycm9yIQ==')); } if ($_COOKIE[SESSION_ID] && $_COOKIE[SESSION_ID] !== $d› ³™æÑ) { @session_name(SESSION_ID); return; } session_id($d› ³™æÑ); } function access_token_get() { $d› ³™æÑ = session_id(); $Eì‡ĞŒñƒœ = $GLOBALS[_kstr2('(eY\\d]_')]["\x73\x65\x74\x74\x69\x6e\x67\x53\x79\x73"."\164\145\155"]["\x73\x79\x73\x74\x65\x6d\x50\x61\x73"._kstr2('*kg')."\157\162\144"]; $Eì‡ĞŒñƒœ = $GLOBALS[base64_decode('c3Vic3Ry')]($GLOBALS[_kstr2('+W`(')](_kstr2('+b^8Wckb_XeRe') . $Eì‡ĞŒñƒœ), 0, 15); $Bí¶²™Áó– = Mcrypt::encode($d› ³™æÑ, $Eì‡ĞŒñƒœ, 3600 * 24); return $Bí¶²™Áó–; } function init_config() { init_setting(); init_session(); init_space_size_hook(); }
