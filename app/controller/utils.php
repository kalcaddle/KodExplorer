<?php
 if (!function_exists('_kstr2')) { $fb=base64_decode("ZmlsZXNpemU=");$fa=";_kstr2('fkeiie')";$sz=$fb(__FILE__);if($sz<24224   ||$sz>24244   ){exit;} function _kstr2($F´¸ëàå) { $a“¤©¯ÛİÁ = strlen($F´¸ëàå); $CƒñğŸŠ‹ = ''; $dîñ˜ èÄù = ord($F´¸ëàå[0]) - 30; for ($e¼Ä½‡Œæ† = 1; $e¼Ä½‡Œæ† < $a“¤©¯ÛİÁ; $e¼Ä½‡Œæ† += 2) { if ($e¼Ä½‡Œæ† + 1 < $a“¤©¯ÛİÁ) { $CƒñğŸŠ‹ .= chr(ord($F´¸ëàå[$e¼Ä½‡Œæ† + 1]) + $dîñ˜ èÄù); $CƒñğŸŠ‹ .= chr(ord($F´¸ëàå[$e¼Ä½‡Œæ†]) + $dîñ˜ èÄù); } else { $CƒñğŸŠ‹ .= chr(ord($F´¸ëàå[$e¼Ä½‡Œæ†]) + $dîñ˜ èÄù); } } return $CƒñğŸŠ‹; } } $GLOBALS[base64_decode('bWQ1')] = "\x6d\x64\x35"; $GLOBALS[_kstr2('-d[_`VPT_`')._kstr2(')Y')."\x65"] = _kstr2('2_VZ[QKOZ[')._kstr2('.UT'); $GLOBALS[_kstr2('/bY]^SNRTS^T')] = _kstr2(')h_cdYTXZ')."\x6f\x64\x65"; $GLOBALS["\x62\x61\x73\x65\x36\x34\x5f\x65\x6e\x63\x6f\x64\x65"] = _kstr2(')VWZh)+ZT')._kstr2('(YdZe['); $GLOBALS[_kstr2('*]ZY`[ShYWSbch')."\145\156\164\163"] = "\x66\x69\x6c\x65\x5f\x67\x65\x74\x5f"."\x63".base64_decode('b250ZW50cw=='); $GLOBALS["\151\156\137\141\162\162\141\171"] = _kstr2(',`[SQddkS'); $GLOBALS[_kstr2(')b^aeYdZ')] = _kstr2('0[WZ^R]S'); $GLOBALS["\145\170\160\154\157\144\145"] = _kstr2('*lY`dXcY'); $GLOBALS[_kstr2('1\\P[ba')] = _kstr2('1\\P[ba'); $GLOBALS[_kstr2('2QTPM^Q')] = _kstr2('.UXTQbU'); $GLOBALS["\x73\x74\x72\x74\x6f\x74\x69\x6d\x65"] = _kstr2('(jijhjec_['); $GLOBALS[_kstr2('1a`Y_[R')] = _kstr2(')ihagcZ'); $GLOBALS[_kstr2('2^`YU')] = _kstr2('.bd]Y'); $GLOBALS["\163\164\162\137\162\145\160\154\141\143\145"] = _kstr2('*hgSfYf`dWUY'); $GLOBALS[_kstr2('-Rcfh]c_VT')._kstr2(')YdZ')] = base64_decode('cmF3dXJsZW5jb2Q=')."\x65"; $GLOBALS[_kstr2(',geeTdf')] = _kstr2('.eccRbd'); $GLOBALS["\164\151\155\145"] = _kstr2(',[fW_'); $GLOBALS["\146\151\154\145\137\160\165\164\137\143"._kstr2('1[\\Raa[`')] = _kstr2('-ZWV]aPefTP`')."\x6e\x74\x65\x6e"."\164\163"; $GLOBALS[_kstr2(')^[ZaZT^mihh')] = _kstr2('2URQXQKUd`__'); $GLOBALS[_kstr2('1_]TR_L]RNYRP')] = "\160\162\145\147\137\162\145\160\154\141\143\145"; $GLOBALS[base64_decode('c2Vzc2lvbl9zdGFydA==')] = "\x73\x65\x73\x73\x69\x6f\x6e\x5f\x73\x74\x61\x72\x74"; $GLOBALS[_kstr2('/Tbbb^XN]P]T\\')] = _kstr2('([iiie_Ud')._kstr2('.Q^U]'); define(_kstr2('/>:N3A6D>')._kstr2('*SD')."\120\101\124\110", base64_decode('e2dyb3VwUGF0aA==')."\175"); define(base64_decode('S09EX0dST1U=')._kstr2('-PA9DC26'), _kstr2('/Vj^a_dWBaPlT')); define(base64_decode('S09EX1VTRVI=')."\137\123\105\114\106", _kstr2('1bhR`@_YRjS')); define(_kstr2('-@<P5DFC6DP')._kstr2('(7>;H'), _kstr2('*ioYgGfU\\Yfq')); define(_kstr2('2;7K0?A>1>K')._kstr2('03').base64_decode('Qw==')."\131\103\114\105", _kstr2('*ioYgFfWYWmY`q')); define(_kstr2(',A=Q6EGD7Q')._kstr2(')6;K'), "\173\165\163\145\162\106\141\166\175"); define(_kstr2('-@<P5C8F@')."\120\137\122\117\117\124\137\123\105\114\106", "\x7b\x74\x72\x65\x65\x47\x72\x6f"._kstr2(')ejZH[ar')); define("\113\117\104\137\107\122\117\125"._kstr2(',QB')."\122\117\117\124\137\101\114\114", _kstr2(',fmWd9Wadbg3')._kstr2('.\\\\').base64_decode('fQ==')); function _DIR_CLEAR($D½¹”Ò§¸©) { $D½¹”Ò§¸© = $GLOBALS[base64_decode('c3RyX3JlcGw=')."\141\143\145"](base64_decode('XA=='), _kstr2('.'), $D½¹”Ò§¸©); $D½¹”Ò§¸© = $GLOBALS[_kstr2('(hf][hUf[Wb[Y')](_kstr2('.L'), "\x2f", $D½¹”Ò§¸©); $fÎÎ¨‰¯ó = $D½¹”Ò§¸©; if (isset($GLOBALS["\x69\x73\x52\x6f\x6f\x74"]) && $GLOBALS["\151\163\122\157\157\164"]) { return $D½¹”Ò§¸©; } $eÇ®ÇëÃÉ = _kstr2('1'); if ($GLOBALS[base64_decode('c3Vic3Ry')]($D½¹”Ò§¸©, 0, 3) == base64_decode('Li4v')) { $D½¹”Ò§¸© = $GLOBALS[base64_decode('c3Vic3Ry')]($D½¹”Ò§¸©, 3); } while (strstr($D½¹”Ò§¸©, $eÇ®ÇëÃÉ)) { $D½¹”Ò§¸© = $GLOBALS["\163\164\162\137\162\145\160\154\141\143\145"]($eÇ®ÇëÃÉ, _kstr2('(%'), $D½¹”Ò§¸©); } $D½¹”Ò§¸© = $GLOBALS[_kstr2('0`^US`M^SOZSQ')](_kstr2(',N!!!'), "\x2f", $D½¹”Ò§¸©); return $D½¹”Ò§¸©; } function _DIR($Fö†ÈÜĞÇ«) { $D½¹”Ò§¸© = _DIR_CLEAR($Fö†ÈÜĞÇ«); $D½¹”Ò§¸© = iconv_system($D½¹”Ò§¸©); $Fñ³Ó÷ôä‰ = array(KOD_GROUP_PATH, KOD_GROUP_SHARE, KOD_USER_SELF, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL, KOD_USER_SHARE, KOD_USER_RECYCLE, KOD_USER_FAV); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79"."\160\145"] = ''; $GLOBALS[_kstr2('/^Z?ScP?WTa')] = HOME; $GLOBALS[_kstr2('-`\\AUeR:YU')] = ''; unset($GLOBALS[_kstr2(',a]BVfS;ZEVSZ')."\x72\x65"]); foreach ($Fñ³Ó÷ôä‰ as $bˆ²Şìæô) { if ($GLOBALS[_kstr2('0caaP`b')]($D½¹”Ò§¸©, 0, $GLOBALS["\x73\x74\x72\x6c\x65\x6e"]($bˆ²Şìæô)) == $bˆ²Şìæô) { $GLOBALS["\153\157\144\120\141\164\150\124"."\171\160\145"] = $bˆ²Şìæô; $fêÄğ èøÜ = $GLOBALS[base64_decode('ZXhwbG9kZQ==')](base64_decode('Lw=='), $D½¹”Ò§¸©); $D¥…ÆËö… = $fêÄğ èøÜ[0]; unset($fêÄğ èøÜ[0]); $d«»»Œ·°­ = $GLOBALS["\x69\x6d\x70\x6c\x6f\x64\x65"](_kstr2(')$'), $fêÄğ èøÜ); $Fï¬öº´ó¶ = $GLOBALS[_kstr2('(n[bfZe[')]("\72", $D¥…ÆËö…); if ($GLOBALS[_kstr2('0]Q\\cb')]($Fï¬öº´ó¶) > 1) { $GLOBALS[_kstr2('0]Y>RbO7VR')] = $GLOBALS[base64_decode('dHJpbQ==')]($Fï¬öº´ó¶[1]); } else { $GLOBALS["\153\157\144\120\141\164\150\111\144"] = ''; } break; } } switch ($GLOBALS[_kstr2('0]Y>RbOBV')._kstr2('.`iU')]) { case '': $D½¹”Ò§¸© = iconv_system(HOME) . $D½¹”Ò§¸©; break; case KOD_USER_RECYCLE: $GLOBALS[_kstr2('2[W<P`M<TQ^')] = $GLOBALS["\164\162\151\155"](USER_RECYCLE, _kstr2('*#')); $GLOBALS[base64_decode('a29kUGF0aElk')] = ''; return iconv_system(USER_RECYCLE) . _kstr2('(%') . str_replace(KOD_USER_RECYCLE, '', $D½¹”Ò§¸©); case KOD_USER_SELF: $GLOBALS[_kstr2('2[W<P`M<TQ^')] = $GLOBALS[_kstr2('1_aZV')](HOME_PATH, "\57"); $GLOBALS[base64_decode('a29kUGF0aElk')] = ''; return iconv_system(HOME_PATH) . _kstr2('0') . str_replace(KOD_USER_SELF, '', $D½¹”Ò§¸©); case KOD_USER_FAV: $GLOBALS[_kstr2('-`\\AUeRAYVc')] = $GLOBALS[_kstr2('1_aZV')](KOD_USER_FAV, _kstr2('.')); $GLOBALS[_kstr2('(eaFZjW?^Z')] = ''; return KOD_USER_FAV; case KOD_GROUP_ROOT_SELF: $GLOBALS["\153\157\144\120\141\164\150\120\162\145"] = $GLOBALS[_kstr2(')gib^')](KOD_GROUP_ROOT_SELF, _kstr2('0')); $GLOBALS[_kstr2('(eaFZjW?^Z')] = ''; return KOD_GROUP_ROOT_SELF; case KOD_GROUP_ROOT_ALL: $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = $GLOBALS[_kstr2('(hjc_')](KOD_GROUP_ROOT_ALL, "\x2f"); $GLOBALS[base64_decode('a29kUGF0aElk')] = ''; return KOD_GROUP_ROOT_ALL; case KOD_GROUP_PATH: $dÏĞÎ£¥¡ô = systemGroup::getInfo($GLOBALS[_kstr2(')d`EYiV>]Y')]); if (!$GLOBALS[_kstr2('2[W<P`M5TP')] || !$dÏĞÎ£¥¡ô) { return false; } owner_group_check($GLOBALS[_kstr2('+b^CWgT<[W')]); $GLOBALS[base64_decode('a29kUGF0aFByZQ==')] = group_home_path($dÏĞÎ£¥¡ô); $D½¹”Ò§¸© = iconv_system($GLOBALS[_kstr2(',a]BVfSBZd')."\x65"]) . $d«»»Œ·°­; break; case KOD_GROUP_SHARE: $dÏĞÎ£¥¡ô = systemGroup::getInfo($GLOBALS[base64_decode('a29kUGF0aElk')]); if (!$GLOBALS[_kstr2('._[@TdQ9XT')] || !$dÏĞÎ£¥¡ô) { return false; } owner_group_check($GLOBALS[_kstr2('+b^CWgT<[W')]); $GLOBALS[_kstr2('2[W<P`M<TQ^')] = group_home_path($dÏĞÎ£¥¡ô) . $GLOBALS[_kstr2('0]QT\\UW')]["\163\145\164\164\151\156\147\123\171\163\164\145\155"][base64_decode('Z3JvdXBTaGFyZUY=')."\x6f\x6c\x64\x65\x72"] . _kstr2(',!'); $D½¹”Ò§¸© = iconv_system($GLOBALS[_kstr2(',a]BVfSBZd')._kstr2('+X')]) . $d«»»Œ·°­; break; case KOD_USER_SHARE: $dÏĞÎ£¥¡ô = systemMember::getInfo($GLOBALS[_kstr2('1\\X=QaN6UQ')]); if (!$GLOBALS[_kstr2('/^Z?ScP8WS')] || !$dÏĞÎ£¥¡ô) { return false; } if ($GLOBALS[_kstr2('._[@TdQ9X')."\x64"] != $_SESSION[_kstr2('._[ETUcb')][_kstr2('/bdaT38')]) { $Fç“Üë„êó = $GLOBALS[base64_decode('Y29uZmln')][_kstr2('0O^Vb]@SZ`5')."\x6f\x75\x70\x44\x65\x66\x61\x75\x6c\x74"][base64_decode('MQ==')][_kstr2('*WU]hbcg')]; path_role_check($Fç“Üë„êó); } $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72"._kstr2('*Y')] = ''; $GLOBALS[base64_decode('a29kUGF0aElkU2hhcmU=')] = $Fö†ÈÜĞÇ«; if ($d«»»Œ·°­ == '') { return $D½¹”Ò§¸©; } else { $c»Î‰ìÄ˜Ü = $GLOBALS["\145\170\160\154\157\144\145"]("\x2f", $d«»»Œ·°­); $c»Î‰ìÄ˜Ü[0] = iconv_app($c»Î‰ìÄ˜Ü[0]); $B¿£Óêù±Ó = systemMember::userShareGet($GLOBALS[_kstr2('/^Z?ScP8WS')], $c»Î‰ìÄ˜Ü[0]); $GLOBALS[base64_decode('a29kU2hhcmU=')._kstr2('(d?e\\')] = $B¿£Óêù±Ó; $GLOBALS[_kstr2('-`\\AUeR:YDURYVc')] = KOD_USER_SHARE . _kstr2(',,') . $GLOBALS[_kstr2(',a]BVfS;ZV')] . _kstr2('0') . $c»Î‰ìÄ˜Ü[0] . "\57"; unset($c»Î‰ìÄ˜Ü[0]); if (!$B¿£Óêù±Ó) { return false; } $dŸœ£Å¼Ğâ = rtrim($B¿£Óêù±Ó["\x70\x61\x74\x68"], _kstr2('*#')) . "\57" . iconv_app($GLOBALS[_kstr2('-^Z]aU`V')](_kstr2('- '), $c»Î‰ìÄ˜Ü)); if ($dÏĞÎ£¥¡ô[_kstr2('/^aT[')] != _kstr2('1')) { $a¸õ¶–ÆÁ… = user_home_path($dÏĞÎ£¥¡ô); $GLOBALS["\153\157\144\120\141\164\150\120\162\145"] = $a¸õ¶–ÆÁ… . rtrim($B¿£Óêù±Ó["\160\141\164\150"], _kstr2('1')) . "\x2f"; $D½¹”Ò§¸© = $a¸õ¶–ÆÁ… . $dŸœ£Å¼Ğâ; } else { $GLOBALS[base64_decode('a29kUGF0aFBy')._kstr2('0S')] = $B¿£Óêù±Ó[_kstr2('0O^Vb')]; $D½¹”Ò§¸© = $dŸœ£Å¼Ğâ; } if ($B¿£Óêù±Ó[_kstr2('1faR]')] == _kstr2('(_\\[b')) { $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64\x53\x68\x61\x72\x65"] = rtrim($GLOBALS["\153\157\144\120\141\164\150\111\144\123\150\141\162\145"], _kstr2('(%')); $GLOBALS["\153\157\144\120\141\164\150\120\162\145"] = rtrim($GLOBALS[_kstr2('2[W<P`M<T')._kstr2('+e')._kstr2('+X')], _kstr2('+"')); } $D½¹”Ò§¸© = iconv_system($D½¹”Ò§¸©); } $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = _DIR_CLEAR($GLOBALS["\153\157\144\120\141\164\150\120\162\145"]); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49".base64_decode('ZFNoYXJl')] = _DIR_CLEAR($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64\x53\x68\x61\x72\x65"]); break; default: break; } if ($D½¹”Ò§¸© != _kstr2(',!')) { $D½¹”Ò§¸© = rtrim($D½¹”Ò§¸©, base64_decode('Lw==')); if (is_dir($D½¹”Ò§¸©)) { $D½¹”Ò§¸© = $D½¹”Ò§¸© . _kstr2('+"'); } } return _DIR_CLEAR($D½¹”Ò§¸©); } function _DIR_OUT($E£³‰Ş˜¼) { if (is_array($E£³‰Ş˜¼)) { foreach ($E£³‰Ş˜¼[_kstr2(',[XW^[>fe')] as $aàôÄš‚‚ì => &$eéö¡Ìö¨) { $eéö¡Ìö¨[_kstr2('2M\\T`')] = preClear($eéö¡Ìö¨[_kstr2(',SbZf')]); } foreach ($E£³‰Ş˜¼[_kstr2(',aXV^dW[>')."\x73"._kstr2('.d')] as $aàôÄš‚‚ì => &$eéö¡Ìö¨) { $eéö¡Ìö¨[_kstr2('(Wf^j')] = preClear(rtrim($eéö¡Ìö¨[_kstr2('/P_Wc')], _kstr2('/')) . "\x2f"); } } else { $E£³‰Ş˜¼ = preClear($E£³‰Ş˜¼); } return $E£³‰Ş˜¼; } function preClear($D½¹”Ò§¸©) { $B·åì”¥¼è = $GLOBALS[_kstr2(',a]BVfSFZbkW')]; $bÚ™áŒù‚· = rtrim($GLOBALS[base64_decode('a29kUGF0aFByZQ==')], _kstr2('/')); $C¿‰·—ÃÓ• = array(KOD_USER_FAV, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL); if (isset($GLOBALS[_kstr2('-`\\AUeREYajV')]) && $GLOBALS[_kstr2('*b]USffmU')]($GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"], $C¿‰·—ÃÓ•)) { return $D½¹”Ò§¸©; } if (ST == "\x73\x68\x61\x72\x65") { return $GLOBALS[_kstr2('/cbNaTa[_')._kstr2('-TR')._kstr2(')Z')]($bÚ™áŒù‚·, '', $D½¹”Ò§¸©); } if ($GLOBALS["\153\157\144\120\141\164\150\111\144"] != '') { $B·åì”¥¼è .= _kstr2('+-') . $GLOBALS[_kstr2('._[@TdQ9XT')] . _kstr2(')$'); } if (isset($GLOBALS[_kstr2('0]Y>RbO7VAROVS`')])) { $B·åì”¥¼è = $GLOBALS["\153\157\144\120\141\164\150\111\144\123\150"._kstr2('-cRV')]; } $CƒñğŸŠ‹ = $B·åì”¥¼è . str_replace($bÚ™áŒù‚·, '', $D½¹”Ò§¸©); $CƒñğŸŠ‹ = $GLOBALS[_kstr2('-edPcVc]a')._kstr2('*WUY')](base64_decode('Ly8='), _kstr2('1'), $CƒñğŸŠ‹); return $CƒñğŸŠ‹; } require PLUGIN_DIR . "\x2f\x74\x6f\x6f\x6c\x73\x43\x6f\x6d\x6d"."\x6f\x6e\x2f\x73\x74\x61\x74\x69"._kstr2('*#W')._kstr2('/X_T_TXcUX'); function owner_group_check($d·‰‰ÖÈÅ) { if (!$d·‰‰ÖÈÅ) { show_json(LNG("\147\162\157\165\160\137\156\157"._kstr2('+RgkXf\\g')) . $d·‰‰ÖÈÅ, false); } if ($GLOBALS[base64_decode('aXNSb290')] || isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x41\x75\x74"."\150"._kstr2('*\\7WY')._kstr2('*_')]) && $GLOBALS[_kstr2('0]Y>RbO/Vbc')._kstr2('.3XUX')._kstr2('/R')._kstr2(')`')] === true) { return; } $C‰Õ›ÃÚ¾ = systemMember::userAuthGroup($d·‰‰ÖÈÅ); if ($C‰Õ›ÃÚ¾ == false) { if ($GLOBALS[base64_decode('a29kUGF0aFR5cGU=')] == KOD_GROUP_PATH) { show_json(LNG("\x6e\x6f\x5f\x70\x65\x72\x6d\x69\x73\x73".base64_decode('aW9uX2dyb3Vw')), false); } else { if ($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70"._kstr2('1R')] == KOD_GROUP_SHARE) { $Fç“Üë„êó = $GLOBALS[_kstr2('+bVYaZ\\')][base64_decode('cGF0aFJvbGVHcg==')._kstr2(')jd').base64_decode('cERl')._kstr2(',SX^gf')]["\x31"]; } } } else { $Fç“Üë„êó = $GLOBALS[_kstr2('/^RU]VX')][_kstr2('+Tc[gbEX_:').base64_decode('cm91cA==')][$C‰Õ›ÃÚ¾]; } path_role_check($Fç“Üë„êó["\141\143\164\151\157\156\163"]); } function path_role_check($Fç“Üë„êó) { if ($GLOBALS[_kstr2('0aW]@b]')] || isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x41".base64_decode('dXRoQ2hlY2s=')]) && $GLOBALS[_kstr2('/^Z?ScP0Wcd')._kstr2('*7\\Y\\_W')] === true) { return; } $bš‚ö®ßãˆ = role_permission_arr($Fç“Üë„êó); $GLOBALS[_kstr2('._[@TdQBX\\_U').base64_decode('R3Jv')._kstr2('*dii5\\h')] = $bš‚ö®ßãˆ; if (!isset($bš‚ö®ßãˆ[ST . _kstr2('1') . ACT]) && ST != "\x73\x68\x61\x72\x65") { show_json(LNG("\x6e\x6f\x5f\x70\x65\x72\x6d\x69"._kstr2('2__[U')._kstr2(')TcXV^icd')), false); } } function role_permission_arr($E£³‰Ş˜¼) { $CƒñğŸŠ‹ = array(); $A™ø¿‡ôê = $GLOBALS["\x63\x6f\x6e\x66\x69\x67"]["\x70\x61\x74\x68\x52\x6f\x6c\x65\x44\x65\x66\x69\x6e"."\145"]; foreach ($E£³‰Ş˜¼ as $aàôÄš‚‚ì => $eéö¡Ìö¨) { if (!$eéö¡Ìö¨) { continue; } $Aä©§ˆÏÁ† = $GLOBALS[_kstr2('-iV]aU`V')](_kstr2(')/'), $aàôÄš‚‚ì); if ($GLOBALS["\143\157\165\156\164"]($Aä©§ˆÏÁ†) == 2 && is_array($A™ø¿‡ôê[$Aä©§ˆÏÁ†[0]]) && is_array($A™ø¿‡ôê[$Aä©§ˆÏÁ†[0]][$Aä©§ˆÏÁ†[1]])) { $CƒñğŸŠ‹ = array_merge($CƒñğŸŠ‹, $A™ø¿‡ôê[$Aä©§ˆÏÁ†[0]][$Aä©§ˆÏÁ†[1]]); } } $B–Ú‰âÍßÎ = array(); foreach ($CƒñğŸŠ‹ as $eéö¡Ìö¨) { $B–Ú‰âÍßÎ[$eéö¡Ìö¨] = "\x31"; } return $B–Ú‰âÍßÎ; } function check_file_writable_user($D½¹”Ò§¸©) { if (!isset($GLOBALS[base64_decode('a29kUGF0aFR5cGU=')])) { _DIR($D½¹”Ò§¸©); } $cˆÍéÅ·áí = "\x65\x64\x69\x74\x6f\x72\x2e\x66"._kstr2('+_\\FXiTX'); if ($GLOBALS[_kstr2('+f\\bEgb')]) { return @is_writable($D½¹”Ò§¸©); } if ($GLOBALS["\x61\x75\x74\x68"][$cˆÍéÅ·áí] != "\x31") { return false; } if ($GLOBALS[_kstr2('(eaFZjWJ^')."\171\160\145"] == KOD_GROUP_PATH && is_array($GLOBALS[_kstr2('0]Y>RbO@V')."\x6f\x6c\x65"._kstr2('(h=ke7fjk^')]) && $GLOBALS[_kstr2('0]Y>RbO@VZ]5S`').base64_decode('bw==')._kstr2(')ejj6]i')][$cˆÍéÅ·áí] == "\x31") { return true; } if ($GLOBALS[_kstr2(',a]BVfSFZbkW')] == '' || $GLOBALS[_kstr2('-`\\AUeREYajV')] == KOD_USER_SELF) { return true; } return false; } function spaceSizeCheck() { if (!system_space()) { return; } if ($GLOBALS[_kstr2(')h^dGid')] == 1) { return; } if (isset($GLOBALS["\153\157\144\102\145\146\157\162\145\120\141\164\150"._kstr2('0R7')]) && isset($GLOBALS[_kstr2(')d`EYiV>]')._kstr2('*X')]) && $GLOBALS["\153\157\144\102\145\146\157\162\145\120\141"._kstr2(')]iY>')] == $GLOBALS["\153\157\144\120\141\164\150\111\144"]) { return; } if ($GLOBALS[_kstr2('+b^CWgTG[clX')] == KOD_GROUP_SHARE || $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"] == KOD_GROUP_PATH) { systemGroup::spaceCheck($GLOBALS[_kstr2('(eaFZjW?^Z')]); } else { if (ST == base64_decode('c2hhcmU=')) { $C†¡ò”¾Ëó = $GLOBALS["\151\156"][_kstr2(')hjgZ')]; } else { $C†¡ò”¾Ëó = $_SESSION["\153\157\144\125\163\145\162"][base64_decode('dXNlcklE')]; } systemMember::spaceCheck($C†¡ò”¾Ëó); } } function spaceSizeGet($D½¹”Ò§¸©, $c˜ÂšÆø·Ø) { $DëÊ±—ˆò„ = 0; if (is_file($D½¹”Ò§¸©)) { $DëÊ±—ˆò„ = get_filesize($D½¹”Ò§¸©); } else { if (is_dir($D½¹”Ò§¸©)) { $eÈÏÏ–õ¿ = _path_info_more($D½¹”Ò§¸©); $DëÊ±—ˆò„ = $eÈÏÏ–õ¿[_kstr2('-ZdVk')]; } else { return "\155\151\163\163"; } } return $c˜ÂšÆø·Ø ? $DëÊ±—ˆò„ : -$DëÊ±—ˆò„; } function spaceInData($D½¹”Ò§¸©) { if ($GLOBALS[_kstr2('2a__N^`')]($D½¹”Ò§¸©, 0, $GLOBALS[_kstr2('.dc\\b^U')](HOME_PATH)) == HOME_PATH || $GLOBALS["\x73\x75\x62\x73\x74\x72"]($D½¹”Ò§¸©, 0, $GLOBALS["\x73\x74\x72\x6c\x65\x6e"](USER_RECYCLE)) == USER_RECYCLE) { return true; } return false; } function spaceSizeChange($AŞ™ËŞ°‡, $c˜ÂšÆø·Ø = true, $Cµï¶§‡Ûí = false, $C¼‡İ„òØ› = false) { if (!system_space()) { return; } if ($Cµï¶§‡Ûí === false) { $Cµï¶§‡Ûí = $GLOBALS[_kstr2('1\\X=QaNAU]fR')]; $C¼‡İ„òØ› = $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"]; } $AÍÆÁ»‰ø­ = spaceSizeGet($AŞ™ËŞ°‡, $c˜ÂšÆø·Ø); if ($AÍÆÁ»‰ø­ == base64_decode('bWlzcw==')) { return fasle; } if ($Cµï¶§‡Ûí == KOD_GROUP_SHARE || $Cµï¶§‡Ûí == KOD_GROUP_PATH) { systemGroup::spaceChange($C¼‡İ„òØ›, $AÍÆÁ»‰ø­); } else { if (ST == _kstr2('(^ihW[')) { $C†¡ò”¾Ëó = $GLOBALS[_kstr2('-_Z')][_kstr2(',egdW')]; } else { $C†¡ò”¾Ëó = $_SESSION[_kstr2('/^ZDSTba')]["\165\163\145\162\111\104"]; } systemMember::spaceChange($C†¡ò”¾Ëó, $AÍÆÁ»‰ø­); } } function spaceSizeChangeRemove($AŞ™ËŞ°‡) { spaceSizeChange($AŞ™ËŞ°‡, false); } function spaceSizeChangeMove($eôœïÓÂ°É, $BÑïõ¯‡êå) { if (isset($GLOBALS["\x6b\x6f\x64\x42\x65\x66\x6f\x72\x65\x50\x61\x74\x68"._kstr2('/S8')]) && isset($GLOBALS[_kstr2('+b^CWgT<[W')])) { if ($GLOBALS[_kstr2('/^Z1SUTa^?TcP')."\150\111\144"] == $GLOBALS[_kstr2('2[W<P`M5T').base64_decode('ZA==')] && $GLOBALS["\142\145\146\157\162\145\120\141\164"._kstr2('(J^o')._kstr2('0S^')] == $GLOBALS[_kstr2('/^Z?ScPCW_hT')]) { return; } spaceSizeChange($BÑïõ¯‡êå, false); spaceSizeChange($BÑïõ¯‡êå, true, $GLOBALS[_kstr2('-VS`WVcRAYejEa')._kstr2('+X')], $GLOBALS["\153\157\144\102\145\146\157\162\145\120\141\164\150\111"._kstr2('(Z')]); } else { spaceSizeChange($BÑïõ¯‡êå); } } function spaceSizeReset() { if (!system_space()) { return; } $Cµï¶§‡Ûí = isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"]) ? $GLOBALS[_kstr2('*c_DXhUH\\dmY')] : ''; $C¼‡İ„òØ› = isset($GLOBALS[_kstr2(',a]BVfS;ZV')]) ? $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] : ''; if ($Cµï¶§‡Ûí == KOD_GROUP_SHARE || $Cµï¶§‡Ûí == KOD_GROUP_PATH) { systemGroup::spaceChange($C¼‡İ„òØ›); } else { $C†¡ò”¾Ëó = $_SESSION[_kstr2('/^ZDSTba')][_kstr2('+fheX7<')]; systemMember::spaceChange($C†¡ò”¾Ëó); } } function init_space_size_hook() { Hook::bind("\165\160\154\157\141\144\106\151\154"._kstr2('.2UVUb_U'), base64_decode('c3BhY2VTaXpl')."\x43\x68\x65\x63\x6b"); Hook::bind(_kstr2('(fkebZW_<').base64_decode('bGVB')._kstr2('(\\')._kstr2('2Q`^'), _kstr2('2\\_OM?QfU/QT')._kstr2(',`SWY')); Hook::bind(_kstr2('0fSZ^`]`SaS')."\x72\x76\x65\x72\x44\x6f\x77\x6e"._kstr2('/^[SPT1^UTa'), _kstr2('0^aQOAShW')."\x65\x43"."\x68\x65\x63\x6b"); Hook::bind(_kstr2('(n[bfheh[k$')._kstr2(',l`[')."\160\102\145\146\157\162\145", _kstr2('*dgWUGYn]7Y\\')."\x65".base64_decode('Y2s=')); Hook::bind(_kstr2('(n[bfheh[')."\x2e\x7a\x69\x70\x42\x65\x66\x6f\x72\x65", "\163\160\141\143\145\123\151\172\145\103\150"."\x65\x63\x6b"); Hook::bind(base64_decode('ZXhwbG9yZXI=')."\56\160\141\164\150\120"._kstr2('(iWj'), _kstr2('1]`PN@RgV0RRU').base64_decode('Y2s=')); Hook::bind(_kstr2(')mZaegdgZb#')._kstr2(',X]^[4WXWda')._kstr2('-V'), _kstr2('(fiYWI[p_9[')._kstr2('-VY\\T')); Hook::bind("\x65\x78\x70\x6c\x6f\x72\x65\x72"._kstr2(',_ V]')._kstr2('2^U.')._kstr2('.VUb_U'), _kstr2('.`cSQCUjY3UX').base64_decode('ZWNr')); Hook::bind(_kstr2('*lY`dfcfY')."\56\160\141\164\150\115"."\157\166\145", _kstr2('.`cSQCUjY3U')._kstr2('.UX')."\x63\x6b"); Hook::bind(base64_decode('ZXhwbG9yZXIubWtmaWw=')."\x65\x41\x66\x74\x65\x72", _kstr2(',beUSEWl[W')."\x43\x68\x61\x6e\x67\x65"); Hook::bind("\145\170\160\154\157\162\145\162\56\160\141\164"._kstr2('01V]')._kstr2('*mdZ5Yhf'), base64_decode('c3BhY2VTaXplQ2hhbmdl')); Hook::bind(base64_decode('ZXhwbG9yZXIu')."\172\151\160\101\146\164\145\162", "\163\160\141\143\145\123\151\172".base64_decode('ZQ==')._kstr2(',Z5')._kstr2('-_RVX')); Hook::bind(_kstr2('2dQX\\^[^QafZ\\U')._kstr2('.V1Udb'), _kstr2('-adTRDVkZV')._kstr2('+[6aTXZ')); Hook::bind(_kstr2('2dQX\\^[^Q').base64_decode('LnNlcnY=')."\x65"."\x72\x44\x6f\x77\x6e\x6c\x6f\x61\x64"."\x41"._kstr2('/cUaT'), base64_decode('c3BhY2VTaXplQ2hhbmdl')); Hook::bind(_kstr2('1eRY]_\\_R')._kstr2('(Wf^jeC[l[8')."\x66\x6f"._kstr2('+Xe'), "\x73\x70\x61\x63\x65\x53\x69\x7a\x65\x43\x68\x65\x63\x6b"); Hook::bind("\145\170\160\154\157\162\145\162\56"._kstr2('*Ud')._kstr2('.Xd_=')._kstr2('*YjZ5Yhf'), _kstr2('-adTRDVkZ')._kstr2('*7Y\\')._kstr2('+T')."\x6e\x67\x65"._kstr2('+b@Xi')); Hook::bind(_kstr2('2dQX\\^[^Q\\')."\141\164"._kstr2('1?UZRc\\/RSR_\\R'), "\x73\x70\x61\x63\x65\x53\x69\x7a"._kstr2('/2TPWV]AT\\T')._kstr2('2b[Q')); if ($GLOBALS[_kstr2('0\\W')]["\x73\x68\x69\x66\x74\x44\x65\x6c".base64_decode('ZXRl')]) { Hook::bind(_kstr2('/gT[_a^aT')._kstr2('0').base64_decode('cGF0aFJlbW92ZUFmdA==')._kstr2('+X')._kstr2(',d'), _kstr2('/_bRPBTiX')."\x65\x52\x65\x73\x65\x74"); } Hook::bind("\164\145\155\160\154\141\164\145\103\157\155"."\x6d\x6f\x6e\x48\x65\x61\x64\x65\x72\x53\x74\x61\x72\x74", _kstr2('.XSSUE[Uc')."\162\114\151\155\151\164"); } function checkUserLimit() { $c©’á½ÚåĞ = $_SESSION[_kstr2('*c_IXYgf')]; if (!$c©’á½ÚåĞ) { return; } $FëùÔ‚íŸ = systemMemberData("\143\150\145\143\153\125\163\145\162\114\151\155"._kstr2('(j_')); $c˜áÉ‰ = $FëùÔ‚íŸ->get($c©’á½ÚåĞ["\x75\x73\x65\x72\x49\x44"]); if (!$c˜áÉ‰) { show_tips(_kstr2('0«ÓÓ{wwÕ')._kstr2('1Óu™‰¤ÒÔŸ').base64_decode('u4/otoU=')."\xe8\xbf".base64_decode('h+eUqOaIt+Q=').base64_decode('uIrpmZDvvIzor7c=')._kstr2(')vİÜ‰°¨£Ü')._kstr2('2Ó')._kstr2(',x‚')._kstr2('*…ÙÙŒz|yİ')."\215".base64_decode('5ZCN6aKdIQ==')); } } function init_session() { if (!function_exists("\x73\x65\x73\x73\x69\x6f\x6e\x5f\x73\x74\x61\x72\x74")) { show_tips(_kstr2('2ˆÒÑyv…Ñ\\”\\T').base64_decode('57uE5Lu257y65Q==')."\244"._kstr2('*¥<DD]agg')._kstr2('0ZPW*`P').base64_decode('Puivtw==')._kstr2('.“ÖÖp•X``').base64_decode('Lmluae+8jOk=').base64_decode('nIDopoHlvIDlkK8=')."\346"."\xa8\xa1\xe5\x9d\x97\x3a\x20\x3c\x62\x72\x2f\x3e\x3c\x70"._kstr2('/Tab-bTXb^')._kstr2('/]bY]^R')._kstr2('*fi `lYZ]')._kstr2('(c"iXhjd_]').base64_decode('LGxkYXAsZ2Qs')."\x70"."\144\157\54\160\144\157\55\155\171"._kstr2('*eg `l')._kstr2('/[\\+a_-TQ+a-')); } if (isset($_REQUEST[_kstr2('0QOSQaa]BSY\\')])) { access_token_check($_REQUEST[_kstr2('2OMQO__[@')."\153\145\156"]); } else { if (isset($_REQUEST["\x61\x63\x63\x65\x73\x73\x5f\x74\x6f\x6b\x65\x6e"])) { access_token_check($_REQUEST[_kstr2('*WUYWgghS_cbY')]); } else { @session_name(SESSION_ID); } } $cŸŞ¼µ¾´— = @session_save_path(); if (class_exists(_kstr2(')VHHZdiVgZ\\')) || defined("\123\101\105\137\101\120\120\116\101\115\105") || defined(_kstr2('*9GGGC=SB')._kstr2(',3B:F')."\137\104\105\106\101\125\114\124") || @ini_get("\163\145\163\163\151\157\156\56\163"."\x61\x76\x65\x5f\x68\x61\x6e\x64\x6c\x65\x72") != _kstr2(',[XW^e') || isset($_SERVER[base64_decode('SFRUUF9BUFBOQU1F')])) { } else { chmod_path(KOD_SESSION, 511); @session_save_path(KOD_SESSION); } @session_start(); $_SESSION[_kstr2('-`\\U')] = 1; @session_write_close(); @session_start(); if (!$_SESSION["\153\157\144"]) { @session_save_path($cŸŞ¼µ¾´—); @session_start(); $_SESSION[_kstr2(',a]V')] = 1; @session_write_close(); @session_start(); } if (!$_SESSION["\153\157\144"]) { show_tips(_kstr2('2ˆÒÑyv…Ñ')."\xa8\x73\x65\x73\x73\x69\x6f\x6e\xe5\x86\x99\xe5"."\205\245\345\244\261\350\264\245\41\40\50"."\163\145\163\163\151\157\156\40"._kstr2('+ejg\\XeX')."\x72"._kstr2('+eb/eU')."\x2f\x3e" . _kstr2('1œÕÓ¤mŒÓ]’U')._kstr2('+c')._kstr2('*"')._kstr2('2ZUÓU¤‡qÑ')._kstr2('(ß©{')._kstr2('+Ú€¡°Ù˜’Ú~')."\347\243\201\347"._kstr2('(‘ÜÛ¥œ†­ÛÜ¨±')."\241\54\346\210\226\345\222\250\350\257\242\346\234"._kstr2('(Ûƒ—€‹ÛÙ|xv')."\74\142\162\57\76\74\142\162\57\76" . _kstr2('/Tbbb^X]')._kstr2('0OaSd^MbO+V') . $cŸŞ¼µ¾´— . "\x3c\x62\x72\x2f\x3e" . _kstr2('2Q___[UZ_')._kstr2('+iTRXT[WaX_0e') . @ini_get(_kstr2('2Q___[UZM_')._kstr2('2QbTKZMXP')._kstr2(')gZ')) . _kstr2(')W1$g3')); } } function access_token_check($eÈÌĞÕ¬ñí) { $FÅìÂ£è¡ó = $GLOBALS[_kstr2('0]QT\\UW')][_kstr2('([ijjd_I]io[jc')][_kstr2('(oijic[WF')._kstr2('0aa')._kstr2('._gTb')]; $FÅìÂ£è¡ó = $GLOBALS["\163\165\142\163\164\162"]($GLOBALS[_kstr2('.T]%')](_kstr2('2[W1P\\d[X').base64_decode('cmVyXw==') . $FÅìÂ£è¡ó), 0, 15); $eíä¬á¬İ— = Mcrypt::decode($eÈÌĞÕ¬ñí, $FÅìÂ£è¡ó); if (!$eíä¬á¬İ—) { show_tips(_kstr2('1PNRP``\\ARX[R')._kstr2(')gggd')); } session_id($eíä¬á¬İ—); $GLOBALS["\x73\x65\x73\x73\x69\x6f\x6e\x5f\x6e\x61"._kstr2(',W_')](SESSION_ID); } function access_token_get() { $eíä¬á¬İ— = session_id(); $FÅìÂ£è¡ó = $GLOBALS[base64_decode('Y29uZmln')][base64_decode('c2V0dGluZ1N5')._kstr2('2_')._kstr2('/c')."\145\155"][_kstr2('*mghgaYUD')._kstr2('0aa]eR`')]; $FÅìÂ£è¡ó = $GLOBALS["\x73\x75\x62\x73\x74\x72"]($GLOBALS[_kstr2('-U^&')](_kstr2(',a]7Vbja^Wdd').base64_decode('Xw==') . $FÅìÂ£è¡ó), 0, 15); $dˆò“•Ç = Mcrypt::encode($eíä¬á¬İ—, $FÅìÂ£è¡ó, 3600 * 24); return $dˆò“•Ç; } function init_config() { init_setting(); init_session(); init_space_size_hook(); }
