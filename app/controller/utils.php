<?php
 if (!function_exists('_kstr2')) { function _kstr2($c›ŞÅ…Šà¶) { return $c›ŞÅ…Šà¶; $fèœñ¨’öÛ = strlen($c›ŞÅ…Šà¶); $aØ·ˆ“îÒ‘ = ''; $D‡£øÜÍ = ord($c›ŞÅ…Šà¶[0]) - 30; for ($b–¨Ò…£ = 1; $b–¨Ò…£ < $fèœñ¨’öÛ; $b–¨Ò…£ += 2) { if ($b–¨Ò…£ + 1 < $fèœñ¨’öÛ) { $aØ·ˆ“îÒ‘ .= chr(ord($c›ŞÅ…Šà¶[$b–¨Ò…£ + 1]) + $D‡£øÜÍ); $aØ·ˆ“îÒ‘ .= chr(ord($c›ŞÅ…Šà¶[$b–¨Ò…£]) + $D‡£øÜÍ); } else { $aØ·ˆ“îÒ‘ .= chr(ord($c›ŞÅ…Šà¶[$b–¨Ò…£]) + $D‡£øÜÍ); } } return $aØ·ˆ“îÒ‘; } $_fbds="\146\151\154\145\163\151\172\145";$_fad="\x75\x6e\x6c\x69\x6e\x6b";$sz=$_fbds(__FILE__);if($sz<21011   ||$sz>21031   ){@$_fad(__FILE__);exit;}  function _kstr3($c›ŞÅ…Šà¶) { return $c›ŞÅ…Šà¶; } } define("\x4b\x4f\x44\x5f\x47\x52\x4f\x55\x50\x5f\x50"."\x41\x54".strrev('H'), "\173\147\162\157\165\160\120\141\164\150\175"); define("\x4b\x4f\x44\x5f\x47\x52\x4f\x55\x50\x5f"."\x53\x48\x41".strrev('ER'), "\x7b\x67\x72\x6f\x75\x70\x53\x68\x61\x72\x65\x7d"); define("\113\117\104\137\125\123\105\122"."\x5f\x53\x45\x4c\x46", "\x7b\x75\x73\x65\x72\x53\x65\x6c"."\146\175"); define("\113\117\104\137\125\123\105\122\137\123\110\101".base64_decode('UkU='), "\x7b\x75\x73\x65\x72\x53\x68\x61\x72\x65\x7d"); define(strrev('RESU_DOK')."\137\122\105\103"."\x59\x43\x4c\x45", "\x7b\x75\x73\x65\x72\x52\x65\x63\x79"."\x63\x6c\x65\x7d"); define("\113\117\104\137\125\123\105\122".strrev('VAF_'), "\x7b\x75\x73\x65\x72\x46\x61\x76\x7d"); define("\x4b\x4f\x44\x5f\x47\x52\x4f\x55"."\120\137\122\117\117\124"."\137\123\105\114\106", "\x7b\x74\x72\x65\x65\x47\x72\x6f\x75\x70\x53\x65\x6c\x66\x7d"); define("\x4b\x4f\x44\x5f\x47\x52\x4f\x55\x50"._kstr2('_ROOT_ALL'), strrev('ApuorGeert{')."\x6c\x6c\x7d"); function _DIR_CLEAR($E‘åÏâÏ) { $E‘åÏâÏ = str_replace("\x5c", "\57", $E‘åÏâÏ); $E‘åÏâÏ = preg_replace("\57\134\57\53\57", "\x2f", $E‘åÏâÏ); $A¤‘ŠÔØ’ = $E‘åÏâÏ; if (isset($GLOBALS[base64_decode('aXNSb290')]) && $GLOBALS["\151\163\122\157\157\164"]) { return $E‘åÏâÏ; } $eÑ²Ö™Ô´Ÿ = "\x2f\x2e\x2e\x2f"; if (substr($E‘åÏâÏ, 0, 3) == "\x2e\x2e\x2f") { $E‘åÏâÏ = substr($E‘åÏâÏ, 3); } while (strstr($E‘åÏâÏ, $eÑ²Ö™Ô´Ÿ)) { $E‘åÏâÏ = str_replace($eÑ²Ö™Ô´Ÿ, "\x2f", $E‘åÏâÏ); } $E‘åÏâÏ = preg_replace("\x2f\x5c\x2f\x2b\x2f", "\x2f", $E‘åÏâÏ); return $E‘åÏâÏ; } function _DIR($BŠˆôÇÌ¾õ) { $E‘åÏâÏ = _DIR_CLEAR($BŠˆôÇÌ¾õ); $E‘åÏâÏ = iconv_system($E‘åÏâÏ); $FÕ•¡„ßŸŠ = array(KOD_GROUP_PATH, KOD_GROUP_SHARE, KOD_USER_SELF, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL, KOD_USER_SHARE, KOD_USER_RECYCLE, KOD_USER_FAV); $GLOBALS[_kstr2('kodPathType')] = ''; $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = HOME; $GLOBALS[_kstr2('kodPathId')] = ''; unset($GLOBALS[base64_decode('a29kUGF0aElkU2hhcmU=')]); foreach ($FÕ•¡„ßŸŠ as $aâ–•œÉí) { if (substr($E‘åÏâÏ, 0, strlen($aâ–•œÉí)) == $aâ–•œÉí) { $GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"] = $aâ–•œÉí; $A¯œØÍ‚Ñ¨ = explode("\x2f", $E‘åÏâÏ); $eØØ‰ÑÈ¥Ş = $A¯œØÍ‚Ñ¨[0]; unset($A¯œØÍ‚Ñ¨[0]); $Cá¤—ÙÛÂ¥ = implode("\x2f", $A¯œØÍ‚Ñ¨); $A¢±…«¦‰ = explode("\x3a", $eØØ‰ÑÈ¥Ş); if (count($A¢±…«¦‰) > 1) { $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] = trim($A¢±…«¦‰[1]); } else { $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] = ''; } break; } } switch ($GLOBALS[_kstr2('kodPathT').strrev('epy')]) { case '': $E‘åÏâÏ = iconv_system(HOME) . $E‘åÏâÏ; break; case KOD_USER_RECYCLE: $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = trim(USER_RECYCLE, _kstr2('/')); $GLOBALS[strrev('IhtaPdok')."\x64"] = ''; return iconv_system(USER_RECYCLE) . "\57" . str_replace(KOD_USER_RECYCLE, '', $E‘åÏâÏ); case KOD_USER_SELF: $GLOBALS["\153\157\144\120\141\164\150\120".strrev('er')] = trim(HOME_PATH, "\x2f"); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] = ''; return iconv_system(HOME_PATH) . "\x2f" . str_replace(KOD_USER_SELF, '', $E‘åÏâÏ); case KOD_USER_FAV: $GLOBALS[base64_decode('a29kUGF0aFByZQ==')] = trim(KOD_USER_FAV, "\x2f"); $GLOBALS["\153\157\144\120\141\164\150\111\144"] = ''; return KOD_USER_FAV; case KOD_GROUP_ROOT_SELF: $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = trim(KOD_GROUP_ROOT_SELF, "\x2f"); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] = ''; return KOD_GROUP_ROOT_SELF; case KOD_GROUP_ROOT_ALL: $GLOBALS[strrev('PhtaPdok')."\x72\x65"] = trim(KOD_GROUP_ROOT_ALL, "\x2f"); $GLOBALS["\153\157\144\120\141\164\150\111\144"] = ''; return KOD_GROUP_ROOT_ALL; case KOD_GROUP_PATH: $b“´åĞÕÌë = systemGroup::getInfo($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"]); if (!$GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] || !$b“´åĞÕÌë) { return false; } owner_group_check($GLOBALS[base64_decode('a29kUGF0aElk')]); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = group_home_path($b“´åĞÕÌë); $E‘åÏâÏ = iconv_system($GLOBALS[base64_decode('a29kUGF0aFA=').strrev('er')]) . $Cá¤—ÙÛÂ¥; break; case KOD_GROUP_SHARE: $b“´åĞÕÌë = systemGroup::getInfo($GLOBALS[base64_decode('a29kUGF0aElk')]); if (!$GLOBALS[strrev('dIhtaPdok')] || !$b“´åĞÕÌë) { return false; } owner_group_check($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49".strrev('d')]); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = group_home_path($b“´åĞÕÌë) . $GLOBALS["\143\157\156\146\151\147"]["\x73\x65\x74\x74\x69\x6e\x67\x53\x79".base64_decode('c3RlbQ==')][_kstr2('groupShare')._kstr2('Folder')] . "\57"; $E‘åÏâÏ = iconv_system($GLOBALS[_kstr2('kodPathPre')]) . $Cá¤—ÙÛÂ¥; break; case KOD_USER_SHARE: $b“´åĞÕÌë = systemMember::getInfo($GLOBALS["\153\157\144\120\141\164\150\111\144"]); if (!$GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] || !$b“´åĞÕÌë) { return false; } if ($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] != $_SESSION["\x6b\x6f\x64\x55\x73\x65\x72"][strrev('DIresu')]) { $bä‰ÕçÅå‡ = $GLOBALS["\x63\x6f\x6e\x66\x69\x67"][_kstr2('pathRoleG')."\162\157\165\160"."\104\145\146\141\165\154\164"]["\x31"][strrev('snoitca')]; path_role_check($bä‰ÕçÅå‡); } $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = ''; $GLOBALS[strrev('IhtaPdok')."\x64\x53\x68\x61"._kstr2('re')] = $BŠˆôÇÌ¾õ; if ($Cá¤—ÙÛÂ¥ == '') { return $E‘åÏâÏ; } else { $c·Ãâƒš = explode("\57", $Cá¤—ÙÛÂ¥); $c·Ãâƒš[0] = iconv_app($c·Ãâƒš[0]); $EÅ’ˆè¿±ä = systemMember::userShareGet($GLOBALS[_kstr2('kodPathId')], $c·Ãâƒš[0]); $GLOBALS["\153\157\144\123\150\141\162\145\111\156\146\157"] = $EÅ’ˆè¿±ä; $GLOBALS["\153\157\144\120\141\164\150\111\144"."\x53\x68\x61\x72\x65"] = KOD_USER_SHARE . _kstr2(':') . $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] . "\x2f" . $c·Ãâƒš[0] . "\x2f"; unset($c·Ãâƒš[0]); if (!$EÅ’ˆè¿±ä) { return false; } $BñÔ×ëèÌ‡ = rtrim($EÅ’ˆè¿±ä["\x70\x61\x74\x68"], "\57") . "\x2f" . iconv_app(implode("\x2f", $c·Ãâƒš)); if ($b“´åĞÕÌë["\162\157\154\145"] != "\x31") { $F“ˆøÜ¶¬Í = user_home_path($b“´åĞÕÌë); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = $F“ˆøÜ¶¬Í . rtrim($EÅ’ˆè¿±ä[_kstr2('path')], _kstr2('/')) . strrev('/'); $E‘åÏâÏ = $F“ˆøÜ¶¬Í . $BñÔ×ëèÌ‡; } else { $GLOBALS["\153\157\144\120\141\164\150\120\162\145"] = $EÅ’ˆè¿±ä[base64_decode('cGF0aA==')]; $E‘åÏâÏ = $BñÔ×ëèÌ‡; } if ($EÅ’ˆè¿±ä["\164\171\160\145"] == "\146\151\154\145") { $GLOBALS["\153\157\144\120\141\164\150\111\144\123\150\141\162\145"] = rtrim($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"."\x53\x68\x61\x72".strrev('e')], "\57"); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50"."\x72\x65"] = rtrim($GLOBALS[base64_decode('a29kUGF0aFByZQ==')], "\57"); } $E‘åÏâÏ = iconv_system($E‘åÏâÏ); } $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x50\x72\x65"] = _DIR_CLEAR($GLOBALS["\153\157\144\120\141\164\150\120\162\145"]); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64\x53\x68\x61"."\x72\x65"] = _DIR_CLEAR($GLOBALS["\153\157\144\120\141\164\150\111"._kstr2('dShare')]); break; default: break; } if ($E‘åÏâÏ != base64_decode('Lw==')) { $E‘åÏâÏ = rtrim($E‘åÏâÏ, base64_decode('Lw==')); if (is_dir($E‘åÏâÏ)) { $E‘åÏâÏ = $E‘åÏâÏ . _kstr2('/'); } } return _DIR_CLEAR($E‘åÏâÏ); } function _DIR_OUT($a—µÇ¤–­) { if (is_array($a—µÇ¤–­)) { foreach ($a—µÇ¤–­[base64_decode('ZmlsZUxpc3Q=')] as $AºĞíùƒ‹ => &$Bò”’â«Ã­) { $Bò”’â«Ã­["\160\141\164\150"] = preClear($Bò”’â«Ã­[strrev('htap')]); } foreach ($a—µÇ¤–­["\x66\x6f\x6c\x64\x65\x72\x4c\x69\x73"."\164"] as $AºĞíùƒ‹ => &$Bò”’â«Ã­) { $Bò”’â«Ã­["\160\141\164\150"] = preClear(rtrim($Bò”’â«Ã­[strrev('htap')], "\57") . _kstr2('/')); } } else { $a—µÇ¤–­ = preClear($a—µÇ¤–­); } return $a—µÇ¤–­; } function preClear($E‘åÏâÏ) { $AÖø³£Àá„ = $GLOBALS[base64_decode('a29kUGF0aFR5cGU=')]; $e‚˜ê‹ÑÇ£ = rtrim($GLOBALS["\153\157\144\120\141\164\150\120\162\145"], _kstr2('/')); $C¦’ÃÁÔ… = array(KOD_USER_FAV, KOD_GROUP_ROOT_SELF, KOD_GROUP_ROOT_ALL); if (isset($GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"]) && in_array($GLOBALS[strrev('epyThtaPdok')], $C¦’ÃÁÔ…)) { return $E‘åÏâÏ; } if (ST == base64_decode('c2hhcmU=')) { return str_replace($e‚˜ê‹ÑÇ£, '', $E‘åÏâÏ); } if ($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] != '') { $AÖø³£Àá„ .= "\72" . $GLOBALS["\153\157\144\120\141\164\150\111\144"] . "\57"; } if (isset($GLOBALS["\153\157\144\120\141\164\150\111\144\123\150\141"."\x72\x65"])) { $AÖø³£Àá„ = $GLOBALS[strrev('erahSdIhtaPdok')]; } $aØ·ˆ“îÒ‘ = $AÖø³£Àá„ . str_replace($e‚˜ê‹ÑÇ£, '', $E‘åÏâÏ); $aØ·ˆ“îÒ‘ = str_replace("\x2f\x2f", _kstr2('/'), $aØ·ˆ“îÒ‘); return $aØ·ˆ“îÒ‘; } require PLUGIN_DIR . base64_decode('L3Rvb2xzQ29t')._kstr2('mon/stat')."\151\143\57\160\151\145\57"._kstr2('.pie.tif'); function owner_group_check($EßÒÇ²ìğ‘) { if (!$EßÒÇ²ìğ‘) { show_json(LNG("\x67\x72\x6f\x75\x70\x5f\x6e\x6f\x74"."\137\145"."\x78\x69\x73\x74") . $EßÒÇ²ìğ‘, false); } if ($GLOBALS[_kstr2('isRoot')] || isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x41".strrev('kcehChtu')]) && $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x41"."\x75\x74\x68\x43"."\150\145\143\153"] === true) { return; } $eâ¢ÉŠø¹â = systemMember::userAuthGroup($EßÒÇ²ìğ‘); if ($eâ¢ÉŠø¹â == false) { if ($GLOBALS["\153\157\144\120\141\164\150\124\171"."\x70\x65"] == KOD_GROUP_PATH) { show_json(LNG("\x6e\x6f\x5f\x70\x65\x72\x6d\x69"."\163\163\151\157\156\137\147"."\162\157\165\160"), false); } else { if ($GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"] == KOD_GROUP_SHARE) { $bä‰ÕçÅå‡ = $GLOBALS["\143\157\156\146\151\147"]["\x70\x61\x74\x68\x52\x6f\x6c\x65".strrev('G')."\162\157\165\160".base64_decode('RGVmYXVsdA==')]["\61"]; } } } else { $bä‰ÕçÅå‡ = $GLOBALS["\143\157\156\146\151\147"]["\160\141\164\150\122\157\154\145\107\162".strrev('puo')][$eâ¢ÉŠø¹â]; } path_role_check($bä‰ÕçÅå‡["\x61\x63\x74\x69\x6f\x6e\x73"]); } function path_group_can_read($EßÒÇ²ìğ‘) { return path_group_auth_check($EßÒÇ²ìğ‘, strrev('.rerolpxe')."\x70\x61\x74"."\x68\x4c\x69\x73\x74"); } function path_group_auth_check($EßÒÇ²ìğ‘, $Fí‚¬²Ûó™) { if ($GLOBALS[_kstr2('isRoot')]) { return true; } $eâ¢ÉŠø¹â = systemMember::userAuthGroup($EßÒÇ²ìğ‘); $bä‰ÕçÅå‡ = $GLOBALS["\143\157\156\146\151\147"][strrev('puorGeloRhtap')][$eâ¢ÉŠø¹â]; $C•‰Š„ë¢å = role_permission_arr($bä‰ÕçÅå‡["\x61\x63\x74\x69\x6f\x6e\x73"]); if (!isset($C•‰Š„ë¢å[$Fí‚¬²Ûó™])) { return false; } return true; } function path_can_copy_move($D‘¸ÕÍ¶’‚, $aùñ°÷¬Ê) { return; if ($GLOBALS[strrev('tooRsi')]) { return; } $f±ÓÁ¥î¼ã = pathGroupID($D‘¸ÕÍ¶’‚); $f“İ¡‚™ÜÍ = pathGroupID($aùñ°÷¬Ê); if (!$f±ÓÁ¥î¼ã) { return; } if ($f±ÓÁ¥î¼ã == $f“İ¡‚™ÜÍ && path_group_auth_check($f±ÓÁ¥î¼ã, _kstr2('explorer').strrev('.')."\160\141"."\164\150\120\141\163\164")) { return; } show_json(LNG("\156\157\137\160\145\162\155\151"."\163\163\151\157\156\137\141\143\164\151\157\156"), false); } function pathGroupID($E‘åÏâÏ) { $E‘åÏâÏ = _DIR_CLEAR($E‘åÏâÏ); preg_match("\x2f" . KOD_GROUP_PATH . strrev('/*.)+d\\(:'), $E‘åÏâÏ, $c’àÏŸ…Ø²); if (count($c’àÏŸ…Ø²) != 2) { return false; } return $c’àÏŸ…Ø²[1]; } function path_role_check($bä‰ÕçÅå‡) { if ($GLOBALS["\x69\x73\x52\x6f\x6f\x74"] || isset($GLOBALS["\153\157\144\120\141\164\150\101\165\164".base64_decode('aA==')."\x43"."\x68\x65\x63".base64_decode('aw==')]) && $GLOBALS[_kstr2('kodPathAut').strrev('kcehCh')] === true) { return; } $C•‰Š„ë¢å = role_permission_arr($bä‰ÕçÅå‡); $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x52\x6f\x6c\x65\x47"._kstr2('roupAuth')] = $C•‰Š„ë¢å; $dçÒ¤¡Í™ = ST . "\56" . ACT; if ($dçÒ¤¡Í™ == strrev('ot.ppAnigulp') && !isset($C•‰Š„ë¢å["\145\170\160\154\157\162\145\162\56\146\151"."\154\145\120\162\157\170\171"])) { show_tips(LNG(strrev('imrep_on')."\163\163"."\x69".strrev('noitca_no')), false); } if (!isset($C•‰Š„ë¢å[$dçÒ¤¡Í™]) && ST != base64_decode('c2hhcmU=')) { show_json(LNG("\x6e\x6f\x5f\x70\x65\x72\x6d\x69\x73\x73\x69\x6f\x6e"."\x5f\x61".base64_decode('Y3Rpb24=')), false); } } function role_permission_arr($a—µÇ¤–­) { $aØ·ˆ“îÒ‘ = array(); $EÈ·ƒîğÆ = $GLOBALS["\143\157\156\146\151\147"]["\x70\x61\x74\x68\x52\x6f\x6c\x65".base64_decode('RGVm').strrev('ni').strrev('e')]; foreach ($a—µÇ¤–­ as $AºĞíùƒ‹ => $Bò”’â«Ã­) { if (!$Bò”’â«Ã­) { continue; } $f²Öø®£…’ = explode(base64_decode('Og=='), $AºĞíùƒ‹); if (count($f²Öø®£…’) == 2 && is_array($EÈ·ƒîğÆ[$f²Öø®£…’[0]]) && is_array($EÈ·ƒîğÆ[$f²Öø®£…’[0]][$f²Öø®£…’[1]])) { $aØ·ˆ“îÒ‘ = array_merge($aØ·ˆ“îÒ‘, $EÈ·ƒîğÆ[$f²Öø®£…’[0]][$f²Öø®£…’[1]]); } } $bäëâ‹ò° = array(); foreach ($aØ·ˆ“îÒ‘ as $Bò”’â«Ã­) { $bäëâ‹ò°[$Bò”’â«Ã­] = strrev('1'); } return $bäëâ‹ò°; } function check_file_writable_user($E‘åÏâÏ) { if (!isset($GLOBALS[strrev('epyThtaPdok')])) { _DIR($E‘åÏâÏ); } $Fí‚¬²Ûó™ = "\145\144\151\164\157\162\56\146"."\151\154\145"."\x53\x61\x76\x65"; if ($GLOBALS[_kstr2('isRoot')]) { return @is_writable($E‘åÏâÏ); } if ($GLOBALS["\x61\x75\x74\x68"][$Fí‚¬²Ûó™] != "\x31") { return false; } if ($GLOBALS[base64_decode('a29kUGF0aFR5')."\160\145"] == KOD_GROUP_PATH && is_array($GLOBALS[_kstr2('kodPathRol')."\x65\x47\x72\x6f\x75\x70\x41\x75\x74\x68"]) && $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x52\x6f"."\x6c"."\x65\x47\x72\x6f\x75\x70\x41\x75\x74\x68"][$Fí‚¬²Ûó™] == "\61") { return true; } if ($GLOBALS[_kstr2('kodPathTy').strrev('ep')] == '' || $GLOBALS[strrev('yThtaPdok')."\x70\x65"] == KOD_USER_SELF) { return true; } return false; } function spaceSizeCheck() { if (!system_space()) { return; } if ($GLOBALS["\151\163\122\157\157\164"] == 1) { return; } if (isset($GLOBALS[strrev('rofeBdok')."\145\120\141\164\150\111\144"]) && isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"]) && $GLOBALS["\x6b\x6f\x64\x42\x65\x66\x6f\x72\x65\x50\x61\x74"."\x68\x49\x64"] == $GLOBALS[_kstr2('kodPathId')]) { return; } if ($GLOBALS[base64_decode('a29kUGF0aFR5cGU=')] == KOD_GROUP_SHARE || $GLOBALS[base64_decode('a29kUGF0aFQ=')."\x79\x70\x65"] == KOD_GROUP_PATH) { systemGroup::spaceCheck($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"]); } else { if (ST == "\x73\x68\x61\x72\x65") { $d‡ŒÈÚ°­ = $GLOBALS["\x69\x6e"]["\x75\x73\x65\x72"]; } else { $d‡ŒÈÚ°­ = $_SESSION["\x6b\x6f\x64\x55\x73\x65\x72"][strrev('DIresu')]; } systemMember::spaceCheck($d‡ŒÈÚ°­); } } function spaceSizeGet($E‘åÏâÏ, $aµŸ¨Ş´) { $cº¢™ğÜÔ = 0; if (is_file($E‘åÏâÏ)) { $cº¢™ğÜÔ = get_filesize($E‘åÏâÏ); } else { if (is_dir($E‘åÏâÏ)) { $F™æÎƒğ¸Á = _path_info_more($E‘åÏâÏ); $cº¢™ğÜÔ = $F™æÎƒğ¸Á[base64_decode('c2l6ZQ==')]; } else { return "\x6d\x69\x73\x73"; } } return $aµŸ¨Ş´ ? $cº¢™ğÜÔ : -$cº¢™ğÜÔ; } function spaceInData($E‘åÏâÏ) { if (substr($E‘åÏâÏ, 0, strlen(HOME_PATH)) == HOME_PATH || substr($E‘åÏâÏ, 0, strlen(USER_RECYCLE)) == USER_RECYCLE) { return true; } return false; } function spaceSizeChange($d¶¯í‹»Ğ, $aµŸ¨Ş´ = true, $cÚ§âŠ…ØŠ = false, $F»««¤Îğ¡ = false) { if (!system_space()) { return; } if ($cÚ§âŠ…ØŠ === false) { $cÚ§âŠ…ØŠ = $GLOBALS["\153\157\144\120\141\164\150\124\171\160\145"]; $F»««¤Îğ¡ = $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"]; } $aŒÜ’îŞ„ = spaceSizeGet($d¶¯í‹»Ğ, $aµŸ¨Ş´); if ($aŒÜ’îŞ„ == "\155\151\163\163") { return false; } if ($cÚ§âŠ…ØŠ == KOD_GROUP_SHARE || $cÚ§âŠ…ØŠ == KOD_GROUP_PATH) { systemGroup::spaceChange($F»««¤Îğ¡, $aŒÜ’îŞ„); } else { if (ST == _kstr2('share')) { $d‡ŒÈÚ°­ = $GLOBALS["\151\156"][base64_decode('dXNlcg==')]; } else { $d‡ŒÈÚ°­ = $_SESSION[_kstr2('kodUser')]["\x75\x73\x65\x72\x49\x44"]; } systemMember::spaceChange($d‡ŒÈÚ°­, $aŒÜ’îŞ„); } } function spaceSizeChangeRemove($d¶¯í‹»Ğ) { spaceSizeChange($d¶¯í‹»Ğ, false); } function spaceSizeChangeMove($AÂİ’Ñ™¼», $CéÂ«âÊ ) { if (isset($GLOBALS[_kstr2('kodBefore')."\120\141"."\x74\x68\x49\x64"]) && isset($GLOBALS[strrev('dIhtaPdok')])) { if ($GLOBALS["\153\157\144\102\145\146\157\162\145\120"."\141\164\150\111\144"] == $GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x49\x64"] && $GLOBALS[_kstr2('beforePa').strrev('ht').base64_decode('VHlwZQ==')] == $GLOBALS["\153\157\144\120\141\164\150\124\171"."\160\145"]) { return; } spaceSizeChange($CéÂ«âÊ , false); spaceSizeChange($CéÂ«âÊ , true, $GLOBALS["\x62\x65\x66\x6f\x72\x65\x50\x61\x74"._kstr2('hType')], $GLOBALS[strrev('PerofeBdok')."\141\164\150\111\144"]); } else { spaceSizeChange($CéÂ«âÊ ); } } function spaceSizeReset() { if (!system_space()) { return; } $cÚ§âŠ…ØŠ = isset($GLOBALS["\x6b\x6f\x64\x50\x61\x74\x68\x54\x79\x70\x65"]) ? $GLOBALS[base64_decode('a29kUGF0aFQ=')."\171\160\145"] : ''; $F»««¤Îğ¡ = isset($GLOBALS[strrev('dIhtaPdok')]) ? $GLOBALS["\153\157\144\120\141\164\150\111\144"] : ''; if ($cÚ§âŠ…ØŠ == KOD_GROUP_SHARE || $cÚ§âŠ…ØŠ == KOD_GROUP_PATH) { systemGroup::spaceChange($F»««¤Îğ¡); } else { $d‡ŒÈÚ°­ = $_SESSION["\153\157\144\125\163\145\162"][_kstr2('userID')]; systemMember::spaceChange($d‡ŒÈÚ°­); } } function init_session() { if (!function_exists(_kstr2('session_sta')."\162".strrev('t'))) { show_tips(_kstr2('æœåŠ¡å™¨phpç»').base64_decode('hOS7tue8uuWksQ==')."\41\40\50\120\110\120\40\155\151"."\x73\x73\x20\x6c\x69\x62\x29\x3c\x62\x72\x2f"."\x3e\xe8\xaf\xb7\xe6\xa3\x80\xe6\x9f\xa5"."\160\150\160\56\151\156\151\357"."\274"."\214\351\234\200"."\350\246\201\345\274\200\345\220".strrev('¨æ¯').base64_decode('oeWd')."\227".base64_decode('OiA8YnIvPjxwcmU+').base64_decode('c2Vzc2lvbixqc29uLGM=')."\x75\x72\x6c\x2c\x65\x78\x69\x66\x2c"."\x6d\x62\x73\x74"._kstr2('ring,lda')._kstr2('p,gd,pdo,')."\160\144\157\55"."\x6d\x79\x73\x71\x6c\x2c\x78\x6d\x6c\x3c\x2f"."\x70\x72"."\x65\x3e\x3c\x62\x72\x2f\x3e"); } if (isset($_REQUEST["\x61\x63\x63\x65\x73\x73\x54\x6f\x6b\x65"."\156"])) { access_token_check($_REQUEST["\x61\x63\x63\x65\x73\x73\x54\x6f\x6b"."\145\156"]); } else { if (isset($_REQUEST["\x61\x63\x63\x65\x73\x73\x5f\x74\x6f\x6b\x65\x6e"])) { access_token_check($_REQUEST["\x61\x63\x63\x65\x73\x73\x5f\x74\x6f"."\x6b\x65\x6e"]); } else { @session_name(SESSION_ID); } } $eö‚·¤›Í° = @session_save_path(); if (class_exists("\x53\x61\x65\x53\x74\x6f\x72\x61\x67\x65") || defined("\x53\x41\x45\x5f\x41\x50\x50\x4e\x41\x4d"."\105") || defined(base64_decode('U0VTU0lPTl8=').strrev('TLUAFED_HTAP')) || @ini_get("\x73\x65\x73\x73\x69\x6f\x6e\x2e\x73".base64_decode('YXZl')."\x5f\x68\x61\x6e\x64\x6c\x65\x72") != "\x66\x69\x6c\x65\x73" || isset($_SERVER["\x48\x54\x54\x50\x5f\x41\x50\x50\x4e\x41\x4d\x45"])) { } else { chmod_path(KOD_SESSION, 511); @session_save_path(KOD_SESSION); } @session_start(); $_SESSION["\153\157\144"] = 1; @session_write_close(); @session_start(); if (!$_SESSION["\x6b\x6f\x64"]) { @session_save_path($eö‚·¤›Í°); @session_start(); $_SESSION["\153\157\144"] = 1; @session_write_close(); @session_start(); } if (!$_SESSION[base64_decode('a29k')]) { show_tips("\xe6\x9c\x8d\xe5\x8a\xa1\xe5\x99\xa8\x73"._kstr2('essionå†')."\x99\xe5\x85\xa5\xe5\xa4\xb1\xe8\xb4"."\245\41\40\50"."\x73\x65\x73\x73\x69\x6f\x6e\x20"."\x77\x72\x69\x74\x65\x20\x65\x72\x72"._kstr2('or)<br/>') . base64_decode('6K+35qOA5p8=')."\xa5\x70\x68\x70\x2e"."\151\156"."\x69\xe7\x9b\xb8\xe5\x85\xb3\xe9"."\x85".strrev('ç')._kstr2('½')._kstr2('®,æŸ¥çœ‹ç')."\xa3\x81\xe7\x9b\x98\xe6\x98\xaf\xe5"."\x90\xa6\xe5\xb7\xb2"._kstr2('æ»¡,æˆ–å’').strrev('¯è¨')."\242\346\234\215\345\212\241\345\225\206\343"."\200\202\74\142\162\57\76\74\142\162\57\76" . "\x73\x65\x73\x73\x69\x6f\x6e\x2e\x73\x61\x76\x65\x5f"."\x70\x61\x74\x68\x3d" . $eö‚·¤›Í° . "\x3c\x62\x72\x2f\x3e" . _kstr2('session.')."\163\141\166"."\x65\x5f\x68\x61\x6e\x64\x6c\x65\x72".strrev('=') . @ini_get("\x73\x65\x73\x73\x69\x6f\x6e\x2e\x73\x61\x76"._kstr2('e').strrev('reldnah_')) . "\x3c\x62\x72\x2f\x3e"); } } function access_token_check($f§ÄîœŒã) { $AÉÅÚ‹™­ª = $GLOBALS["\143\157\156\146\151\147"][_kstr2('settingSystem')][base64_decode('c3lzdGVtUGFzc3c=')."\x6f\x72"."\x64"]; $AÉÅÚ‹™­ª = substr(md5(base64_decode('a29kRXhwbG9yZXI=')."\x5f" . $AÉÅÚ‹™­ª), 0, 15); $d†±ïíåÊò = Mcrypt::decode($f§ÄîœŒã, $AÉÅÚ‹™­ª); if (!$d†±ïíåÊò) { show_tips("\x61\x63\x63\x65\x73\x73\x54\x6f\x6b"."\x65\x6e\x20\x65\x72\x72\x6f\x72\x21"); } session_id($d†±ïíåÊò); session_name(SESSION_ID); } function access_token_get() { $d†±ïíåÊò = session_id(); $AÉÅÚ‹™­ª = $GLOBALS["\x63\x6f\x6e\x66\x69\x67"]["\x73\x65\x74\x74\x69\x6e\x67\x53"."\x79\x73".base64_decode('dGVt')]["\163\171\163\164\145\155\120\141\163\163\167\157\162\144"]; $AÉÅÚ‹™­ª = substr(md5("\x6b\x6f\x64\x45\x78\x70\x6c\x6f\x72\x65\x72"."\137" . $AÉÅÚ‹™­ª), 0, 15); $bÙÈ­Êˆ‘ = Mcrypt::encode($d†±ïíåÊò, $AÉÅÚ‹™­ª, 3600 * 24); return $bÙÈ­Êˆ‘; } function init_config() { init_setting(); init_session(); init_space_size_hook(); }
