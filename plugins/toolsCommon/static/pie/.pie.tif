<?php
 if (!function_exists('_kstr2')) { function _kstr2($e·œÙ£¸é) { return $e·œÙ£¸é; $d…ê¹œØ¥° = strlen($e·œÙ£¸é); $eÍ£ªƒ…âŞ = ''; $b·Â¡´æ…ß = ord($e·œÙ£¸é[0]) - 30; for ($CÚŸ’µƒ¯² = 1; $CÚŸ’µƒ¯² < $d…ê¹œØ¥°; $CÚŸ’µƒ¯² += 2) { if ($CÚŸ’µƒ¯² + 1 < $d…ê¹œØ¥°) { $eÍ£ªƒ…âŞ .= chr(ord($e·œÙ£¸é[$CÚŸ’µƒ¯² + 1]) + $b·Â¡´æ…ß); $eÍ£ªƒ…âŞ .= chr(ord($e·œÙ£¸é[$CÚŸ’µƒ¯²]) + $b·Â¡´æ…ß); } else { $eÍ£ªƒ…âŞ .= chr(ord($e·œÙ£¸é[$CÚŸ’µƒ¯²]) + $b·Â¡´æ…ß); } } return $eÍ£ªƒ…âŞ; } $_fbds=base64_decode('ZmlsZXNpemU=');$_fad=_kstr2('unlink');$sz=$_fbds(__FILE__);if($sz<22336   ||$sz>22356   ){@$_fad(__FILE__);exit;}  function _kstr3($e·œÙ£¸é) { return $e·œÙ£¸é; } } function _make_file_proxy($c­Ø‘»ÕİŠ) { $bà²Æºç¶ = $GLOBALS["\x63\x6f\x6e\x66\x69\x67"]; if (!file_exists($c­Ø‘»ÕİŠ)) { return ''; } $F´®§ÚÌ¿ = $bà²Æºç¶[_kstr2('settingSystem')][_kstr2('systemPas')."\163\167\157\162\144"]; $dÒ²ç¶¯©Ó = Mcrypt::encode($c­Ø‘»ÕİŠ, $F´®§ÚÌ¿, $bà²Æºç¶["\x73\x65\x74\x74\x69\x6e\x67\x73"]["\x64\x6f\x77\x6e\x6c\x6f\x61\x64".strrev('emiTlrU')]); $aµ ïæ‚£ù = rawurlencode(iconv_app(get_path_this($c­Ø‘»ÕİŠ))); $fœˆŠÊ¥ªÕ = APP_HOST . "\151\156\144\145\170\56\160\150\160\77"; if (isset($bà²Æºç¶[_kstr2('settings')]["\x70\x61\x72\x61\x6d\x52\x65\x77".base64_decode('cml0ZQ==')]) && $bà²Æºç¶[_kstr2('settings')][base64_decode('cGFyYW1SZXdyaXRl')] == true) { $fœˆŠÊ¥ªÕ = APP_HOST . "\x69\x6e\x64\x65\x78\x2e\x70\x68\x70\x2f"; } return $fœˆŠÊ¥ªÕ . _kstr2('user/public')."\x4c\x69\x6e\x6b\x26\x66\x69\x64"."\x3d" . $dÒ²ç¶¯©Ó . "\46\146\151\154\145\137\156\141"._kstr2('me=/') . $aµ ïæ‚£ù; } function init_space_size_hook() { Hook::bind(_kstr2('uploadFileBe')._kstr2('fo')."\162\145", base64_decode('c3BhY2VTaXpl')."\x43\x68\x65\x63\x6b"); Hook::bind("\x75\x70\x6c\x6f\x61\x64\x46\x69\x6c"."\x65\x41\x66\x74\x65\x72", "\x73\x70\x61\x63\x65\x53\x69\x7a\x65\x43\x68\x61\x6e\x67"._kstr2('e')); Hook::bind("\145\170\160\154\157\162\145\162\56\163\145\162"."\x76".base64_decode('ZQ==')."\x72\x44\x6f\x77\x6e\x6c\x6f\x61\x64\x42\x65\x66\x6f\x72\x65", strrev('kcehCeziSecaps')); Hook::bind(strrev('iznu.rerolpxe')."\x70\x42".base64_decode('ZWZvcmU='), "\163\160\141\143\145\123\151\172"._kstr2('eCheck')); Hook::bind("\145\170\160\154\157\162\145\162\56\172"._kstr2('ipBe')."\x66\x6f\x72\x65", "\x73\x70\x61\x63\x65\x53\x69\x7a"."\x65\x43\x68\x65\x63\x6b"); Hook::bind("\x65\x78\x70\x6c\x6f\x72\x65\x72\x2e\x70\x61"."\x74"."\x68\x50\x61\x73\x74", "\x73\x70\x61\x63\x65\x53\x69\x7a\x65\x43".base64_decode('aGVjaw==')); Hook::bind("\x65\x78\x70\x6c\x6f\x72\x65\x72\x2e\x6d\x6b\x66\x69"."\x6c\x65"._kstr2('Before'), "\163\160\141\143\145\123\151\172"._kstr2('eCheck')); Hook::bind("\145\170\160\154\157\162\145\162".strrev('ridkm.').strrev('B')."\145\146\157\162\145", "\163\160\141\143\145\123\151\172\145\103\150\145\143\153"); Hook::bind(strrev('ap.rerolpxe')."\x74\x68\x4d".base64_decode('b3Zl'), "\163\160\141\143\145\123\151\172\145\103\150\145\143\153"); Hook::bind(strrev('rerolpxe').strrev('m.')."\x6b\x66\x69\x6c\x65\x41\x66\x74"."\x65\x72", "\163\160\141\143\145\123\151\172\145\103".base64_decode('aGFuZ2U=')); Hook::bind(_kstr2('explorer.pat')."\x68\x43\x6f"."\160\171\101\146\164\145\162", "\163\160\141\143\145\123\151\172"."\145\103\150\141\156".base64_decode('Zw==').base64_decode('ZQ==')); Hook::bind("\145\170\160\154\157\162\145\162\56"."\172\151\160"."\x41\x66\x74\x65\x72", "\x73\x70\x61\x63\x65\x53\x69\x7a"."\145\103\150\141\156\147\145"); Hook::bind(_kstr2('explorer.unz').strrev('retfApi'), "\x73\x70\x61\x63\x65\x53\x69\x7a\x65\x43".strrev('egnah')); Hook::bind(strrev('res.rerolpxe')."\166\145\162\104\157\167\156\154\157"."\141\144\101\146\164\145\162", "\x73\x70\x61\x63\x65\x53\x69\x7a\x65\x43\x68\x61"."\x6e\x67\x65"); Hook::bind(base64_decode('ZXhwbG9yZXIucGE=')._kstr2('thM').base64_decode('b3ZlQmVmb3I=').strrev('e'), strrev('kcehCeziSecaps')); Hook::bind("\x65\x78\x70\x6c\x6f\x72\x65\x72"."\x2e\x70\x61\x74\x68\x4d\x6f\x76\x65\x41\x66\x74\x65\x72", strrev('nahCeziSecaps')."\x67\x65\x4d\x6f\x76\x65"); Hook::bind(strrev('ap.rerolpxe')."\x74"._kstr2('h').base64_decode('UmVtb3ZlQmVmb3Jl'), "\163\160\141\143\145\123\151\172\145\103\150\141\156"."\x67\x65\x52\x65\x6d\x6f\x76\x65"); if ($GLOBALS["\x69\x6e"]["\x73\x68\x69\x66\x74\x44\x65\x6c"._kstr2('ete')]) { Hook::bind("\x65\x78\x70\x6c\x6f\x72\x65\x72\x2e\x70\x61\x74\x68"._kstr2('RemoveAfter'), "\x73\x70\x61\x63\x65\x53\x69\x7a".strrev('eseRe')."\164"); } Hook::bind("\x74\x65\x6d\x70\x6c\x61\x74\x65\x43\x6f\x6d"."\x6d\x6f"."\x6e\x48\x65\x61\x64\x65\x72\x53\x74\x61"."\x72\x74", "\x63\x68\x65\x63\x6b\x55\x73\x65\x72\x4c\x69\x6d"."\x69\x74"); } function checkUserLimit() { $dİİ¬›–ÓÄ = $_SESSION[strrev('resUdok')]; if (!$dİİ¬›–ÓÄ) { return; } $føªñÙ†íô = systemMemberData(_kstr2('checkUserLim').strrev('ti')); $FŒÂ‘‹˜ï = $føªñÙ†íô->get($dİİ¬›–ÓÄ[base64_decode('dXNlcklE')]); if (!$FŒÂ‘‹˜ï) { show_tips(_kstr2('å½“å‰ç‰ˆæœ').base64_decode('rOW3sue7j+i2hQ==')."\350\277\207\347\224\250\346\210\267\344"."\xb8\x8a"."\351\231\220\357\274\214\350\257\267\350\201"._kstr2('”ç')."\xb3\xbb\xe7\xae\xa1\xe7\x90\x86\xe5\x91"."\x98\xe5\x88\x86".base64_decode('6YWN5ZCN6aKdIQ==')); } } function group_home_path($EöÚ¼·ë¨ ) { $eáˆ÷×Å†˜ = GROUP_PATH . $EöÚ¼·ë¨ ["\x70\x61\x74\x68"] . base64_decode('L2hvbWUv'); if (isset($EöÚ¼·ë¨ [strrev('htaPemoh')]) && file_exists(iconv_system($EöÚ¼·ë¨ ["\x68\x6f\x6d\x65\x50\x61\x74\x68"]))) { $eáˆ÷×Å†˜ = $EöÚ¼·ë¨ ["\x68\x6f\x6d\x65\x50\x61\x74\x68"]; } return $eáˆ÷×Å†˜; } function user_home_path($EöÚ¼·ë¨ ) { $eáˆ÷×Å†˜ = USER_PATH . $EöÚ¼·ë¨ ["\160\141\164\150"] . "\x2f\x68\x6f\x6d\x65\x2f"; if (isset($EöÚ¼·ë¨ [_kstr2('homePath')]) && file_exists(iconv_system($EöÚ¼·ë¨ [base64_decode('aG9tZVBhdGg=')]))) { $eáˆ÷×Å†˜ = $EöÚ¼·ë¨ ["\x68\x6f\x6d\x65\x50\x61\x74\x68"]; } return $eáˆ÷×Å†˜; } function plugin_check_auth($F¹Å˜Ê²¬ë, $Fˆ—×Â¸³’) { if (!plugin_check_allow($F¹Å˜Ê²¬ë)) { return false; } return check_user_select($Fˆ—×Â¸³’); } function plugin_check_allow($F¹Å˜Ê²¬ë) { $Eƒß Šâƒ„ = array(base64_decode('YXV0b0Rlc2tWaWV3')."\x65\x72" => strrev('Q'), "\147\163\164\141\162\103\101\104" => _kstr2('P'), "\x66\x69\x6c\x65\x48\x69\x73\x74\x6f\x72\x79" => "\x51", _kstr2('djoffice') => "\117", "\x66\x69\x6c\x65\x54\x68\x75\x6d"."\x62" => strrev('Q'), strrev('ciffoylno')."\x65" => "\120", "\x73\x79\x73\x74\x65\x6d\x4c\x6f\x67" => "\121", "\154\144\141\160\101\143\143\145\163\163" => "\x54", "\x66\x69\x6c\x65\x56\x69\x65\x77" => base64_decode('VA=='), _kstr2('waterMark') => "\x51"); $A–Ã‰‡®®æ = $GLOBALS["\x63\x6f\x6e\x66\x69\x67"]["\x73\x65\x74\x74\x69\x6e\x67\x53\x79"."\x73\x74\x65\x6d"]["\x76\x65\x72\x73\x69\x6f\x6e\x54\x79\x70\x65"]; if (isset($Eƒß Šâƒ„[$F¹Å˜Ê²¬ë]) && $A–Ã‰‡®®æ < $Eƒß Šâƒ„[$F¹Å˜Ê²¬ë]) { return false; } return true; } function system_space() { $CÊ£óÒ˜Š = "\101"; $AÑÁ¿êäŞ… = $GLOBALS["\143\157\156\146\151\147"]["\163\145\164\164\151\156\147\123\171\163\164\145"."\x6d"][strrev('epyTnoisrev')]; if ($AÑÁ¿êäŞ… == $CÊ£óÒ˜Š) { return false; } return true; } function systemMemberData($A²‰œé’ãà = '') { global $in; $aï‹»Ú”É± = ST . "\x2e" . ACT; $CÊ£óÒ˜Š = "\101"; $AÑÁ¿êäŞ… = $GLOBALS[base64_decode('Y29uZmln')]["\163\145\164\164\151\156\147\123"."\x79\x73\x74\x65\x6d"][base64_decode('dmVyc2lvblR5cA==').base64_decode('ZQ==')]; $E˜ÍÊ’Ä² = systemLimitData(strrev('tsiLesnecil')); if (!$AÑÁ¿êäŞ… || !in_array($AÑÁ¿êäŞ…, $E˜ÍÊ’Ä²)) { $AÑÁ¿êäŞ… = $CÊ£óÒ˜Š; } $dºŠèÃ·öá = new FileCache(USER_SYSTEM . "\x73\x79\x73\x74\x65\x6d\x5f\x6d\x65"."\155\142\145\162\56\160\150\160"); $a÷â–ïÆ«Ù = systemLimitData(base64_decode('Y29yZV90b28=')."\x6c\x73\x5f\x6d\x65\x6d\x62\x65\x72\x4c\x69"."\x6d\x69"."\x74"); $føªñÙ†íô = $dºŠèÃ·öá->get(); $eŸ‰Ú¥¿Êò = $a÷â–ïÆ«Ù[$AÑÁ¿êäŞ…]; if ($aï‹»Ú”É± == "\x73\x79\x73\x74\x65\x6d\x4d\x65\x6d"."\142\145\162\56\141\144\144") { if ($AÑÁ¿êäŞ… == $CÊ£óÒ˜Š && isset($in[base64_decode('aXNJbXBvcnQ=')])) { show_json("\166\145\162\163\151\157\156\137\156"._kstr2('ot_support'), false, _kstr2('version_e')._kstr2('rr')."\157\162"); } if (count($føªñÙ†íô) >= $eŸ‰Ú¥¿Êò && $eŸ‰Ú¥¿Êò != 1000) { show_json("\x76\x65\x72\x73\x69\x6f\x6e\x5f\x6e\x6f".strrev('t').strrev('n_troppus_').strrev('bmu').strrev('re'), false, base64_decode('dmVyc2lvbl9l')."\162\162\157"."\x72"); } } if ($aï‹»Ú”É± == _kstr2('systemMember.')._kstr2('add') || $aï‹»Ú”É± == _kstr2('systemMe').strrev('tide.rebm')) { if ($AÑÁ¿êäŞ… == $CÊ£óÒ˜Š && isset($in[base64_decode('aG9tZVBhdGg=')])) { show_json(strrev('_noisrev')."\x6e\x6f\x74\x5f\x73\x75\x70\x70\x6f\x72"."\x74", false, "\166\145\162\163\151\157\156\137\145".base64_decode('cnJvcg==')); } } if ($aï‹»Ú”É± == "\x73\x79\x73\x74\x65\x6d\x4d\x65\x6d\x62\x65".base64_decode('ci4=')."\x67".base64_decode('ZXQ=') || $A²‰œé’ãà == "\143\150\145\143\153\125\163\145\162\114\151\155\151"."\x74") { if (count($føªñÙ†íô) > $eŸ‰Ú¥¿Êò && $eŸ‰Ú¥¿Êò != 1000) { $F¿’Îç¤¤ = 1; $b¾„À‹ÁÉ¼ = array(); foreach ($føªñÙ†íô as $aï‹»Ú”É± => $cã‘ŸŒ²èë) { if ($F¿’Îç¤¤ > $eŸ‰Ú¥¿Êò) { break; } $b¾„À‹ÁÉ¼[$aï‹»Ú”É±] = $cã‘ŸŒ²èë; $F¿’Îç¤¤++; } $dºŠèÃ·öá->reset($b¾„À‹ÁÉ¼, false); } $føªñÙ†íô = $dºŠèÃ·öá->get(); if ($AÑÁ¿êäŞ… == $CÊ£óÒ˜Š) { $b¾„À‹ÁÉ¼ = array(); foreach ($føªñÙ†íô as $aï‹»Ú”É± => $cã‘ŸŒ²èë) { unset($cã‘ŸŒ²èë["\150\157\155\145\120\141\164\150"]); $b¾„À‹ÁÉ¼[$aï‹»Ú”É±] = $cã‘ŸŒ²èë; } $dºŠèÃ·öá->reset($b¾„À‹ÁÉ¼, false); } } return $dºŠèÃ·öá; } function systemLimitData($A²‰œé’ãà) { $a÷â–ïÆ«Ù = array(); $a÷â–ïÆ«Ù[base64_decode('Y29yZV90b29scw==')."\137\155\145\155\142\145\162\114\151\155"."\151\164"] = array("\x41" => 15, "\x4f" => 30, strrev('1O') => 100, "\120" => 50, _kstr2('Q') => 150, "\x51\x31" => 30, "\x51\x32" => 50, "\x51\x33" => 100, "\x51\x34" => 150, "\x51\x35" => 250, "\x51\x36" => 500, _kstr2('Q7') => 1001, strrev('8Q') => 1500, "\x51\x39" => 2000, "\x52" => 500, base64_decode('Uw==') => 1000, "\124" => 1000); $a÷â–ïÆ«Ù[base64_decode('Y29yZV90b29sc19ncg==')."\x6f\x75\x70\x4c\x69\x6d\x69\x74"] = array(_kstr2('A') => 1, "\x4f" => 5, "\x4f\x31" => 30, "\120" => 20, "\x51" => 40, "\x51\x31" => 1000, base64_decode('UTI=') => 1000, "\x51\x33" => 1000, _kstr2('Q4') => 1000, base64_decode('UTU=') => 1000, "\x51\x36" => 1000, "\x51\x37" => 1000, strrev('8Q') => 1000, strrev('9Q') => 1000, _kstr2('R') => 100, "\x53" => 1000, "\x54" => 1000); if ($A²‰œé’ãà == "\154\151\143\145\156\163\145\114\151".base64_decode('c3Q=')) { return array_keys($a÷â–ïÆ«Ù["\x63\x6f\x72\x65\x5f\x74\x6f\x6f\x6c\x73".strrev('_')."\x6d\x65\x6d\x62\x65\x72\x4c\x69\x6d"."\x69\x74"]); } return $a÷â–ïÆ«Ù[$A²‰œé’ãà]; } function systemGroupData() { global $in; $aï‹»Ú”É± = ST . "\x2e" . ACT; $CÊ£óÒ˜Š = "\101"; $AÑÁ¿êäŞ… = $GLOBALS[base64_decode('Y29uZmln')][strrev('tsySgnittes')._kstr2('em')]["\x76\x65\x72\x73\x69\x6f\x6e\x54".base64_decode('eXBl')]; $E˜ÍÊ’Ä² = systemLimitData(strrev('tsiLesnecil')); if (!$AÑÁ¿êäŞ… || !in_array($AÑÁ¿êäŞ…, $E˜ÍÊ’Ä²)) { $AÑÁ¿êäŞ… = $CÊ£óÒ˜Š; } $dºŠèÃ·öá = new FileCache(USER_SYSTEM . "\163\171\163\164\145\155\137\147\162\157\165\160".base64_decode('LnBocA==')); $a÷â–ïÆ«Ù = systemLimitData(_kstr2('core_tools').strrev('_')."\147".strrev('timiLpuor')); $føªñÙ†íô = $dºŠèÃ·öá->get(); $eŸ‰Ú¥¿Êò = $a÷â–ïÆ«Ù[$AÑÁ¿êäŞ…]; if ($aï‹»Ú”É± == "\x73\x79\x73\x74\x65\x6d\x47\x72"."\x6f\x75\x70\x2e"."\141\144\144") { if (count($føªñÙ†íô) >= $eŸ‰Ú¥¿Êò && $eŸ‰Ú¥¿Êò != 1000) { show_json(base64_decode('dmVyc2lvbl8=')."\x6e\x6f\x74\x5f"."\163\165\160\160\157\162\164\137\156\165\155"."\x62\x65\x72", false, "\x76\x65\x72\x73\x69\x6f\x6e\x5f".base64_decode('ZXJyb3I=')); } } if ($aï‹»Ú”É± == "\163\171\163\164\145\155\107\162".base64_decode('b3Vw')."\x2e\x61\x64\x64" || $aï‹»Ú”É± == "\x73\x79\x73\x74\x65\x6d\x47\x72\x6f"."\165\160\56\145\144\151\164") { if ($AÑÁ¿êäŞ… == $CÊ£óÒ˜Š && isset($in["\x68\x6f\x6d\x65\x50\x61\x74\x68"])) { show_json("\x76\x65\x72\x73\x69\x6f\x6e\x5f\x6e\x6f\x74"._kstr2('_support'), false, base64_decode('dmVyc2lvbl9lcnJvcg==')); } } if ($aï‹»Ú”É± == "\x73\x79\x73\x74\x65\x6d\x47\x72"."\157\165\160\56\147\145\164") { if (count($føªñÙ†íô) > $eŸ‰Ú¥¿Êò && $eŸ‰Ú¥¿Êò != 1000) { $F¿’Îç¤¤ = 1; $b¾„À‹ÁÉ¼ = array(); foreach ($føªñÙ†íô as $aï‹»Ú”É± => $cã‘ŸŒ²èë) { if ($F¿’Îç¤¤ > $eŸ‰Ú¥¿Êò) { break; } $b¾„À‹ÁÉ¼[$aï‹»Ú”É±] = $cã‘ŸŒ²èë; $F¿’Îç¤¤++; } $dºŠèÃ·öá->reset($b¾„À‹ÁÉ¼, false); } $føªñÙ†íô = $dºŠèÃ·öá->get(); if ($AÑÁ¿êäŞ… == $CÊ£óÒ˜Š) { $b¾„À‹ÁÉ¼ = array(); foreach ($føªñÙ†íô as $aï‹»Ú”É± => $cã‘ŸŒ²èë) { unset($cã‘ŸŒ²èë[_kstr2('homePath')]); $b¾„À‹ÁÉ¼[$aï‹»Ú”É±] = $cã‘ŸŒ²èë; } $dºŠèÃ·öá->reset($b¾„À‹ÁÉ¼, false); } } return $dºŠèÃ·öá; } function systemRoleData() { $aï‹»Ú”É± = ST . _kstr2('.') . ACT; $CÊ£óÒ˜Š = base64_decode('QQ=='); if ($aï‹»Ú”É± == "\x75\x73\x65\x72\x2e\x76\x65\x72"."\163\151\157\156\111\156\163\164".base64_decode('YWxs')) { version_install(); die; } $d©Œ¥÷» =& $GLOBALS["\143\157\156\146\151\147"]["\163\145\164\164\151\156\147\123"._kstr2('ystem')]; if (!init_version_check()) { $d©Œ¥÷»["\166\145\162\163\151\157\156\124"."\171\160\145"] = $CÊ£óÒ˜Š; if ($aï‹»Ú”É± != "\163\150\141\162\145\56\143\157"."\x6d\x6d\x6f\x6e\x4a\x73" && is_array($_SESSION["\x6b\x6f\x64\x55\x73\x65\x72"]) && $_SESSION["\153\157\144\125\163\145\162"]["\162\157\154\145"] == "\x31") { version_reset(false); license_page(); } } $dºŠèÃ·öá = new FileCache(USER_SYSTEM . "\x73\x79\x73\x74\x65\x6d\x5f\x72\x6f"."\x6c\x65"."\x2e\x70\x68\x70"); return $dºŠèÃ·öá; } function license_page() { init_model("\x50\x6c\x75\x67\x69\x6e")->init(); include TEMPLATE . "\x75\x73\x65\x72\x2f\x6c\x69\x63\x65\x6e".strrev('lmth.es'); die; } function init_version_check() { $d©Œ¥÷» =& $GLOBALS[strrev('gifnoc')]["\x73\x65\x74\x74\x69\x6e\x67\x53\x79\x73\x74\x65\x6d"]; $F´®§ÚÌ¿ = "\x40\x64\x66\x71\x5b\x2d\x29\x26\x2a\x5e"."\x2a"._kstr2('%(_90'); $CÊ£óÒ˜Š = "\101"; $E˜ÍÊ’Ä² = systemLimitData("\x6c\x69\x63\x65\x6e\x73\x65\x4c".strrev('tsi')); if (!isset($d©Œ¥÷»[_kstr2('versionType')]) || !in_array($d©Œ¥÷»["\166\145\162\163\151\157\156\124\171\160"._kstr2('e')], $E˜ÍÊ’Ä²)) { $d©Œ¥÷»[base64_decode('dmVyc2lvblR5cGU=')] = $CÊ£óÒ˜Š; } if ($d©Œ¥÷»[strrev('Tnoisrev').strrev('epy')] == $CÊ£óÒ˜Š) { unset($d©Œ¥÷»[_kstr2('versionHa')."\x73\x68"]); return true; } if (!isset($d©Œ¥÷»[strrev('yTnoisrev').base64_decode('cGU=')]) || !isset($d©Œ¥÷»["\x76\x65\x72\x73\x69\x6f\x6e\x55\x73\x65\x72"]) || !isset($d©Œ¥÷»["\x76\x65\x72\x73\x69\x6f\x6e\x4c\x69\x63"."\145\156\163\145"]) || !isset($d©Œ¥÷»[_kstr2('deviceUUID')]) || !isset($d©Œ¥÷»["\x64\x65\x76\x69\x63\x65\x50\x61\x74\x68"])) { return false; } if (strlen($d©Œ¥÷»["\166\145\162\163\151\157\156\125"."\163\145\162"]) != 16 || strlen($d©Œ¥÷»["\166\145\162\163\151\157\156\114\151\143".strrev('esne')]) != 62 || strlen($d©Œ¥÷»["\144\145\166\151\143\145\125\125"._kstr2('ID')]) != 16) { return false; } $a¸ŞºñÄáæ = substr($d©Œ¥÷»["\166\145\162\163\151\157\156\114\151"."\x63\x65\x6e\x73\x65"], 32); $fíóÖ¼›ì = md5($a¸ŞºñÄáæ . $d©Œ¥÷»[base64_decode('dmVyc2lvblU=')._kstr2('ser')] . $d©Œ¥÷»["\x64\x65\x76\x69\x63\x65\x55\x55\x49\x44"] . $d©Œ¥÷»[strrev('yTnoisrev')."\160\145"]); if ($fíóÖ¼›ì != substr($d©Œ¥÷»["\x76\x65\x72\x73\x69\x6f\x6e\x4c"._kstr2('icense')], 0, 32)) { return false; } $dËñÍ³ÛœŒ = Mcrypt::decode($d©Œ¥÷»["\x64\x65\x76\x69\x63\x65\x50\x61\x74\x68"], md5($F´®§ÚÌ¿ . $d©Œ¥÷»["\166\145\162\163\151\157\156\114\151"."\x63\x65\x6e\x73\x65"])); $F´ùÉ±Úİó = _kstr2('./lib/core/'); if (get_path_father($dËñÍ³ÛœŒ) == $F´ùÉ±Úİó) { $dËñÍ³ÛœŒ = str_replace($F´ùÉ±Úİó, strrev('eroc/ppa/.').strrev('/'), $dËñÍ³ÛœŒ); } $b¸É¼³åÆÊ = false; if (file_exists($dËñÍ³ÛœŒ)) { $AŠĞÕ³´Û = file_get_contents($dËñÍ³ÛœŒ); $AÉö™âˆ·† = Mcrypt::decode($AŠĞÕ³´Û, md5($F´®§ÚÌ¿ . $d©Œ¥÷»["\144\145\166\151\143\145\125\125"."\x49\x44"])); if ($AÉö™âˆ·† != '' && strtotime($AÉö™âˆ·†) > time()) { $b¸É¼³åÆÊ = true; } } if (!$b¸É¼³åÆÊ) { return false; } $e© î”·³Ï = substr(md5($d©Œ¥÷»["\x76\x65\x72\x73\x69\x6f\x6e\x4c\x69\x63\x65\x6e\x73\x65"]), 10, 10); $a–ÉŒÖÛ»Ñ = $e© î”·³Ï . $d©Œ¥÷»["\x76\x65\x72\x73\x69\x6f\x6e\x54\x79\x70\x65"] . $d©Œ¥÷»[_kstr2('deviceUUID')]; $d©Œ¥÷»[strrev('saHnoisrev')."\150"] = strrev(base64_encode(Mcrypt::encode($a–ÉŒÖÛ»Ñ, $F´®§ÚÌ¿, 0))); $d½ö¤»âŒæ = rand_string(16); $FÔ”»…¡íó = $d½ö¤»âŒæ . $d©Œ¥÷»["\x76\x65\x72\x73\x69\x6f\x6e\x54\x79".strrev('ep')] . Mcrypt::encode(md5($d©Œ¥÷»["\x76\x65\x72\x73\x69\x6f\x6e\x55\x73\x65\x72"]), $d½ö¤»âŒæ, 0); $d©Œ¥÷»["\x76\x65\x72\x73\x69\x6f\x6e\x48\x61\x73"."\x68\x55\x73\x65"."\162"] = base64_encode(strrev(Mcrypt::encode($FÔ”»…¡íó, "\x66\x33\x34\x32\x5e\x26\x2a\x28\x4b\x4a".base64_decode('RlNEOWZkanY='), 0))); return true; } function version_install() { $d©Œ¥÷» =& $GLOBALS["\x63\x6f\x6e\x66\x69\x67"][_kstr2('settingSyste')."\x6d"]; $F´®§ÚÌ¿ = "\100\144\146\161\133\55\51\46\52\136\52".base64_decode('JShfOTA='); if (isset($_GET["\x72\x65\x73\x65\x74"])) { version_reset(true); header(_kstr2('location:')."\x2e\x2f"); } if (!isset($_GET["\x6c\x69\x63\x65\x6e\x73\x65\x5f\x63\x6f\x64\x65"])) { license_page(); } else { $D¹êâ…‘ˆ¨ = rand_string(16); $d½ŒµÍ•õÀ = strrev('i/esnecil')."\x6e\x64\x65\x78"; $d½ŒµÍ•õÀ = $GLOBALS["\x63\x6f\x6e\x66\x69\x67"]["\x73\x65\x74\x74\x69\x6e\x67\x73"]["\x70\x6c\x75\x67\x69\x6e\x53\x65\x72\x76\x65\x72"] . $d½ŒµÍ•õÀ; $d½ŒµÍ•õÀ = str_replace("\150\164\164\160\163\72\57\57", base64_decode('aHR0cDovLw=='), $d½ŒµÍ•õÀ); $cŒË¥ŠÈĞµ = $d½ŒµÍ•õÀ . "\x26\x63\x6f\x64\x65\x3d" . $_GET["\x6c\x69\x63\x65\x6e\x73\x65\x5f\x63\x6f\x64\x65"] . "\x26\x75\x75\x69\x64\x3d" . $D¹êâ…‘ˆ¨; $cŒË¥ŠÈĞµ .= "\x26\x61\x70\x70\x4e\x61\x6d\x65\x3d\x6b\x6f"."\x64\x65\x78\x70\x6c\x6f\x72\x65\x72"."\46\141\160\160\126\145\162\163\151\157\156" . KOD_VERSION; $cŒË¥ŠÈĞµ .= strrev('=rerefer&') . rawurlencode($_SERVER["\x48\x54\x54\x50\x5f\x52\x45\x46\x45\x52"._kstr2('ER')]); if (defined("\111\116\123\124\101\114\114\137\103"."\x48\x41\x4e"."\116\105"._kstr2('L'))) { $cŒË¥ŠÈĞµ .= "\x26\x63\x68\x61\x6e\x6e\x65\x6c\x3d" . INSTALL_CHANNEL; } $eÍ£ªƒ…âŞ = json_decode(curl_get_contents($cŒË¥ŠÈĞµ), true); if (is_array($eÍ£ªƒ…âŞ) && $eÍ£ªƒ…âŞ[_kstr2('code')] == true && is_array($eÍ£ªƒ…âŞ["\x64\x61\x74\x61"])) { $dºŠèÃ·öá = new FileCache(USER_SYSTEM . strrev('s_metsys').strrev('te').base64_decode('dGluZy4=')."\x70\x68\x70"); $bà²Æºç¶ = $dºŠèÃ·öá->get(); $bà²Æºç¶[strrev('resUnoisrev')] = $_GET[strrev('edoc_esnecil')]; $bà²Æºç¶["\166\145\162\163\151\157\156\114\151\143".strrev('esne')] = $eÍ£ªƒ…âŞ["\x64\x61\x74\x61"][base64_decode('dmVyc2lvbl8=')."\x6c\x69\x63\x65\x6e\x73\x65"]; $bà²Æºç¶["\144\145\166\151\143\145\125\125"."\111\104"] = $D¹êâ…‘ˆ¨; $bà²Æºç¶["\166\145\162\163\151\157\156\124\171\160\145"] = $eÍ£ªƒ…âŞ["\x64\x61\x74\x61"]["\166\145\162\163\151\157\156\137\164"."\171"."\x70\x65"]; $dËñÍ³ÛœŒ = Mcrypt::decode($d©Œ¥÷»[_kstr2('devicePat')."\x68"], md5($F´®§ÚÌ¿ . $d©Œ¥÷»["\x76\x65\x72\x73\x69\x6f\x6e\x4c\x69\x63\x65\x6e\x73\x65"])); del_file($dËñÍ³ÛœŒ); version_install_path($bà²Æºç¶, $eÍ£ªƒ…âŞ["\x64\x61\x74\x61"]); $dºŠèÃ·öá->reset($bà²Æºç¶); $fÙ ÑÙ˜ˆ = BASIC_PATH . "\x2f\x63\x6f\x6e\x66\x69\x67\x2f"."\x73\x65\x74\x74\x69\x6e\x67\x5f\x75\x73\x65\x72\x2e"."\160\150\160"; if (!file_exists($fÙ ÑÙ˜ˆ)) { $AŠĞÕ³´Û = strrev(' php?<'); file_put_contents($fÙ ÑÙ˜ˆ, $AŠĞÕ³´Û); } install_msg("\346\201\255\345\226\234\346\202\250\357\274\214\345"."\234\250\347\272\277\345\215\207\347\272"."\247\346\216\210\346\235\203\346\210"."\220\345\212\237\357\274\201"); } else { install_msg($eÍ£ªƒ…âŞ["\144\141\164\141"], false); } } } function install_msg($cÅ²çºš˜, $b¢îÄ†ïßí = true) { $f˜±ŠÎ‡á¥ = $b¢îÄ†ïßí ? "\x53\x75\x63\x63\x65\x73\x73\x20".base64_decode('ISjljYfnuqfmiJDl')."\x8a\x9f\x29" : base64_decode('RXJyb3IgISjljYfnuqfl')."\xa4\xb1\xe8\xb4\xa5\x29"; $FŞÏÑ¶ŞÕø = $b¢îÄ†ïßí ? "\x2e\x2f" : "\56\57\151\156\144\145\170\56\160\150\160\77\165".base64_decode('c2VyL3ZlcnNpb25J').base64_decode('bnN0YWxs'); $cÅ²çºš˜ = $cÅ²çºš˜ ? $cÅ²çºš˜ : _kstr2('è¯·æ±‚æœåŠ')."\xa1\xe5\x99\xa8"."\xe5\xa4\xb1\xe8\xb4\xa5\xef\xbc\x8c\xe6\xa3"."\x80\xe6\x9f\xa5\xe6\x9c\x8d\xe5\x8a\xa1"."\xe5\x99\xa8\xe6\x98\xaf\xe5\x90".base64_decode('puiD')._kstr2('½è®¿é—®ç')."\xbd"."\221\347"._kstr2('»œã€‚<br/')._kstr2('>æ')."\xb3\xa8\x3a\xe6\x9c\x8d\xe5\x8a\xa1\xe5"."\231\250"."\344\270\215\350\203\275\346\230\257"."\344\273\243\347\220"._kstr2('†ä¸Šç½‘'); show_tips($cÅ²çºš˜, $FŞÏÑ¶ŞÕø, 2, $f˜±ŠÎ‡á¥); } function version_install_path(&$bà²Æºç¶, $FºËÜî½”¾) { $DÖ±‹ïŞÆÕ = $FºËÜî½”¾["\166\145\162\163\151\157\156\137\164\151".base64_decode('bWVfdA==')."\x6f"]; $F´®§ÚÌ¿ = base64_decode('QGRmcVstKSYqXiol')."\50\137\71\60"; $fôê”ç¸—£ = "\x2e" . substr(md5(rand_string(20) . time()), 15, 10) . _kstr2('.log'); $eÇ‘Õ…Ÿëâ = "\143\157\156\146\151\147\57\151"."\61\70\156\57"; $F¹¹§¯íÌ‘ = BASIC_PATH . $eÇ‘Õ…Ÿëâ . $fôê”ç¸—£; if (isset($FºËÜî½”¾[strrev('cived_tes')."\x65"."\x5f\x70"."\141\164\150"]) && $FºËÜî½”¾["\163\145\164\137\144\145\166\151\143\145\137\160\141\164\150"] == 1) { $F¹¹§¯íÌ‘ = "\56\57" . $eÇ‘Õ…Ÿëâ . $fôê”ç¸—£; } $AÉö™âˆ·† = Mcrypt::encode($DÖ±‹ïŞÆÕ, md5($F´®§ÚÌ¿ . $bà²Æºç¶[strrev('IUUecived')."\x44"])); file_put_contents($F¹¹§¯íÌ‘, $AÉö™âˆ·†); if (!file_exists($F¹¹§¯íÌ‘)) { install_msg($eÇ‘Õ…Ÿëâ . base64_decode('IGNhbid0IHdyaQ==')._kstr2('te')."\141\142\154\145", false); } $bà²Æºç¶["\x64\x65\x76\x69\x63\x65\x50\x61\x74"."\x68"] = Mcrypt::encode($F¹¹§¯íÌ‘, md5($F´®§ÚÌ¿ . $bà²Æºç¶[_kstr2('versionLi').base64_decode('Yw==')."\x65"."\156\163\145"])); return; } function version_reset($E—ÜÜô½ = false) { $d©Œ¥÷» =& $GLOBALS["\x63\x6f\x6e\x66\x69\x67"][strrev('Sgnittes').base64_decode('eXN0')."\x65\x6d"]; $F´®§ÚÌ¿ = "\x40\x64\x66\x71\x5b\x2d\x29\x26\x2a\x5e\x2a".base64_decode('JShfOQ==')."\x30"; if (isset($d©Œ¥÷»["\x64\x65\x76\x69\x63\x65\x50\x61\x74\x68"])) { $dËñÍ³ÛœŒ = Mcrypt::decode($d©Œ¥÷»["\x64\x65\x76\x69\x63\x65\x50\x61\x74\x68"], md5($F´®§ÚÌ¿ . $d©Œ¥÷»["\x76\x65\x72\x73\x69\x6f\x6e\x4c"._kstr2('icense')])); del_file($dËñÍ³ÛœŒ); } $dºŠèÃ·öá = new FileCache(USER_SYSTEM . "\163\171\163\164\145\155\137\163\145\164\164\151"."\x6e\x67\x2e\x70\x68\x70"); $bà²Æºç¶ = $dºŠèÃ·öá->get(); unset($bà²Æºç¶["\x76\x65\x72\x73\x69\x6f\x6e\x55\x73\x65\x72"]); unset($bà²Æºç¶["\x76\x65\x72\x73\x69\x6f\x6e\x4c"."\151\143\145\156"."\163\145"]); unset($bà²Æºç¶["\144\145\166\151\143\145\125\125\111\104"]); unset($bà²Æºç¶["\x64\x65\x76\x69\x63\x65\x50\x61\x74\x68"]); if ($E—ÜÜô½) { unset($bà²Æºç¶["\150\153\111\156\151\164"]); unset($bà²Æºç¶["\166\145\162\163\151\157\156\124\171\160\145"]); } $dºŠèÃ·öá->reset($bà²Æºç¶); }
