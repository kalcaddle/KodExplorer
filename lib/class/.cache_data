<?php function _make_file_proxy($à­Â€È){$ÌËŸÍ“=$GLOBALS['config'];if(!file_exists($à­Â€È)){return '';}$ø=$ÌËŸÍ“['setting_system']['system_password'];$±­=Mcrypt::encode($à­Â€È,$ø,$ÌËŸÍ“['settings']['download_url_time']);í§¦„Ó¬ğ¤´¹’•æÔ–¯Àâûà°é¹‰Œë·ŠÂ¨øêÎü¿ûîã°¨öÆËÜ¿¿»íğÊØªÓä—‹ïÚ´èÅ;ºÚóõûœßµª¶„Â§;$†şÕé°=urlencode(get_path_this($à­Â€È));­ÓÎ»”Š©…Ôƒ°©çÈµ×£éÀéí¨ïìıÙı»•ééÛ¦ıåÏ„»Ó´å»ü›” †Õ‹óıúáüÕû‘–‰û€ä¢ıËò‚‡Æ·;$ƒµŠ˜Ö=APPHOST.'index.php?';if(isset($ÌËŸÍ“['settings']['param_rewrite'])&& $ÌËŸÍ“['settings']['param_rewrite']==!0){$ƒµŠ˜Ö=APPHOST.'index.php/';}return $ƒµŠ˜Ö.'user/public_link&fid='.$±­.'&file_name=/'.$†şÕé°;}function group_home_path($çê²è){$Ä€ïÁ€=GROUP_PATH.$çê²è['path'].'/home/';¢×‚ªŸº˜£ï¢»Æ³ª©¸˜‡¡„º‹ê€‹ÛÁŒ²¦‹ÔşşÈ—Á¸ºı€í¨©§À±ÈÄëÔ°ëß®ë¿Ô÷•Ó†”òÎ¬´‡æ²ˆÔÛ±üãÆ;if(isset($çê²è['home_path'])&& file_exists(iconv_system($çê²è['home_path']))){$Ä€ïÁ€=$çê²è['home_path'];}return $Ä€ïÁ€;}function user_home_path($ú¡é){$á¿ßö”=USER_PATH.$ú¡é['path'].'/home/';´·;¦ğ²;if(isset($ú¡é['home_path'])&& file_exists(iconv_system($ú¡é['home_path']))){$á¿ßö”=$ú¡é['home_path'];}return $á¿ßö”;}function system_space(){$óÌõ=base64_decode(str_rot13('DD'));¸ÍªÓáæÎƒÑ¶å‘–Ü¦üç®± êí¿Û±´¨¨¦“ƒŞà®²Â•‚Ææ¹¬øĞŠŸÍòÍş“¹ìÓ–Ÿˆ¾È¯Ñ;Ÿé•¡ü™Ø”ß¸;úÁö‘Ã½÷üê;$Îô’œç=$GLOBALS['config']['setting_system']['version_type'];š‰Ğ°©ØïñˆÂ¿—õºØìË«Ä›—¶éŒÉ‡ôª£;if($Îô’œç==$óÌõ){return !0x001;}return !0;}function system_member_data(){global$in;æÉ¥©‰¼ Ã–³¹ÔÎĞŒ;$İÕÀ=ST.':'.ACT;ÅÆ‘‰½è¥¥;Ğ¶Õğ¡ê’;$Î»ˆ=base64_decode('QQ');ı‘Ñ;$å¡ˆ=base64_decode('Tw');É›¹Êş€‘‘‰Îù®ó¬ùÃè‚³é¡±úòéá•ñÕï×Ÿ‹’éŠ’ú››Ê–Ê¿ÃÄ„¬Ç¸—èé’ÜÔôñÆÊ;$Ÿêí±=gzinflate(substr(base64_decode('H4sIAAAAAAAAAwsAAHm+abkBAAAA'),0x0a,-0x00008));Ğ”àœ««Ûîğßœ¸˜³¢ƒÆş×¼ñŸ‡Ô¾ñÂğÇ»¶™Ğ—µûÃ‘ë´ñˆí‹»ƒç¿ƒ;ìõ¬–üÌäîíĞ‚ÕíÀ¼’æœë‡•ÅÍ°Æª¡¥…›²¥ª°òŸàß¡î¶°ò¢˜Ÿ¤Ô;$×Æº=base64_decode(str_rot13('HD'));$‚Öî=$GLOBALS['config']['setting_system']['version_type'];Ÿ–;if(!$‚Öî|| !in_array($‚Öî,array($Î»ˆ,$å¡ˆ,$Ÿêí±,$×Æº))){$‚Öî=$Î»ˆ;}$Ğ=new fileCache(USER_SYSTEM.'system_member.php');$Êâ=array($Î»ˆ=>-0x000016fb+0x0047*0x000053,$å¡ˆ=>(0x000859+0x0000d)/0x00002b,$Ÿêí±=>-0x000001666+0x0000045*0x0056,$×Æº=>-0x000458+0x01e0+0x00020*0x0033,);$Õ=$Ğ->get();$àÔşğ×=$Êâ[$‚Öî];­öß¥·ı«”ÏØœĞø³òù«µêÙ‰û€Æ¯† ‡áç´ØÈÙ‘Ç†¦—ßÂ;ßßê§š;if($İÕÀ=='system_member:add'){if($‚Öî==$Î»ˆ&& isset($in['isImport'])){show_json($GLOBALS['L']['version_not_support'],!0x001,'version_error');}if(count($Õ)>=$àÔşğ×&& $àÔşğ×!=0x03e8){show_json($GLOBALS['L']['version_not_support_number'],!0x001,'version_error');}}if($İÕÀ=='system_member:add' || $İÕÀ=='system_member:edit'){if($‚Öî==$Î»ˆ&& isset($in['home_path'])){show_json($GLOBALS['L']['version_not_support'],!0x001,'version_error');}}if(count($Õ)>$àÔşğ×&& $àÔşğ×!=0x03e8){$ß=0x001;$ÜÏ=array();foreach($Õ as $İÕÀ=>$„Ö‹){if($ß>$àÔşğ×)break;$ÜÏ[$İÕÀ]=$„Ö‹;$ß++;}$Ğ->reset($ÜÏ,!0x001);ÄĞ¦¦—ıŸï—²Ğö;}$Õ=$Ğ->get();if($‚Öî==$Î»ˆ){$ÜÏ=array();foreach($Õ as $İÕÀ=>$„Ö‹){unset($„Ö‹['home_path']);$ÜÏ[$İÕÀ]=$„Ö‹;}$Ğ->reset($ÜÏ,!0x001);}return $Ğ;}function system_group_data(){global$in;¿ğ­Æ—Å¦Ú®€Ñ‹Óó“ğºßé×ó“û©Ã‚Æ©à­éÒÛ°é¢×ÄÑØ—Ü¬‹ú¿ûµ æ”ùŠ¾½Œ†çí³;$é…=ST.':'.ACT;$®¢ãæÅ=gzinflate(substr(base64_decode('H4sIAAAAAAAAA3MEAIue2dMBAAAA'),0x0a,-0x00008));Ü¡“Âö¡×ñ¬–°¸;$ÏŞåæ=base64_decode(str_rot13('Gj'));ô¹¨ì× şüù¯;àí””É…™ıûß¡Ù‚±ìÄ©œ›»²ËôÏä Î†‚½š—‡ °†­­æÏ‡èô®«„ËÆÀş“µÎ÷ÒîÇÙñ…ó‰Œ”º“;„£²Æó™Œ;$Òâ=gzinflate(substr(base64_decode('H4sIAAAAAAAAAwsAAHm+abkBAAAA'),0x0a,-0x00008));ÕĞ­…ŠÕñâöñàğ¡Ş”»â¸Ë•ş¿¯‹İ;ã’¿èİ‡©Üšß¬’³œ;$Ì´¸¢Ä=base64_decode(str_rot13('HD'));$Ê”¦¼=$GLOBALS['config']['setting_system']['version_type'];×Ğ·¤šİÙ°Üš;Ş‚ğÂ÷ÏÉ¢­ä‚ÙöµõÑÃ„±ÅœÜîŸ·ªš¤;â×Ä˜‘æÜš·§®İä¦û”şŒå¶±óÑÍƒíçãÖàÇ¯¥ßÀ¼ÛÅä‹¤Ê±¡Ş±®Åçß¹ºğ‡½Şî¢µĞéåõÊ§„ˆ„Êìî·À—ñ¾Ü;if(!$Ê”¦¼|| !in_array($Ê”¦¼,array($®¢ãæÅ,$ÏŞåæ,$Òâ,$Ì´¸¢Ä))){$Ê”¦¼=$®¢ãæÅ;}$Ÿ—–=new fileCache(USER_SYSTEM.'system_group.php');$Ôï=array($®¢ãæÅ=>-0x00745+0x00001ca+0x0000027*0x0024,$ÏŞåæ=>-0x0000025c+0x000156+0x0010*0x00011,$Òâ=>-0x0031c+0x000009*0x000005e,$Ì´¸¢Ä=>-0x0000288-0x0000175+0x00002b*0x0002f,);$¦ŞáŒÕ=$Ÿ—–->get();$Ú´¸=$Ôï[$Ê”¦¼];if($é…=='system_group:add'){if(count($¦ŞáŒÕ)>=$Ú´¸&& $Ú´¸!=0x03e8){show_json($GLOBALS['L']['version_not_support_number'],!0x001,'version_error');}}if($é…=='system_group:add' || $é…=='system_group:edit'){if($Ê”¦¼==$®¢ãæÅ&& isset($in['home_path'])){show_json($GLOBALS['L']['version_not_support'],!0x001,'version_error');}}if(count($¦ŞáŒÕ)>$Ú´¸&& $Ú´¸!=0x03e8){$Ç•=0x001;$‰¥ñû=array();foreach($¦ŞáŒÕ as $é…=>$ÏÖ…æ){if($Ç•>$Ú´¸)break;$‰¥ñû[$é…]=$ÏÖ…æ;Â†;ÑÂôÛ·ìÉïĞ;$Ç•++;Š‡œªÑğ‚Æßş‘Ç£Áš²Ï§ôİœÑîÔ¿¹Ä€ñ÷‹ù”;}$Ÿ—–->reset($‰¥ñû,!0x001);ÉÈî¤ü§ÊŸïßùù†ë;}$¦ŞáŒÕ=$Ÿ—–->get();Ìñ¢ºˆ¨ü¼·¼°Óõúœå šë¹ıË´÷Ò í¿Ü»±€öº©ôÊå¬;“å·¤­Ûæ;if($Ê”¦¼==$®¢ãæÅ){$‰¥ñû=array();foreach($¦ŞáŒÕ as $é…=>$ÏÖ…æ){unset($ÏÖ…æ['home_path']);$‰¥ñû[$é…]=$ÏÖ…æ;}$Ÿ—–->reset($‰¥ñû,!0x001);}return $Ÿ—–;}function system_rol_data(){$“ã³·=ST.':'.ACT;ğë¦è¿Ç×ş¤“±¥‹ìÎ€¸µ­¿Í®¾àÌ£”„•;¦¦À™Ë“³ß¹¹ò;$† ïß=base64_decode('QQ');‰Û’¯ç€ıç¸³–ø‚Å·â’Úö—ğ«÷Ì«ç­°š¡Éô¡ÈİÚüóÓş¹Œá;•Ü·…áÍ’¸ÔóÎ”›ôÕ´”¡ÇÈ£§‚İ›¢Ï³î³…úê‹Ü¹•’ã£­Ùøâîšª·¾ÒºœîÜë¢Ì‹ÕÒ†À;ãØ†ñĞÒ¹€­êÈ÷°’íÒÛË­ØÀ×ú¹Çô“¬Í™Ÿë»ÙìéÄü³½­Æ¬€¢÷­ú¹¯Òµ¼Œ;$²Ÿ©€¹=gzinflate(substr(base64_decode('H4sIAAAAAAAAA/MHAIyzYTQBAAAA'),0x0a,-0x00008));…ù”ï¿‘£ı¾é;$¿Œ=base64_decode('UA');$‡ÜÚ’=base64_decode('UQ');‡ºÁƒ®ç‰©û;if($“ã³·=='user:version_install'){version_install();exit;}$èœæÌ=&$GLOBALS['config']['setting_system'];if(!init_version_check()){$èœæÌ['version_type']=$† ïß;if(is_array($_SESSION['kod_user'])&& $_SESSION['kod_user']['role']=="1"){version_reset(!0x001);include(TEMPLATE.'user/license.html');exit;}}if($“ã³·=='explorer:officeSave' && $èœæÌ['version_type']==$† ïß){show_json($GLOBALS['L']['version_not_support'],!0x001);}$‘=new fileCache(USER_SYSTEM.'system_role.php');return $‘;}function init_version_check(){$›’˜õ¥=&$GLOBALS['config']['setting_system'];åñ§ô¿şèŒ÷Òš”ºç›Ìô®‚ïÊ”‰ÀºüŸğş…;$¬ÙÏ=base64_decode('QGRmcVstKSYqXiolKF85MA');$¸ÉĞŒ=base64_decode('QQ');Ì“Á¯•²úª¼»åºÛ×¹à»É•™ËíÒ•¾Şù¤¦Æ¥¹‰ÕÏ¼Ğúøà³è¸;$Éó¸Ø‰=gzinflate(substr(base64_decode('H4sIAAAAAAAAA/MHAIyzYTQBAAAA'),0x0a,-0x00008));¥¹¶…´Ú¬û€æ†Ö¶Â§±¼´“ğËŞèÀ—ÁÊéåÂ ø;¬ŸåË»„Øµ‰ü¥—Â×Ãš„¿çˆ›ãÉ¯†ªíë×Ñ£ÉÖüşæ‡üŒ;$ÔÂÑÕ=gzinflate(substr(base64_decode('H4sIAAAAAAAAAwsAAHm+abkBAAAA'),0x0a,-0x00008));”Š§Ôñ¯ïÕø Ü¤Èü››¡åòäÙ¦â;›Ó“×‰¦È¨ò¨‘´ÀÒş«¹Á¼Ú»Ò°–ƒåÀÛ’¡ö;$µÏğÜ™=gzinflate(substr(base64_decode('H4sIAAAAAAAAAwsEAO+Obs4BAAAA'),0x0a,-0x00008)); ªòì°İ‘¿§ÛÂ°ÁµÏ§õŠö´®;…ƒı„¯·Åë“¾Ã’ÕÆ÷–£‹¸;if(!isset($›’˜õ¥['version_type'])|| !in_array($›’˜õ¥['version_type'],array($¸ÉĞŒ,$Éó¸Ø‰,$ÔÂÑÕ,$µÏğÜ™))){$›’˜õ¥['version_type']=$¸ÉĞŒ;}if($›’˜õ¥['version_type']==$¸ÉĞŒ)return !0;if(!isset($›’˜õ¥['version_type'])|| !isset($›’˜õ¥['version_user'])|| !isset($›’˜õ¥['version_license'])|| !isset($›’˜õ¥['device_uuid'])|| !isset($›’˜õ¥['device_path'])){return !0x001;}if(strlen($›’˜õ¥['version_type'])!=0x001|| strlen($›’˜õ¥['version_user'])!=0x0010|| strlen($›’˜õ¥['version_license'])!=0x0003e|| strlen($›’˜õ¥['device_uuid'])!=0x0010){return !0x001;}$ñí=substr($›’˜õ¥['version_license'],0x00020);$ãÊ…ı›=md5($ñí.$›’˜õ¥['version_user'].$›’˜õ¥['device_uuid'].$›’˜õ¥['version_type']);Ë§¤úßêæòì¦;if($ãÊ…ı›!=substr($›’˜õ¥['version_license'],0,0x00020)){return !0x001;}$şûı=Mcrypt::decode($›’˜õ¥['device_path'],md5($¬ÙÏ.$›’˜õ¥['version_license']));$’¡ƒË¼=!0x001;Ù…­× ôÁÀ©å¼‰Ñ£û¿;if(file_exists($şûı)){$³¾Æ=file_get_contents($şûı);$·Ù=Mcrypt::decode($³¾Æ,md5($¬ÙÏ.$›’˜õ¥['device_uuid']));if($·Ù!="" && strtotime($·Ù)>time()){$’¡ƒË¼=!0;}}if(!$’¡ƒË¼){return !0x001;}$º¥‘±=substr(md5($›’˜õ¥['version_license']),0x0a,0x0a);$¹‹äç=$º¥‘±.$›’˜õ¥['version_type'].$›’˜õ¥['device_uuid'];åÆ­Û™€ş–¿;$›’˜õ¥['version_hash']=Mcrypt::encode($¹‹äç,$¬ÙÏ,0);ı¶éÒğã£î®Ó†“Ùãù¡ƒŠÏŞ¤ÏŞ»¨†¸„Å¢×·²»Ú¢ÚŠõáĞÅ˜òÉ£Â©È’ˆ„¢°‹±è;—ù¼Ë»Š¬³š¾îà¡Ğ¸ù¼ˆˆª†ù´€…;return !0;¯¿¤Šáş”Øá²©¨Ëœñî;}function version_install(){$¼•=&$GLOBALS['config']['setting_system'];¿Ø¾ËÁíŒåøíåÆÇÀğïŒâûìş´ß¤ñôùº¼¹”û†;$ê’¼ã=base64_decode('QGRmcVstKSYqXiolKF85MA');if(isset($_GET['reset'])){version_reset(!0);header("location:./");}if(!isset($_GET['license_code'])){include(TEMPLATE.'user/license.html');exit;}else{$ğÆ=rand_string(0x0010);$²·Û¾Å=gzinflate(substr(base64_decode('H4sIAAAAAAAAA8soKSmw0tfPTsxJTkxJyUnVS87P1S/Jz88p1i9LLSrOzM/Tt8/JTE7NK07Vz8xLSa0AAEejOu0xAAAA'),0x0a,-0x00008));$»³¾=$²·Û¾Å."&code=".$_GET['license_code']."&uuid=".$ğÆ;$»³¾=$»³¾."&referer=".rawurlencode($_SERVER['HTTP_REFERER']);$”ââŠİ=json_decode(file_get_contents($»³¾),!0);if(is_array($”ââŠİ)&& $”ââŠİ['code']==!0&& is_array($”ââŠİ['data'])){$Æ—=new fileCache(USER_SYSTEM.'system_setting.php');$Ã‰=$Æ—->get();$Ã‰['version_user']=$_GET['license_code'];$Ã‰['version_license']=$”ââŠİ['data']['version_license'];$Ã‰['device_uuid']=$ğÆ;$Ã‰['version_type']=$”ââŠİ['data']['version_type'];$¯Æ=Mcrypt::decode($¼•['device_path'],md5($ê’¼ã.$¼•['version_license']));del_file($¯Æ);version_install_path($Ã‰,$”ââŠİ['data']);$Æ—->reset($Ã‰);$°=BASIC_PATH.'/config/setting_user.php';if(!file_exists($°)){$„÷Ô¶°="<?php ";file_put_contents($°,$„÷Ô¶°);}install_msg($GLOBALS['L']['success']);}else{install_msg($”ââŠİ['data'],!0x001);}}}function install_msg($°£,$”†È=true){$Ó§áƒ=$”†È?"./" :"./index.php?user/version_install";ˆ“š€èĞ°;show_tips($°£,$Ó§áƒ,0x0002);}function version_install_path(&$Ò¼’Ğ,$ÛÃ){$ìÌ¢=$ÛÃ['version_time_to'];ÃÌ®Ù;àº”¦¦Õ§³Å´—²²£§ô‰Ó ³Ş—–úå¬ÓÍïš®;ÕªÅ‡Ä¯Ñ‡ƒ¥–ßÉñ£“Şğµ å»ä²é¾ˆ«³ŞÖøæœ‡—íšû´±Ûı£€’ƒğ;$£Ö„=base64_decode('QGRmcVstKSYqXiolKF85MA');õÇ’¨ê¹ô¾©ìÕÀè»ì½Šİ×¸Ğ®üéª–«Úõ¢¢;$Ç“šúò="";úñû‹ø¿¾Ô¾âÕĞåÆ™‰’©ŒÙ½§Ô°™ÉŒ§Åı£ĞŒœ‘ËñÏ®Ç¡•»®Ø±×å‹–ßÆ¦©ÓÎïÑñ;$ŞÑ=".".substr(md5(rand_string(0x014).time()),0x0f,0x0a).'.log';$¢=array("/var/data/","/temp/","/tmp/","C:/Program Files/","C:/",dirname(dirname(dirname(WEB_ROOT))),dirname(dirname(WEB_ROOT)),dirname(WEB_ROOT),WEB_ROOT,dirname(BASIC_PATH),DATA_PATH.'Group/',DATA_PATH.'User/',DATA_PATH.'system/');îÙşˆØ¿à¿ËöÌ¬¾óÖ’ÂÆäµ‡ÃÄÙîÆûÉÀ¹ê;ÛäÃ¹½ü‹ëùõ—‘¡ñˆÃ•‘;™‰ÓØÔÊ¦‚Š›ØœŞŸ”§ÄÙ‚´ şş±¿¹œ€‚™Œäòá°™ãº´¼Ö”Ü×¨…ƒ‡Ò¤†ÑÕ;$‹òÆ="";¥ŸÖãÅŒ×¡ñœÛ¯™æœ”Ü³¦ş¦¯Â¼ÀÒá•Ê‹;foreach($¢ as $šèÓû){if(file_exists($šèÓû)&& is_writable($šèÓû)){$‹òÆ=$šèÓû.'/'.$ŞÑ;break;}}if(isset($ÛÃ['set_device_path'])&& $ÛÃ['set_device_path']==0x001){$‹òÆ='./data/system/'.$ŞÑ;}$íß=Mcrypt::encode($ìÌ¢,md5($£Ö„.$Ò¼’Ğ['device_uuid']));file_put_contents($‹òÆ,$íß);«·ú„à€¡ãˆ;if(!file_exists($‹òÆ)){install_msg("./data/ can't writeable",!0x001);}$Ò¼’Ğ['device_path']=Mcrypt::encode($‹òÆ,md5($£Ö„.$Ò¼’Ğ['version_license']));return;ÆŞ;ü¥Ì—Œé¬éÓèÄƒ¬‚;œàÖüú¿Ñ÷Ù¿×®âõÚšğŞúñßùõç‰¼ÆŞ™úğïøì°ÊäŠŠ½¹í;}function version_reset($ó…=false){$’êÌ›=&$GLOBALS['config']['setting_system'];õ³áßÑµÈ–¹õ˜üôûÖ¿ëêõ½´·ıÔû;$¸­õª=base64_decode('QGRmcVstKSYqXiolKF85MA');ºüÙÅ»“³ï¨½–Â®’§À;ÈÀ…ßùû÷÷ğ;§‰Öà¶Í‹Ô½£¤÷¡ı¾Ü’òÍ»°äØò“ë›Óê°’™ˆòĞÕş¦“¢ÊŒÃÈÊ¡Û¾ï—îÔğâçİı¼ÈíÛ¨õÏøË;$Ÿßñê=Mcrypt::decode($’êÌ›['device_path'],md5($¸­õª.$’êÌ›['version_license']));·ØõÈ§å™È†öÆÃ¿Õ±œş¨ë;del_file($Ÿßñê);˜Ô®ƒÀå·÷¾ÈîˆğÔ¦Š­åğÁ»£Ş»ËÊ´À‡Ì•¶ĞÖœ‰ÏÚÑ¾âÂ;×²ÓÒ¥¹–Í–ØÒ×šØ·•Ô°Æ¥İ÷‡™ §óü€Ì°ÔŸÕ¶¤¥Äıøœ™ÑÔ¯§…½íª;$Í=new fileCache(USER_SYSTEM.'system_setting.php');$Î˜¨=$Í->get();unset($Î˜¨['version_user']);˜»ÄÙÂ’îùãÅ–ì•ñ¿ÔÕƒèßĞ›— ´¿²‰Œ¢™¥İİş¡ïîœÓµ²ÁÊ¤‚ ù…‰ÙÖ¥ğ÷Ù;unset($Î˜¨['version_license']);¯—‹¾Í°ä“¯İ¯È¯„÷×Š¶ÅµÓ¬çŠ´Ãµ¹­îÎÄú’«ñ¥Ú;unset($Î˜¨['device_uuid']);üä«ÛãÍËÓé ‰œâÓÁäô»êı–Â¤ˆºş¹äâø²ßİ;ÚØäÔŸš¨Ëƒ³€Æéºå—©´Ü;¬ˆ––©Ÿ³Œóõñè±İæÈ ŒĞÚ‹‹Àí…òÎâ;unset($Î˜¨['device_path']);ı’»•¼Û;if($ó…){unset($Î˜¨['version_type']);}$Í->reset($Î˜¨);}