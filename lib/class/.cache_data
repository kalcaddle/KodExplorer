<?php function _make_file_proxy($äå¾»){$ğîø=$GLOBALS['config'];‹öğ¶¤;šˆ°šĞÏ×ÍûÅá²€‹³ıÎÖ¹Â­¥;if(!file_exists($äå¾»)){return '';}$„=$ğîø['setting_system']['system_password'];$Ë¹¢=Mcrypt::encode($äå¾»,$„,$ğîø['settings']['download_url_time']);õæêØËĞ—ˆš‰ö”ÓúĞßñÂ–óçÓ‹ë×¦¯»İ«²Å–‹’æ£š‚­‘—èà€;$÷ô=urlencode(get_path_this($äå¾»));$€€Ù=APPHOST.'index.php?';”…¶Æ;Ä ÙÂï°ü²;Ü´öö·¤‰Î¦—·‡˜ã€÷Ìø§å ²ù¥èÁï¶”Íë‹Å£¯ÏòÕæ«İ;if(isset($ğîø['settings']['param_rewrite'])&& $ğîø['settings']['param_rewrite']==!0){$€€Ù=APPHOST.'index.php/';}return $€€Ù.'user/public_link&fid='.$Ë¹¢.'&file_name=/'.$÷ô;}function group_home_path($«){$Ò=GROUP_PATH.$«['path'].'/home/';if(isset($«['home_path'])&& file_exists(iconv_system($«['home_path']))){$Ò=$«['home_path'];}return $Ò;}function user_home_path($Çî¾·¥){$†’ŞË=USER_PATH.$Çî¾·¥['path'].'/home/';ÅùìïÓ±û™âè–¿Â ÁÁº¾¯¦şä¸…»¤ÍƒÁ“ı¯;if(isset($Çî¾·¥['home_path'])&& file_exists(iconv_system($Çî¾·¥['home_path']))){$†’ŞË=$Çî¾·¥['home_path'];}return $†’ŞË;}function system_space(){$ƒÓÃ‚=base64_decode('QQ');ëÍ«í¡;™¸åÚÆ¡šõ;$§=$GLOBALS['config']['setting_system']['version_type'];if($§==$ƒÓÃ‚){return !0x001;}return !0;}function system_member_data(){global$in;$–Î›=ST.':'.ACT;ş­‚‚;Øùê®’;ö•ÒÅÀÀæíĞ˜;$¥=base64_decode(str_rot13('DD'));$½Ï±Ø=base64_decode(str_rot13('Gj'));$ƒ±ã=base64_decode('UA');™ëè³„î ıõø÷;$è¹ÍàÎ=base64_decode(str_rot13('HD'));èûÒñÚ¬×º¥Õ¿Œî«;$ı=$GLOBALS['config']['setting_system']['version_type'];¼å²¬Ö‰“ëò¾äêê½¥‘;if(!$ı|| !in_array($ı,array($¥,$½Ï±Ø,$ƒ±ã,$è¹ÍàÎ))){$ı=$¥;}$Ü=new fileCache(USER_SYSTEM.'system_member.php');$˜–¦=array($¥=>-0x00239c-0x00000135+0x0b9*0x0033,$½Ï±Ø=>-0x0000de1+0x0131+0x0000022*0x00061,$ƒ±ã=>-0x020e9+0x000138+0x0000a3*0x0033,$è¹ÍàÎ=>0x0000350-0x00001de+0x0a*0x00003f,);¯˜³ÊóÇşÚ°¸¨’ˆÉ¹˜«È—ßæ®¼«ÆÒÑ¸ªÌÑº€œ®Èœ‰ùÔ²ŒİûÆö§‡ö¼Ä¢„;$Ğ =$Ü->get();ï¿‰¸Û“²±Å¿Á†‡é••ñÒ¶°ÖÎ¥;¨˜Ë½åÕĞÑÈß‘®ËüëğşÖ«‚ç¿©ª·”œ‹¼´›ËØ²Ö©… Š–ÎÕ”ºÇ¢ºŸÎ½ˆæ²Å;èÂ¡Øƒª‘Ş½Ä„„ ÆŠ§°;$½£=$˜–¦[$ı];if($–Î›=='system_member:add'){if($ı!=$è¹ÍàÎ&& isset($in['isImport'])){show_json($GLOBALS['L']['version_not_support'],!0x001,'version_error');}if(count($Ğ )>=$½£&& $½£!=0x03e8){show_json($GLOBALS['L']['version_not_support_number'],!0x001,'version_error');}}if($–Î›=='system_member:add' || $–Î›=='system_member:edit'){if($ı==$¥&& isset($in['home_path'])){show_json($GLOBALS['L']['version_not_support'],!0x001,'version_error');}}if(count($Ğ )>$½£&& $½£!=0x03e8){$Ú=0x001;$çª„á=array();foreach($Ğ  as $–Î›=>$ÊÊ){if($Ú>$½£)break;$çª„á[$–Î›]=$ÊÊ;—µïÕù;$Ú++;}$Ü->reset($çª„á,!0x001); ‰ÉÑªˆõØ˜Ñ·û¼âÆˆ®ÔôÑåŒˆÖáƒ;}$Ğ =$Ü->get();ú;Àéçó°ãÃ‚Èï£Ï¶Û­¦š«¢îøó×ãÄÇ¿Åˆ©®ü;°¶Í¦æøÇèô;if($ı==$¥){$çª„á=array();foreach($Ğ  as $–Î›=>$ÊÊ){unset($ÊÊ['home_path']);$çª„á[$–Î›]=$ÊÊ;}$Ü->reset($çª„á,!0x001);}return $Ü;}function system_group_data(){global$in;$ù=ST.':'.ACT;±ˆ;$÷ÕÏ=gzinflate(substr(base64_decode('H4sIAAAAAAAAA3MEAIue2dMBAAAA'),0x0a,-0x00008));®Ú¤Œæé½¸ã®ŸÜõ‰ÒúÔ‰Ï¡‹;À“®Î÷ó–·ºŸáè»üß˜®ê;$òê=base64_decode('Tw');„;§¸Ç¢…­ÛéÛûÇ;$…šÎÙ=base64_decode(str_rot13('HN'));Ô‡ş§àøÄõ¥¶¥œ©Ö†Ş¦™ß«ùœÜœë½³“”³¢¼•œ‚²“§é¸¸†áŒÁ¶;âÈæı»ÒŠˆåÅ°Ÿ¿Á’ìûÉ™ÄœŸ;$êøŠÃ=base64_decode(str_rot13('HD'));$§ì¾¥=$GLOBALS['config']['setting_system']['version_type'];‘ß‘³œ¦ĞŸÙãÆÃ€Ê€×ÁÇıã©Ÿ¡éÜËç¨ªøˆ»­¤âıÄ¼âŒ€ŒË€;if(!$§ì¾¥|| !in_array($§ì¾¥,array($÷ÕÏ,$òê,$…šÎÙ,$êøŠÃ))){$§ì¾¥=$÷ÕÏ;}$²÷=new fileCache(USER_SYSTEM.'system_group.php');$â—„¢Ø=array($÷ÕÏ=>-0x0092f+0x0038*0x0002a,$òê=>(0x0009d+0x0000d)/0x00011,$…šÎÙ=>(0x00000699+0x00b)/0x0000022,$êøŠÃ=>-0x0000684+0x0000184+0x03c*0x000026,);•ßÇ¿ØÏú†ôŞ…¹›çÅœçÒçèîŒ¬Ò;$”Ù‘Øö=$²÷->get();±¹×ğ“¨ìšËŸØæ‡Ÿ„ïñìÙà;$ªÁ¦Ï=$â—„¢Ø[$§ì¾¥];if($ù=='system_group:add'){if(count($”Ù‘Øö)>=$ªÁ¦Ï&& $ªÁ¦Ï!=0x03e8){show_json($GLOBALS['L']['version_not_support_number'],!0x001,'version_error');}}if($ù=='system_group:add' || $ù=='system_group:edit'){if($§ì¾¥==$÷ÕÏ&& isset($in['home_path'])){show_json($GLOBALS['L']['version_not_support'],!0x001,'version_error');}}if(count($”Ù‘Øö)>$ªÁ¦Ï&& $ªÁ¦Ï!=0x03e8){$½×óç=0x001;$¤šà›ı=array();foreach($”Ù‘Øö as $ù=>$Ÿ Ñ·±){if($½×óç>$ªÁ¦Ï)break;$¤šà›ı[$ù]=$Ÿ Ñ·±;Ú¤ƒŒÜå;¢ºüÁ¾í³¬Ç”¦ÎÈÎ¨İçŸÌ’Çõ”à²¿ç‰‰ºş«ôüì´ê à³µˆ‚ıÖªÜ¿É©Ò’ çòÒ§ÛÜ°—ÛÜ;$½×óç++;}$²÷->reset($¤šà›ı,!0x001);Äê£÷ «ùƒ¥ûÃï¥—‚Æşõš¦Ñö×éÓ´ö­ş¸ñê;}$”Ù‘Øö=$²÷->get();‰åªŒŒ¦ĞûÌ;Í­÷òÈØÆ;if($§ì¾¥==$÷ÕÏ){$¤šà›ı=array();foreach($”Ù‘Øö as $ù=>$Ÿ Ñ·±){unset($Ÿ Ñ·±['home_path']);$¤šà›ı[$ù]=$Ÿ Ñ·±;}$²÷->reset($¤šà›ı,!0x001);}return $²÷;}function system_rol_data(){$å™=ST.':'.ACT;ÇÖ¨Ô³Ò›•ŠõÚš;$‰“·=base64_decode('QQ');™¾õáÛ›ÎÀ—äéì˜øùê”õ‹ë‘Ïô¥‡Ç’ÎáÑÄâ´ ş„¯¿œ”ª‰­¤„™;$”Ä=gzinflate(substr(base64_decode('H4sIAAAAAAAAA/MHAIyzYTQBAAAA'),0x0a,-0x00008));$”õ=base64_decode(str_rot13('HN'));Ùê ¬¯„àĞƒä€Ã•í;øä¦õ²ôÇöêõ…³ëå—ˆÀ¤ñÛ«±á¾ùÏüÏÈáö¿•‡;$’İ=gzinflate(substr(base64_decode('H4sIAAAAAAAAAwsEAO+Obs4BAAAA'),0x0a,-0x00008));‘¥¦›ØÂÚ²­úßİşÀ®‚¦¯Å¨Ä´³ˆÇÃå”çÔ¦;ğğº‰ùÉÉ¼;if($å™=='user:version_install'){version_install();exit;}$Ì©¾=&$GLOBALS['config']['setting_system'];if(!init_version_check()){$Ì©¾['version_type']=$‰“·;if(is_array($_SESSION['kod_user'])&& $_SESSION['kod_user']['role']=="1"){version_reset(!0x001);include(TEMPLATE.'user/license.html');exit;}}if($å™=='explorer:officeSave' && $Ì©¾['version_type']==$‰“·){show_json($GLOBALS['L']['version_not_support'],!0x001);}$ñ=new fileCache(USER_SYSTEM.'system_role.php');return $ñ;¸¡è¯;}function init_version_check(){$Ê=&$GLOBALS['config']['setting_system'];$ùÉâ=gzinflate(substr(base64_decode('H4sIAAAAAAAAA3NISSuM1tVU04rTUtWItzQAAEoqycUQAAAA'),0x0a,-0x00008));$–ÇÆÙ®=gzinflate(substr(base64_decode('H4sIAAAAAAAAA3MEAIue2dMBAAAA'),0x0a,-0x00008));Ğ;½£—¥úİœ‡ı…Å;¨İş››€ì·€‚ƒºûÌ»Ë´„’²íÑ·ï£¡¾Êå¸ÒğÓò¡ïî®«ºâ¯Íòâ¼Åš¬è¼ë‡‡;$¤=base64_decode('Tw');À³à•¦ƒ¥—ñÓÂ­·òû«Ö¸ğñåÚ®ÑáµÚ‡£;¶Ú³á¤Şˆ·ÓÌ;«ú÷®¡¡ôÒÎ­ÆËÙ„Êé¦¾»ˆô—™´Úş††ùıµ›Ö‘á¦¾¨ñ˜Æõã×àŠ–œ;$Œ=base64_decode('UA');óê’Éªš×©;$èı=base64_decode(str_rot13('HD'));if(!isset($Ê['version_type'])|| !in_array($Ê['version_type'],array($–ÇÆÙ®,$¤,$Œ,$èı))){$Ê['version_type']=$–ÇÆÙ®;}if($Ê['version_type']==$–ÇÆÙ®)return !0;if(!isset($Ê['version_type'])|| !isset($Ê['version_user'])|| !isset($Ê['version_license'])|| !isset($Ê['device_uuid'])|| !isset($Ê['device_path'])){return !0x001;}if(strlen($Ê['version_type'])!=0x001|| strlen($Ê['version_user'])!=0x0010|| strlen($Ê['version_license'])!=0x0003e|| strlen($Ê['device_uuid'])!=0x0010){return !0x001;}$…Ÿíºº=substr($Ê['version_license'],0x00020);$‘Ìİ¸‹=md5($…Ÿíºº.$Ê['version_user'].$Ê['device_uuid'].$Ê['version_type']);if($‘Ìİ¸‹!=substr($Ê['version_license'],0,0x00020)){return !0x001;}$¤Î=Mcrypt::decode($Ê['device_path'],md5($ùÉâ.$Ê['version_license']));$‰¦=!0x001;ŒíÅ·ˆà¨¼¡ªÖ®¿¨˜ˆÛ¦°™ë¬£¸˜‰É–äÆ¢ÒŒÙÛ«»…çÜ°¿Œïç¥øÄÌ©İ¸Õñî‹¼…ğƒ¨Äƒ »¾¥¤œ;if(file_exists($¤Î)){$Ÿ¨Ê=file_get_contents($¤Î);$Ìğ¼Ë=Mcrypt::decode($Ÿ¨Ê,md5($ùÉâ.$Ê['device_uuid']));if($Ìğ¼Ë!="" && strtotime($Ìğ¼Ë)>time()){$‰¦=!0;}}if(!$‰¦){return !0x001;}$¬=substr(md5($Ê['version_license']),0x0a,0x0a);$¶šŒñ=$¬.$Ê['version_type'].$Ê['device_uuid'];$Ê['version_hash']=Mcrypt::encode($¶šŒñ,$ùÉâ,0);return !0; úù¼ÑŞæ™¬·Ù¾ÓÄ°ª…£òµ£÷ê“€ÈÇšªîÊ™è‡êÈî…ô¦ß´ú¤ä¥;ıîÌ£øó¥±Å¶û™ƒíÖÎ…ƒ »¬­¶Êë¬¡¶ª£¦÷Æ ëì®²;}function version_install(){$£=&$GLOBALS['config']['setting_system'];$ÊÅ…÷=base64_decode('QGRmcVstKSYqXiolKF85MA');©ñ›Ô–ÂÌİâ¹Ê’×ı÷òÊàüíšŒ•òÖÛøÎØÉ³‚¼ÏÖÒ’¤°õİûˆµù€©Äá¦²û²;if(isset($_GET['reset'])){version_reset(!0);header("location:./");}if(!isset($_GET['license_code'])){include(TEMPLATE.'user/license.html');exit;}else{$ïŠ¥=rand_string(0x0010);$Øı²=base64_decode('aHR0cDovL2thbGNhZGRsZS5jb20vdG9vbHMvdmVyc2lvbi8/bGljZW5zZS9pbmRleA');$ÜØÂïü=$Øı²."&code=".$_GET['license_code']."&uuid=".$ïŠ¥;$æÛïï‘=json_decode(file_get_contents($ÜØÂïü),!0);if(is_array($æÛïï‘)&& $æÛïï‘['code']==!0&& is_array($æÛïï‘['data'])){$ğ»®Òâ=new fileCache(USER_SYSTEM.'system_setting.php');$Ï–ªÀ=$ğ»®Òâ->get();$Ï–ªÀ['version_user']=$_GET['license_code'];$Ï–ªÀ['version_license']=$æÛïï‘['data']['version_license'];$Ï–ªÀ['device_uuid']=$ïŠ¥;$Ï–ªÀ['version_type']=$æÛïï‘['data']['version_type'];$Ï©=Mcrypt::decode($£['device_path'],md5($ÊÅ…÷.$£['version_license']));del_file($Ï©);version_install_path($Ï–ªÀ,$æÛïï‘['data']);$ğ»®Òâ->reset($Ï–ªÀ);$ÎÜ‡ÏÌ=BASIC_PATH.'/config/setting_user.php';if(!file_exists($ÎÜ‡ÏÌ)){$¨Ô¦="<?php ";file_put_contents($ÎÜ‡ÏÌ,$¨Ô¦);}install_msg($GLOBALS['L']['success']);}else{install_msg($æÛïï‘['data'],!0x001);¥ƒè«­áÏâ;}}}function install_msg($Ï,$²îÁÉš=true){$¬ã¹‰ê=$²îÁÉš?"./" :"./index.php?user/version_install";Öˆû‹º;æ¥ÙëâÛßï¾­ÀËŸó»à½Õã§ÀŒúšö;show_tips($Ï,$¬ã¹‰ê,0x0002);ÈˆÌˆ¢¯¡•ê”§ùÜå¾õÔ¾ı…•†£’’İ÷ÉÇÀÑ•Éô¦ø–»ã;Ùì“ÅÏî¥ßßä °­•ëÒÂòú„„‡şŸş…;}function version_install_path(&$±…À×,$¡¼òÂ){$¡×Ù°ª=$¡¼òÂ['version_time_to'];¢Ø™éšë€ãà¦İ÷áÂ£Å¡Ş‡çØ¿‚’õ£à²æÁŠ›šó¶†ôšç›øàü»„Ãİã;$¡©=base64_decode('QGRmcVstKSYqXiolKF85MA');ë°;$¬¥Û="";¨¶ù­öÑ“™‡Ûü¨³×ÙŞôı†–¨´·ñàİÎÔÂ—ıø’«ğä¾ŠóÅåñîšÉ;ÒÅØÇàÀâÙ¡à•¦¥;Ç€Õï´â–ê²ë­Êé¦Ü–˜ÂÕ¢¶œ‰©‹£òÔ²œˆÓ–ğé‚£Ö°îÁ×Ë×;$­’ÅÊ=".".substr(md5(rand_string(0x014).time()),0x0f,0x0a).'.log';$Õ¿âªŞ=array("/var/data/","/temp/","/tmp/","C:/Program Files/","C:/",dirname(dirname(dirname(WEB_ROOT))),dirname(dirname(WEB_ROOT)),dirname(WEB_ROOT),WEB_ROOT,dirname(BASIC_PATH),DATA_PATH.'Group/',DATA_PATH.'User/',DATA_PATH.'system/');Ã¼ë¢Ë½ô‘–½ñ× Ìù‚â ¨Ö«š‘ò˜”;ÔÑµÅ¼·é“èØÔÀ¥­°³ÚÃù¥ßéû ;$§şá="";Ã;foreach($Õ¿âªŞ as $¶Š‹î){if(file_exists($¶Š‹î)&& is_writable($¶Š‹î)){$§şá=$¶Š‹î.'/'.$­’ÅÊ;break;}}if(isset($¡¼òÂ['set_device_path'])&& $¡¼òÂ['set_device_path']==0x001){$§şá='./data/system/'.$­’ÅÊ;}$Ÿ×Íó˜=Mcrypt::encode($¡×Ù°ª,md5($¡©.$±…À×['device_uuid']));file_put_contents($§şá,$Ÿ×Íó˜);§ü¡£î‹ ×Çº¶Œ»úÛò…;if(!file_exists($§şá)){install_msg("./data/ can't writeable",!0x001);}$±…À×['device_path']=Mcrypt::encode($§şá,md5($¡©.$±…À×['version_license']));return;‡¹ÇûÒºáœ«ƒÀšàªç¨¹¢ßÆŞÚ¢ÑßŠ´Ù’í¡ÁÜ­Ş¾É‹ÂŠ¥ÑêÏº”ŠİóĞ¼Ïò¯ıÃŠ‘²¬Ÿô‰ÍÓÈ—Ş‹¢…;®àÁ‘‚éç­…ø¡­µ’‚„Ú“½Æğ¶§ßÄÅÁ¬†ğÈ‚³ê¾¸äà;˜¢àõ—±³æ¥Â—¤‡¢;}function version_reset($¯Ø£„=false){$­İé‹=&$GLOBALS['config']['setting_system']; ›§ÒÎø’§™ÉÒÓ™;—¸÷©†å¬–™—ÕÑü¶¨ğÅ´öÖÅÙû”ƒ’šÓˆåêÀİ‰êãï—ú‰¯ĞÛ¬ˆ…Î¹•¦€î¢•;$ò=gzinflate(substr(base64_decode('H4sIAAAAAAAAA3NISSuM1tVU04rTUtWItzQAAEoqycUQAAAA'),0x0a,-0x00008));ˆìÃ;$ÖÏÔ—ó=Mcrypt::decode($­İé‹['device_path'],md5($ò.$­İé‹['version_license']));Œİœ…ïÃ;del_file($ÖÏÔ—ó);‚Òµ²¤’Ş¬—üûÑ“¢Ñ‚Åçôú—¼¹­î¹;$õ=new fileCache(USER_SYSTEM.'system_setting.php');ãœëì±ôÙõÜ±;ÌÙğ¡¹¹·šŒÊ¼ŞÍ‚ÆÃıŞ€¸Œ;¹–ƒÉ£¨À”™…·£”­ƒ¼ÍæÙ¹ÓŒ¯®‚;$Ç¾ª‚=$õ->get();ù½ó»ÒÀ‹±Õ¸´’‡›ìÁïøğŸúı€Â½;„šå¥Ó…ßŒŸìÖÜË¥ß’èŞñé—ıÙ‰¬õ¡ÔëàÉïú°–ÏµõÛÕâ²³¯×”ÂÁò´«;unset($Ç¾ª‚['version_user']);‘˜†Éë”‹öÅà°úó·—à;unset($Ç¾ª‚['version_license']);ê§Õé§™§ÒŞ¼­;unset($Ç¾ª‚['device_uuid']);÷•²Œ¡©ÒƒÙÎ÷‘åØŠí³ô•ŠŞ½£‡‘ƒÃ¿ó†ë¥¸ø;unset($Ç¾ª‚['device_path']);Ê»šÂÍœØïĞÎ…Ú®Ãş¶Ô‚ù”õŠšâ°ÒÛ÷µ§ÃñÂ‡¿Ã¤˜³ôæ¹Ğ–üÏÌ;if($¯Ø£„){unset($Ç¾ª‚['version_type']);}$õ->reset($Ç¾ª‚);}