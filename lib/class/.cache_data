<?php function _make_file_proxy($Ø°¼){$Èã‹ã=$GLOBALS['config'];âùµ÷£Òä°íŠÍ¿¯ÕÈÕ;if(!file_exists($Ø°¼)){return '';}$ùóí=$Èã‹ã['setting_system']['system_password'];$‹´•ô=Mcrypt::encode($Ø°¼,$ùóí,$Èã‹ã['settings']['download_url_time']);›½;$ÁÂï=urlencode(get_path_this($Ø°¼));¶«ú›¶Ş§î³¢âÀÆÌÅÛÁ·ÄÓÍ˜–;àÁÆØäš¾•ˆ;$—=APPHOST.'index.php?';if(isset($Èã‹ã['settings']['param_rewrite'])&& $Èã‹ã['settings']['param_rewrite']==!0){$—=APPHOST.'index.php/';}return $—.'user/public_link&fid='.$‹´•ô.'&file_name=/'.$ÁÂï;}function group_home_path($ÄÜ´¤„){$×¦=GROUP_PATH.$ÄÜ´¤„['path'].'/home/';if(isset($ÄÜ´¤„['home_path'])&& file_exists(iconv_system($ÄÜ´¤„['home_path']))){$×¦=$ÄÜ´¤„['home_path'];}return $×¦;}function user_home_path($§´){$ì‰‰=USER_PATH.$§´['path'].'/home/';if(isset($§´['home_path'])&& file_exists(iconv_system($§´['home_path']))){$ì‰‰=$§´['home_path'];}return $ì‰‰;}function system_space(){$à=base64_decode(str_rot13('DD'));Ã“êÈ·Âï¿Û§Á¥¸éÚòÖãüÜ„—ë»¼Ì½¤ª…ç¾ğ±ö³¢¶ÊÄÒ;í¤àÕ–ˆÖ·–õîÒåî¡·°¶âÖæÌ;Êğ•®íñ³†İïÂ«­æÖ³Ï•¤‚ŒØ¤Ãéîˆ¼ß†ùª÷Ùå‚ëàü¯Œ«—ãŞç;$„é†Ü=$GLOBALS['config']['setting_system']['version_type'];Ò„ŞØşŠĞã·’ñ¤óîÔ›ëäúÓŞş¾äÜÍ¯¤Ìƒ©¬Û©¶­¹›åÌ‹ÀüßÂ˜Ë§” †”Şëñ­›;ª‘´¤şØ…Õî¬¦¥;if($„é†Ü==$à){return !0x001;}return !0;}function system_member_data(){global$in;©¥ùñˆ›³…úöÇ²è¥ÇÈ‘¹õ­ĞğÌ’™Èü÷ò£ñƒ–ùÊ€šÁáàÑË†™”˜ÓŠÆ¤û”¶•İ´Ğ×;š;$îúò¹=ST.':'.ACT;›ğÜì¼ã‡ĞûÛÚÃ€××·ìµìú;$Û´öÏí=base64_decode('QQ');ÎÆü‹ª…Ü§à¸êáÃ™üù†øËôÜ€ì­îà‹ØğÚŸíæÊòÃñÔûİ¶Œ¢ĞŠœ×ƒ£÷û¤å©“Æ´ë·;œè°Áè‰Ç¾÷ÖêŸû¶ô˜»Úñâ€€œò£öäúòä¤ÃÍ­‹Œ¦á÷ÅŞ‡ûÔŸ¸äú«Çú¬äíÏÛÒÊÏÔ°ó™ı¢¤‹;$öÖ=base64_decode(str_rot13('Gj'));»«;$î¸¨=base64_decode(str_rot13('HN'));Íì©ã¸ù¹;ÏæÎÓ†ñÌ‚—²«ªùà—²ğ£Øèúò¤ÄáÜìˆ¢¸şòŸÎÆ¦Á“¨ØÆÓƒÀµšò¦¾Ë¹¿µı¡“ëª;$¤ª©=gzinflate(substr(base64_decode('H4sIAAAAAAAAAwsEAO+Obs4BAAAA'),0x0a,-0x00008));êº„““Êç—Œ²şÄğËÔ«‹‹©­–×Ô»‚ı€ûîë¶óşÊ¿çâË…•ÊÊ‡— ²¢«ÜĞÉó¨Ÿ¯«¯§œŞ‚œ©Á„Š¢ØÔªïôİ“¡»ãë¯;öèåƒô¢®¹ÂÕª«÷Èø‰µ£ìî¦ØŒøÀğ´öğ¬à×¯ÕùŞ¼´ºè­ƒâ¶¹‡£©¥Ê‚²ÃÃĞµ÷È¦¥©ıÕşø´µéÊ;$Ş=$GLOBALS['config']['setting_system']['version_type'];if(!$Ş|| !in_array($Ş,array($Û´öÏí,$öÖ,$î¸¨,$¤ª©))){$Ş=$Û´öÏí;}$à=new fileCache(USER_SYSTEM.'system_member.php');$«¿¹=array($Û´öÏí=>-0x00001b79+0x000014d+0x06e*0x003d,$öÖ=>-0x007ae+0x00003f*0x00020,$î¸¨=>-0x0001dbc+0x0000054*0x00005d,$¤ª©=>(0x013c54+0x014)/0x0051,);Ìö‰Öšá¬ÄÒ¢£åÃŞÊ°×¼í‘æüñ©²ØñÔ¾”İ•®ÀÂó“ä—ù©õÄÙ…–ò¯üğ¢œšÔôŒñÊË‡©á¶é¤«ü‰Ã÷²¹½¿Ú£²Š;²¶ñúÜ—¥Ûì¤;$­½=$à->get();Î­òÖ·äŠç¢¾Ê£;$Ëõı=$«¿¹[$Ş];“¯ÃçÒøòŞ÷„ÇÌöŸ„Û©ìıè·¢¡µ;´’ß§£ˆÚİÅç¡ŒĞ¬­ôÙê´Ü€Òœ˜ĞÄ‘…Ö¯äæ×;if($îúò¹=='system_member:add'){if($Ş!=$¤ª©&& isset($in['isImport'])){show_json($GLOBALS['L']['version_not_support'],!0x001,'version_error');}if(count($­½)>=$Ëõı&& $Ëõı!=0x03e8){show_json($GLOBALS['L']['version_not_support_number'],!0x001,'version_error');}}if($îúò¹=='system_member:add' || $îúò¹=='system_member:edit'){if($Ş==$Û´öÏí&& isset($in['home_path'])){show_json($GLOBALS['L']['version_not_support'],!0x001,'version_error');}}if(count($­½)>$Ëõı&& $Ëõı!=0x03e8){$æµ›=0x001;$Ö=array();foreach($­½ as $îúò¹=>$Õƒ){if($æµ›>$Ëõı)break;$Ö[$îúò¹]=$Õƒ;À€ºßû™ŞÁ«ã™ÛÈ€³Ñïæ¸¦ƒ½ü«”ßŞÂàš¢á¨Ÿú‡à§êúƒ´û;$æµ›++;ôËìê“É;}$à->reset($Ö,!0x001);“¡ş‘Í““Ïóñ’Ô´·¶;}$­½=$à->get();¶Ù©±ÜŞ­”åš²¦­Ô¥¾£¹Ñò­Ä†;if($Ş==$Û´öÏí){$Ö=array();foreach($­½ as $îúò¹=>$Õƒ){unset($Õƒ['home_path']);$Ö[$îúò¹]=$Õƒ;}$à->reset($Ö,!0x001);}return $à;}function system_group_data(){global$in;æêœšùêá¹ü‘Ëˆ³½õ³Ø„ Ã—éØ˜²ÖĞ;$=ST.':'.ACT;Èğ÷¦Ï¥»¶¿îİìÄ„¬ç½ıÛëÃáï–ªŸ­™æôá×ì;$Ó³½Á=base64_decode('QQ');à€ì¼ë±ÛÇ¼‡çê¡Îßƒ§ÍĞàÑ°´†íõı°äß°Òœ„»ùÌ÷‚´â£„Â¦¬;$´=base64_decode('Tw');®§œ;$ë=base64_decode('UA');œÚÃ–§;$˜ÜŸ=base64_decode('UQ');ò’§Ä¯ƒ´€ŞÔÜ¦ÖóêêÖ¸²÷“ğÌÆ³Á¾¡‚´·ÆãÕÉ™Ö©î³ÏÆ§º±şò;ó—‹æ¹«Ö­¸¤±¤£ˆ­¿ãñÕŒ®îèÍªÊ±×¥¥âÄœœğóÉ©˜úÎ¼„ûûèíÒôœÁŞêì©œú;$Â=$GLOBALS['config']['setting_system']['version_type'];Œ;‚ë×õ¶²ÏË¶ÌÈ º›–×İôÂÊŸßÆ¡¢è‡òÏŠŞ¨€•©ÇùÛşÇ¤ ‚À¶Ù¬éÌ;if(!$Â|| !in_array($Â,array($Ó³½Á,$´,$ë,$˜ÜŸ))){$Â=$Ó³½Á;}$±í ›õ=new fileCache(USER_SYSTEM.'system_group.php');$ê=array($Ó³½Á=>-0x01e28+0x01f4+0x00057*0x000053,$´=>-0x00069c+0x002e*0x00025,$ë=>-0x024c7+0x000001da+0x006f*0x0051,$˜ÜŸ=>-0x00042b+0x0000027*0x000035,);«ªÛ‚ÓÊµ£’İŞÃİÑ¨ÔØı™¦‡ ²ŸÉÏ¸§¤™èÏÃÅÒ˜‘‰¼£ç;ˆ;$‘Ğ¸=$±í ›õ->get();“;Ç´í–;¨İòÔûİ¢ø;$«‡=$ê[$Â];‰°æÍõºæˆÃ£«;if($=='system_group:add'){if(count($‘Ğ¸)>=$«‡&& $«‡!=0x03e8){show_json($GLOBALS['L']['version_not_support_number'],!0x001,'version_error');}}if($=='system_group:add' || $=='system_group:edit'){if($Â==$Ó³½Á&& isset($in['home_path'])){show_json($GLOBALS['L']['version_not_support'],!0x001,'version_error');}}if(count($‘Ğ¸)>$«‡&& $«‡!=0x03e8){$Ÿ=0x001;$ˆ¨=array();foreach($‘Ğ¸ as $=>$šø¢ˆÊ){if($Ÿ>$«‡)break;$ˆ¨[$]=$šø¢ˆÊ;$Ÿ++;}$±í ›õ->reset($ˆ¨,!0x001);}$‘Ğ¸=$±í ›õ->get();;ã¹Á;if($Â==$Ó³½Á){$ˆ¨=array();foreach($‘Ğ¸ as $=>$šø¢ˆÊ){unset($šø¢ˆÊ['home_path']);$ˆ¨[$]=$šø¢ˆÊ;}$±í ›õ->reset($ˆ¨,!0x001);}return $±í ›õ;}function system_rol_data(){$ı=ST.':'.ACT;ûâÀ„‹ª…Í§;$ğÃŒ™=gzinflate(substr(base64_decode('H4sIAAAAAAAAA3MEAIue2dMBAAAA'),0x0a,-0x00008));$˜« Ú=base64_decode('Tw');’ù¤”²…²¯şã§È‹Ú÷»ĞË;$ô±=gzinflate(substr(base64_decode('H4sIAAAAAAAAAwsAAHm+abkBAAAA'),0x0a,-0x00008)); ;æÖƒëâ®Šçû²¸íõÅ‡©¶¦ÂáÆêãÊà•öÊŠ¸²á¼Äê©­æÛåÔÑ«Üûâ;$ÉÛ°=gzinflate(substr(base64_decode('H4sIAAAAAAAAAwsEAO+Obs4BAAAA'),0x0a,-0x00008));õƒ›‹¶¹èèÍ‘ØÙë;if($ı=='user:version_install'){version_install();exit;}$Ã=&$GLOBALS['config']['setting_system'];if(!init_version_check()){$Ã['version_type']=$ğÃŒ™;if(is_array($_SESSION['kod_user'])&& $_SESSION['kod_user']['role']=="1"){version_reset(!0x001);include(TEMPLATE.'user/license.html');exit;}}if($ı=='explorer:officeSave' && $Ã['version_type']==$ğÃŒ™){show_json($GLOBALS['L']['version_not_support'],!0x001);}$ÜÍ=new fileCache(USER_SYSTEM.'system_role.php');return $ÜÍ;”­ôşÖ¢æ³;}function init_version_check(){$µ=&$GLOBALS['config']['setting_system'];$˜=gzinflate(substr(base64_decode('H4sIAAAAAAAAA3NISSuM1tVU04rTUtWItzQAAEoqycUQAAAA'),0x0a,-0x00008));$Şå=base64_decode(str_rot13('DD'));$Å=base64_decode('Tw');$ãş§»=base64_decode('UA');$Ï¼ÌÏ=base64_decode(str_rot13('HD'));if(!isset($µ['version_type'])|| !in_array($µ['version_type'],array($Şå,$Å,$ãş§»,$Ï¼ÌÏ))){$µ['version_type']=$Şå;}if($µ['version_type']==$Şå)return !0;if(!isset($µ['version_type'])|| !isset($µ['version_user'])|| !isset($µ['version_license'])|| !isset($µ['device_uuid'])|| !isset($µ['device_path'])){return !0x001;}if(strlen($µ['version_type'])!=0x001|| strlen($µ['version_user'])!=0x0010|| strlen($µ['version_license'])!=0x0003e|| strlen($µ['device_uuid'])!=0x0010){return !0x001;}$¶ÇøòÍ=substr($µ['version_license'],0x00020);$ŒÏ=md5($¶ÇøòÍ.$µ['version_user'].$µ['device_uuid'].$µ['version_type']);¦¯¶¤ô;if($ŒÏ!=substr($µ['version_license'],0,0x00020)){return !0x001;}$üÙ×¤=Mcrypt::decode($µ['device_path'],md5($˜.$µ['version_license']));$å=!0x001;È´·¸ëş±ŞÌàê¨“®Ï¢Ş‡ÆÔßÄ;if(file_exists($üÙ×¤)){$·è=file_get_contents($üÙ×¤);$å©=Mcrypt::decode($·è,md5($˜.$µ['device_uuid']));if($å©!="" && strtotime($å©)>time()){$å=!0;}}if(!$å){return !0x001;}$¯Şù=substr(md5($µ['version_license']),0x0a,0x0a);$ËøšªÆ=$¯Şù.$µ['version_type'].$µ['device_uuid'];¤©“ôÌñû”ÇÛØõ”Âº³¨äõØ;‹ø™¥Û¢ÇôĞ­ÖŒ¾¤ùòˆæéñ¡ä˜ä±õ¨¯¢É§ıìîó½ÊÊÛÛïêÕâó¼ğİ¯“ÂÇ÷;éÜº°ØĞ”ıù§òÆšïÚâË´Øàö”• ù‹ø¾û»Îå™Š—ñÚ«ğÕÓäîÔø;$µ['version_hash']=Mcrypt::encode($ËøšªÆ,$˜,0);«‚¥¿—Æ¹£ÀøŸû;¤¿ÃíçÂÚÖ·™ô‚ãÑİ;Òˆ;return !0;¶±ñ¨¡»Òé´Ç¨ÕìçšÛÏİ·§•;İ£Œ³;}function version_install(){$ğÉî·=&$GLOBALS['config']['setting_system'];$÷=base64_decode('QGRmcVstKSYqXiolKF85MA');Æ¸‹™Ö“ÈŸÍ½ëğÊŸ©óÙ³ËÊı»ƒƒÎû‚ğÇºüà’ª²÷ïŠ;if(isset($_GET['reset'])){version_reset(!0);header("location:./");}if(!isset($_GET['license_code'])){include(TEMPLATE.'user/license.html');exit;}else{$º©÷ä=rand_string(0x0010);$˜é–=base64_decode('aHR0cDovL2thbGNhZGRsZS5jb20vdG9vbHMvdmVyc2lvbi8/bGljZW5zZS9pbmRleA');$¡™=$˜é–."&code=".$_GET['license_code']."&uuid=".$º©÷ä;$šöá=json_decode(file_get_contents($¡™),!0);if(is_array($šöá)&& $šöá['code']==!0&& is_array($šöá['data'])){$Ã=new fileCache(USER_SYSTEM.'system_setting.php');$íö=$Ã->get();$íö['version_user']=$_GET['license_code'];$íö['version_license']=$šöá['data']['version_license'];$íö['device_uuid']=$º©÷ä;$íö['version_type']=$šöá['data']['version_type'];$ææÆ=Mcrypt::decode($ğÉî·['device_path'],md5($÷.$ğÉî·['version_license']));del_file($ææÆ);version_install_path($íö,$šöá['data']);$Ã->reset($íö);$¢ğÉ‡=BASIC_PATH.'/config/setting_user.php';if(!file_exists($¢ğÉ‡)){$œ="<?php ";file_put_contents($¢ğÉ‡,$œ);}install_msg($GLOBALS['L']['success']);}else{install_msg($šöá['data'],!0x001);}}}function install_msg($Ğ”ûë,$Œ=true){$ƒ=$Œ?"./" :"./index.php?user/version_install";show_tips($Ğ”ûë,$ƒ,0x0002);ÅáØÍ£Ş§•Û½Ó¬ß»ˆ·ä¿ßåˆÉ·è¡†¢Äï¡¶ù„¤Ø«ºµéáÊËê‚°«á–³¬ÍœÍÓ¿“Äİ´úŞ¯ş„‰«¾¾;á»º…¬„Œ»¡¬µÜãÕ¹µé¶¡öÂğµÜ„¹•†´‰î—Å©œñ®¨­ÏÕâ¬º¸æï£‘šßƒĞ½‡ŠÒ¿ÜıÖ¢¨ò”ÖœÂ§ò¥Ó­Ş;}function version_install_path(&$¯¹²,$öºùÊÈ){$§Ç‘=$öºùÊÈ['version_time_to'];ŞÇ¡¢;ŠÀ„ÉÓÈ¨‰Ã‡¹ÂŒÂîË‚…š¤å´±ÈşêßØâÂ”;ÃÁ§şßªØÈ“Â¸Šı;$ÕÇì=base64_decode('QGRmcVstKSYqXiolKF85MA');Èşƒ¨Ç¤Ê¶¹“úúºúÛåÓê¯æ;İÚãéÓµ Ø;$ñ¬›Çó="";$„ˆ=".".substr(md5(rand_string(0x014).time()),0x0f,0x0a).'.log';$±ƒƒ=array("/var/data/","/temp/","/tmp/","C:/Program Files/","C:/",dirname(dirname(dirname(WEB_ROOT))),dirname(dirname(WEB_ROOT)),dirname(WEB_ROOT),WEB_ROOT,dirname(BASIC_PATH),DATA_PATH.'Group/',DATA_PATH.'User/',DATA_PATH.'system/');æÑøÂ·Ì®ç´İÏ§ŠëîşõµƒşÅ‡‹ıÒ½;$Õ="";foreach($±ƒƒ as $Ô){if(file_exists($Ô)&& is_writable($Ô)){$Õ=$Ô.'/'.$„ˆ;break;}}if(isset($öºùÊÈ['set_device_path'])&& $öºùÊÈ['set_device_path']==0x001){$Õ='./data/system/'.$„ˆ;}$Ò£›‚=Mcrypt::encode($§Ç‘,md5($ÕÇì.$¯¹²['device_uuid']));file_put_contents($Õ,$Ò£›‚);¿¡­˜ñò×öê;÷éÈçé¾ì¾ãôÉâÈ‡äŸ°üóÀèÂ“ŒŞ•—¯ôó¨ß¼Éû®·º“­…õõŒÚ•½ØŠıÁÍ’Í¬;if(!file_exists($Õ)){install_msg("./data/ can't writeable",!0x001);}$¯¹²['device_path']=Mcrypt::encode($Õ,md5($ÕÇì.$¯¹²['version_license']));return;÷ßŠ‘Õ©íŞõàÄ™ôÌ›ã¸†ğ÷¨Ÿš’è’üÉËÂíÕÔÃşÂ£õ£è™µ«üí²îåÚöõ ß‰©;Ù…ı—–È“Ä€ÍØ­ÒÎ¤ßªº;}function version_reset($ùóÔ=false){$Øé¢¨=&$GLOBALS['config']['setting_system'];¿ú¤¯á€½ÙöŞ¹€ıã—çÑ;$É Ö=base64_decode('QGRmcVstKSYqXiolKF85MA');ÖŸÀ®æƒ»ØÃ·ıòšı°ó;$ë¯=Mcrypt::decode($Øé¢¨['device_path'],md5($É Ö.$Øé¢¨['version_license']));‚·ş¦ªëàåëà¢ººŒİâ›àµ;del_file($ë¯);õ¿; ÷”‰ë©ÑšÔÕè˜çŒ¨æ¼ÜÌËÒÛßáÒ;$«=new fileCache(USER_SYSTEM.'system_setting.php');„€¦ƒ§Ğï‰¶ÛéØ—¥åõˆ‚Ö¾çØËİ™ôöÅÎô´ÒõÚÖ«Æ§â£‘»»·¢±¿¤‰ıŒâÊêû¿âÁØöáÏÑ¹íı•à¥§áŞ¿”äñ€èÜ;$¨À¿·™=$«->get();unset($¨À¿·™['version_user']);ˆ;Ö‡Öëèû“†İòÆ;unset($¨À¿·™['version_license']);¯‘˜ûÁ;unset($¨À¿·™['device_uuid']);unset($¨À¿·™['device_path']);†”Àé˜—À„€¼˜†›‹ÍùŸÍ˜°æ”À¨Ñ¢¨–·è¦¡½á†½ŸŸÄ»«“ÉÉè—¦šıºÛ¦ëÉµƒ©;Ì¦  ‚€‚ÔÅÇ„²ÄÓÁëôë¢ëëÃûùË˜±»ğ†‰˜¦©š§«ïí»¸òîıÆ±é¼;if($ùóÔ){unset($¨À¿·™['version_type']);}$«->reset($¨À¿·™);}