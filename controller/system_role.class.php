<?php class system_role extends Controller{public static $static_sql=null;private $sql;function __construct(){parent::__construct();Ö¨Á¢;$this->sql=self::load_data();ò²™ø™à†ç¸¼õş;}public static function load_data(){if(is_null(self::$static_sql)){self::$static_sql=system_rol_data();}return self::$static_sql;}public static function get_info($îï¹¡){$Æ‘È=self::load_data();¨‹á®‰Ôà£Îú„Ôâ½‘ÙË‘Ëºéô£¬¼´õ£çÌ©Êú³ ÜÖî×ÛÄº™Õ•åæá èË–ŒøÒÁïöŞØÃ‰£¿¼Ãœ”³óï÷¯;return $Æ‘È->get($îï¹¡);}public function get(){show_json($this->sql->get());µ§Ÿó§«ìùìİñÌ¶µÕÚõ“’§Ò‡—Ê¶¡™û‘Ï¤¢î˜Éš†Äˆã·Ô›ì«õã¿•õ;}public function add(){$çüş²´=$this->_init_data();$çüş²´['role_id']=$this->sql->get_max_id().'';œÔÕ‹í ¦óå®Ø„ó‹°éî;if($this->sql->set($çüş²´['role_id'],$çüş²´)){show_json($this->L['success'],!0,$çüş²´['role_id']);}show_json($this->L['error'],!1);}public function edit(){$€ä×çâ=$this->_init_data();øçÇ¬„;$=$this->in['role_id'];if($this->sql->set($,$€ä×çâ)){show_json($this->L['success'],!0,$);}show_json($this->L['error'],!1);}public function del(){if(!isset($this->in['role_id']))show_json($this->L["data_not_full"],!1);if(strlen($this->in['role_id'])<=0x001)show_json($this->L['default_user_can_not_do'],!1);system_member::role_remove_user_update($this->in['role_id']);if($this->sql->remove($this->in['role_id'])){show_json($this->L['success']);}show_json($this->L['error'],!1);}private function _init_data(){if(strlen($this->in['name'])<0x001)show_json($this->L["groupname_can_not_null"],!1);$€‰å=array('name'=>rawurldecode($this->in['name']));Í±›¸¡Œ¸†ã¡è»¼€µ¥Èâªæå»òŠñó“ØÍºÃ;$€‰å['ext_not_allow']=$this->in['ext_not_allow'];foreach($this->config['role_setting'] as $ŞÔê=>$Ï){foreach($Ï as $ıŒ){$şÁ“Ç¥=$ŞÔê.':'.$ıŒ;if(isset($this->in[$şÁ“Ç¥])){$€‰å[$şÁ“Ç¥]=0x001;}else{$€‰å[$şÁ“Ç¥]=0;}}}return $€‰å;}}