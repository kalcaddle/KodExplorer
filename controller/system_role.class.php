<?php class system_role extends Controller{public static $static_sql=null;private $sql;function __construct(){parent::__construct();$this->sql=self::load_data();Ù³Ñììñ§Àë¡ÑÆ¥§¶ÂßÚ¾üÎ¹ÎÒİëí;}public static function load_data(){if(is_null(self::$static_sql)){self::$static_sql=system_rol_data();}return self::$static_sql;}public static function get_info($£){$İ×ˆ=self::load_data();ò†å”×¬¹şãüŞ¾¼Üö«àÔ»ÌÃ¾ïùœÇ‚çûÛ“âïëªêò§Ê²ä§ÀÛÓ¡°íôÎŞîë;return $İ×ˆ->get($£);}public function get(){show_json($this->sql->get());í°ÈĞ ´àË Óóê‡Ø“Ç´çéå÷ØÚÆ·É³ß»ˆ;}public function add(){$ª=$this->_init_data();$ª['role_id']=$this->sql->get_max_id().'';’Ü¦²±š¸ó±¨™ê‘ÄéØû´Üğ–ğœÏÏ˜ªáõĞ•¨ë³áßäã‰şÎ™‘”ƒê‘¸÷íªßÆŞ¯ß‰‘ÖÚ¦€ÇÚá;if($this->sql->set($ª['role_id'],$ª)){show_json($this->L['success'],!0,$ª['role_id']);}show_json($this->L['error'],!1);}public function edit(){$¿Å=$this->_init_data();$•ËĞ=$this->in['role_id'];if($this->sql->set($•ËĞ,$¿Å)){show_json($this->L['success'],!0,$•ËĞ);}show_json($this->L['error'],!1);}public function del(){if(!isset($this->in['role_id']))show_json($this->L["data_not_full"],!1);if(strlen($this->in['role_id'])<=0x001)show_json($this->L['default_user_can_not_do'],!1);system_member::role_remove_user_update($this->in['role_id']);ˆ´©³Â‰ú¡¸Û«Ê²†ñ³ÎÌ•öÛ©Ìñ;if($this->sql->remove($this->in['role_id'])){show_json($this->L['success']);}show_json($this->L['error'],!1);}private function _init_data(){if(strlen($this->in['name'])<0x001)show_json($this->L["groupname_can_not_null"],!1);$œÄÙ×=array('name'=>rawurldecode($this->in['name']));‚;$œÄÙ×['ext_not_allow']=$this->in['ext_not_allow'];óÄØŸŒ¦‚¿ôÎÕìÛ²–¨¤;foreach($this->config['role_setting'] as $Æ=>$Ğ ™){foreach($Ğ ™ as $¯›){$§=$Æ.':'.$¯›;if(isset($this->in[$§])){$œÄÙ×[$§]=0x001;}else{$œÄÙ×[$§]=0;}}}return $œÄÙ×;•û…¼ıÄ±Í›©ÍµÑñÁ™´“ºÎ³ééÕë’ôáşíöûò³ù¸åÇÓ…ñ¢ºÄ•üİÉ‘˜˜Äƒƒšî•Ğ•ıÈ‘ğüŒªâÓşçÆ¡£‹¶¡è²‚™;}}