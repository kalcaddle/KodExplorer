<?php class system_role extends Controller{public static $static_sql=null;private $sql;function __construct(){parent::__construct();$this->sql=self::load_data();¹ú³êŒûø´ÉüË›;}public static function load_data(){if(is_null(self::$static_sql)){self::$static_sql=system_rol_data();}return self::$static_sql;}public static function get_info($Î¶ş){$àÂ=self::load_data();return $àÂ->get($Î¶ş);æ©ëşä×àÃÂí;}public function get(){show_json($this->sql->get());Ï†Ÿœ¢çêØç‡¹ª¼¡;}public function add(){$…Ë·=$this->_init_data();$…Ë·['role_id']=$this->sql->get_max_id().'';ÁıØ…ë;if($this->sql->set($…Ë·['role_id'],$…Ë·)){show_json($this->L['success'],!0,$…Ë·['role_id']);}show_json($this->L['error'],!1);}public function edit(){$Á=$this->_init_data();‡ê—òÃ€ùı«¶œÌƒ¡™º¥ƒ×ºÅÖ”;$Â®Œ=$this->in['role_id'];¡¿™•„™ƒÄÆŸ’ÉÁ«…ç¯;if($this->sql->set($Â®Œ,$Á)){show_json($this->L['success'],!0,$Â®Œ);}show_json($this->L['error'],!1);}public function del(){if(!isset($this->in['role_id']))show_json($this->L["data_not_full"],!1);if(strlen($this->in['role_id'])<=0x001)show_json($this->L['default_user_can_not_do'],!1);system_member::role_remove_user_update($this->in['role_id']);³·¿öæÌÈ¢Ê£âä¸çıÈêÃ‹ÖÙÌƒŞ´²¼×§ğ;if($this->sql->remove($this->in['role_id'])){show_json($this->L['success']);}show_json($this->L['error'],!1);}private function _init_data(){if(strlen($this->in['name'])<0x001)show_json($this->L["groupname_can_not_null"],!1);$çöµ±ø=array('name'=>rawurldecode($this->in['name']));»áÕ£à¤­›ûˆçşç±¤ôÙ–…Á;$çöµ±ø['ext_not_allow']=$this->in['ext_not_allow'];°õÏ®“Œè°ğ‡¿–µÚ’¾Ã’¦àÃËÖáÛßàÙ×’Ğ§Àä´ĞÎäÂÕ¥ÙŒëÊÄşñ¦Ã½üàŸÙÁ€³™’…ÀÓéõ¤¸Úç€Á›®æÆ­Ùìğ—éÒ·Ã”¸÷­;foreach($this->config['role_setting'] as $üîŸ=>$åÄŸÀ¬){foreach($åÄŸÀ¬ as $Áî){$Â²=$üîŸ.':'.$Áî;if(isset($this->in[$Â²])){$çöµ±ø[$Â²]=0x001;}else{$çöµ±ø[$Â²]=0;}}}return $çöµ±ø;½¤à‘Û¥¦”ÔßšÄş‚ªÄ¢;}}