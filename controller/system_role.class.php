<?php class system_role extends Controller{public static $static_sql=null;private $sql;function __construct(){parent::__construct();$this->sql=self::load_data();§üÀÕ°·üîàÛñöåå‚;}public static function load_data(){if(is_null(self::$static_sql)){self::$static_sql=system_rol_data();}return self::$static_sql;}public static function get_info($ü){$á=self::load_data();return $á->get($ü);¸€¾ûØŞ¤Ö ù‡Ø˜…ÇøàºğÇ òİ‹¿¯ñ†©ª†ºéƒ“È§éè¢ñÂ»÷Š´ÙÅ¥¡å™ş„¥¿;}public function get(){show_json($this->sql->get());}public function add(){$Å=$this->_init_data();˜¬Ï¬ô÷—Şš‰¡Õ¬‹Úñ±üØËüÜğ¼‘‰‚îËÎˆ÷´;$Å['role_id']=$this->sql->get_max_id().'';Ì²Õî‰×›”³Æ±ç“®Å;if($this->sql->set($Å['role_id'],$Å)){show_json($this->L['success'],!0,$Å['role_id']);}show_json($this->L['error'],!1);}public function edit(){$ê=$this->_init_data();ÆÙ¼ÎÑÛ„¿òĞŒ¥¦û®ş˜Ã;$§‹ä=$this->in['role_id'];if($this->sql->set($§‹ä,$ê)){show_json($this->L['success'],!0,$§‹ä);}show_json($this->L['error'],!1);}public function del(){if(!isset($this->in['role_id']))show_json($this->L["data_not_full"],!1);if(strlen($this->in['role_id'])<=0x001)show_json($this->L['default_user_can_not_do'],!1);system_member::role_remove_user_update($this->in['role_id']);if($this->sql->remove($this->in['role_id'])){show_json($this->L['success']);}show_json($this->L['error'],!1);}private function _init_data(){if(strlen($this->in['name'])<0x001)show_json($this->L["groupname_can_not_null"],!1);$Ô=array('name'=>rawurldecode($this->in['name']));$Ô['ext_not_allow']=$this->in['ext_not_allow'];ìòŒ©Áİ…Æø—«Ÿ¾§Í½;foreach($this->config['role_setting'] as $’ñæ=>$Öö){foreach($Öö as $êËá){$÷”Öë =$’ñæ.':'.$êËá;if(isset($this->in[$÷”Öë ])){$Ô[$÷”Öë ]=0x001;}else{$Ô[$÷”Öë ]=0;}}}return $Ô;}}