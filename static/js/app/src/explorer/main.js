define("app/src/explorer/main",["lib/jquery-lib","lib/util","lib/webuploader/webuploader-min","lib/ztree/js/ztree","lib/contextMenu/jquery-contextMenu","lib/artDialog/jquery-artDialog","lib/picasa/picasa","./ui","./fileSelect","../../common/taskTap","../../common/core","../../tpl/search","../../tpl/upload","../../common/rightMenu","../../common/tree","../../common/pathOperate","../../tpl/fileinfo","../../tpl/app","../../common/pathOpen","../../common/CMPlayer","./path"],function(e){Config={BodyContent:".bodymain",FileBoxSelector:".fileContiner",FileBoxClass:".fileContiner .file",FileBoxClassName:"file",FileBoxTittleClass:".fileContiner .title",SelectClass:".fileContiner .select",SelectClassName:"select",TypeFolderClass:"folderBox",TypeFileClass:"fileBox",HoverClassName:"hover",FileOrderAttr:"number",TreeId:"folderList",pageApp:"explorer",treeAjaxURL:"index.php?explorer/treeList&app=explorer",AnimateTime:200},Global={fileListAll:"",fileListNum:0,fileRowNum:0,frameLeftWidth:200,treeSpaceWide:10,topbar_height:40,ctrlKey:!1,shiftKey:!1,fileListSelect:"",fileListSelectNum:"",isIE:!-[1],isDragSelect:!1,historyStatus:{back:1,next:0}},e("lib/jquery-lib"),e("lib/util"),e("lib/webuploader/webuploader-min"),e("lib/ztree/js/ztree"),e("lib/contextMenu/jquery-contextMenu"),e("lib/artDialog/jquery-artDialog"),e("lib/picasa/picasa"),ui=e("./ui"),TaskTap=e("../../common/taskTap"),core=e("../../common/core"),rightMenu=e("../../common/rightMenu"),ui.tree=e("../../common/tree"),ui.path=e("./path"),fileSelect=e("./fileSelect"),fileLight=fileSelect.fileLight,$(document).ready(function(){Global.topbar_height="none"==$(".topbar").css("display")?0:$(".topbar").height(),$(".init_loading").fadeOut(600),ui.init(),ui.tree.init(),TaskTap.init(),core.update(),core.upload_init(),fileSelect.init(),rightMenu.initExplorer()})}),define("app/src/explorer/ui",["./fileSelect"],function(require,exports){var fileSelect=require("./fileSelect"),fileLight=fileSelect.fileLight,MyPicasa=new Picasa;PicasaOpen=!1;var _ajaxLive=function(){fileLight.init(),ui.setStyle(),PicasaOpen=!1,MyPicasa.initData(),$(".fileContiner .picture img").lazyload({container:$(".bodymain")})},_initListType=function(e){$(".tools-right button").removeClass("active"),$("#set_"+e).addClass("active"),"list"==e?($(Config.FileBoxSelector).removeClass("fileList_icon").addClass("fileList_list"),$("#list_type_list").html('<div id="main_title"><div class="filename" field="name">'+LNG.name+"<span></span></div>"+'<div class="filetype" field="ext">'+LNG.type+"<span></span></div>"+'<div class="filesize" field="size">'+LNG.size+"<span></span></div>"+'<div class="filetime" field="mtime">'+LNG.modify_time+"<span></span></div>"+'<div style="clear:both"></div>'+"</div>"),$(Config.FileBoxSelector+" textarea").autoTextarea({minHeight:19,padding:4})):($(Config.FileBoxSelector).removeClass("fileList_list").addClass("fileList_icon"),$("#list_type_list").html(""),$(Config.FileBoxSelector+" textarea").autoTextarea({minHeight:32,padding:4})),$(".menu_seticon").removeClass("selected"),$(".set_set"+G.list_type).addClass("selected")},_setListType=function(e,t){G.list_type=e,void 0==t?$.ajax({url:"index.php?setting/set&k=list_type&v="+e,dataType:"json",success:function(){_initListType(e),_f5(!1,!1)}}):(_initListType(e),_f5(!1,!0))},_sortBy=function(e,t){var t="down"==t?-1:1;return function(a,i){return a=a[e],i=i[e],i>a?-1*t:a>i?1*t:void 0}},_setListSort=function(e,t){0!=e&&(G.sort_field=e,$(".menu_set_sort").removeClass("selected"),$(".set_sort_"+e).addClass("selected")),0!=t&&(G.sort_order=t,$(".menu_set_desc").removeClass("selected"),$(".set_sort_"+t).addClass("selected")),_f5(!1,!0),$.ajax({url:"index.php?setting/set&k=list_sort_field,list_sort_order&v="+G.sort_field+","+G.sort_order})},_jsonSortTitle=function(){var up='<i class="font-icon icon-chevron-up"></i>',down='<i class="font-icon icon-chevron-down"></i>';$("#main_title .this").toggleClass("this").attr("id","").find("span").html(""),$("#main_title div[field="+G.sort_field+"]").addClass("this").attr("id",G.sort_order).find("span").html(eval(G.sort_order))},_bindEventSort=function(){$("#main_title div").die("click").live("click",function(){"up"==$(this).attr("id")?$(this).attr("id","down"):$(this).attr("id","up"),_setListSort($(this).attr("field"),$(this).attr("id"))})},_bindEventTools=function(){$(".tools a,.tools button").bind("click",function(){var e=$(this).attr("id");_toolsAction(e)})},_bindEventTheme=function(){$(".dropdown-menu-theme li").click(function(){var e=$(this).attr("theme");$.ajax({url:"index.php?setting/set&k=theme&v="+e,dataType:"json",success:function(){ui.setTheme(e)}}),$(".dropdown-menu li").removeClass("this"),$(this).addClass("this")})},_bindFrameSizeEvent=function(){var e=!1,t=0,a=0,i=0,s=$(".frame-left"),n=$(".frame-resize"),o=$(".frame-right");n.die("mousedown").live("mousedown",function(e){return 1!=e.which?!0:(l(e),this.setCapture&&this.setCapture(),$(document).mousemove(function(e){r(e)}),$(document).one("mouseup",function(e){return c(e),this.releaseCapture&&this.releaseCapture(),stopPP(e),!1}),void 0)});var l=function(i){e=!0,t=i.pageX,a=$(".frame-left").width(),n.addClass("active")},r=function(l){if(!e)return!0;var r=l.pageX-t,c=a+r;i>c&&(c=i),c>$(document).width()-200&&(c=$(document).width()-200),s.css("width",c),n.css("left",c-5),o.css("left",c+1),ui.setStyle()},c=function(){return e?(e=!1,n.removeClass("active"),Global.frameLeftWidth=$(".frame-left").width(),void 0):!1}},_bindHotKey=function(){var e=91;Global.ctrlKey=!1,$(document).keydown(function(t){if("none"!=$("#PicasaView").css("display"))return!0;if(ui.isEdit())return!0;if(rightMenu.isDisplay())return!0;var a=!1;if(Global.ctrlKey||t.keyCode==e||t.ctrlKey)switch(a=!0,Global.ctrlKey=!0,t.keyCode){case 8:ui.path.remove(),a=!0;break;case 65:fileSelect.selectPos("all");break;case 8:ui.path.next(),a=!0;break;case 67:ui.path.copy();break;case 88:ui.path.cute();break;case 83:break;case 86:ui.path.past();break;case 70:core.search($(".header-right input").val(),G.this_path);break;default:a=!1}else if(t.shiftKey)Global.shiftKey=!0;else switch(t.keyCode){case 8:ui.path.back(),a=!0;break;case 35:fileSelect.selectPos("end");break;case 36:fileSelect.selectPos("home");break;case 37:fileSelect.selectPos("left"),a=!0;break;case 38:fileSelect.selectPos("up");break;case 39:fileSelect.selectPos("right"),a=!0;break;case 40:fileSelect.selectPos("down");break;case 13:ui.path.open(),a=!1;break;case 46:ui.path.remove();break;case 113:ui.path.rname();break;default:a=!1}return a&&(stopPP(t),t.keyCode=0,t.returnValue=!1),!0}).keyup(function(t){t.shiftKey||(Global.shiftKey=!1),t.keyCode!=e&&t.ctrlKey||(Global.ctrlKey=!1)})},_menuActionBind=function(){$(".drop-menu-action li").bind("click",function(){if(!$(this).hasClass("disabled")){var e=$(this).attr("id");switch(e){case"open":ui.path.open();break;case"copy":ui.path.copy();break;case"rname":ui.path.rname();break;case"cute":ui.path.cute();break;case"past":ui.path.past();break;case"remove":ui.path.remove();break;case"zip":ui.path.zip();break;case"download":ui.path.download();break;case"info":ui.path.info();break;default:}}})};this._getFolderBox=function(e){var t="";return t+="<div class='file folderBox menufolder' data-name='"+e.name+"' title='"+LNG.name+":"+e.name+"&#10;"+LNG.modify_time+":"+e.mtime+"'>",t+="<div class='folder ico' filetype='folder'></div>",t+="<div id='"+e.name+"' class='titleBox'><span class='title' title='"+LNG.double_click_rename+"'>"+e.name+"</span></div></div>"},this._getFileBox=function(e){var t="";if("oexe"==e.ext&&void 0!=e.icon){var a=e.icon;-1==e.icon.search(G.static_path)&&"http"!=e.icon.substring(0,4)&&(a=G.static_path+"images/app/"+e.icon);var i=urlEncode(json_encode(e)),s=e.name.replace(".oexe","");t="<div class='file fileApp menuApp' data-app="+i+" data-name='"+e.name+"' title='"+LNG.name+":"+e.name+"&#10;"+LNG.size+":"+e.size_friendly+"&#10;"+LNG.modify_time+":"+e.mtime+"'>",t+="<div class='ico' filetype='oexe' style='background-image:url("+a+")'></div>",t+="<div id='' class='titleBox'><span class='title' title='"+LNG.double_click_rename+"'>"+s+"</span></div></div>"}else if(inArray(core.filetype.image,e.ext)){var n=core.path2url(G.this_path+e.name),o="index.php?explorer/image&path="+urlEncode(G.this_path+e.name);t+="<div class='file fileBox menufile' data-name='"+e.name+"' title='"+LNG.name+":"+e.name+"&#10;"+LNG.size+":"+e.size_friendly+"&#10;"+LNG.modify_time+":"+e.mtime+"'>",t+="<div picasa='"+n+"' thumb='"+o+"' class='picasaImage picture ico' filetype='"+e.ext+"'><img data-original='"+o+"'/></div>",t+="<div id='"+e.name+"' class='titleBox'><span class='title' title='"+LNG.double_click_rename+"'>"+e.name+"</span></div></div>"}else t+="<div class='file fileBox menufile' data-name='"+e.name+"' title='"+LNG.name+":"+e.name+"&#10;"+LNG.size+":"+e.size_friendly+"&#10;"+LNG.modify_time+":"+e.mtime+"'>",t+="<div class='"+e.ext+" ico' filetype='"+e.ext+"'></div>",t+="<div id='"+e.name+"' class='titleBox'><span class='title' title='"+LNG.double_click_rename+"'>"+e.name+"</span></div></div>";return t},this._getFolderBoxList=function(e){var t="";return t+="<div class='file folderBox menufolder' data-name='"+e.name+"' title='"+LNG.name+":"+e.name+"&#10;"+LNG.modify_time+":"+e.mtime+"'>",t+="	<div class='folder ico' filetype='folder'></div>",t+="	<div id='"+e.name+"' class='titleBox'><span class='title' title='"+LNG.double_click_rename+"'>"+e.name+"</span></div>",t+="	<div class='filetype'>"+LNG.folder+"</div>",t+="	<div class='filesize'></div>",t+="	<div class='filetime'>"+e.mtime+"</div>",t+="	<div style='clear:both'></div>",t+="</div>"},this._getFileBoxList=function(e){var t="";if("oexe"==e.ext){var a=urlEncode(json_encode(e));t="<div class='file fileApp menuApp' data-app='"+a+"' data-name='"+e.name+"' title='"+LNG.name+":"+e.name+"&#10;"+LNG.size+":"+e.size_friendly+"&#10;"+LNG.modify_time+":"+e.mtime+"'>"}else if(inArray(core.filetype.image,e.ext)){var i=core.path2url(G.this_path+e.name),s="index.php?explorer/image&path="+urlEncode(G.this_path+e.name);t+="<div picasa='"+i+"' thumb='"+s+"' class='picasaImage file fileBox menufile' data-name='"+e.name+"' title='"+LNG.name+":"+e.name+"&#10;"+LNG.size+":"+e.size_friendly+"&#10;"+LNG.modify_time+":"+e.mtime+"'>"}else t+="<div class='file fileBox menufile' data-name='"+e.name+"' title='"+LNG.name+":"+e.name+"&#10;"+LNG.size+":"+e.size_friendly+"&#10;"+LNG.modify_time+":"+e.mtime+"'>";return t+="	<div class='"+e.ext+" ico' filetype='"+e.ext+"'></div>",t+="	<div id='"+e.name+"' class='titleBox'><span class='title' title='"+LNG.double_click_rename+"'>"+e.name+"</span></div>",t+="	<div class='filetype'>"+e.ext+"  "+LNG.file+"</div>",t+="	<div class='filesize'>"+e.size_friendly+"</div>",t+="	<div class='filetime'>"+e.mtime+"</div>",t+="	<div style='clear:both'></div>",t+="</div>"};var _mainSetData=function(e){var t="",a=G.json_data.folderlist,i=G.json_data.filelist;a="size"==G.sort_field||"ext"==G.sort_field?a.sort(_sortBy("name",G.sort_order)):a.sort(_sortBy(G.sort_field,G.sort_order)),i=i.sort(_sortBy(G.sort_field,G.sort_order)),G.json_data.folderlist=a,G.json_data.filelist=i;var s="_getFileBox",n="_getFolderBox",o="",l="";"list"==G.list_type&&(s="_getFileBoxList",n="_getFolderBoxList");for(var r in i)o+=this[s](i[r]);for(var r in a)l+=this[n](a[r]);t="up"==G.sort_order?l+o:o+l,""==t&&(t='<div style="text-align:center;color:#aaa;">'+LNG.path_null+"</div>"),t+="<div style='clear:both'></div>",e?$(Config.FileBoxSelector).hide().html(t).fadeIn(Config.AnimateTime):$(Config.FileBoxSelector).html(t),"list"==G.list_type&&$(Config.FileBoxSelector+" .file:nth-child(2n)").addClass("file2"),_ajaxLive()},_f5=function(e,t,a){if(void 0==e&&(e=!0),void 0==t&&(t=!1),_jsonSortTitle(),e)$.ajax({url:"index.php?explorer/pathList&path="+urlEncode(G.this_path),dataType:"json",beforeSend:function(){$(".tools-left .msg").stop(!0,!0).fadeIn(100)},success:function(e){return $(".tools-left .msg").fadeOut(100),e.code?(G.json_data=e.data,Global.historyStatus=G.json_data.history_status,_mainSetData(t),ui.header.updateHistoryStatus(),ui.header.addressSet(),"function"==typeof a&&a(e),void 0):(core.tips.tips(e),$(Config.FileBoxSelector).html(""),!1)},error:function(e,t,a){$(".tools-left .msg").fadeOut(100),$(Config.FileBoxSelector).html(""),core.ajaxError(e,t,a)}});else{var i=fileLight.getAllName();_mainSetData(t),ui.path.setSelectByFilename(i)}},_f5_callback=function(e){_f5(!0,!1,e)},_toolsAction=function(e){switch(e){case"newfile":ui.path.newFile();break;case"newfolder":ui.path.newFolder();break;case"upload":core.upload();break;case"set_icon":$("#set_icon").hasClass("active")||_setListType("icon");break;case"set_list":$("#set_list").hasClass("active")||_setListType("list");break;default:}};return{f5:_f5,f5_callback:_f5_callback,picasa:MyPicasa,setListSort:_setListSort,setListType:_setListType,setTheme:function(e){core.setSkin(e,"app_explorer.css"),FrameCall.top("OpenopenEditor","Editor.setTheme",'"'+e+'"'),FrameCall.top("Opensetting_mode","Setting.setThemeSelf",'"'+e+'"'),FrameCall.father("ui.setTheme",'"'+e+'"')},isEdit:function(){var e=$(document.activeElement).get(0).tagName;return"INPUT"==e||"TEXTAREA"==e?!0:!1},init:function(){_f5_callback(function(){_setListType(G.list_type,!0)}),_bindEventSort(),_bindEventTheme(),_bindEventTools(),_bindHotKey(),_bindFrameSizeEvent(),_menuActionBind(),ui.header.bindEvent(),$(window).bind("resize",function(){ui.setStyle(),ui.header.set_width(),0!=PicasaOpen&&MyPicasa.setFrameResize()}),$("html").bind("click",function(){rightMenu.hidden(),Global.isIE&&Global.isDragSelect}),Mousetrap.bind(["ctrl+s","command+s"],function(e){e.preventDefault(),FrameCall.top("OpenopenEditor","Editor.save","")}),Mousetrap.bind(["1","2","3","4","5","6","7","8","9","0","`","~","!","@","#","$","%","^","&","*","(",")","-","_","=","+","[","{","]","}","|","/","?",".",">",",","<","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],function(e){var t=String.fromCharCode(e.charCode);ui.path.setSelectByChar(t)}),Mousetrap.bind(["alt+n","alt+n"],function(e){stopPP(e),ui.path.newFile()}),Mousetrap.bind(["alt+m","alt+m"],function(e){stopPP(e),ui.path.newFolder()}),PicasaOpen=!1,MyPicasa.init(".picasaImage"),MyPicasa.initData()},setStyle:function(){Global.fileRowNum="list"==G.list_type?1:function(){var e=$(Config.FileBoxSelector).width(),t=parseInt($(Config.FileBoxClass).css("width"))+parseInt($(Config.FileBoxClass).css("border-left-width"))+parseInt($(Config.FileBoxClass).css("border-right-width"))+parseInt($(Config.FileBoxClass).css("margin-right"));return parseInt(e/t)}()},header:{bindEvent:function(){$("#yarnball li a").die("click").live("click",function(e){var t=$(this).attr("title");$("input.path").val(t),ui.header.gotoPath(),stopPP(e)}),$("#yarnball").die("click").live("click",function(){return $("#yarnball").css("display","none"),$("#yarnball_input").css("display","block"),$("#yarnball_input input").focus(),!0}),$("#yarnball_input input").die("blur").live("blur",function(){ui.header.gotoPath()}),$("#yarnball_input input").keyEnter(function(){ui.header.gotoPath()}),$(".header-right input").keyEnter(function(){core.search($(".header-right input").val(),G.this_path)}),$(".header-content a,.header-content button").click(function(){var e=$(this).attr("id");switch(e){case"history_back":$("#history_back").hasClass("active")||ui.path.back("");break;case"history_next":$("#history_next").hasClass("active")||ui.path.next("");break;case"refresh":ui.f5(!0,!0),ui.tree.init();break;case"home":ui.path.list(G.myhome);break;case"fav":ui.path.pathOperate.fav(G.this_path);break;case"up":ui.header.gotoFather();break;case"setting":core.setting();break;case"search":core.search($(".header-right input").val(),G.this_path);break;default:}return!0})},addressSet:function(){var e=G.this_path;e.substring(0,G.public_path.length)==G.public_path&&(e=e.replace(G.public_path,"*public*/")),$("input.path").val(e),$("#yarnball_input").css("display","none"),$("#yarnball").css("display","block");var t=function(e){var t='<li class="yarnlet first"><a title="@1@" style="z-index:{$2};"><span class="left-yarn"></span>{$3}</a></li>\n',a='<li class="yarnlet "><a title="@1@" style="z-index:{$2};">{$3}</a></li>\n';e=e.replace(/\/+/g,"/");var i=e.split("/");""==i[i.length-1]&&i.pop();var s=i[0]+"/",n=t.replace(/@1@/g,s);n=n.replace("{$2}",i.length),n=n.replace("{$3}",i[0]);for(var o=n,l=1,r=i.length-1;i.length>l;l++,r--)s+=i[l]+"/",n=a.replace(/@1@/g,s),n=n.replace("{$2}",r),n=n.replace("{$3}",i[l]),o+=n;return'<ul class="yarnball">'+o+"</ul>"};$("#yarnball").html(t(e)),ui.header.set_width()},set_width:function(){$(".yarnball").stop(!0,!0);var e=$("#yarnball").innerWidth(),t=0;$("#yarnball li a").each(function(){t+=$(this).outerWidth()+parseInt($(this).css("margin-left"))+5});var a=e-t;0>=a?$(".yarnball").css("width",t+"px").css("left",a+"px"):$(".yarnball").css({left:"3px",width:e+"px"})},gotoPath:function(){var e=$("input.path").val();e=e.replace(/\\/g,"/"),$("input.path").val(e),"/"!=e.substr(e.length-1,1)&&(e+="/");var t="*public*/";e.substring(0,t.length)==t&&(e=e.replace(t,G.public_path)),ui.path.list(e),ui.header.addressSet()},updateHistoryStatus:function(){0==Global.historyStatus.back?$("#history_back").addClass("active"):$("#history_back").removeClass("active"),0==Global.historyStatus.next?$("#history_next").addClass("active"):$("#history_next").removeClass("active")},gotoFather:function(){var e=$("input.path").val(),t=e.length-1,a="",i=e.split("/").length-1;if(1==i)a=e;else{"/"==e.substr(t,1)&&(t-=1);for(var s=t;s>0&&"/"!=e.substr(t,1);s--)t--;a=e.substr(0,t+1)}$("input.path").val(a),ui.header.gotoPath()}}}}),define("app/src/explorer/fileSelect",[],function(){var e=!1,t=!1,a=function(){s(),i(),n()},i=function(){$(Config.FileBoxClass).die("touchstart").live("touchstart",function(){$(this).hasClass("select")?ui.path.open():(c.clear(),$(this).removeClass("select"),$(this).addClass("select"),c.select())}),$(Config.FileBoxClass).live("mouseenter",function(){t&&$(this).hasClass(Config.TypeFolderClass)&&!$(this).hasClass(Config.SelectClassName)&&$(this).addClass("selectDragTemp"),e||t||$(this).addClass(Config.HoverClassName),$(this).unbind("mouseup").mouseup(function(e){3!=e.which||$(this).hasClass(Config.SelectClassName)||(c.clear(),$(this).addClass(Config.SelectClassName),c.select())}).unbind("mousedown").mousedown(function(e){if(rightMenu.hidden(),1!=e.which)return!0;if(e.ctrlKey||e.shiftKey||$(this).hasClass(Config.SelectClassName)||(c.clear(),$(this).addClass(Config.SelectClassName),c.select()),e.ctrlKey)$(this).hasClass(Config.SelectClassName)?(c.resumeMenu($(this)),$(this).removeClass(Config.SelectClassName)):(c.setMenu($(this)),$(this).addClass(Config.SelectClassName)),c.select();else if(e.shiftKey){var t=parseInt($(this).attr(Config.FileOrderAttr));if(0==Global.fileListSelectNum)r(0,t);else{var a=parseInt(Global.fileListSelect.first().attr(Config.FileOrderAttr)),i=parseInt(Global.fileListSelect.last().attr(Config.FileOrderAttr));a>t?r(t,a):t>i?r(i,t):t>a&&i>t&&r(a,t)}}})}).die("mouseleave").live("mouseleave",function(){$(this).removeClass(Config.HoverClassName),$(this).removeClass("selectDragTemp")}).die("click").live("click",function(e){stopPP(e),e.ctrlKey||e.shiftKey||!$(this).hasClass(Config.SelectClassName)||(c.clear(),$(this).removeClass(Config.SelectClassName),$(this).addClass(Config.SelectClassName),c.select())}),$(Config.FileBoxClass).die("dblclick").live("dblclick",function(e){stopPP(e),e.altKey?ui.path.info():ui.path.open()}),$(Config.FileBoxTittleClass).die("dblclick").live("dblclick",function(e){return ui.path.rname(),stopPP(e),!1})},s=function(){var a,i,s,n=300,o=50,l=80-Global.topbar_height,r=0,d=!1,p=0,u=0;$(Config.FileBoxClass).die("mousedown").live("mousedown",function(t){if(!Global.shiftKey&&!Global.ctrlKey){if(ui.isEdit())return!0;if(1!=t.which||e)return!0;a=$(this),f(t),this.setCapture&&this.setCapture(),$(document).mousemove(function(e){h(e)}),$(document).one("mouseup",function(e){return m(e),this.releaseCapture&&this.releaseCapture(),stopPP(e),!1})}});var f=function(e){rightMenu.hidden(),t=!0,r=$.now(),p=e.pageY,u=e.pageX,i=$(document).height(),s=$(document).width()},h=function(e){if(!t)return!0;$.now()-r>n&&!d&&v();var a=e.clientX>=s-50?s-50:e.clientX,c=e.clientY>=i-50?i-50:e.clientY;a=0>=a?0:a,c=0>=c?0:c,a-=o,c-=l,$(".draggable-dragging").css("left",a),$(".draggable-dragging").css("top",c),Global.isIE&&$("."+Config.TypeFolderClass).each(function(){var t=e.pageX,a=e.pageY,i=$(this).offset(),s=$(this).width(),n=$(this).height();t>i.left&&i.left+s>t&&a>i.top&&i.top+n>a?$(this).addClass("selectDragTemp"):$(this).removeClass("selectDragTemp")})},m=function(){if(!t)return!1;if(t=!1,d=!1,$("body").css("cursor","auto"),$(".draggable-dragging").fadeOut(200,function(){$(this).remove()}),0!=$(".selectDragTemp").length){var e=G.this_path+c.name($(".selectDragTemp"))+"/";ui.path.cuteDrag(e)}},v=function(){d=!0,$("body").css("cursor","move"),a.find(".ico").attr("filetype"),$('<div class="file draggable-dragging"><div class="drag_number">'+Global.fileListSelectNum+"</div>"+'<div class="ico" style="background:'+a.find(".ico").css("background")+'"></div>'+"</div>").appendTo("body")}},n=function(){var a=null,i=null,s=null,n=85+Global.topbar_height,o=0,l=0;$(Config.BodyContent).die("mousedown").live("mousedown",function(e){if(!($(e.target).hasClass("bodymain")&&20>$(document).width()-e.pageX)){if(ui.isEdit())return!0;if(1!=e.which||t)return!0;r(e),this.setCapture&&this.setCapture(),$(document).unbind("mousemove").mousemove(function(e){d(e)}),$(document).one("mouseup",function(e){p(e),Global.isDragSelect=!0,this.releaseCapture&&this.releaseCapture()})}});var r=function(t){o=$(Config.BodyContent).scrollTop(),l=n-o,$(t.target).parent().hasClass(Config.FileBoxClassName)||$(t.target).parent().parent().hasClass(Config.FileBoxClassName)||$(t.target).hasClass("fix")||(rightMenu.hidden(),t.ctrlKey||t.shiftKey||c.clear(),0==$(t.target).hasClass("ico")&&(0==$("#selContainer").length&&($('<div id="selContainer"></div>').appendTo(Config.FileBoxSelector),s=$("#selContainer")),a=t.pageX-Global.frameLeftWidth,i=t.pageY+$(Config.BodyContent).scrollTop()-n,e=!0))},d=function(t){if(!e)return!0;"none"==s.css("display")&&s.css("display","");var n=$(Config.BodyContent).scrollTop()-o,r=t.pageX-Global.frameLeftWidth,d=t.pageY-l+n;s.css({left:Math.min(r,a),top:Math.min(d,i),width:Math.abs(r-a),height:Math.abs(d-i)});for(var p=s.offset().left-Global.frameLeftWidth,u=s.offset().top-l+n,f=s.width(),h=s.height()+Math.abs(n),m=Global.fileListNum,v=0;m>v;v++){var g=Global.fileListAll[v],_=$(Global.fileListAll[v]),b=g.offsetWidth+g.offsetLeft,y=g.offsetHeight+g.offsetTop;if(b>p&&y>u&&p+f>g.offsetLeft&&u+h>g.offsetTop){if(!_.hasClass("selectDragTemp")){if(_.hasClass("selectToggleClass"))continue;if(_.hasClass(Config.SelectClassName)){_.removeClass(Config.SelectClassName).addClass("selectToggleClass"),c.resumeMenu(_);continue}_.addClass("selectDragTemp")}}else _.removeClass("selectDragTemp"),_.hasClass("selectToggleClass")&&_.addClass(Config.SelectClassName).removeClass("selectToggleClass")}},p=function(){return e?(s.css("display","none"),$(".selectDragTemp").addClass(Config.SelectClassName).removeClass("selectDragTemp"),$(".selectToggleClass").removeClass("selectToggleClass"),c.select(),e=!1,a=null,i=null,void 0):!1}},o=function(e){var t=0,a=Global.fileListSelect;Global.fileListSelectNum;var i=Global.fileListNum,s=function(){if(1==Global.fileListSelectNum){var s=parseInt(a.attr(Config.FileOrderAttr));switch(e){case"up":case"left":t=0>=s?s:s-1;break;case"down":case"right":t=s>=i-1?s:s+1;break;default:}}else if(Global.fileListSelectNum>1){var n=parseInt(a.first().attr(Config.FileOrderAttr)),o=parseInt(a.last().attr(Config.FileOrderAttr));switch(e){case"up":case"left":t=0>=n?n:n-1;break;case"down":case"right":t=o>=i?o:o+1;break;default:}}},n=function(){var s=Global.fileRowNum;if(1==Global.fileListSelectNum){var n=parseInt(a.attr(Config.FileOrderAttr));switch(e){case"up":t=s>n?0:n-s;break;case"left":t=0>=n?n:n-1;break;case"down":t=n+s>=i-1?i-1:n+s;break;case"right":t=n>=i-1?n:n+1;break;default:}}else if(Global.fileListSelectNum>1){var o=parseInt(a.first().attr(Config.FileOrderAttr)),l=parseInt(a.last().attr(Config.FileOrderAttr));switch(e){case"up":t=s>=o?o:o-s;break;case"left":t=0>=o?o:o-1;break;case"down":t=l+s>=i?l:l+s;break;case"right":t=l>=i?l:l+1;break;default:}}};return"list"==G.list_type?s():n(),Global.fileListAll.eq(t)},l=function(e){var t;switch(e){case"home":t=Global.fileListAll.first();break;case"end":t=Global.fileListAll.last();break;case"left":case"up":case"right":case"down":t=o(e);break;case"all":t=Global.fileListAll;break;default:}c.clear(),t.addClass(Config.SelectClassName),c.select()},r=function(e,t){c.clear();for(var a=e;t>=a;a++)$(Global.fileListAll[a]).addClass(Config.SelectClassName);c.select()},c={init:function(){var e=$(Config.FileBoxClass);e.each(function(e){$(this).attr(Config.FileOrderAttr,e)}),Global.fileListSelect="",Global.fileListAll=e,Global.fileListNum=e.length,Global.fileListSelectNum=0,c.menuAction("clear")},select:function(){var e=$(Config.SelectClass);Global.fileListSelect=e,Global.fileListSelectNum=e.length,e.length>1&&c.setMenu(e),c.menuAction("menufile")},name:function(e){return e.attr("data-name")},type:function(e){return e.find(".ico").attr("filetype")},setMenu:function(e){e.removeClass("menufile menufolder menuApp").addClass("menuMore"),c.menuAction()},resumeMenu:function(e){var t={fileApp:"menuApp",fileBox:"menufile",folderBox:"menufolder"};for(var a in t)e.hasClass(a)&&e.removeClass("menuMore").addClass(t[a]);c.menuAction()},getAllName:function(){var e=[];if(0!=Global.fileListSelectNum){var t=Global.fileListSelect;return t.each(function(t){e[t]=c.name($(this))}),e}},clear:function(){if(0!=Global.fileListSelectNum){var e=Global.fileListSelect;e.removeClass(Config.SelectClassName),e.each(function(){c.resumeMenu($(this))}),Global.fileListSelect="",Global.fileListSelectNum=0,c.menuAction()}},menuAction:function(){0==Global.fileListSelectNum?($(".drop-menu-action li").addClass("disabled"),$(".drop-menu-action #past").removeClass("disabled"),$(".drop-menu-action #info").removeClass("disabled")):Global.fileListSelectNum>1?($(".drop-menu-action li").removeClass("disabled"),$(".drop-menu-action #open").addClass("disabled"),$(".drop-menu-action #rname").addClass("disabled"),$(".drop-menu-action #past").addClass("disabled")):($(".drop-menu-action li").removeClass("disabled"),$(".drop-menu-action #past").addClass("disabled"))}};return{init:a,selectPos:l,fileLight:c}}),define("app/common/taskTap",[],function(){var e={},t="",a=160,i=function(){$(".task_tab .tab").die("mouseenter").live("mouseenter",function(){$(this).hasClass("this")||$(this).addClass("hover")}).die("click").live("click",function(){var e=$(this).attr("id"),t=art.dialog.list[e],a=$("."+e);"hidden"!=a.css("visibility")?t.display(!1):t.display(!0)}).die("mouseleave").live("mouseleave",function(){$(this).removeClass("hover")}).die("dblclick").live("dblclick",function(){})},s=function(){var e,t,i,s,n=!1,o=!1,l=0,r=0,c=0,d=0,p=0,u=0;$(".task_tab .tab").die("mousedown").live("mousedown",function(){e=$(this),n=!0,this.setCapture&&this.setCapture(),$(document).mousemove(function(e){h(e)}),$(document).one("mouseup",function(e){return v(e),this.releaseCapture&&this.releaseCapture(),stopPP(e),!1})});var f=function(a){o=!0,l=a.pageX,$tab_parent=$(".task_tab"),t=$(".task_tab .tab"),$(".tasktab-dragging").remove(),i=e.clone().addClass("tasktab-dragging").prependTo("body"),d=parseInt(t.css("margin-right")),p=$tab_parent.width(),u=$tab_parent.get(0).getBoundingClientRect().left,u+=$(window).scrollLeft(),r=e.get(0).getBoundingClientRect().left,c=parseInt(t.css("width"));var s=e.get(0).getBoundingClientRect().top-parseInt(e.css("margin-top")),n=a.clientX-l+r;$("body").prepend("<div class='dragMaskView'></div>"),i.css({width:c+"px",top:s,left:n}),e.css("opacity",0)},h=function(a){if(n){0==o&&f(a);var s=a.clientX-l+r;u>s||s>u+p-c||(i.css("left",s),t.each(function(){var t=$(this).get(0).getBoundingClientRect().left;if(s>t&&t+c/2+d>s){if(e.attr("id")==$(this).attr("id"))return;m($(this).attr("id"),"left")}if(s>t-c/2+d&&t>s){if(e.attr("id")==$(this).attr("id"))return;m($(this).attr("id"),"right")}}))}},m=function(i,n){if(!e.is(":animated")||s!=i){s=i,e.stop(!0,!0),$(".insertTemp").remove(),t=$(".task_tab .tab");var o=e.width(),l=$(".task_tab #"+i),r=e.clone(!0).insertAfter(e).css({"margin-right":"0px",border:"none"}).addClass("insertTemp");"left"==n?e.after(l).css("width","0px"):(e.before(l).css("width","0px"),l.before(r)),e.animate({width:o+"px"},a),r.animate({width:"0px"},a,function(){$(this).remove(),t=$(".task_tab .tab")})}},v=function(){n=!1,o=!1,startTime=0,$(".dragMaskView").remove(),void 0!=i&&(r=e.get(0).getBoundingClientRect().left,i.animate({left:r+"px"},a,function(){e.css("opacity",1),$(this).remove()}))}},n=function(e){var t=110,i=t,s=t+12,n=$(".task_tab .tab"),o=$(".task_tab .tabs").width()-50,l=n.length,r=Math.floor(o/s);switch(l>r&&(i=Math.floor(o/l)-12),e){case"add":$(".task_tab .tabs .this").css("width","0").animate({width:i+"px"},a);case"close":n.animate({width:i+"px"},a);break;case"resize":n.css("width",i+"px");break;default:}},o=function(t,a){$(".task_tab").removeClass("hidden");var i='<div class="tab taskBarMenu" id="'+t+'">'+a+"</div>";$(i).insertBefore(".task_tab .last"),n("add"),e[t]={id:t,name:name}},l=function(e){$(".task_tab .this").removeClass("this"),$(".task_tab #"+e).addClass("this"),t=e},r=function(t){delete e[t],$(".task_tab #"+t).animate({width:0},a,function(){$(".task_tab #"+t).remove(),n("close"),0==$(".tabs .tab").length&&$(".task_tab").addClass("hidden")})};return{add:o,focus:l,close:r,init:function(){var e='<div class="task_tab hidden"><div class="tabs"><div class="last" style="clear:both;"></div></div></div>';$(e).appendTo("body"),$(window).bind("resize",function(){n("resize")}),i(),s()}}}),define("app/common/core",["../tpl/search","../tpl/upload"],function(require,exports){return{filetype:{music:["mp3","wma","wav","mid","aac","ogg","oga","midi","ram","ac3","aif","aiff","m3a","m4a","m4b","mka","mp1","mx3","mp2"],movie:["avi","flv","f4v","wmv","3gp","rmvb","mp4","rm","rmvb","flv","mkv","wmv","asf","avi","aiff","mp4","divx","dv","m4v","mov","mpeg","vob","mpg","mpv","ogm","ogv","qt"],image:["jpg","jpeg","png","bmp","gif","ico","tif","tiff","dib","rle"],code:["html","htm","js","css","less","scss","sass","py","php","rb","erl","lua","pl","c","cpp","m","h","java","jsp","cs","asp","sql","as","go","lsp","yml","json","tpl","xml","cmd","reg","bat","vbs","sh"],doc:["doc","docx","docm","xls","xlsx","xlsb","xlsm","ppt","pptx","pptm"],text:["txt","ini","inc","inf","conf","oexe","md","htaccess","csv","log","asc","tsv"],bindary:["pdf","bin","zip","swf","gzip","rar","arj","tar","gz","cab","tbz","tbz2","lzh","uue","bz2","ace","exe","so","dll","chm","rtf","odp","odt","pages","class","psd","ttf"]},contextmenu:function(e){rightMenu.hidden();var t=e||window.event;return t&&($.nodeName(t.target,"TEXTAREA")||$.nodeName(t.target,"INPUT"))?!0:void 0},pathThis:function(e){e=e.replace(/\\/g,"/");var t=e.split("/"),a=t[t.length-1];return""==a&&(a=t[t.length-2]),a},pathFather:function(e){e=e.replace(/\\/g,"/");var t=e.lastIndexOf("/");return e.substr(0,t+1)},pathExt:function(e){e=e.replace(/\\/g,"/"),e=e.replace(/\/+/g,"/");var t=e.lastIndexOf(".");return e=e.substr(t+1),e.toLowerCase()},path2url:function(e){if("http"==e.substr(0,4))return e;if(e=e.replace(/\\/g,"/"),e=e.replace(/\/+/g,"/"),e=e.replace(/\/\.*\//g,"/"),e.substring(0,G.public_path.length)==G.public_path)return G.app_host+"data/public/"+e.replace(G.public_path,"");if(G.is_root){if(e.substring(0,G.web_root.length)==G.web_root)return G.web_host+e.replace(G.web_root,"");var t=G.basic_path.replace(G.web_root,"")+"/";return t=G.web_host+t,t+"index.php?explorer/fileProxy&path="+urlEncode(e)}return G.web_host+G.web_root+e},ajaxError:function(e){core.tips.close(LNG.system_error,!1);
var t='<div style="color:#f60;">'+e.responseText+"</div>",a=$.dialog.list.ajaxErrorDialog;a?a.content(t):$.dialog({id:"ajaxErrorDialog",fixed:!0,resize:!0,title:"ajax error",width:450,height:200,content:t})},setting:function(e){void 0==e&&(e=""),void 0==window.top.frames.Opensetting_mode?$.dialog.open("?setting#"+e,{id:"setting_mode",fixed:!0,resize:!0,title:LNG.setting,width:960,height:580}):($.dialog.list.setting_mode.display(!0),FrameCall.top("Opensetting_mode","Setting.setGoto",'"'+e+'"'))},appStore:function(){$.dialog.open("./index.php?app",{id:"app_store",fixed:!0,resize:!0,title:LNG.app_store,width:800,height:500})},openApp:function(app){if("url"==app.type)"number"!=typeof app.width&&-1==app.width.search("%")&&(app.width=parseInt(app.width)),"number"!=typeof app.height&&-1==app.height.search("%")&&(app.height=parseInt(app.height)),$.dialog.open(app.content,{title:app.name,fixed:!0,resize:app.resize,simple:app.simple,title:app.name.replace(".oexe",""),width:app.width,height:app.height});else{var exec=app.content;eval("{"+exec+"}")}},update:function(e){var t=base64_decode("aHR0cDovL3N0YXRpYy5rYWxjYWRkbGUuY29tL3VwZGF0ZS9tYWluLmpz");require.async(t,function(t){try{t.todo(e)}catch(a){}})},explorer:function(e){void 0==e&&(e=""),$.dialog.open("?/explorer&type=iframe&path="+e,{resize:!0,fixed:!0,title:LNG.ui_filemanage,width:880,height:550})},setSkin:function(e,t){var a="./../../../style/skin/"+e+t,i=G.static_path+"style/skin/"+e+t;require.async(a,function(){$("#link_css_list").attr("href",i),$("link[rel=stylesheet]").each(function(){var e=$(this).attr("href");e.substring(e.length-t.length)==t&&"link_css_list"!=$(this).attr("id")&&$(this).remove()})})},editorFull:function(){var e=$("iframe[name=OpenopenEditor]");e.toggleClass("frame_fullscreen")},language:function(e){Cookie.set("kod_user_language",e,8760),window.location.reload()},tips:{loading:function(e){Tips.loading(e,"info",Global.topbar_height)},close:function(e,t){"object"==typeof e?Tips.close(e.data,e.code,Global.topbar_height):Tips.close(e,t,Global.topbar_height)},tips:function(e,t){"object"==typeof e?Tips.tips(e.data,e.code,Global.topbar_height):Tips.tips(e,t,Global.topbar_height)}},createFlash:function(e,t,a){var i='<object type="application/x-shockwave-flash" id="'+a+'" data="'+e+'" width="100%" height="100%">'+'<param name="movie" value="'+e+'"/>'+'<param name="allowfullscreen" value="true" />'+'<param name="allowscriptaccess" value="always" />'+'<param name="flashvars" value="'+t+'" />'+'<param name="wmode" value="transparent" />'+"</object>";return i},search:function(e,t){var a,i,s=require("../tpl/search"),n=function(){var n=template.compile(s.html);0==$(".dialog_do_search").length?(l(),i={search:e,path:t,is_content:void 0,is_case:void 0,ext:"",LNG:LNG},a=$.dialog({id:"dialog_do_search",padding:0,fixed:!0,resize:!0,title:LNG.search,width:450,content:n(i)}),r(i),$("#search_ext").tooltip({placement:"bottom",html:!0}),$("#search_path").tooltip({placement:"bottom",html:!0,title:function(){return $("#search_path").val()}})):($("#search_value").val(e),$("#search_path").val(t),o(),$.dialog.list.dialog_do_search.display(!0))},o=function(){i={search:$("#search_value").val(),path:$("#search_path").val(),is_content:$("#search_is_content").attr("checked"),is_case:$("#search_is_case").attr("checked"),ext:$("#search_ext").val()},r(i)},l=function(){$("#search_value,#search_ext,#search_path").keyEnter(o),$(".search_header a.button").die("click").live("click",o),$(".search_result .list .name").die("click").live("click",function(){var e=$(this).find("a").html(),t=$(this).parent().find(".path a").html()+e;$(this).parent().hasClass("file")?ui.pathOpen.open(t):"explorer"==Config.pageApp?ui.path.list(t+"/","tips"):core.explorer(t+"/")}),$(".search_result .list .path a").die("click").live("click",function(){var e=$(this).html();"explorer"==Config.pageApp?ui.path.list(e,"tips"):core.explorer(e)})},r=function(e){var t=150;$("#search_value").focus(),$(".search_result .list").remove();var a=$(".search_result .message td");return e.search&&e.path?($.ajax({url:"index.php?explorer/search",dataType:"json",type:"POST",data:e,beforeSend:function(){a.hide().html(LNG.searching+'<img src="'+G.static_path+'images/loading.gif">').fadeIn(t)},error:core.ajaxError,success:function(e){if(!e.code)return a.hide().html(e.data).fadeIn(t),void 0;if(0==e.data.filelist.length&&0==e.data.folderlist.length)return a.hide().html(LNG.search_null).fadeIn(t),void 0;a.hide();var i=template.compile(s.list);e.data.LNG=LNG,$(i(e.data)).insertAfter(".search_result .message").fadeIn(t)}}),void 0):(a.hide().html(LNG.search_info).fadeIn(t),void 0)};n()},upload:function(){G.upload_path=G.this_path;var e=urlDecode(G.upload_path);uploader.option("server","index.php?explorer/fileUpload&path="+G.upload_path);var t=30>=e.length?e:"..."+e.substr(e.length-30);if(0!=$(".dialog_file_upload").length)return $(".file_upload .upload_path b").html(t),$.dialog.list.dialog_file_upload.display(!0),void 0;var a=require("../tpl/upload"),i=template.compile(a.html),s=WebUploader.Base.formatSize(G.upload_max);$.dialog({padding:5,height:430,resize:!0,id:"dialog_file_upload",fixed:!0,title:LNG.upload_muti,content:i({LNG:LNG,maxsize:s}),close:function(){$.each(uploader.getFiles(),function(e,t){uploader.skipFile(t),uploader.removeFile(t)})}}),$(".file_upload .tips").tooltip({placement:"bottom"}),$(".file_upload .upload_path").tooltip({placement:"bottom",title:function(){return G.upload_path}}),$(".file_upload .upload_path b").html(t),$(".file_upload .top_nav a.menu").unbind("click").bind("click",function(){$(this).hasClass("tab_upload")?($(".file_upload .tab_upload").addClass("this"),$(".file_upload .tab_download").removeClass("this"),$(".file_upload .upload_box").removeClass("hidden"),$(".file_upload .download_box").addClass("hidden")):($(".file_upload .tab_upload").removeClass("this"),$(".file_upload .tab_download").addClass("this"),$(".file_upload .upload_box").addClass("hidden"),$(".file_upload .download_box").removeClass("hidden"))}),$(".file_upload .download_box .submit input").unbind("click").bind("click",function(){core.server_dwonload(G.upload_path)}),uploader.addButton({id:"#picker"})},server_dwonload:function(e){var t=[];$(".list input").each(function(){""!=$(this).val()&&t.push($(this).val())}),core.tips.tips(t.length+LNG.server_dwonload_desc);for(var a=0;t.length>a;a++)$.ajax({url:"?explorer/serverDownload&save_path="+e+"&url="+urlEncode2(t[a]),dataType:"json",error:core.ajaxError,success:function(e){e.code&&FrameCall.father("ui.f5",""),core.tips.tips(e)}})},upload_init:function(){var e="#thelist",t="span.state";uploader=WebUploader.create({swf:G.static_path+"js/lib/webuploader/Uploader.swf",dnd:"body",threads:3,fileSizeLimit:G.upload_max,resize:!1});var a=[];uploader.on("uploadBeforeSend",function(e,t){var a=urlEncode(e.file.fullPath);(void 0==a||"undefined"==a)&&(a=""),t.fullPath=a}).on("fileQueued",function(t){var i,s=$(e),i=t.fullPath;(void 0==i||"undefined"==i)&&(i=t.name),$(e).find(".item").length>0&&(s=$(e).find(".item:eq(0)"));var n='<div id="'+t.id+'" class="item">'+'<div class="info"><span class="title" tytle="'+i+'">'+i+'</span><span class="state">'+LNG.upload_ready+'</span><div style="clear:both"></div></div></div>';$(e).find(".item").length>0?$(n).insertBefore($(e).find(".item:eq(0)")):$(e).append(n),a.push(t.name),uploader.upload()}).on("uploadProgress",function(e,a){var i=$("#"+e.id),s=i.find(".progress .progress-bar");s.length||(s=$('<div class="progress progress-striped active"><div class="progress-bar" role="progressbar" style="width: 0%"></div></div>').appendTo(i).find(".progress-bar")),i.find(t).text((100*a).toFixed(2)+"%"),s.css("width",100*a+"%")}).on("uploadAccept",function(e,t){e.file.serverData=t}).on("uploadSuccess",function(e){var i=e.serverData;i.code?$("#"+e.id).find(t).text(i.data):$("#"+e.id).find(t).addClass("error").text(i.data),uploader.removeFile(e),$("#"+e.id).find(".progress").fadeOut();var s=a;ui.f5_callback(function(){ui.path.setSelectByFilename(s)})}).on("uploadError",function(e){$("#"+e.id).find(t).addClass("error").text(LNG.upload_error)}).on("uploadFinished",function(){$(e).find(".item").delay(2e3).each(function(e){$(this).delay(300*e).slideUp(600)}),a=[],"explorer"==Config.pageApp&&ui.tree.checkIfChange(G.this_path)}).on("error",function(){});var i;inState=!1,dragOver=function(){0==inState&&(inState=!0,MaskView.tips(LNG.upload_drag_tips)),i&&window.clearTimeout(i)},dragLeave=function(e){stopPP(e),i&&window.clearTimeout(i),i=window.setTimeout(function(){inState=!1,MaskView.close()},100)},dragDrop=function(e){e=e.originalEvent||e;var t=e.dataTransfer.getData("text/plain");t&&"http"==t.substring(0,4)?(ui.path.pathOperate.appAddURL(t),console.log(t)):core.upload(),stopPP(e),inState&&(inState=!1,MaskView.close())}}}}),define("app/tpl/search",[],function(){var e="<div class='do_search'>        <div class='search_header'>           <div class='s_br'>                <input type='text' id='search_value' value='{{search}}'/><a class='right button icon-search'></a>                <div style='float:right'>{{LNG.path}}:<input type='text' id='search_path' value='{{path}}'/></div>            </div>           <div class='s_br'>                <input type='checkbox' id='search_is_case' {{if is_case}}checked='true'{{/if}}/>                <label for='search_is_case'>{{LNG.search_uplow}}</label>                <input type='checkbox' id='search_is_content' {{if is_content}}checked='true'{{/if}}/>                <label for='search_is_content'>{{LNG.search_content}}</label>                <div style='float:right'>{{LNG.file_type}}:<input type='text' id='search_ext' value='{{ext}}' title='{{LNG.search_ext_tips}}'/></div>            </div>        </div>        <div class='search_result'>            <table border='0' cellspacing='0' cellpadding='0'>                <tr class='search_title'>                   <td class='name'>{{LNG.name}}</td>                   <td class='type'>{{LNG.type}}</td>                   <td class='size'>{{LNG.size}}</td>                   <td class='path'>{{LNG.path}}</td>                </tr>                <tr class='message'><td colspan='4'></td></tr>            </table>        </div>    </div>",t="{{each folderlist as v i}}        <tr class='list folder' data-path='{{v.path}}{{v.name}}' data-type='folder' data-size='0'>            <td class='name'><a href='javascript:void(0);' title='{{LNG.open}}{{v.name}}'>{{v.name}}</a></td>            <td class='type'>{{LNG.folder}}</td>            <td class='size'>0</td>            <td class='path'><a href='javascript:void(0);' title='{{LNG.goto}}{{v.path}}'>{{v.path}}</a></td>        </tr>    {{/each}}    {{each filelist as v i}}        <tr class='list file'            data-path='{{v.path}}{{v.name}}'             data-type='{{v.ext}}'             data-size='{{v.size}}'>            <td class='name'><a href='javascript:void(0);' title='{{LNG.open}}{{v.name}}'>{{v.name}}</a></td>            <td class='type'>{{v.ext}}</td>            <td class='size'>{{v.size_friendly}}</td>            <td class='path'><a href='javascript:void(0);' title='{{LNG.goto}}{{v.path}}'>{{v.path}}</a></td>        </tr>    {{/each}}";return{html:e,list:t}}),define("app/tpl/upload",[],function(){return{html:"<div class='file_upload'>            <div class='top_nav'>               <a href='javascript:void(0);' class='menu this tab_upload'>{{LNG.upload_local}}</a>               <a href='javascript:void(0);' class='menu tab_download''>{{LNG.download_from_server}}</a>               <a class='button' style='margin:-1px 0 0 10px;cursor: pointer;' href='javascript:core.upload()'>{{LNG.upload_path_current}}</a>               <div style='clear:both'></div>            </div>            <div class='upload_path'>{{LNG.save_path}}:<b></b></div>            <div class='upload_box'>                <div class='btns'><div id='picker'>{{LNG.upload_select}}</div>                <div tips class='tips' title='{{LNG.upload_size_info}}'>{{LNG.upload_max_size}}:{{maxsize}}</div>                <div style='clear:both'></div></div>                <div id='uploader' class='wu-example'>                    <div id='thelist' class='uploader-list'></div>                </div>            </div>            <div class='download_box hidden'>                <form id='form' method='post'>                    <div class='list'>{{LNG.download_address}}1: <input type='text' name='url1'/></div>                    <div class='list'>{{LNG.download_address}}2: <input type='text' name='url2'/></div>                    <div class='list'>{{LNG.download_address}}3: <input type='text' name='url3'/></div>                    <div class='list'>{{LNG.download_address}}4: <input type='text' name='url4'/></div>                    <div class='list'>{{LNG.download_address}}5: <input type='text' name='url5'/></div>                    <div class='submit'><input type='button' name='' value='{{LNG.button_submit}}' class=''/></div>                </form>            </div>        </div>"}}),define("app/common/rightMenu",[],function(){var e=".menufile",t=".menufolder",a=".menuMore",i=".menuApp",s=".menuTreeFav",n=".menuTreeRoot",o=".menuTreeFolder",l=".menuTreeFile",r=function(){$('<div id="rightMenu" class="hidden"></div>').appendTo("body"),$(".context-menu-list").die("click").live("click",function(e){return stopPP(e),!1}),p(),h(),m(),g(),y(),N(),x(),v(),j(),C(),L(),$(".set_set"+G.list_type).addClass("selected"),$(".set_sort_"+G.sort_field).addClass("selected"),$(".set_sort_"+G.sort_order).addClass("selected")},c=function(){$('<div id="rightMenu" class="hidden"></div>').appendTo("body"),$(".context-menu-list").die("click").live("click",function(e){return stopPP(e),!1}),f(),v(),u(),h(),m(),C(),j(),g(),L(),$(".set_sort_"+G.sort_field).addClass("selected"),$(".set_sort_"+G.sort_order).addClass("selected")},d=function(){$('<div id="rightMenu" class="hidden"></div>').appendTo("body"),$(".context-menu-list").die("click").live("click",function(e){return stopPP(e),!1}),y(),N(),v(),C(),j(),k(),w(),L()},p=function(){$.contextMenu({selector:Config.BodyContent,zIndex:9999,callback:function(e,t){_(e,t)},items:{refresh:{name:LNG.refresh,className:"refresh",icon:"refresh",accesskey:"e"},upload:{name:LNG.upload,className:"upload",icon:"upload",accesskey:"u"},past:{name:LNG.past,className:"past",icon:"paste",accesskey:"p"},copy_see:{name:LNG.clipboard,className:"copy_see",icon:"eye",accesskey:"b"},sep1:"--------",listIcon:{name:LNG.list_type,accesskey:"v",icon:"eye-open",items:{seticon:{name:LNG.list_icon,className:"seticon",icon:"th",accesskey:"i",className:"menu_seticon set_seticon"},setlist:{name:LNG.list_list,className:"setlist",icon:"list",accesskey:"l",className:"menu_seticon set_setlist"}}},sortBy:{name:LNG.order_type,accesskey:"o",icon:"sort",items:{set_sort_name:{name:LNG.name,className:"menu_set_sort set_sort_name"},set_sort_ext:{name:LNG.type,className:"menu_set_sort set_sort_ext"},set_sort_size:{name:LNG.size,className:"menu_set_sort set_sort_size"},set_sort_mtime:{name:LNG.modify_time,className:"menu_set_sort set_sort_mtime"},set_sort_up:{name:LNG.sort_up,className:"set_sort_up",icon:"sort-up",className:"menu_set_desc set_sort_up"},set_sort_down:{name:LNG.sort_down,className:"set_sort_down",icon:"sort-down",className:"menu_set_desc set_sort_down"}}},sep2:"--------",app_install:{name:LNG.app_store,className:"app_install",icon:"tasks",accesskey:"a"},app_create:{name:LNG.app_create,className:"app_create",icon:"puzzle-piece",accesskey:"k"},sep3:"--------",newfolder:{name:LNG.newfolder,className:"newfolder",icon:"folder-close-alt",accesskey:"n"},newfile:{name:LNG.newfile,className:"newfile",icon:"file-alt",accesskey:"j"},newfileOther:{name:LNG.newothers,items:{newfile_html:{name:"html "+LNG.file},newfile_php:{name:"php "+LNG.file},newfile_js:{name:"js "+LNG.file},newfile_css:{name:"css "+LNG.file}}},sep3:"--------",info:{name:LNG.info,className:"info",icon:"info",accesskey:"i"}}})},u=function(){$.contextMenu({selector:".menuDefault",zIndex:9999,items:{open:{name:LNG.open,className:"open",icon:"external-link",accesskey:"o"}},callback:function(e){switch(e){case"open":ui.path.open();break;default:}}})},f=function(){$.contextMenu({selector:Config.BodyContent,zIndex:9999,callback:function(e){_(e)},items:{refresh:{name:LNG.refresh,className:"refresh",icon:"refresh",accesskey:"e"},sortBy:{name:LNG.order_type,accesskey:"o",icon:"sort",items:{set_sort_name:{name:LNG.name,className:"menu_set_sort set_sort_name"},set_sort_ext:{name:LNG.type,className:"menu_set_sort set_sort_ext"},set_sort_size:{name:LNG.size,className:"menu_set_sort set_sort_size"},set_sort_mtime:{name:LNG.modify_time,className:"menu_set_sort set_sort_mtime"},set_sort_up:{name:LNG.sort_up,className:"set_sort_up",icon:"sort-up",className:"menu_set_desc set_sort_up"},set_sort_down:{name:LNG.sort_down,className:"set_sort_down",icon:"sort-down",className:"menu_set_desc set_sort_down"}}},sep1:"--------",upload:{name:LNG.upload,className:"upload",icon:"upload",accesskey:"u"},past:{name:LNG.past,className:"past",icon:"paste",accesskey:"p"},copy_see:{name:LNG.clipboard,className:"copy_see",icon:"eye",accesskey:"b"},sep2:"--------",app_install:{name:LNG.app_store,className:"app_install",icon:"tasks",accesskey:"a"},app_create:{name:LNG.app_create,className:"app_create",icon:"puzzle-piece",accesskey:"k"},sep3:"--------",newfolder:{name:LNG.newfolder,className:"newfolder",icon:"folder-close-alt",accesskey:"n"},newfile:{name:LNG.newfile,className:"newfile",icon:"file-alt",accesskey:"j"},newfileOther:{name:LNG.newothers,items:{newfile_html:{name:"html "+LNG.file},newfile_php:{name:"php "+LNG.file},newfile_js:{name:"js "+LNG.file},newfile_css:{name:"css "+LNG.file}}},sep3:"--------",full:{name:LNG.full_screen,className:"full",icon:"fullscreen",accesskey:"m"},setting_wall:{name:LNG.setting_wall,className:"setting_wall",icon:"picture",accesskey:"w"},setting:{name:LNG.setting,className:"setting",icon:"cogs",accesskey:"s"}}})},h=function(){$('<i class="'+t.substr(1)+'"></i>').appendTo("#rightMenu"),$.contextMenu({zIndex:9999,selector:t,className:t,callback:function(e){b(e)},items:{open:{name:LNG.open,className:"open",icon:"folder-open-alt",accesskey:"o"},open_ie:{name:LNG.open_ie,className:"open_ie",icon:"globe",accesskey:"b"},sep1:"--------",copy:{name:LNG.copy,className:"copy",icon:"copy",accesskey:"c"},cute:{name:LNG.cute,className:"cute",icon:"cut",accesskey:"k"},remove:{name:LNG.remove,className:"remove",icon:"trash",accesskey:"d"},rname:{name:LNG.rename,className:"rname",icon:"pencil",accesskey:"r"},sep2:"--------",search:{name:LNG.search_in_path,className:"search",icon:"search",accesskey:"s"},fav:{name:LNG.add_to_fav,className:"fav",icon:"star",accesskey:"f"},zip:{name:LNG.zip,className:"zip",icon:"folder-close",accesskey:"z"},sep3:"--------",info:{name:LNG.info,className:"info",icon:"info",accesskey:"i"}}})},m=function(){$('<i class="'+e.substr(1)+'"></i>').appendTo("#rightMenu"),$.contextMenu({zIndex:9999,selector:e,className:t,callback:function(e){b(e)},items:{open:{name:LNG.open,className:"open",icon:"external-link",accesskey:"o"},open_text:{name:LNG.edit,className:"open_text",icon:"edit",accesskey:"e"},open_ie:{name:LNG.open_ie,className:"open_ie",icon:"globe",accesskey:"b"},newfileOther:{name:LNG.open_with,accesskey:"h",items:{open_text:{name:LNG.edit,className:"open_text",icon:"edit"},open_kindedit:{name:LNG.others,className:"open_kindedit",icon:"edit"}}},sep1:"--------",copy:{name:LNG.copy,className:"copy",icon:"copy",accesskey:"c"},cute:{name:LNG.cute,className:"cute",icon:"cut",accesskey:"k"},remove:{name:LNG.remove,className:"remove",icon:"trash",accesskey:"d"},rname:{name:LNG.rename,className:"rname",icon:"pencil",accesskey:"r"},sep2:"--------",zip:{name:LNG.zip,className:"zip",icon:"folder-close",accesskey:"z"},unzip:{name:LNG.unzip,className:"unzip",icon:"folder-open-alt",accesskey:"u"},down:{name:LNG.download,className:"down",icon:"download",accesskey:"x"},sep3:"--------",info:{name:LNG.info,className:"info",icon:"info",accesskey:"i"}}})},v=function(){$('<i class="'+i.substr(1)+'"></i>').appendTo("#rightMenu"),$.contextMenu({zIndex:9999,selector:i,className:t,callback:function(e){"editor"==Config.pageApp?T(e):b(e)},items:{open:{name:LNG.open,className:"open",icon:"external-link",accesskey:"o"},app_edit:{name:LNG.app_edit,className:"app_edit",icon:"code",accesskey:"a"},sep1:"--------",copy:{name:LNG.copy,className:"copy",icon:"copy",accesskey:"c"},cute:{name:LNG.cute,className:"cute",icon:"cut",accesskey:"k"},remove:{name:LNG.remove,className:"remove",icon:"trash",accesskey:"d"},rname:{name:LNG.rename,className:"rname",icon:"pencil",accesskey:"r"},sep2:"--------",info:{name:LNG.info,className:"info",icon:"info",accesskey:"i"}}})},g=function(){$('<i class="'+a.substr(1)+'"></i>').appendTo("#rightMenu"),$.contextMenu({zIndex:9999,selector:a,className:t,callback:function(e){b(e)},items:{copy:{name:LNG.copy,className:"copy",icon:"copy",accesskey:"c"},cute:{name:LNG.cute,className:"cute",icon:"cut",accesskey:"k"},remove:{name:LNG.remove,className:"remove",icon:"trash",accesskey:"d"},sep1:"--------",playmedia:{name:LNG.add_to_play,className:"playmedia",icon:"music",accesskey:"p"},zip:{name:LNG.zip,className:"zip",icon:"folder-close",accesskey:"z"},sep2:"--------",info:{name:LNG.info,className:"info",icon:"info",accesskey:"i"}}})},_=function(e){switch(e){case"refresh":ui.f5(!0,!0);break;case"back":ui.path.back();case"next":ui.path.next();break;case"seticon":ui.setListType("icon");break;case"setlist":ui.setListType("list");break;case"set_sort_name":ui.setListSort("name",0);break;case"set_sort_ext":ui.setListSort("ext",0);break;case"set_sort_size":ui.setListSort("size",0);break;case"set_sort_mtime":ui.setListSort("mtime",0);break;case"set_sort_up":ui.setListSort(0,"up");break;case"set_sort_down":ui.setListSort(0,"down");break;case"upload":core.upload();break;case"past":ui.path.past();break;case"copy_see":ui.path.clipboard();break;case"newfolder":ui.path.newFolder();break;case"newfile":ui.path.newFile();break;case"newfile_html":ui.path.newFile("html");break;case"newfile_php":ui.path.newFile("php");break;case"newfile_js":ui.path.newFile("js");break;case"newfile_css":ui.path.newFile("css");break;case"newfile_oexe":ui.path.newFile("oexe");break;case"info":ui.path.info();break;case"open":ui.path.open();break;case"open_new":ui.path.open_new();break;case"app_install":ui.path.appList();break;case"app_create":ui.path.appEdit(!0);break;case"full":ui.fullScreen();break;case"setting":core.setting();break;case"setting_wall":core.setting("wall");break;default:}},b=function(e){switch(e){case"open":ui.path.open();break;case"down":ui.path.download();break;case"open_ie":ui.path.openIE();break;case"open_text":ui.path.openEditor();break;case"app_edit":ui.path.appEdit();case"open_kindedit":break;case"playmedia":ui.path.play();break;case"fav":ui.path.fav();break;case"search":ui.path.search();break;case"copy":ui.path.copy();break;case"cute":ui.path.cute();break;case"remove":ui.path.remove();break;case"rname":ui.path.rname();break;case"zip":ui.path.zip();break;case"unzip":ui.path.unZip();break;case"info":ui.path.info();break;default:}},y=function(){$('<i class="'+s.substr(1)+'"></i>').appendTo("#rightMenu"),$.contextMenu({zIndex:9999,selector:s,callback:function(e){T(e)},items:{fav_page:{name:LNG.manage_fav,className:"fav_page",icon:"star",accesskey:"r"},refresh_all:{name:LNG.refresh_tree,className:"refresh_all",icon:"refresh",accesskey:"e"},sep1:"--------",quit:{name:LNG.close_menu,className:"quit",icon:"remove",accesskey:"q"}}})},N=function(){$('<i class="'+n.substr(1)+'"></i>').appendTo("#rightMenu"),$.contextMenu({zIndex:9999,selector:n,callback:function(e){T(e)},items:{explorer:{name:LNG.manage_folder,className:"explorer",icon:"laptop",accesskey:"v"},refresh:{name:LNG.refresh_tree,className:"refresh",icon:"refresh",accesskey:"e"},newfolder:{name:LNG.newfolder,className:"newfolder",icon:"folder-close-alt",accesskey:"n"},newfile:{name:LNG.newfile,className:"newfile",icon:"file-alt",accesskey:"j"},fav:{name:LNG.add_to_fav,className:"fav",icon:"star",accesskey:"f"},search:{name:LNG.search_in_path,className:"search",icon:"search",accesskey:"s"},sep1:"--------",past:{name:LNG.past,className:"past",icon:"paste",accesskey:"p"},sep3:"--------",quit:{name:LNG.close_menu,className:"quit",icon:"remove",accesskey:"q"}}})},x=function(){$('<i class="'+o.substr(1)+'"></i>').appendTo("#rightMenu"),$.contextMenu({zIndex:9999,selector:o,callback:function(e){T(e)},items:{refresh:{name:LNG.refresh_tree,className:"refresh",icon:"refresh",accesskey:"e"},newfolder:{name:LNG.newfolder,className:"newfolder",icon:"folder-close-alt",accesskey:"n"},fav:{name:LNG.add_to_fav,className:"fav",icon:"star",accesskey:"f"},search:{name:LNG.search_in_path,className:"search",icon:"search",accesskey:"s"},sep1:"--------",copy:{name:LNG.copy,className:"copy",icon:"copy",accesskey:"c"},cute:{name:LNG.cute,className:"cute",icon:"cut",accesskey:"k"},past:{name:LNG.past,className:"past",icon:"paste",accesskey:"p"},rname:{name:LNG.rename,className:"rname",icon:"pencil",accesskey:"r"},sep2:"--------",remove:{name:LNG.remove,className:"remove",icon:"trash",accesskey:"d"},info:{name:LNG.info,className:"info",icon:"info",accesskey:"i"}}})},k=function(){$('<i class="'+o.substr(1)+'"></i>').appendTo("#rightMenu"),$.contextMenu({zIndex:9999,selector:o,callback:function(e){T(e)},items:{explorer:{name:LNG.manage_folder,className:"explorer",icon:"laptop",accesskey:"v"},refresh:{name:LNG.refresh_tree,className:"refresh",icon:"refresh",accesskey:"e"},fav:{name:LNG.add_to_fav,className:"fav",icon:"star",accesskey:"f"},search:{name:LNG.search_in_path,className:"search",icon:"search",accesskey:"s"},sep3:"--------",newfolder:{name:LNG.newfolder,className:"newfolder",icon:"folder-close-alt",accesskey:"n"},newfile:{name:LNG.newfile,className:"newfile",icon:"file-alt",accesskey:"j"},sep2:"--------",copy:{name:LNG.copy,className:"copy",icon:"copy",accesskey:"c"},cute:{name:LNG.cute,className:"cute",icon:"cut",accesskey:"k"},past:{name:LNG.past,className:"past",icon:"paste",accesskey:"p"},rname:{name:LNG.rename,className:"rname",icon:"pencil",accesskey:"r"},sep4:"--------",remove:{name:LNG.remove,className:"remove",icon:"trash",accesskey:"d"},info:{name:LNG.info,className:"info",icon:"info",accesskey:"i"},sep5:"--------",quit:{name:LNG.close_menu,className:"quit",icon:"remove",accesskey:"q"}}})},w=function(){$('<i class="'+l.substr(1)+'"></i>').appendTo("#rightMenu"),$.contextMenu({zIndex:9999,selector:l,callback:function(e){T(e)},items:{edit:{name:LNG.edit,className:"edit",icon:"edit",accesskey:"e"},open:{name:LNG.open,className:"open",icon:"external-link",accesskey:"o"},openIE:{name:LNG.open_ie,className:"openIE",icon:"globe",accesskey:"b"},download:{name:LNG.download,className:"download",icon:"download",accesskey:"x"},sep1:"--------",rname:{name:LNG.rename,className:"rname",icon:"pencil",accesskey:"r"},copy:{name:LNG.copy,className:"copy",icon:"copy",accesskey:"c"},cute:{name:LNG.cute,className:"cute",icon:"cut",accesskey:"k"},remove:{name:LNG.remove,className:"remove",icon:"trash",accesskey:"d"},sep2:"--------",info:{name:LNG.info,className:"info",icon:"info",accesskey:"i"},quit:{name:LNG.close_menu,className:"quit",icon:"remove",accesskey:"q"}}})},L=function(){$('<i class="taskBarMenu"></i>').appendTo("#rightMenu"),$.contextMenu({zIndex:9999,selector:".taskBarMenu",items:{quitOthers:{name:LNG.close_others,className:"quitOthers",icon:"remove-circle",accesskey:"o"},quit:{name:LNG.close,className:"quit",icon:"remove",accesskey:"q"}},callback:function(e,t){var a=t.$trigger.attr("id"),i=art.dialog.list[a];switch(e){case"quitOthers":$.each(art.dialog.list,function(e,t){a!=e&&t.close()});break;case"quit":i.close()}}})},C=function(){$.contextMenu({zIndex:9999,selector:".task_tab",items:{closeAll:{name:LNG.dialog_close_all,icon:"remove-circle",accesskey:"o"},showAll:{name:LNG.dialog_display_all,icon:"th-large",accesskey:"o"},hideAll:{name:LNG.dialog_min_all,icon:"remove",accesskey:"q"}},callback:function(e,t){var a=t.$trigger.attr("id");switch(art.dialog.list[a],e){case"showAll":$.each(art.dialog.list,function(e,t){t.display(!0)});break;case"hideAll":$.each(art.dialog.list,function(e,t){t.display(!1)});break;case"closeAll":$.each(art.dialog.list,function(e,t){t.close()});break;default:}}})},j=function(){$('<i class="dialog_menu"></i>').appendTo("#rightMenu"),$.contextMenu({zIndex:9999,selector:".dialog_menu",items:{quit:{name:LNG.close,icon:"remove",accesskey:"o"},hide:{name:LNG.dialog_min,icon:"minus",accesskey:"o"},refresh:{name:LNG.refresh,icon:"refresh",accesskey:"q"}},callback:function(e,t){var a=t.$trigger.attr("id"),i=art.dialog.list[a];switch(e){case"quit":i.close();break;case"hide":i.display(!1);break;case"refresh":i.refresh();break;default:}}})},T=function(e){switch(e){case"app_edit":ui.tree.appEdit();break;case"edit":ui.tree.openEditor();break;case"open":ui.tree.open();break;case"refresh":ui.tree.refresh();break;case"copy":ui.tree.copy();break;case"cute":ui.tree.cute();break;case"past":ui.tree.past();break;case"rname":ui.tree.rname();break;case"remove":ui.tree.remove();break;case"info":ui.tree.info();break;case"download":ui.tree.download();break;case"openIE":ui.tree.openIE();break;case"search":ui.tree.search();break;case"newfolder":ui.tree.create("folder");break;case"newfile":ui.tree.create("file");break;case"explorer":ui.tree.explorer();break;case"fav_page":core.setting("fav");break;case"fav":ui.tree.fav();break;case"refresh_all":ui.tree.init();break;case"quit":break;default:}};return{initDesktop:c,initExplorer:r,initEditor:d,show:function(e,t,a){e&&(rightMenu.hidden(),$(e).contextMenu({x:t,y:a}))},isDisplay:function(){var e=!1;return $(".context-menu-list").each(function(){"none"!=$(this).css("display")&&(e=!0)}),e},hidden:function(){$(".context-menu-list").filter(":visible").trigger("contextmenu:hide")}}}),define("app/common/tree",["./pathOperate","../tpl/fileinfo","../tpl/app","./pathOpen","./CMPlayer"],function(e){var t,a=e("./pathOperate"),i=e("./pathOpen"),s=!1;ui.pathOpen=i;var n=function(){$.ajax({url:Config.treeAjaxURL+"&type=init",dataType:"json",error:function(){$("#folderList").html('<div style="text-align:center;">'+LNG.system_error+"</div>")},success:function(e){if(!e.code)return $("#folderList").html('<div style="text-align:center;">'+LNG.system_error+"</div>"),void 0;var t=e.data;$.fn.zTree.init($("#folderList"),l,t)}}),$(".ztree .switch").die("mouseenter").live("mouseenter",function(){$(this).addClass("switch_hover")}).die("mouseleave").live("mouseleave",function(){$(this).removeClass("switch_hover")}),"editor"==Config.pageApp&&(Mousetrap.bind("up",function(e){o(e,"up")}).bind("down",function(e){o(e,"down")}).bind("left",function(e){o(e,"left")}).bind("right",function(e){o(e,"right")}),Mousetrap.bind("enter",function(){tree.open()}).bind(["del","command+backspace"],function(){tree.remove()}).bind("f2",function(e){stopPP(e),tree.rname()}).bind(["ctrl+f","command+f"],function(e){stopPP(e),tree.search()}).bind(["ctrl+c","command+c"],function(){tree.copy()}).bind(["ctrl+x","command+x"],function(){tree.cute()}).bind(["ctrl+v","command+v"],function(){tree.past()}).bind("alt+m",function(){tree.create("folder")}).bind("alt+n",function(){tree.create("file")}))},o=function(e,t){stopPP(e);var a=$.fn.zTree.getZTreeObj("folderList"),i=a.getSelectedNodes()[0];if(void 0!=i)switch(t){case"up":var s=i.getPreNode();if(s){if(s.open&&s.children.length>0)for(;s.open&&s.children&&s.children.length>=1;)s=s.children[s.children.length-1]}else s=i.getParentNode();a.selectNode(s);break;case"down":if(i.open&&i.children.length>=1)s=i.children[0];else{var n=i,s=n.getNextNode()||n.getParentNode().getNextNode();try{for(;!s;)n=n.getParentNode(),s=n.getNextNode()||n.getParentNode().getNextNode()}catch(e){}}a.selectNode(s);break;case"left":i.isParent?i.open?a.expandNode(i,!1):a.selectNode(i.getParentNode()):a.selectNode(i.getParentNode());break;case"right":i.open?a.selectNode(i.children[0]):a.expandNode(i,!0);
break;default:}},l={async:{enable:!0,url:Config.treeAjaxURL,autoParam:["ajax_name=name","ajax_path=path","this_path"],dataFilter:function(e,t,a){return a.code?a.data:null}},edit:{enable:!0,showRemoveBtn:!1,showRenameBtn:!1,drag:{isCopy:!1,isMove:!1}},view:{showLine:!1,selectedMulti:!1,dblClickExpand:!1,addDiyDom:function(e,t){var a=Global.treeSpaceWide,i=$("#"+t.tId+"_switch"),s=$("#"+t.tId+"_ico");if(i.remove(),s.before(i),"file"==t.type&&s.removeClass("button ico_docu").addClass("file "+t.ext),"oexe"==t.ext&&s.removeClass("button ico_docu").addClass("file oexe").removeAttr("style"),t.level>=1){var n="<span class='space' style='display: inline-block;width:"+a*t.level+"px'></span>";i.before(n)}var o="";"explorer"==Config.pageApp?("__fav__"==t.ext&&(o="menuTreeFav"),"__root__"==t.ext&&(o="menuTreeRoot"),"folder"==t.type&&(o="menuTreeFolder")):"editor"==Config.pageApp&&("__fav__"==t.ext&&(o="menuTreeFav"),"__root__"==t.ext&&(o="menuTreeRoot"),"file"==t.type&&(o="menuTreeFile"),"folder"==t.type&&(o="menuTreeFolder"),"oexe"==t.ext&&(o="menuApp"));var l=LNG.name+":"+t.name+"\n"+LNG.size+":"+t.size_friendly+"\n"+LNG.modify_time+":"+t.mtime;"file"!=t.type&&(l=t.name),i.parent().addClass(o).attr("title",l)}},callback:{onClick:function(e,t,a){var i=$.fn.zTree.getZTreeObj("folderList");return i.selectNode(a),i.expandNode(a),"folder"!=a.type||"editor"!=Config.pageApp?0==a.level?("explorer"==Config.pageApp&&"__fav__"!=a.ext&&ui.path.list(a.this_path+"/"),!1):("editor"==Config.pageApp?ui.tree.openEditor():"explorer"==Config.pageApp&&ui.tree.open(),void 0):void 0},beforeRightClick:function(e,t){var a=$.fn.zTree.getZTreeObj("folderList");a.selectNode(t)},beforeAsync:function(e,t){t.ajax_name=urlEncode(t.name),t.ajax_path=urlEncode(t.path)},onAsyncSuccess:function(){"function"==typeof t&&(t(),t=void 0)},onRename:function(e,i,s){var n=$.fn.zTree.getZTreeObj("folderList"),o=s.getParentNode();if(n.getNodesByParam("name",s.name,o).length>1)return core.tips.tips(LNG.name_isexists,!1),n.removeNode(s),void 0;if(s.create){var l=s.path+"/"+s.name;"folder"==s.type?a.newFolder(l,function(e){e.code&&(c(o),t=function(){var e=n.getNodesByParam("name",s.name,o)[0];n.selectNode(e),d()})}):a.newFile(l,function(e){e.code&&(c(o),t=function(){var e=n.getNodesByParam("name",s.name,o)[0];n.selectNode(e),d()})})}else{var r=s.path+s.beforeName,p=s.path+s.name;a.rname(r,p,function(e){e.code&&(c(o),t=function(){var e=n.getNodesByParam("name",s.name,o)[0];n.selectNode(e),d()})})}}}},r=function(e){var t=$.fn.zTree.getZTreeObj("folderList");if(t){var a=t.getSelectedNodes()[0],i="",s="";return a?(a.father?i=a.father+a.name:a.this_path?i=a.this_path:""!=a.path?i=a.path+a.name:""==a.path&&(i="/"+a.name),s=a.ext,("_null_"==s||void 0==s)&&(s="folder"),"file"==s&&(s=a.ext),e?[{path:i,type:s,node:a}]:{path:i,type:s,node:a}):{path:"",type:""}}},c=function(e){var t=$.fn.zTree.getZTreeObj("folderList");void 0==e&&(e=t.getSelectedNodes()[0]),e.isParent||(e=e.getParentNode()),t.reAsyncChildNodes(e,"refresh")},d=function(){"explorer"==Config.pageApp&&ui.f5()};return{pathOpen:i,init:n,refresh:c,openEditor:function(){i.openEditor(r().path)},openIE:function(){i.openIE(r().path)},download:function(){i.download(r().path)},open:function(){if(!($(".dialog_path_remove").length>=1)){var e=r();"oexe"==e.type&&(e.path=e.node),i.open(e.path,e.type)}},fav:function(){a.fav(r().path)},search:function(){core.search("",r().path)},appEdit:function(){var e=r(),t=e.node;t.path=e.path,a.appEdit(t,function(){c(e.node.getParentNode())})},info:function(){a.info(r(!0))},copy:function(){a.copy(r(!0))},cute:function(){a.cute(r(!0))},past:function(){var e=r();e.node.isParent||(e.node=e.node.getParentNode()),a.past(e.path,function(){d(),c(e.node)})},remove:function(){var e=r(!0),t=e[0].node.getParentNode();t?a.remove(e,function(){d(),c(t)}):$.dialog({fixed:!0,resize:!1,icon:"warning",drag:!0,title:LNG.tips,content:LNG.remove_not,ok:!0})},checkIfChange:function(e){if(!s){s=!0;var t=$.fn.zTree.getZTreeObj("folderList");t&&(t.getNodesByFilter(function(t){var a;return t.this_path?a=t.this_path:""!=t.path&&(a=t.path+t.name),a==e||a+"/"==e?(c(t),!0):!1},!0),setTimeout(function(){s=!1},1e3))}},explorer:function(){var e=r().path;e||(e=G.this_path),core.explorer(e)},fileBox:function(e){e="save_file",e="save_folder",e="select_",$(".header-left").css("width",110).next().css("left",150),$(".frame-left").width("width",142),$.dialog.open("?/explorer&plague="+e,{resize:!0,fixed:!0,title:"",width:750,height:420})},create:function(e){var a=$.fn.zTree.getZTreeObj("folderList"),i=a.getSelectedNodes();if(0>=i.length){var s=a.getNodeByParam("ext","__root__",null);a.selectNode(s)}var n=r(),o=n.node,l=o.getParentNode(),d="newfile",p=0,u=LNG.newfolder;if("folder"==e){for(;a.getNodesByParam("name",u+"("+p+")",l).length>0;)p++;newNode={name:u+"("+p+")",ext:"",type:"folder",create:!0,path:n.path}}else if("file"==e){for(;a.getNodesByParam("name",d+"("+p+").txt",l).length>0;)p++;newNode={name:d+"("+p+").txt",ext:"txt",type:"file",create:!0,path:n.path}}void 0!=o.children?(treeNodeNew=a.addNodes(o,newNode),a.editName(treeNodeNew[0])):("folder"!=o.type&&(o=o.getParentNode()),t=function(){treeNodeNew=a.addNodes(o,newNode),a.editName(treeNodeNew[0])},c(o))},rname:function(){var e=$.fn.zTree.getZTreeObj("folderList"),t=e.getSelectedNodes()[0];e.editName(t),t.beforeName=t.name}}}),define("app/common/pathOperate",["../tpl/fileinfo","../tpl/app"],function(e){var t=e("../tpl/fileinfo"),a=["/","\\",":","*","?",'"',"<",">","|"],i=function(e){var t=function(e,t){for(var a=t.length,i=0;a>i;i++)if(e.indexOf(t[i])>0)return!0;return!1};return t(e,a)?(core.tips.tips(LNG.path_not_allow+':/  : * ? " < > |',!1),!1):!0},s=function(e){var t="list=[";for(var a in e)t+='{"type":"'+e[a].type+'","path":"'+urlEncode2(e[a].path)+'"}',a!=e.length-1&&(t+=",");return t+"]"},n=function(e,t){if(e){var a=core.pathThis(e);i(a)&&$.ajax({dataType:"json",url:"index.php?explorer/mkfile&path="+urlEncode2(e),beforeSend:function(){core.tips.loading()},error:core.ajaxError,success:function(e){core.tips.close(e),"function"==typeof t&&t(e)}})}},o=function(e,t){if(e){var a=core.pathThis(e);i(a)&&$.ajax({dataType:"json",url:"index.php?explorer/mkdir&path="+urlEncode2(e),beforeSend:function(){core.tips.loading()},error:core.ajaxError,success:function(e){core.tips.close(e),"function"==typeof t&&t(e)}})}},l=function(e,t,a){e&&t&&e!=t&&i(core.pathThis(t))&&$.ajax({type:"POST",dataType:"json",url:"index.php?explorer/pathRname",data:"path="+urlEncode(e)+"&rname_to="+urlEncode(t),beforeSend:function(){core.tips.loading()},error:core.ajaxError,success:function(e){core.tips.close(e),"function"==typeof a&&a(e)}})},r=function(e,t){if(!(1>e.length)){var a=e[0].path;a.length>20&&(a=a.substr(-20)+"..."),$.dialog({id:"dialog_path_remove",fixed:!0,icon:"question",title:LNG.remove_title,padding:40,lock:!0,background:"#000",opacity:.5,content:a+"<br/>"+LNG.remove_info+""+e.length+"",ok:function(){$.ajax({url:"index.php?explorer/pathDelete",type:"POST",dataType:"json",data:s(e),beforeSend:function(){core.tips.loading()},error:core.ajaxError,success:function(e){core.tips.close(e),"function"==typeof t&&t(e)}})},cancel:!0})}},c=function(e){1>e.length||$.ajax({url:"index.php?explorer/pathCopy",type:"POST",dataType:"json",data:s(e),error:core.ajaxError,success:function(e){core.tips.tips(e)}})},d=function(e){1>e.length||$.ajax({url:"index.php?explorer/pathCute",type:"POST",dataType:"json",data:s(e),error:core.ajaxError,success:function(e){core.tips.tips(e)}})},p=function(e,t){if(e){var a="index.php?explorer/pathPast&path="+urlEncode2(e);$.ajax({url:a,dataType:"json",beforeSend:function(){core.tips.loading(LNG.moving)},error:core.ajaxError,success:function(e){e.code?core.tips.close(e.info):core.tips.close(e),"function"==typeof t&&t(e)}})}},u=function(e){if(1>e.length&&(e=[{path:G.this_path,type:"folder"}]),e.length>1)return f(e),void 0;e=e[0];var a="folder"==e.type?"path_info":"file_info";$.ajax({url:"index.php?explorer/pathInfo&type="+e.type+"&path="+urlEncode2(e.path),beforeSend:function(){core.tips.loading(LNG.getting)},error:core.ajaxError,success:function(i){if(!i.code)return core.tips.close(i),void 0;core.tips.close(LNG.get_success,!0);var s=template.compile(t[a]);i.data.LNG=LNG,$.dialog({padding:5,fixed:!0,title:core.pathThis(e.path).substr(0,20)+"...  "+LNG.info,content:s(i.data),width:"350px",cancel:!0})}})},f=function(e){$.ajax({url:"index.php?explorer/pathInfoMuti",type:"POST",data:s(e),beforeSend:function(){core.tips.loading(LNG.getting)},error:core.ajaxError,success:function(e){if(!e.code)return core.tips.close(e),void 0;core.tips.close(LNG.get_success,!0);var a=template.compile(t.path_info_more);e.data.LNG=LNG,$.dialog({padding:5,fixed:!0,width:"350px",title:LNG.info,content:a(e.data),cancel:!0})}})},h=function(e,t){1>e.length||$.ajax({url:"index.php?explorer/zip",type:"POST",dataType:"json",data:s(e),beforeSend:function(){core.tips.loading(LNG.ziping)},error:core.ajaxError,success:function(e){core.tips.close(e),e.code=100,core.tips.tips(e),"function"==typeof t&&t(e)}})},m=function(e,t){if(e){var a="index.php?explorer/unzip&path="+urlEncode2(e);$.ajax({url:a,beforeSend:function(){core.tips.loading(LNG.unziping)},error:core.ajaxError,success:function(e){core.tips.close(e),e.code=100,"function"==typeof t&&t(e)}})}},v=function(e,t,a){t&&$.ajax({url:"index.php?explorer/pathCuteDrag",type:"POST",dataType:"json",data:s(e)+"&path="+urlEncode2(t),beforeSend:function(){core.tips.loading(LNG.moving)},error:core.ajaxError,success:function(e){core.tips.close(e),e.code&&"function"==typeof a&&a(e)}})},g=function(){$.ajax({url:"index.php?explorer/clipboard",dataType:"json",error:core.ajaxError,success:function(e){e.code&&$.dialog({title:LNG.clipboard,padding:0,height:200,width:400,content:e.data})}})},_=function(e){if(e){var t="&name="+urlEncode(core.pathThis(e))+"&path="+urlEncode(e);core.setting("fav"+t)}},b=function(e){var t={};return t.type=e.find("input[type=radio]:checked").val(),t.content=e.find("textarea").val(),t.group=e.find("[name=group]").val(),e.find("input[type=text]").each(function(){var e=$(this).attr("name");t[e]=$(this).val()}),e.find("input[type=checkbox]").each(function(){var e=$(this).attr("name");t[e]="checked"==$(this).attr("checked")?1:0}),t},y=function(e){e.find(".type input").change(function(){var t=$(this).attr("apptype");e.find("[data-type]").addClass("hidden"),e.find("[data-type="+t+"]").removeClass("hidden")})},N=function(t,a,i){var s,n,o,l=LNG.app_create,r=UUID(),c=e("../tpl/app"),d=G.basic_path+"static/images/app/",p=template.compile(c.html);switch(void 0==i&&(i="user_edit"),"root_edit"==i&&(t=json_decode(t)),"user_edit"==i||"root_edit"==i?(l=LNG.app_edit,o=p({LNG:LNG,iconPath:d,uuid:r,data:t})):o=p({LNG:LNG,iconPath:d,uuid:r,data:{}}),$.dialog({fixed:!0,width:450,height:310,id:r,padding:15,title:l,content:o,button:[{name:LNG.preview,callback:function(){var e=b(s);return core.openApp(e),!1}},{name:LNG.button_save,focus:!0,callback:function(){var e=b(s);switch(i){case"user_add":var o=urlEncode2(G.this_path+e.name);n="./index.php?app/user_app&action=add&path="+o;break;case"user_edit":n="./index.php?app/user_app&path="+urlEncode2(t.path);break;case"root_add":n="./index.php?app/add&name="+e.name;break;case"root_edit":n="./index.php?app/edit&name="+e.name+"&old_name="+t.name;break;default:}$.ajax({url:n,type:"POST",dataType:"json",data:"data="+urlEncode2(json_encode(e)),beforeSend:function(){core.tips.loading()},error:core.ajaxError,success:function(e){if(core.tips.close(e),e.code)if("root_edit"==i||"root_add"==i){if(!e.code)return;FrameCall.top("Openapp_store","App.reload",'""')}else"function"==typeof a?a():ui.f5()}})}}]}),s=$("."+r),t.group&&s.find("option").eq(t.group).attr("selected",1),s.find(".aui_content").css("overflow","inherit"),i){case"user_edit":s.find(".name").addClass("hidden"),s.find(".desc").addClass("hidden"),s.find(".group").addClass("hidden"),s.find("option[value="+t.group+"]").attr("checked",!0);break;case"user_add":s.find(".desc").addClass("hidden"),s.find(".group").addClass("hidden"),s.find("[apptype=url]").attr("checked",!0),s.find("[data-type=url] input[name=resize]").attr("checked",!0),s.find("input[name=width]").attr("value","800"),s.find("input[name=height]").attr("value","600"),s.find("input[name=icon]").attr("value","oexe.png");break;case"root_add":s.find("[apptype=url]").attr("checked",!0),s.find("[data-type=url] input[name=resize]").attr("checked",!0),s.find("input[name=width]").attr("value","800"),s.find("input[name=height]").attr("value","600"),s.find("input[name=icon]").attr("value","oexe.png");break;case"root_edit":s.find("option[value="+t.group+"]").attr("selected",!0);break;default:}y(s)},x=function(){core.appStore()},k=function(e){e&&4>e.length&&"http"!=e.substring(0,4)||$.ajax({url:"./index.php?app/get_url_title&url="+e,dataType:"json",beforeSend:function(){core.tips.loading()},success:function(t){var a=t.data;core.tips.close(t);var i={content:e,desc:"",group:"others",type:"url",icon:"internet.png",name:a,resize:1,simple:0,height:"70%",width:"80%"},s=urlEncode2(G.this_path+a);e="./index.php?app/user_app&action=add&path="+s,$.ajax({url:e,type:"POST",dataType:"json",data:"data="+urlEncode2(json_encode(i)),success:function(e){core.tips.close(e),e.code&&ui.f5()}})}})};return{appEdit:N,appList:x,appAddURL:k,newFile:n,newFolder:o,rname:l,unZip:m,zip:h,copy:c,cute:d,info:u,remove:r,cuteDrag:v,past:p,clipboard:g,fav:_}});var file_info="<div class='pathinfo'>    <div class='p'>        <div class='icon file_icon'></div>        <input type='text' name='filename' value='{{name}}'/>        <div style='clear:both'></div>    </div>    <div class='line'></div>    <div class='p'>        <div class='title'>{{LNG.file_type}}:</div>        <div class='content'>{{ext}} {{LNG.file}}</div>        <div style='clear:both'></div>    </div>    <div class='line'></div>    <div class='p'>        <div class='title'>{{LNG.address}}:</div>        <div class='content' id='id_fileinfo_path'>{{path}}</div>        <div style='clear:both'></div>    </div>    <div class='p'>        <div class='title'>{{LNG.size}}:</div>        <div class='content'>{{size_friendly}}  ({{size}} Byte)</div>        <div style='clear:both'></div>    </div>    <div class='line'></div>    <div class='p'>        <div class='title'>{{LNG.create_time}}</div>        <div class='content'>{{ctime}}</div>        <div style='clear:both'></div>    </div>    <div class='p'>        <div class='title'>{{LNG.modify_time}}</div>        <div class='content'>{{mtime}}</div>        <div style='clear:both'></div>    </div>    <div class='p'>        <div class='title'>{{LNG.last_time}}</div>        <div class='content'>{{atime}}</div>        <div style='clear:both'></div>    </div>    <div class='line'></div>    <div class='p'>        <div class='title'>{{LNG.permission}}:</div>        <div class='content'>{{mode}}</div>        <div style='clear:both'></div>    </div>  </div>",path_info="<div class='pathinfo'>    <div class='p'>        <div class='icon folder_icon'></div>        <input type='text' name='filename' value='{{name}}'/>        <div style='clear:both'></div>    </div>    <div class='line'></div>    <div class='p'>        <div class='title'>{{LNG.type}}:</div>        <div class='content'>{{LNG.folder}}</div>        <div style='clear:both'></div>    </div>    <div class='p'>        <div class='title'>{{LNG.address}}:</div>        <div class='content'>{{path}}</div>        <div style='clear:both'></div>    </div>    <div class='p'>        <div class='title'>{{LNG.size}}:</div>        <div class='content'>{{size_friendly}}  ({{size}} Byte)</div>        <div style='clear:both'></div>    </div>    <div class='p'>        <div class='title'>{{LNG.contain}}:</div>         <div class='content'>{{file_num}}  {{LNG.file}},{{folder_num}}  {{LNG.folder}}</div>        <div style='clear:both'></div>    </div>    <div class='line'></div>    <div class='p'>        <div class='title'>{{LNG.create_time}}</div>        <div class='content'>{{ctime}}</div>        <div style='clear:both'></div>    </div>    <div class='p'>        <div class='title'>{{LNG.modify_time}}</div>        <div class='content'>{{mtime}}</div>        <div style='clear:both'></div>    </div>    <div class='p'>        <div class='title'>{{LNG.last_time}}</div>        <div class='content'>{{atime}}</div>        <div style='clear:both'></div>    </div>    <div class='line'></div>    <div class='p'>        <div class='title'>{{LNG.permission}}:</div>        <div class='content'>{{mode}}</div>        <div style='clear:both'></div>    </div>  </div>",path_info_more="<div class='pathinfo'>    <div class='p'>        <div class='icon folder_icon'></div>        <div class='content' style='line-height:40px;margin-left:40px;'>            {{file_num}}  {{LNG.file}},{{folder_num}}  {{LNG.file}}</div>        <div style='clear:both'></div>    </div>    <div class='line'></div>    <div class='p'>        <div class='title'>{{LNG.size}}:</div>        <div class='content'>{{size_friendly}} ({{size}} Byte)</div>        <div style='clear:both'></div>    </div>    <div class='line'></div>    <div class='p'>        <div class='title'>{{LNG.parent_permission}}:</div>        <div class='content'>{{mode}}</div>        <div style='clear:both'></div>    </div>  </div>";define("app/tpl/fileinfo",[],function(){return{file_info:file_info,path_info:path_info,path_info_more:path_info_more}}),define("app/tpl/app",[],function(){return{html:"<div class='appbox'>          <div class='appline name'>              <div class='left'>{{LNG.name}}</div>              <div class='right'><input type='text' name='name' value='{{data.name}}'/></div>              <div style='clear:both;'></div>          </div>          <div class='appline desc'>              <div class='left'>{{LNG.app_desc}}</div>              <div class='right'><input type='text' name='desc' value='{{data.desc}}'/></div>              <div style='clear:both;'></div>          </div>          <div class='appline icon'>              <div class='left'>{{LNG.app_icon}}</div>              <div class='right'><input type='text' name='icon' value='{{data.icon}}'/>              {{LNG.app_icon_show}}<a href='javascript:core.explorer(\"{{iconPath}}\");' class='button open'><img src='./static/images/app/computer.png'/></a></div>              <div style='clear:both;'></div>          </div>          <div class='appline group'>              <div class='left'>{{LNG.app_group}}</div>              <div class='right'><select name='group'>              <option value ='others'>{{LNG.app_group_others}}</option><option value ='game'>{{LNG.app_group_game}}</option>              <option value ='tools'>{{LNG.app_group_tools}}</option><option value ='reader'>{{LNG.app_group_reader}}</option>              <option value ='movie'>{{LNG.app_group_movie}}</option><option value ='music'>{{LNG.app_group_music}}</option>              </option><option value ='life'>{{LNG.app_group_life}}</option>              <select></div>              <div style='clear:both;'></div>          </div>          <div class='appline type'>              <div class='left'>{{LNG.app_type}}</div>              <div class='right'>                  <input class='w20' type='radio' id='url{{uuid}}' apptype='url' value='url' name='{{uuid}}type' {{if data.type=='url'}}checked='checked'{{/if}}>                  <label for='url{{uuid}}'>{{LNG.app_type_url}}</label>                  <input class='w20' type='radio' id='app{{uuid}}' apptype='app' value='app' name='{{uuid}}type' {{if data.type=='app'}}checked='checked'{{/if}}>                  <label for='app{{uuid}}'>{{LNG.app_type_code}}</label>              </div>              <div style='clear:both;'></div>          </div>          <div class='appline {{if data.type=='app'}}hidden{{/if}}' data-type='url'>              <div class='left'>{{LNG.app_display}}</div>              <div class='right'>                  <input class='w20' type='checkbox' id='simple{{uuid}}' name='simple' {{if data.simple}}checked='true'{{/if}}>                  <label for='simple{{uuid}}'>{{LNG.app_display_border}}</label>                  <input class='w20' type='checkbox' id='resize{{uuid}}' name='resize' {{if data.resize}}checked='true'{{/if}}>                  <label for='resize{{uuid}}'>{{LNG.app_display_size}}</label>              </div>              <div style='clear:both;'></div>          </div>          <div class='appline {{if data.type=='app'}}hidden{{/if}}' data-type='url'>              <div class='left'>{{LNG.app_size}}</div>              <div class='right'>                  {{LNG.width}}:&nbsp;&nbsp;<input class='w30' type='text' name='width'  value='{{data.width}}'/>                  {{LNG.height}}:&nbsp;&nbsp;<input class='w30' type='text' name='height' value='{{data.height}}'/>              </div>              <div style='clear:both;'></div>          </div>          <div class='appline content'>              <div class='left hidden' data-type='app'>{{LNG.app_code}}</div>              <div class='left' data-type='url'>{{LNG.app_url}}</div>              <div class='right'><textarea name='content'>{{data.content}}</textarea></div>              <div style='clear:both;'></div>          </div>      </div>"}}),define("app/common/pathOpen",["./CMPlayer"],function(e){var t=function(e,t){if(void 0!=e){if(void 0==t&&(t=core.pathExt(e)),t=t.toLowerCase(),"folder"==t)return"explorer"==Config.pageApp?ui.path.list(e+"/"):core.explorer(e),void 0;if("swf"==t){var i=core.path2url(e);return s(i,core.pathThis(e)),void 0}if("oexe"==t)return core.openApp(e),void 0;if("pdf"==t){var r="pdf"+UUID(),i=core.path2url(e),c='<div id="'+r+'" style="height:100%;">			<a href="'+i+'" target="_blank" style="display:block;margin:0 auto;margin-top:80px;font-size:16px;text-align:center;">'+LNG.error+"   "+LNG.download+" PDF</a></div>";return $.dialog({resize:!0,fixed:!0,title:core.pathThis(e),width:800,height:400,padding:0,content:c}),new PDFObject({url:i}).embed(r),void 0}if("html"==t||"htm"==t){var i=core.path2url(e);return s(i,core.pathThis(e)),void 0}if(inArray(core.filetype.image,t)){var i=urlDecode(e);return-1==e.indexOf("http:")&&(i=core.path2url(i)),MaskView.image(i),void 0}if(inArray(core.filetype.music,t)||inArray(core.filetype.movie,t)){var i=core.path2url(e);return l(i,t),void 0}if(inArray(core.filetype.doc,t)){var i=core.path2url(e);return o(i,t),void 0}return inArray(core.filetype.bindary,t)?(a(e),void 0):(n(e),void 0)}},a=function(e){if(e){var t="index.php?explorer/fileDownload&path="+urlEncode2(e),a='<iframe src="'+t+'" style="width:0px;height:0px;border:0;" frameborder=0></iframe>'+LNG.download_ready+"...",i=$.dialog({icon:"succeed",title:!1,time:1,content:a});i.DOM.wrap.find(".aui_loading").remove()}},i=function(e){if(void 0!=e){var t=core.path2url(e);window.open(t)}},s=function(e,t,a){if(e){void 0==a&&(a="openWindow"+UUID());var i="<iframe frameborder='0' name='Open"+a+"' src='"+e+"' style='width:100%;height:100%;border:0;'></iframe>";art.dialog.through({id:a,title:t,width:"70%",height:"65%",padding:0,content:i,resize:!0})}},n=function(e){if(e){var t=core.pathExt(e),a=core.pathThis(e);if(inArray(core.filetype.bindary,t)||inArray(core.filetype.music,t)||inArray(core.filetype.image,t)||inArray(core.filetype.movie,t)||inArray(core.filetype.doc,t))return core.tips.tips(t+LNG.edit_can_not,!1),void 0;if(void 0==window.top.frames.OpenopenEditor){var i="?editor/edit&filename="+urlEncode(urlEncode2(e)),n=a+" "+LNG.edit;s(i,n.substring(n.length-50),"openEditor")}else $.dialog.list.openEditor&&$.dialog.list.openEditor.display(!0),FrameCall.top("OpenopenEditor","Editor.add",'"'+urlEncode2(e)+'"')}},o=function(e,t){var a,i,s;switch(t){case"doc":case"docx":case"docm":case"dot":a="http://sg1b-word-view.officeapps.live.com/wv/wordviewerframe.aspx?ui=zh-CN&rs=zh-CN&WOPISrc=";break;case"ppt":case"pptm":case"pptx":a="http://sg1b-powerpoint.officeapps.live.com/p/PowerPointFrame.aspx?PowerPointView=ReadingView&ui=zh-CN&rs=zh-CN&WOPISrc=";break;case"xls":case"xlsb":case"xlsm":case"xlsx":a="http://sg1b-excel.officeapps.live.com/x/_layouts/xlviewerinternal.aspx?ui=zh-CN&rs=zh-CN&WOPISrc=";break;default:}i="http://sg1b-15-view-wopi.wopi.live.net:808/oh/wopi/files/@/wFileId?wFileId=",i+=urlEncode(e),s=a+urlEncode(i)+"&access_token=1&access_token_ttl=0";var n=core.pathThis(urlDecode(e));art.dialog.open(s,{title:n,width:"70%",height:"65%",resize:!0})},l=function(t,a){t&&("string"==typeof t&&(t=[t]),CMPlayer=e("./CMPlayer"),CMPlayer.play(t,a))};return{open:t,play:l,openEditor:n,openIE:i,download:a}}),define("app/common/CMPlayer",[],function(){var e={ting:{path:"music/ting",width:410,height:530},beveled:{path:"music/beveled",width:350,height:200},kuwo:{path:"music/kuwo",width:480,height:200},manila:{path:"music/manila",width:320,height:400},mp3player:{path:"music/mp3player",width:320,height:410},qqmusic:{path:"music/qqmusic",width:300,height:400},somusic:{path:"music/somusic",width:420,height:137},xdj:{path:"music/xdj",width:595,height:235},webplayer:{path:"movie/webplayer",width:600,height:400},qqplayer:{path:"movie/qqplayer",width:600,height:400},tvlive:{path:"movie/tvlive",width:600,height:400},youtube:{path:"movie/youtube",width:600,height:400},vplayer:{path:"movie/vplayer",width:600,height:400}},t=function(e){return"music"==e?"music_player":(void 0==e&&(e="mp3"),inArray(core.filetype.music,e)?"music_player":"movie_player")},a=function(t){var a,i,n;"music_player"==t?(a=e[G.musictheme],i="music player",n=!1):(a=e[G.movietheme],i="movie player",n=!0);var o=core.createFlash(G.static_path+"js/lib/cmp4/cmp.swf","context_menu=2&auto_play=1&play_mode=1&skin=skins/"+a.path+".zip",t),l={id:t+"_dialog",simple:!0,title:i,width:a.width,height:a.height,content:o,resize:n,padding:0,fixed:!0,close:function(){var e=s(t);e&&e.sendEvent&&e.sendEvent("view_stop")}};window.top.CMP?art.dialog.through(l):$.dialog(l)},i=function(e){var t,a="";for(t=e.length-1;t>=0;t--){var i,s;-1==e[t].search("fileProxy")?(i=urlEncode(e[t]),s=core.pathThis(e[t])):(i=e[t],s=core.pathThis(urlDecode(i))),i=i.replace(/%2F/g,"/"),i=i.replace(/%3F/g,"?"),i=i.replace(/%26/g,"&"),i=i.replace(/%3A/g,":"),i=i.replace(/%3D/g,"="),a+='<list><m type="" src="'+i+'" label="'+s+'"/></list>'}return a},s=function(e){return window.top.CMP?window.top.CMP.get(e):CMP.get(e)},n=function(e,t){var a=i(e),n=s(t);if(n){n.config("play_mode","normal");var o=n.list().length;n.list_xml(a,!0),n.sendEvent("view_play",o+1)}};return{changeTheme:function(t,a){var i,n,o;"music"==t?(G.musictheme=a,i="music_player"):"movie"==t&&(G.movietheme=a,i="movie_player"),o=s(i),o&&(n=e[a],window.top.art.dialog.list[i+"_dialog"].size(n.width,n.height),o.sendEvent("skin_load","skins/"+n.path+".zip"))},play:function(e,i){var o=t(i),l=s(o);l?(n(e,o),window.top.art.dialog.list[o+"_dialog"].display(!0)):(a(o),setTimeout(function(){n(e,o)},1e3))}}}),define("app/src/explorer/path",["../../common/pathOperate","../../tpl/fileinfo","../../tpl/app","../../common/pathOpen","../../common/CMPlayer"],function(e){var t=e("../../common/pathOperate"),a=e("../../common/pathOpen"),s=void 0;ui.pathOpen=a;var n=function(e,t){var a,i,s=0,n=G.json_data.folderlist,o=G.json_data.filelist;if("desktop"==Config.pageApp&&(s=$(".menuDefault").length),"folder"==t){for(a=0;n.length>a&&!(n[a].name>=e);a++);return"up"==G.sort_order?a+s:o.length+a+s}if("file"==t){for(i=0;o.length>i&&!(o[i].name>=e);i++);return"down"==G.sort_order?i+s:n.length+i+s}return-1},o=function(e){void 0!=e&&("string"==typeof e&&(e=[e]),fileLight.clear(),$(".fileContiner .file").each(function(t){var a=fileLight.name($(this));-1!=$.inArray(a,e)&&$(Global.fileListAll).eq(t).addClass(Config.SelectClassName)}),fileLight.select())},l=function(e){if(""!=e){if(e=e.toLowerCase(),void 0==s||G.this_path!=s.path||e!=s.key){var t=[];$(".fileContiner .file").each(function(){var a=fileLight.name($(this));e==a.substring(0,e.length).toLowerCase()&&t.push(a)}),s={key:e,path:G.this_path,index:0,list:t}}0!=s.list.length&&(o(s.list[s.index++]),s.index==s.list.length&&(s.index=0))}},r=function(e,t,a){var s=e.length;for(i=0;s>i;i++)if(e[i][t]==a)return e[i]},c=function(e){var t="",a=0;return null!=G.json_data.filelist&&(t=r(G.json_data.filelist,"name",e),null!=t&&(a=1)),null!=G.json_data.folderlist&&(t=r(G.json_data.folderlist,"name",e),null!=t&&(a=1)),a},d=function(e,t){var a,i=0;if(void 0==t){if(!c(e))return e;for(a=e+"(0)";c(a);)i++,a=e+"("+i+")";return a}if(!c(e+"."+t))return e+"."+t;for(a=e+"(0)."+t;c(a);)i++,a=e+"("+i+")."+t;return a},p=function(e){if(e){var t=[];return 0==Global.fileListSelect.length?t:(Global.fileListSelect.each(function(){var e=G.this_path+fileLight.name($(this)),a="folder"==fileLight.type($(this))?"folder":"file";t.push({path:e,type:a})}),t)}if(1!=Global.fileListSelectNum)return{path:"",type:""};var a=Global.fileListSelect,i=G.this_path+fileLight.name(a),s=fileLight.type(a);return{path:i,type:s}},u=function(e,t){return e==G.this_path?(void 0!=t&&core.tips.tips(LNG.path_is_current,"info"),void 0):(G.this_path=e.replace(/\\/g,"/"),G.this_path=e.replace(/\/+/g,"/"),"/"!=G.this_path.substr(G.this_path.length-1)&&(G.this_path+="/"),ui.f5(),void 0)},f=function(){$.ajax({dataType:"json",url:"index.php?explorer/historyBack",beforeSend:function(){$(".tools-left .msg").stop(!0,!0).fadeIn(100)},success:function(e){return $(".tools-left .msg").fadeOut(100),e.code?(e=e.data,G.this_path=e.thispath,G.json_data=e.list,Global.historyStatus=e.history_status,ui.f5(!1,!0),ui.header.updateHistoryStatus(),ui.header.addressSet(),void 0):(core.tips.tips(e),$(Config.FileBoxSelector).html(""),!1)}})},h=function(){$.ajax({dataType:"json",url:"index.php?explorer/historyNext",beforeSend:function(){$(".tools-left .msg").stop(!0,!0).fadeIn(100)},success:function(e){return $(".tools-left .msg").fadeOut(100),e.code?(e=e.data,G.this_path=e.thispath,G.json_data=e.list,Global.historyStatus=e.history_status,ui.f5(!1,!0),ui.header.updateHistoryStatus(),ui.header.addressSet(),void 0):(core.tips.tips(e),$(Config.FileBoxSelector).html(""),!1)}})},m=function(e){fileLight.clear(),void 0==e&&(e="txt");var a="newfile",a=d(a,e),i=n(a,"file");i=0==i?-1:i-1;var s='<div class="file select menufile"  id="makefile">			<div class="'+e+' ico"></div>				<div class="titleBox">					<span class="title">					<div class="textarea">						<textarea class="newfile fix">'+a+'</textarea>					</span>				</div>			</div>			<div style="clear:both;"></div>		</div>';-1==i?$(Config.FileBoxSelector).html(s+$(Config.FileBoxSelector).html()):$(s).insertAfter(Config.FileBoxSelector+" .file:eq("+i+")");var l=$(".newfile"),r=l.get(0),p=a.length-e.length-1;if(Global.isIE){var u=r.createTextRange();u.moveEnd("character",-r.value.length),u.moveEnd("character",p),u.moveStart("character",0),u.select()}else r.setSelectionRange(0,p);l.focus(),l.unbind("keydown").keydown(function(e){return(13==e.keyCode||27==e.keyCode)&&(stopPP(e),e.preventDefault(),filename=l.attr("value"),c(filename)?($("#makefile").remove(),core.tips.tips(LNG.path_exists,"warning")):t.newFile(G.this_path+filename,function(){ui.tree.checkIfChange(G.this_path),ui.f5_callback(function(){o(filename)})})),!0}),l.unbind("blur").blur(function(){filename=l.attr("value"),c(filename)?($("#makefile").remove(),core.tips.tips(LNG.path_exists,"warning"),_newFile(e)):t.newFile(G.this_path+filename,function(){ui.tree.checkIfChange(G.this_path),ui.f5_callback(function(){o(filename)})})})},v=function(){fileLight.clear();var e=LNG.newfolder,e=d(e),a=n(e,"folder");a=0==a?-1:a-1;var i='<div class="file select menufolder" id="makefile">';i+='<div class="folder ico" filetype="folder"></div>',i+='<div  class="titleBox"><span class="title">',i+='<div class="textarea"><textarea class="newfile fix">'+e+'</textarea></span></div></div><div style="clear:both;"></div></div>',-1==a?$(Config.FileBoxSelector).html(i+$(Config.FileBoxSelector).html()):$(i).insertAfter(Config.FileBoxSelector+" .file:eq("+a+")"),$(".newfile").select(),$(".newfile").focus(),$(".newfile").unbind("keydown").keydown(function(e){if(13==e.keyCode||27==e.keyCode){stopPP(e),e.preventDefault();
var a=$(".newfile").attr("value");c(a)?($("#makefile").remove(),core.tips.tips(LNG.path_exists,"warning")):t.newFolder(G.this_path+a,function(){ui.tree.checkIfChange(G.this_path),ui.f5_callback(function(){o(a)})})}}),$(".newfile").unbind("blur").blur(function(){filename=$(".newfile").attr("value"),c(filename)?($("#makefile").remove(),core.tips.tips(LNG.path_exists,"warning"),_newFolder()):t.newFolder(G.this_path+filename,function(){ui.tree.checkIfChange(G.this_path),ui.f5_callback(function(){o(filename)})})})},g=function(){var e="",a="",i=Global.fileListSelect,s=fileLight.name(i),n=fileLight.type(i);n="folder"==n?"folder":n,$(i).find(".title").html("<div class='textarea'><textarea class='fix' id='pathRenameTextarea'>"+$(i).find(".title").text()+"</textarea><div>");var l=$("#pathRenameTextarea"),r=l.get(0);if("folder"==n)l.select();else{var c=s.length-n.length-1;if(Global.isIE){var d=r.createTextRange();d.moveEnd("character",-r.value.length),d.moveEnd("character",c),d.moveStart("character",0),d.select()}else r.setSelectionRange(0,c)}l.unbind("focus").focus(),l.keydown(function(r){if(13==r.keyCode){r.preventDefault(),stopPP(r),e=l.attr("value"),"oexe"==n&&(e+=".oexe");var c=e;e!=s?(a=urlEncode(G.this_path+s),e=urlEncode(G.this_path+e),t.rname(a,e,function(){ui.tree.checkIfChange(G.this_path),ui.f5_callback(function(){o(c)})})):("oexe"==n&&(s=s.replace(".oexe","")),$(i).find(".title").html(s))}27==r.keyCode&&("oexe"==n&&(s=s.replace(".oexe","")),$(i).find(".title").html(s))}),l.unbind("blur").blur(function(){e=$("#pathRenameTextarea").attr("value"),"oexe"==n&&(e+=".oexe");var l=e;e!=s?(a=urlEncode(G.this_path+s),e=urlEncode(G.this_path+e),t.rname(a,e,function(){ui.tree.checkIfChange(G.this_path),ui.f5_callback(function(){o(l)})})):("oexe"==n&&(s=s.replace(".oexe","")),$(i).find(".title").html(s))})},_=function(){ui.f5(),ui.tree.checkIfChange(G.this_path)};return{appEdit:function(e){if(e)t.appEdit(0,0,"user_add");else{var a=Global.fileListSelect.attr("data-app"),i=json_decode(urlDecode(a));i.path=G.this_path+fileLight.name(Global.fileListSelect),t.appEdit(i)}},appList:function(){t.appList(p().path)},appInstall:function(){t.appInstall(p().path)},openEditor:function(){a.openEditor(p().path)},openIE:function(){a.openIE(p().path)},download:function(){a.download(p().path)},open:function(e){if(void 0!=e)return a.open(e),void 0;var t=p(),i=Global.fileListSelect;if(inArray(core.filetype.image,t.type))return"icon"==G.list_type?ui.picasa.play($(i).find(".ico")):ui.picasa.play($(i)),void 0;if("oexe"==t.type){var s=i.attr("data-app");t.path=json_decode(urlDecode(s))}a.open(t.path,t.type)},play:function(){if(!(1>Global.fileListSelectNum)){var e=[];Global.fileListSelect.each(function(){var t=fileLight.type($(this));if(inArray(core.filetype.music,t)||inArray(core.filetype.movie,t)){var a=core.path2url(G.this_path+fileLight.name($(this)));e.push(a)}}),a.play(e,"music")}},pathOperate:t,search:function(){core.search("",p().path)},fav:function(){t.fav(p().path)},remove:function(){t.remove(p(!0),_),fileLight.clear()},copy:function(){t.copy(p(!0))},cute:function(){t.cute(p(!0),ui.f5)},zip:function(){t.zip(p(!0),_)},unZip:function(){t.unZip(p().path,ui.f5)},cuteDrag:function(e){t.cuteDrag(p(!0),e,_)},info:function(){t.info(p(!0))},past:function(){fileLight.clear(),t.past(G.this_path,function(e){ui.tree.checkIfChange(G.this_path),ui.f5_callback(function(){o(e.data)})})},back:f,next:h,list:u,newFile:m,newFolder:v,rname:g,setSelectByChar:l,setSelectByFilename:o,clipboard:t.clipboard}});